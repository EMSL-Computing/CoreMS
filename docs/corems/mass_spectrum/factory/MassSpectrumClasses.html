<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>corems.mass_spectrum.factory.MassSpectrumClasses API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../factory.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;corems.mass_spectrum.factory</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#overrides">overrides</a>
            </li>
            <li>
                    <a class="class" href="#MassSpecBase">MassSpecBase</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MassSpecBase.__init__">MassSpecBase</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mspeaks">mspeaks</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.is_calibrated">is_calibrated</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.is_centroid">is_centroid</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.has_frequency">has_frequency</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_order">calibration_order</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_points">calibration_points</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_ref_mzs">calibration_ref_mzs</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_meas_mzs">calibration_meas_mzs</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_RMS">calibration_RMS</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_segment">calibration_segment</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_raw_error_median">calibration_raw_error_median</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.calibration_raw_error_stdev">calibration_raw_error_stdev</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.set_indexes">set_indexes</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.reset_indexes">reset_indexes</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.add_mspeak">add_mspeak</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.reset_cal_therms">reset_cal_therms</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.clear_molecular_formulas">clear_molecular_formulas</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.process_mass_spec">process_mass_spec</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.cal_noise_threshold">cal_noise_threshold</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.parameters">parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.set_parameter_from_json">set_parameter_from_json</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.set_parameter_from_toml">set_parameter_from_toml</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mspeaks_settings">mspeaks_settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.settings">settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.molecular_search_settings">molecular_search_settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mz_cal_profile">mz_cal_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mz_cal">mz_cal</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mz_exp">mz_exp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.freq_exp_profile">freq_exp_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.freq_exp_pp">freq_exp_pp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mz_exp_profile">mz_exp_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.mz_exp_pp">mz_exp_pp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.abundance_profile">abundance_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.abundance_profile_pp">abundance_profile_pp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.abundance">abundance</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.freq_exp">freq_exp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.resolving_power">resolving_power</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.signal_to_noise">signal_to_noise</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.nominal_mz">nominal_mz</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.get_mz_and_abundance_peaks_tuples">get_mz_and_abundance_peaks_tuples</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.kmd">kmd</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.kendrick_mass">kendrick_mass</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.max_mz_exp">max_mz_exp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.min_mz_exp">min_mz_exp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.max_abundance">max_abundance</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.max_signal_to_noise">max_signal_to_noise</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.most_abundant_mspeak">most_abundant_mspeak</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.min_abundance">min_abundance</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.dynamic_range">dynamic_range</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.baseline_noise">baseline_noise</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.baseline_noise_std">baseline_noise_std</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.Aterm">Aterm</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.Bterm">Bterm</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.Cterm">Cterm</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.filename">filename</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.dir_location">dir_location</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.sort_by_mz">sort_by_mz</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.sort_by_abundance">sort_by_abundance</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecBase.tic">tic</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.check_mspeaks_warning">check_mspeaks_warning</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.check_mspeaks">check_mspeaks</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.remove_assignment_by_index">remove_assignment_by_index</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_index">filter_by_index</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_mz">filter_by_mz</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_s2n">filter_by_s2n</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_abundance">filter_by_abundance</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_max_resolving_power">filter_by_max_resolving_power</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_mean_resolving_power">filter_by_mean_resolving_power</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_min_resolving_power">filter_by_min_resolving_power</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.filter_by_noise_threshold">filter_by_noise_threshold</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.find_peaks">find_peaks</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.change_kendrick_base_all_mspeaks">change_kendrick_base_all_mspeaks</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.get_nominal_mz_first_last_indexes">get_nominal_mz_first_last_indexes</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.get_masses_count_by_nominal_mass">get_masses_count_by_nominal_mass</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.datapoints_count_by_nominal_mz">datapoints_count_by_nominal_mz</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.get_nominal_mass_indexes">get_nominal_mass_indexes</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.plot_centroid">plot_centroid</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.plot_profile_and_noise_threshold">plot_profile_and_noise_threshold</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.plot_mz_domain_profile">plot_mz_domain_profile</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_excel">to_excel</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_hdf">to_hdf</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_csv">to_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_pandas">to_pandas</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_dataframe">to_dataframe</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.to_json">to_json</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.parameters_json">parameters_json</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecBase.parameters_toml">parameters_toml</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MassSpecProfile">MassSpecProfile</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MassSpecProfile.__init__">MassSpecProfile</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MassSpecfromFreq">MassSpecfromFreq</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MassSpecfromFreq.__init__">MassSpecfromFreq</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecfromFreq.has_frequency">has_frequency</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecfromFreq.magnetron_frequency">magnetron_frequency</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecfromFreq.magnetron_frequency_sigma">magnetron_frequency_sigma</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecfromFreq.transient_settings">transient_settings</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecfromFreq.calc_magnetron_freq">calc_magnetron_freq</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MassSpecCentroid">MassSpecCentroid</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MassSpecCentroid.__init__">MassSpecCentroid</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroid.is_centroid">is_centroid</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroid.data_dict">data_dict</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroid.mz_exp_profile">mz_exp_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroid.abundance_profile">abundance_profile</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroid.tic">tic</a>
                        </li>
                        <li>
                                <a class="function" href="#MassSpecCentroid.process_mass_spec">process_mass_spec</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#MassSpecCentroidLowRes">MassSpecCentroidLowRes</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#MassSpecCentroidLowRes.__init__">MassSpecCentroidLowRes</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.mz_exp">mz_exp</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.abundance">abundance</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.processed_tic">processed_tic</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.tic">tic</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.mz_abun_tuples">mz_abun_tuples</a>
                        </li>
                        <li>
                                <a class="variable" href="#MassSpecCentroidLowRes.mz_abun_dict">mz_abun_dict</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../../corems.html">corems</a><wbr>.<a href="./../../mass_spectrum.html">mass_spectrum</a><wbr>.<a href="./../factory.html">factory</a><wbr>.MassSpectrumClasses    </h1>

                
                        <input id="mod-MassSpectrumClasses-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-MassSpectrumClasses-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="kn">from</span> <span class="nn">lmfit.models</span> <span class="kn">import</span> <span class="n">GaussianModel</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1"># from matplotlib import rcParamsDefault, rcParams</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">float64</span><span class="p">,</span> <span class="n">histogram</span><span class="p">,</span> <span class="n">trapz</span><span class="p">,</span> <span class="n">where</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.constant</span> <span class="kn">import</span> <span class="n">Labels</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.factory.parameters</span> <span class="kn">import</span> <span class="n">MSParameters</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.input.parameter_from_json</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>    <span class="n">load_and_set_parameters_ms</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a>    <span class="n">load_and_set_toml_parameters_ms</span><span class="p">,</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="p">)</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectrum.calc.KendrickGroup</span> <span class="kn">import</span> <span class="n">KendrickGrouping</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectrum.calc.MassSpectrumCalc</span> <span class="kn">import</span> <span class="n">MassSpecCalc</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectrum.calc.MeanResolvingPowerFilter</span> <span class="kn">import</span> <span class="n">MeanResolvingPowerFilter</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span> <span class="nn">corems.ms_peak.factory.MSPeakClasses</span> <span class="kn">import</span> <span class="n">ICRMassPeak</span> <span class="k">as</span> <span class="n">MSPeak</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Yuri E. Corilo&quot;</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;Jun 12, 2019&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="k">def</span> <span class="nf">overrides</span><span class="p">(</span><span class="n">interface_class</span><span class="p">):</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the method overrides a method from an interface class.&quot;&quot;&quot;</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="k">def</span> <span class="nf">overrider</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a>        <span class="k">assert</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">interface_class</span><span class="p">)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>        <span class="k">return</span> <span class="n">method</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>    <span class="k">return</span> <span class="n">overrider</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="k">class</span> <span class="nc">MassSpecBase</span><span class="p">(</span><span class="n">MassSpecCalc</span><span class="p">,</span> <span class="n">KendrickGrouping</span><span class="p">):</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum base class, stores the profile data and instrument settings.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">    Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    _mspeaks is populated under the hood by calling process_mass_spec method.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">    Iteration is null if _mspeaks is empty.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">    Parameters</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    ----------</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">    mz_exp : array_like</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">    abundance : array_like</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">    d_params : dict</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        A dictionary of parameters for the mass spectrum.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">    **kwargs</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">        Additional keyword arguments.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">    Attributes</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">    ----------</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">    mspeaks : list</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">    is_calibrated : bool</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">        Whether the mass spectrum is calibrated.</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">    is_centroid : bool</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">        Whether the mass spectrum is centroided.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">    has_frequency : bool</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">        Whether the mass spectrum has a frequency domain.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    calibration_order : None or int</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">        The order of the mass spectrum&#39;s calibration.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">    calibration_points : None or ndarray</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">        The calibration points of the mass spectrum.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    calibration_ref_mzs: None or ndarray</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        The reference m/z values of the mass spectrum&#39;s calibration.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">    calibration_meas_mzs : None or ndarray</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">        The measured m/z values of the mass spectrum&#39;s calibration.</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    calibration_RMS : None or float</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">        The root mean square of the mass spectrum&#39;s calibration.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">    calibration_segment : None or CalibrationSegment</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">        The calibration segment of the mass spectrum.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">    _dict_nominal_masses_indexes : dict</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">        A dictionary of nominal masses and their indexes.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    _baseline_noise : float</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        The baseline noise of the mass spectrum.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    _baseline_noise_std : float</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">        The standard deviation of the baseline noise of the mass spectrum.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    _dynamic_range : float or None</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">        The dynamic range of the mass spectrum.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    _transient_settings : None or TransientSettings</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">        The transient settings of the mass spectrum.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    _frequency_domain : None or FrequencyDomain</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">        The frequency domain of the mass spectrum.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    _mz_cal_profile : None or MzCalibrationProfile</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">        The m/z calibration profile of the mass spectrum.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">    Methods</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    -------</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">    * process_mass_spec(). Main function to process the mass spectrum,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    including calculating the noise threshold, peak picking, and resetting the MSpeak indexes.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    See also: MassSpecCentroid(), MassSpecfromFreq(), MassSpecProfile()</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_exp</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">abundance</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>        <span class="c1"># objects created after process_mass_spec() function</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>        <span class="c1"># set to None: initialization occurs inside subclass MassSpecfromFreq</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transient_settings</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_order</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_ref_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_meas_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_RMS</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_segment</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_median</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_stdev</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>    <span class="k">def</span> <span class="nf">_init_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the settings for the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">MSParameters</span><span class="p">()</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MSPeak</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>    <span class="k">def</span> <span class="nf">set_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the mass spectrum to iterate over only the selected MSpeaks indexes.</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">        Parameters</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">        ----------</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">            A list of integers representing the indexes of the MSpeaks to iterate over.</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_indexes</span><span class="p">]</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="k">def</span> <span class="nf">reset_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the mass spectrum to iterate over all MSpeaks objects.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a><span class="sd">        This method resets the mass spectrum to its original state, allowing iteration over all MSpeaks objects.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">        It also sets the index of each MSpeak object to its corresponding position in the mass spectrum.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>    <span class="k">def</span> <span class="nf">add_mspeak</span><span class="p">(</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>        <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="n">abundance</span><span class="p">,</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>        <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>        <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>        <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="n">exp_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="n">ms_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>    <span class="p">):</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new MSPeak object to the MassSpectrum object.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        Parameters</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        ----------</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="sd">        ion_charge : int</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">            The ion charge of the MSPeak.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a><span class="sd">        mz_exp : float</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a><span class="sd">            The experimental m/z value of the MSPeak.</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="sd">        abundance : float</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a><span class="sd">            The abundance of the MSPeak.</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">        resolving_power : float</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a><span class="sd">            The resolving power of the MSPeak.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="sd">        signal_to_noise : float</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">            The signal-to-noise ratio of the MSPeak.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="sd">        massspec_indexes : list</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">            A list of indexes of the MSPeak in the MassSpectrum object.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">        exp_freq : float, optional</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">            The experimental frequency of the MSPeak. Defaults to None.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">        ms_parent : MSParent, optional</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">            The MSParent object associated with the MSPeak. Defaults to None.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>        <span class="n">mspeak</span> <span class="o">=</span> <span class="n">MSPeak</span><span class="p">(</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>            <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>            <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>            <span class="n">abundance</span><span class="p">,</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>            <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>            <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">),</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>            <span class="n">exp_freq</span><span class="o">=</span><span class="n">exp_freq</span><span class="p">,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>            <span class="n">ms_parent</span><span class="o">=</span><span class="n">ms_parent</span><span class="p">,</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mspeak</span><span class="p">)</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>    <span class="k">def</span> <span class="nf">_set_parameters_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d_params</span><span class="p">):</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the parameters of the MassSpectrum object.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        Parameters</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        ----------</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">        d_params : dict</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">            A dictionary containing the parameters to set.</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">        Notes</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">        -----</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">        This method sets the following parameters of the MassSpectrum object:</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">        - _calibration_terms</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a><span class="sd">        - label</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        - analyzer</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">        - acquisition_time</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">        - instrument_label</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">        - polarity</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">        - scan_number</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">        - retention_time</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        - mobility_rt</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        - mobility_scan</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        - _filename</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        - _dir_location</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a><span class="sd">        - _baseline_noise</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a><span class="sd">        - _baseline_noise_std</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        - sample_name</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Aterm&quot;</span><span class="p">),</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Bterm&quot;</span><span class="p">),</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Cterm&quot;</span><span class="p">),</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>        <span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_time</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;acquisition_time&quot;</span><span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;instrument_label&quot;</span><span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;polarity&quot;</span><span class="p">))</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_number</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scan_number&quot;</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">retention_time</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rt&quot;</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mobility_rt</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mobility_rt&quot;</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mobility_scan</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mobility_scan&quot;</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename_path&quot;</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_location</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dir_location&quot;</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="k">if</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sample_name&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sample_name&quot;</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="k">def</span> <span class="nf">reset_cal_therms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">fas</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset calibration terms and recalculate the mass-to-charge ratio and abundance.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">        Parameters</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">        ----------</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a><span class="sd">        Aterm : float</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">            The A-term calibration coefficient.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        Bterm : float</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">            The B-term calibration coefficient.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">        C : float</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">            The C-term calibration coefficient.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        fas : float, optional</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">            The frequency amplitude scaling factor. Default is 0.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span> <span class="o">=</span> <span class="p">(</span><span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz</span><span class="p">()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="k">def</span> <span class="nf">clear_molecular_formulas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the molecular formulas for all mspeaks in the MassSpectrum.</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        Returns</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        -------</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        numpy.ndarray</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">            An array of the cleared molecular formulas for each mspeak in the MassSpectrum.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">        Parameters</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">        ----------</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">        keep_profile : bool, optional</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">            Whether to keep the profile data after processing. Defaults to True.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">        Notes</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        -----</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">        This method does the following:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">        - calculates the noise threshold</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">        - does peak picking (creates mspeak_objs)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        - resets the mspeak_obj indexes</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="c1"># if runned mannually make sure to rerun filter_by_noise_threshold</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="c1"># calculates noise threshold</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>        <span class="c1"># do peak picking( create mspeak_objs)</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="c1"># reset mspeak_obj the indexes</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cal_noise_threshold</span><span class="p">()</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_profile</span><span class="p">:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">*=</span> <span class="mi">0</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">*=</span> <span class="mi">0</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>    <span class="k">def</span> <span class="nf">cal_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the noise threshold of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">simulated_profile</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_log_noise_threshold_calc</span><span class="p">()</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>            <span class="p">)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a>            <span class="p">)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>    <span class="nd">@property</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="nd">@parameters</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MSParameters</span><span class="p">):</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">instance_MSParameters</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the parameters of the mass spectrum from a JSON file.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">        Parameters</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        ----------</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        parameters_path : str</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">            The path to the JSON file containing the parameters.</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>        <span class="n">load_and_set_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="n">load_and_set_toml_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="nd">@property</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="k">def</span> <span class="nf">mspeaks_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the MS peak settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>    <span class="nd">@mspeaks_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>    <span class="k">def</span> <span class="nf">mspeaks_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MassSpecPeakSetting</span><span class="p">):</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span> <span class="o">=</span> <span class="n">instance_MassSpecPeakSetting</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>    <span class="nd">@property</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>    <span class="nd">@settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MassSpectrumSetting</span><span class="p">):</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span> <span class="o">=</span> <span class="n">instance_MassSpectrumSetting</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>    <span class="nd">@property</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>    <span class="k">def</span> <span class="nf">molecular_search_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the molecular search settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">molecular_search</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>    <span class="nd">@molecular_search_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>    <span class="k">def</span> <span class="nf">molecular_search_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MolecularFormulaSearchSettings</span><span class="p">):</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">molecular_search</span> <span class="o">=</span> <span class="n">instance_MolecularFormulaSearchSettings</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>    <span class="nd">@property</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>    <span class="k">def</span> <span class="nf">mz_cal_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the calibrated m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>    <span class="nd">@mz_cal_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>    <span class="k">def</span> <span class="nf">mz_cal_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">):</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span> <span class="o">=</span> <span class="n">mz_cal_list</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>                <span class="s2">&quot;calibrated array (</span><span class="si">%i</span><span class="s2">) is not of the same size of the data (</span><span class="si">%i</span><span class="s2">)&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">))</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="p">)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>    <span class="nd">@property</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>    <span class="k">def</span> <span class="nf">mz_cal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the calibrated m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_cal</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>    <span class="nd">@mz_cal</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>    <span class="k">def</span> <span class="nf">mz_cal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mz_cal</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">mz_cal</span> <span class="o">=</span> <span class="n">mz_cal</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>                <span class="s2">&quot;calibrated array (</span><span class="si">%i</span><span class="s2">) is not of the same size of the data (</span><span class="si">%i</span><span class="s2">)&quot;</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">))</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="p">)</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>    <span class="nd">@property</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>    <span class="k">def</span> <span class="nf">mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>            <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_cal</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>    <span class="nd">@property</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>    <span class="k">def</span> <span class="nf">freq_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>    <span class="nd">@freq_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>    <span class="k">def</span> <span class="nf">freq_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>    <span class="nd">@property</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>    <span class="k">def</span> <span class="nf">freq_exp_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency values of the mass spectrum that are used for peak picking.&quot;&quot;&quot;</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>        <span class="k">return</span> <span class="n">freq</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>    <span class="nd">@property</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_cal_profile</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>    <span class="nd">@mz_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>    <span class="nd">@property</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">def</span> <span class="nf">mz_exp_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z values of the mass spectrum that are used for peak picking.&quot;&quot;&quot;</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="n">mz</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="k">return</span> <span class="n">mz</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="nd">@property</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>    <span class="nd">@abundance_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>    <span class="nd">@property</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>    <span class="k">def</span> <span class="nf">abundance_profile_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum that is used for peak picking.&quot;&quot;&quot;</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="k">return</span> <span class="n">abundance</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>    <span class="nd">@property</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>    <span class="k">def</span> <span class="nf">abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>    <span class="k">def</span> <span class="nf">freq_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">freq_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>    <span class="nd">@property</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>    <span class="k">def</span> <span class="nf">resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the resolving power values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>    <span class="nd">@property</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>    <span class="k">def</span> <span class="nf">signal_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>    <span class="nd">@property</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>    <span class="k">def</span> <span class="nf">nominal_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the nominal m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="p">:</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Nominal indexes not yet set&quot;</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>    <span class="k">def</span> <span class="nf">get_mz_and_abundance_peaks_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of tuples containing the m/z and abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>    <span class="nd">@property</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>    <span class="k">def</span> <span class="nf">kmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Kendrick mass defect values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">kmd</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    <span class="nd">@property</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>    <span class="k">def</span> <span class="nf">kendrick_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Kendrick mass values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">kendrick_mass</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>    <span class="nd">@property</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>    <span class="k">def</span> <span class="nf">max_mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum experimental m/z value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>    <span class="nd">@property</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>    <span class="k">def</span> <span class="nf">min_mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the minimum experimental m/z value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>    <span class="nd">@property</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>    <span class="k">def</span> <span class="nf">max_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum abundance value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>    <span class="nd">@property</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>    <span class="k">def</span> <span class="nf">max_signal_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum signal-to-noise ratio of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>    <span class="nd">@property</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>    <span class="k">def</span> <span class="nf">most_abundant_mspeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the most abundant MSpeak object of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>    <span class="nd">@property</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>    <span class="k">def</span> <span class="nf">min_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the minimum abundance value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>    <span class="c1"># takes too much cpu time</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="nd">@property</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>    <span class="k">def</span> <span class="nf">dynamic_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the dynamic range of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>    <span class="nd">@property</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>    <span class="k">def</span> <span class="nf">baseline_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the baseline noise of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">:</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>    <span class="nd">@property</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>    <span class="k">def</span> <span class="nf">baseline_noise_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the standard deviation of the baseline noise of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span><span class="p">:</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>    <span class="nd">@property</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="k">def</span> <span class="nf">Aterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the A-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>    <span class="nd">@property</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>    <span class="k">def</span> <span class="nf">Bterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the B-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>    <span class="nd">@property</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>    <span class="k">def</span> <span class="nf">Cterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the C-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>    <span class="nd">@property</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the filename of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>    <span class="nd">@property</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>    <span class="k">def</span> <span class="nf">dir_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the directory location of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_location</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>    <span class="k">def</span> <span class="nf">sort_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by m/z values.&quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">)</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>    <span class="k">def</span> <span class="nf">sort_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by abundance values.&quot;&quot;&quot;</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>    <span class="nd">@property</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="k">return</span> <span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">)</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">        Raises</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        ------</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a><span class="sd">        Warning</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>        <span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="k">pass</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;mspeaks list is empty, continuing without filtering data&quot;</span><span class="p">)</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        Raises</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        ------</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">        Exception</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="k">pass</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                <span class="s2">&quot;mspeaks list is empty, please run process_mass_spec() first&quot;</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>    <span class="k">def</span> <span class="nf">remove_assignment_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexes</span><span class="p">):</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the molecular formula assignment of the MSpeaks objects at the specified indexes.</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">        Parameters</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">        ----------</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">        indexes : list of int</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">            A list of indexes of the MSpeaks objects to remove the molecular formula assignment from.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="k">def</span> <span class="nf">filter_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified indexes.</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        Parameters</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        ----------</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">            A list of indexes of the MSpeaks objects to drop.</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_indexes</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>        <span class="p">]</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>    <span class="k">def</span> <span class="nf">filter_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_mz</span><span class="p">,</span> <span class="n">max_mz</span><span class="p">):</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified m/z range.</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">        Parameters</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">        ----------</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a><span class="sd">        min_mz : float</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">            The minimum m/z value to keep.</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        max_mz : float</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">            The maximum m/z value to keep.</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>            <span class="n">index</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">min_mz</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="p">]</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="k">def</span> <span class="nf">filter_by_s2n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_s2n</span><span class="p">,</span> <span class="n">max_s2n</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified signal-to-noise ratio range.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">        Parameters</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        ----------</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">        min_s2n : float</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">            The minimum signal-to-noise ratio to keep.</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">        max_s2n : float, optional</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">            The maximum signal-to-noise ratio to keep. Defaults to False (no maximum).</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">if</span> <span class="n">max_s2n</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>                <span class="n">index</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_s2n</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">max_s2n</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>            <span class="p">]</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>                <span class="n">index</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">min_s2n</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>            <span class="p">]</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>    <span class="k">def</span> <span class="nf">filter_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_abund</span><span class="p">,</span> <span class="n">max_abund</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified abundance range.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">        Parameters</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="sd">        ----------</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">        min_abund : float</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">            The minimum abundance to keep.</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">        max_abund : float, optional</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">            The maximum abundance to keep. Defaults to False (no maximum).</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>        <span class="k">if</span> <span class="n">max_abund</span><span class="p">:</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>                <span class="n">index</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_abund</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">max_abund</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>            <span class="p">]</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>                <span class="n">index</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">min_abund</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="p">]</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>    <span class="k">def</span> <span class="nf">filter_by_max_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified maximum resolving power.</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">        Parameters</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        ----------</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">        B : float</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">        T : float</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="n">index</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&gt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>        <span class="p">]</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>    <span class="k">def</span> <span class="nf">filter_by_mean_resolving_power</span><span class="p">(</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">guess_pars</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>    <span class="p">):</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified mean resolving power.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">        Parameters</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">        ----------</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">        ndeviations : float, optional</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">            The number of standard deviations to use for filtering. Defaults to 3.</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">        plot : bool, optional</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">            Whether to plot the resolving power distribution. Defaults to False.</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">        guess_pars : bool, optional</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            Whether to guess the parameters for the Gaussian model. Defaults to False.</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="n">MeanResolvingPowerFilter</span><span class="p">(</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">guess_pars</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified minimum resolving power.</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">        Parameters</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">        ----------</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">        B : float</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        T : float</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>            <span class="n">index</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&lt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>        <span class="p">]</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>    <span class="k">def</span> <span class="nf">filter_by_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the noise threshold.&quot;&quot;&quot;</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>        <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>            <span class="n">index</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">threshold</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>        <span class="p">]</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>    <span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the peaks of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="c1"># needs to clear previous results from peak_picking</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>        <span class="c1"># then do peak picking</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_peak_picking</span><span class="p">()</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>        <span class="c1"># print(&quot;A total of %i peaks were found&quot; % len(self._mspeaks))</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>    <span class="k">def</span> <span class="nf">change_kendrick_base_all_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kendrick_dict_base</span><span class="p">):</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Change the Kendrick base of all MSpeaks objects.</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">        Parameters</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">        ----------</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">        kendrick_dict_base : dict</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">            A dictionary of the Kendrick base to change to.</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        Notes</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">        -----</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        Example of kendrick_dict_base parameter: kendrick_dict_base = {&quot;C&quot;: 1, &quot;H&quot;: 2} or {&quot;C&quot;: 1, &quot;H&quot;: 1, &quot;O&quot;:1} etc</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span><span class="o">.</span><span class="n">kendrick_base</span> <span class="o">=</span> <span class="n">kendrick_dict_base</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>        <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">change_kendrick_base</span><span class="p">(</span><span class="n">kendrick_dict_base</span><span class="p">)</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mz_first_last_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">):</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        Parameters</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">        ----------</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        Returns</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        -------</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">        tuple</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">            A tuple containing the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="p">:</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>                <span class="p">)</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                <span class="c1"># import warnings</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="c1"># uncomment warn to distribution</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>                <span class="c1"># warnings.warn(&quot;Nominal mass not found in _dict_nominal_masses_indexes, returning (0, 0) for nominal mass %i&quot;%nominal_mass)</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                <span class="s2">&quot;run process_mass_spec() function before trying to access the data&quot;</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>            <span class="p">)</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>    <span class="k">def</span> <span class="nf">get_masses_count_by_nominal_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.&quot;&quot;&quot;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_mass_indexes</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">))</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>                <span class="p">)</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="k">def</span> <span class="nf">datapoints_count_by_nominal_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">        Parameters</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        ----------</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        mz_overlay : float, optional</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a><span class="sd">        Returns</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        -------</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        dict</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">            A dictionary of the nominal masses and their counts.</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>                <span class="n">min_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">mz_overlay</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>                <span class="n">max_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">mz_overlay</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>                <span class="n">indexes</span> <span class="o">=</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&gt;</span> <span class="n">min_mz</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&lt;</span> <span class="n">max_mz</span><span class="p">)</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>                <span class="p">)</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mass_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a><span class="sd">        Parameters</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="sd">        ----------</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        overlay : float, optional</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        Returns</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">        -------</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">        generator</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">            A generator of the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a>        <span class="n">min_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">overlay</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>        <span class="n">max_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">overlay</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>            <span class="n">i</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="k">if</span> <span class="n">min_mz_to_look</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz_to_look</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>        <span class="p">)</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>        <span class="c1"># indexes = (i for i in range(len(self.mspeaks)) if min_mz_to_look &lt;= self.mspeaks[i].mz_exp &lt;= max_mz_to_look)</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>        <span class="c1"># return indexes</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>    <span class="k">def</span> <span class="nf">_set_nominal_masses_start_final_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the start and final indexes of the MSpeaks objects for all nominal masses.&quot;&quot;&quot;</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="n">dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>            <span class="c1"># indexes = self.get_nominal_mass_indexes(nominal_mass)</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="c1"># Convert the iterator to a list to avoid multiple calls</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_mass_indexes</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">))</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="c1"># If the list is not empty, find the first and last; otherwise, set None</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>            <span class="k">if</span> <span class="n">indexes</span><span class="p">:</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>                <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>                <span class="n">first</span> <span class="o">=</span> <span class="n">last</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>            <span class="c1"># defaultvalue = None</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            <span class="c1"># first = last = next(indexes, defaultvalue)</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>            <span class="c1"># for last in indexes:</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="c1">#    pass</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>            <span class="n">dict_nominal_masses_indexes</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="n">dict_nominal_masses_indexes</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>    <span class="k">def</span> <span class="nf">plot_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">):</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the centroid data of the mass spectrum.</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">        Parameters</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">        ----------</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">        c : str, optional</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;g&#39; (green).</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        Returns</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">        -------</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">        Raises</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        ------</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">        Exception</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">            If no centroid data is found.</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">:</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>            <span class="n">markerline_a</span><span class="p">,</span> <span class="n">stemlines_a</span><span class="p">,</span> <span class="n">baseline_a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>            <span class="p">)</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No centroid data found, please run process_mass_spec&quot;</span><span class="p">)</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>    <span class="k">def</span> <span class="nf">plot_profile_and_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the profile data and noise threshold of the mass spectrum.</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        Parameters</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        ----------</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">        legend : bool, optional</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">            Whether to show the legend. Defaults to False.</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">        Returns</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">        -------</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">        Raises</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">        ------</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">        Exception</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a><span class="sd">            If no noise threshold is found.</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span><span class="p">:</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="c1"># x = (self.mz_exp_profile.min(), self.mz_exp_profile.max())</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>            <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">)</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>            <span class="c1"># std = self.parameters.mass_spectrum.noise_threshold_min_std</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>            <span class="c1"># threshold = self.baseline_noise_std + (std * self.baseline_noise_std)</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spectrum&quot;</span><span class="p">,</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>            <span class="p">)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">baseline</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Baseline Noise&quot;</span><span class="p">)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noise Threshold&quot;</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Calculate noise threshold first&quot;</span><span class="p">)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>    <span class="k">def</span> <span class="nf">plot_mz_domain_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the m/z domain profile of the mass spectrum.</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">        Parameters</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">        ----------</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">        color : str, optional</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;green&#39;.</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">        Returns</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a><span class="sd">        -------</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;m/z&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;abundance&quot;</span><span class="p">)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>    <span class="k">def</span> <span class="nf">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an Excel file.</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        Parameters</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">        ----------</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">        out_file_path : str</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">            The path to the Excel file to export to.</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">            Whether to write the metadata to the Excel file. Defaults to True.</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">        Returns</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        -------</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">        None</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>    <span class="k">def</span> <span class="nf">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">):</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an HDF file.</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="sd">        Parameters</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        ----------</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        out_file_path : str</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">            The path to the HDF file to export to.</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">        Returns</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">        -------</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        None</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">()</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a CSV file.</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">        Parameters</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">        ----------</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">        out_file_path : str</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a Pandas dataframe with pkl extension.</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">        Parameters</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        ----------</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">        out_file_path : str</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">additional_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a Pandas dataframe.</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">        Parameters</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">        ----------</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">        additional_columns : list, optional</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">            A list of additional columns to include in the dataframe. Defaults to None.</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">            Suitable columns are: &quot;Aromaticity Index&quot;, &quot;Aromaticity Index (modified)&quot;, and &quot;NOSC&quot;</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">        Returns</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">        -------</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">            The mass spectrum as a Pandas dataframe.</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">get_pandas_df</span><span class="p">(</span><span class="n">additional_columns</span><span class="o">=</span><span class="n">additional_columns</span><span class="p">)</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a JSON file.&quot;&quot;&quot;</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>    <span class="k">def</span> <span class="nf">parameters_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a JSON string.&quot;&quot;&quot;</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_json</span><span class="p">()</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>    <span class="k">def</span> <span class="nf">parameters_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a TOML string.&quot;&quot;&quot;</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_toml</span><span class="p">()</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="k">class</span> <span class="nc">MassSpecProfile</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on profile format</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">    Notes</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">    -----</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">    Stores the profile data and instrument settings.</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">    Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">    _mspeaks is populated under the hood by calling process_mass_spec method.</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">    Iteration is null if _mspeaks is empty. Many more attributes and methods inherited from MassSpecBase().</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">    Parameters</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">    ----------</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">    data_dict : dict</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">        A dictionary containing the profile data.</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">    Attributes</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    ----------</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">    Methods</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a><span class="sd">    ----------</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a><span class="sd">    * process_mass_spec(). Process the mass spectrum.</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a><span class="sd">    see also: MassSpecBase(), MassSpecfromFreq(), MassSpecCentroid()</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="c1"># print(data_dict.keys())</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">),</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">),</span> <span class="n">d_params</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>        <span class="p">)</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="k">class</span> <span class="nc">MassSpecfromFreq</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when data entry is on frequency domain</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a><span class="sd">    Notes</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a><span class="sd">    -----</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a><span class="sd">    - Transform to m/z based on the settings stored at d_params</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a><span class="sd">    - Stores the profile data and instrument settings</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a><span class="sd">    - Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a><span class="sd">    - _mspeaks is populated under the hood by calling process_mass_spec method</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a><span class="sd">    - iteration is null if _mspeaks is empty</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="sd">    Parameters</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="sd">    ----------</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a><span class="sd">    frequency_domain : list(float)</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">        all datapoints in frequency domain in Hz</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">    magnitude :  frequency_domain : list(float)</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a><span class="sd">        all datapoints in for magnitude of each frequency datapoint</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">    keep_profile : bool, optional</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">        Whether to keep the profile data. Defaults to True.</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="sd">    Attributes</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">    ----------</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">    has_frequency : bool</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a><span class="sd">        Whether the mass spectrum has frequency data.</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">    _frequency_domain : list(float)</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">        Frequency domain in Hz</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">    label : str</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">        store label (Bruker, Midas Transient, see Labels class ). It across distinct processing points</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">    See Also: all the attributes of MassSpecBase class</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">    Methods</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">    ----------</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">    * _set_mz_domain().</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">        calculates the m_z based on the setting of d_params</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">    * process_mass_spec().  Process the mass spectrum.</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">    see also: MassSpecBase(), MassSpecProfile(), MassSpecCentroid()</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="n">frequency_domain</span><span class="p">,</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="n">magnitude</span><span class="p">,</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>        <span class="n">d_params</span><span class="p">,</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>    <span class="p">):</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="n">frequency_domain</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mz_domain</span><span class="p">()</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sort_mz_domain</span><span class="p">()</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="c1"># use this call to automatically process data as the object is created, Setting need to be changed before initiating the class to be in effect</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">(</span><span class="n">keep_profile</span><span class="o">=</span><span class="n">keep_profile</span><span class="p">)</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>    <span class="k">def</span> <span class="nf">_sort_mz_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by m/z values.&quot;&quot;&quot;</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>    <span class="k">def</span> <span class="nf">_set_mz_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the m/z domain of the mass spectrum based on the settings of d_params.&quot;&quot;&quot;</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">bruker_frequency</span><span class="p">:</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz_bruker</span><span class="p">()</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz</span><span class="p">()</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>    <span class="nd">@property</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>    <span class="k">def</span> <span class="nf">transient_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transient settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transient</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>    <span class="nd">@transient_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>    <span class="k">def</span> <span class="nf">transient_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_TransientSetting</span><span class="p">):</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transient</span> <span class="o">=</span> <span class="n">instance_TransientSetting</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>    <span class="k">def</span> <span class="nf">calc_magnetron_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_magnetron_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">magnetron_freq_bins</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the magnetron frequency of the mass spectrum.</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        Parameters</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">        ----------</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        max_magnetron_freq : float, optional</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">            The maximum magnetron frequency. Defaults to 50.</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a><span class="sd">        magnetron_freq_bins : int, optional</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">            The number of bins to use for the histogram. Defaults to 300.</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">        Returns</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="sd">        -------</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">        None</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">        Notes</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">        -----</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">        Calculates the magnetron frequency by examining all the picked peaks and the distances between them in the frequency domain.</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="sd">        A histogram of those values below the threshold &#39;max_magnetron_freq&#39; with the &#39;magnetron_freq_bins&#39; number of bins is calculated.</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">        A gaussian model is fit to this histogram - the center value of this (statistically probably) the magnetron frequency.</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="sd">        This appears to work well or nOmega datasets, but may not work well for 1x datasets or those with very low magnetron peaks.</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="n">ms_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_exp</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">])</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>        <span class="n">freq_hist</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>            <span class="n">ms_df</span><span class="p">[</span><span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_magnetron_freq</span><span class="p">][</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">],</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>            <span class="n">bins</span><span class="o">=</span><span class="n">magnetron_freq_bins</span><span class="p">,</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>        <span class="p">)</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>        <span class="n">mod</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>        <span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="k">class</span> <span class="nc">MassSpecCentroid</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on centroid format</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="sd">    Notes</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a><span class="sd">    -----</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">    - Stores the centroid data and instrument settings</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">    - Simulate profile data based on Gaussian or Lorentzian peak shape</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">    - Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">    - _mspeaks is populated under the hood by calling process_mass_spec method</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    - iteration is null if _mspeaks is empty</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">    Parameters</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">    ----------</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">    data_dict : dict {string: numpy array float64 )</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a><span class="sd">        contains keys [m/z, Abundance, Resolving Power, S/N]</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">    Attributes</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">    ----------</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">    label : str</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        store label (Bruker, Midas Transient, see Labels class)</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">    _baseline_noise : float</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">        store baseline noise</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">    _baseline_noise_std : float</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">        store baseline noise std</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">    Methods</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">    ----------</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">    * process_mass_spec().</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">        Process the mass spectrum. Overriden from MassSpecBase. Populates the _mspeaks list with MSpeaks class using the centroid data.</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">    * __simulate_profile__data__().</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">        Simulate profile data based on Gaussian or Lorentzian peak shape. Needs theoretical resolving power calculation and define peak shape, intended for plotting and inspection purposes only.</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">    see also: MassSpecBase(), MassSpecfromFreq(), MassSpecProfile()</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">)</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">)</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="n">data_dict</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">]</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">]</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>    <span class="k">def</span> <span class="nf">__simulate_profile__data__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp_mz_centroid</span><span class="p">,</span> <span class="n">magnitude_centroid</span><span class="p">):</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate profile data based on Gaussian or Lorentzian peak shape</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        Notes</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">        -----</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">        Needs theoretical resolving power calculation and define peak shape.</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        This is a quick fix to trick a line plot be able to plot as sticks for plotting and inspection purposes only.</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">        Parameters</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a><span class="sd">        ----------</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">        exp_mz_centroid : list(float)</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">            list of m/z values</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">        magnitude_centroid : list(float)</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a><span class="sd">            list of abundance values</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a><span class="sd">        Returns</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">        -------</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">        x : list(float)</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">            list of m/z values</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="sd">        y : list(float)</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">            list of abundance values</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">)):</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magnitude_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>    <span class="nd">@property</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>        <span class="n">mz_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="k">for</span> <span class="n">mz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">:</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span> <span class="o">-</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span> <span class="o">+</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>        <span class="k">return</span> <span class="n">mz_list</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>    <span class="nd">@mz_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_mz_exp</span><span class="p">):</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">_mz_exp</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>    <span class="nd">@property</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>        <span class="n">ab_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>        <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="k">return</span> <span class="n">ab_list</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>    <span class="nd">@abundance_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abundance</span><span class="p">):</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">abundance</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>    <span class="nd">@property</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>        <span class="kn">import</span> <span class="nn">tqdm</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>        <span class="c1"># overwrite process_mass_spec</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>        <span class="c1"># mspeak objs are usually added inside the PeaKPicking class</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>        <span class="c1"># for profile and freq based data</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>        <span class="n">ion_charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polarity</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>        <span class="c1"># Check if resolving power is present</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>        <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">):</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>        <span class="k">if</span> <span class="n">rp_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>        <span class="p">):</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>        <span class="c1"># Check if s2n is present</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>        <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">):</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>        <span class="k">if</span> <span class="n">s2n_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="p">):</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>        <span class="c1"># Warning if no s2n data but noise thresholding is set to signal_noise</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>            <span class="ow">not</span> <span class="n">s2n_present</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>        <span class="p">):</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Signal to Noise data is missing for noise thresholding&quot;</span><span class="p">)</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>        <span class="c1"># Pull out abundance data</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>        <span class="n">abun</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>        <span class="c1"># Get the threshold for filtering if using minima, relative, or absolute abundance thresholding</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>        <span class="n">abundance_threshold</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_threshold</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>        <span class="c1"># Set rp_i and s2n_i to None which will be overwritten if present</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>        <span class="n">rp_i</span><span class="p">,</span> <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">)):</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>            <span class="k">if</span> <span class="n">rp_present</span><span class="p">:</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>            <span class="k">if</span> <span class="n">s2n_present</span><span class="p">:</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>            <span class="c1"># centroid peak does not have start and end peak index pos</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>            <span class="n">massspec_indexes</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>            <span class="c1"># Add peaks based on the noise thresholding method</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>                <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;minima&quot;</span><span class="p">,</span> <span class="s2">&quot;relative_abundance&quot;</span><span class="p">,</span> <span class="s2">&quot;absolute_abundance&quot;</span><span class="p">]</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>                <span class="ow">and</span> <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">/</span> <span class="n">factor</span> <span class="o">&gt;=</span> <span class="n">abundance_threshold</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>            <span class="p">):</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>                <span class="p">)</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>                <span class="ow">and</span> <span class="n">s2n_i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_min_s2n</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>            <span class="p">):</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>                <span class="p">)</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;log noise Not tested for centroid data&quot;</span><span class="p">)</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>                <span class="c1"># self._baseline_noise, self._baseline_noise_std = self.run_log_noise_threshold_calc()</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>                <span class="p">)</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a><span class="k">class</span> <span class="nc">MassSpecCentroidLowRes</span><span class="p">(</span><span class="n">MassSpecCentroid</span><span class="p">):</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on low resolution centroid format</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a><span class="sd">    Notes</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a><span class="sd">    -----</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a><span class="sd">    Does not store MSPeak Objs, will iterate over mz, abundance pairs instead</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a><span class="sd">    Parameters</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a><span class="sd">    ----------</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a><span class="sd">    data_dict : dict {string: numpy array float64 )</span>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a><span class="sd">        contains keys [m/z, Abundance, Resolving Power, S/N]</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a><span class="sd">    Attributes</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a><span class="sd">    ----------</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a><span class="sd">    _processed_tic : float</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a><span class="sd">        store processed total ion current</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">):</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">))</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">)</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">[</span><span class="n">position</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">[</span><span class="n">position</span><span class="p">])</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>    <span class="nd">@property</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>    <span class="k">def</span> <span class="nf">mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>    <span class="nd">@property</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>    <span class="k">def</span> <span class="nf">abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>    <span class="nd">@property</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>    <span class="k">def</span> <span class="nf">processed_tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the processed total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span><span class="p">)</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a>    <span class="nd">@property</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span><span class="p">:</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>    <span class="nd">@property</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>    <span class="k">def</span> <span class="nf">mz_abun_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z and abundance values of the mass spectrum as a list of tuples.&quot;&quot;&quot;</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">))))</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>    <span class="nd">@property</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>    <span class="k">def</span> <span class="nf">mz_abun_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z and abundance values of the mass spectrum as a dictionary.&quot;&quot;&quot;</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>
</span></pre></div>


            </section>
                <section id="overrides">
                            <input id="overrides-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">overrides</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">interface_class</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="overrides-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#overrides"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="overrides-26"><a href="#overrides-26"><span class="linenos">26</span></a><span class="k">def</span> <span class="nf">overrides</span><span class="p">(</span><span class="n">interface_class</span><span class="p">):</span>
</span><span id="overrides-27"><a href="#overrides-27"><span class="linenos">27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the method overrides a method from an interface class.&quot;&quot;&quot;</span>
</span><span id="overrides-28"><a href="#overrides-28"><span class="linenos">28</span></a>
</span><span id="overrides-29"><a href="#overrides-29"><span class="linenos">29</span></a>    <span class="k">def</span> <span class="nf">overrider</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
</span><span id="overrides-30"><a href="#overrides-30"><span class="linenos">30</span></a>        <span class="k">assert</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">interface_class</span><span class="p">)</span>
</span><span id="overrides-31"><a href="#overrides-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="n">method</span>
</span><span id="overrides-32"><a href="#overrides-32"><span class="linenos">32</span></a>
</span><span id="overrides-33"><a href="#overrides-33"><span class="linenos">33</span></a>    <span class="k">return</span> <span class="n">overrider</span>
</span></pre></div>


            <div class="docstring"><p>Checks if the method overrides a method from an interface class.</p>
</div>


                </section>
                <section id="MassSpecBase">
                            <input id="MassSpecBase-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MassSpecBase</span><wbr>(<span class="base"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></span>, <span class="base"><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></span>):

                <label class="view-source-button" for="MassSpecBase-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase-36"><a href="#MassSpecBase-36"><span class="linenos">  36</span></a><span class="k">class</span> <span class="nc">MassSpecBase</span><span class="p">(</span><span class="n">MassSpecCalc</span><span class="p">,</span> <span class="n">KendrickGrouping</span><span class="p">):</span>
</span><span id="MassSpecBase-37"><a href="#MassSpecBase-37"><span class="linenos">  37</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum base class, stores the profile data and instrument settings.</span>
</span><span id="MassSpecBase-38"><a href="#MassSpecBase-38"><span class="linenos">  38</span></a>
</span><span id="MassSpecBase-39"><a href="#MassSpecBase-39"><span class="linenos">  39</span></a><span class="sd">    Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.</span>
</span><span id="MassSpecBase-40"><a href="#MassSpecBase-40"><span class="linenos">  40</span></a><span class="sd">    _mspeaks is populated under the hood by calling process_mass_spec method.</span>
</span><span id="MassSpecBase-41"><a href="#MassSpecBase-41"><span class="linenos">  41</span></a><span class="sd">    Iteration is null if _mspeaks is empty.</span>
</span><span id="MassSpecBase-42"><a href="#MassSpecBase-42"><span class="linenos">  42</span></a>
</span><span id="MassSpecBase-43"><a href="#MassSpecBase-43"><span class="linenos">  43</span></a><span class="sd">    Parameters</span>
</span><span id="MassSpecBase-44"><a href="#MassSpecBase-44"><span class="linenos">  44</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecBase-45"><a href="#MassSpecBase-45"><span class="linenos">  45</span></a><span class="sd">    mz_exp : array_like</span>
</span><span id="MassSpecBase-46"><a href="#MassSpecBase-46"><span class="linenos">  46</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecBase-47"><a href="#MassSpecBase-47"><span class="linenos">  47</span></a><span class="sd">    abundance : array_like</span>
</span><span id="MassSpecBase-48"><a href="#MassSpecBase-48"><span class="linenos">  48</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecBase-49"><a href="#MassSpecBase-49"><span class="linenos">  49</span></a><span class="sd">    d_params : dict</span>
</span><span id="MassSpecBase-50"><a href="#MassSpecBase-50"><span class="linenos">  50</span></a><span class="sd">        A dictionary of parameters for the mass spectrum.</span>
</span><span id="MassSpecBase-51"><a href="#MassSpecBase-51"><span class="linenos">  51</span></a><span class="sd">    **kwargs</span>
</span><span id="MassSpecBase-52"><a href="#MassSpecBase-52"><span class="linenos">  52</span></a><span class="sd">        Additional keyword arguments.</span>
</span><span id="MassSpecBase-53"><a href="#MassSpecBase-53"><span class="linenos">  53</span></a>
</span><span id="MassSpecBase-54"><a href="#MassSpecBase-54"><span class="linenos">  54</span></a><span class="sd">    Attributes</span>
</span><span id="MassSpecBase-55"><a href="#MassSpecBase-55"><span class="linenos">  55</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecBase-56"><a href="#MassSpecBase-56"><span class="linenos">  56</span></a>
</span><span id="MassSpecBase-57"><a href="#MassSpecBase-57"><span class="linenos">  57</span></a><span class="sd">    mspeaks : list</span>
</span><span id="MassSpecBase-58"><a href="#MassSpecBase-58"><span class="linenos">  58</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="MassSpecBase-59"><a href="#MassSpecBase-59"><span class="linenos">  59</span></a><span class="sd">    is_calibrated : bool</span>
</span><span id="MassSpecBase-60"><a href="#MassSpecBase-60"><span class="linenos">  60</span></a><span class="sd">        Whether the mass spectrum is calibrated.</span>
</span><span id="MassSpecBase-61"><a href="#MassSpecBase-61"><span class="linenos">  61</span></a><span class="sd">    is_centroid : bool</span>
</span><span id="MassSpecBase-62"><a href="#MassSpecBase-62"><span class="linenos">  62</span></a><span class="sd">        Whether the mass spectrum is centroided.</span>
</span><span id="MassSpecBase-63"><a href="#MassSpecBase-63"><span class="linenos">  63</span></a><span class="sd">    has_frequency : bool</span>
</span><span id="MassSpecBase-64"><a href="#MassSpecBase-64"><span class="linenos">  64</span></a><span class="sd">        Whether the mass spectrum has a frequency domain.</span>
</span><span id="MassSpecBase-65"><a href="#MassSpecBase-65"><span class="linenos">  65</span></a><span class="sd">    calibration_order : None or int</span>
</span><span id="MassSpecBase-66"><a href="#MassSpecBase-66"><span class="linenos">  66</span></a><span class="sd">        The order of the mass spectrum&#39;s calibration.</span>
</span><span id="MassSpecBase-67"><a href="#MassSpecBase-67"><span class="linenos">  67</span></a><span class="sd">    calibration_points : None or ndarray</span>
</span><span id="MassSpecBase-68"><a href="#MassSpecBase-68"><span class="linenos">  68</span></a><span class="sd">        The calibration points of the mass spectrum.</span>
</span><span id="MassSpecBase-69"><a href="#MassSpecBase-69"><span class="linenos">  69</span></a><span class="sd">    calibration_ref_mzs: None or ndarray</span>
</span><span id="MassSpecBase-70"><a href="#MassSpecBase-70"><span class="linenos">  70</span></a><span class="sd">        The reference m/z values of the mass spectrum&#39;s calibration.</span>
</span><span id="MassSpecBase-71"><a href="#MassSpecBase-71"><span class="linenos">  71</span></a><span class="sd">    calibration_meas_mzs : None or ndarray</span>
</span><span id="MassSpecBase-72"><a href="#MassSpecBase-72"><span class="linenos">  72</span></a><span class="sd">        The measured m/z values of the mass spectrum&#39;s calibration.</span>
</span><span id="MassSpecBase-73"><a href="#MassSpecBase-73"><span class="linenos">  73</span></a><span class="sd">    calibration_RMS : None or float</span>
</span><span id="MassSpecBase-74"><a href="#MassSpecBase-74"><span class="linenos">  74</span></a><span class="sd">        The root mean square of the mass spectrum&#39;s calibration.</span>
</span><span id="MassSpecBase-75"><a href="#MassSpecBase-75"><span class="linenos">  75</span></a><span class="sd">    calibration_segment : None or CalibrationSegment</span>
</span><span id="MassSpecBase-76"><a href="#MassSpecBase-76"><span class="linenos">  76</span></a><span class="sd">        The calibration segment of the mass spectrum.</span>
</span><span id="MassSpecBase-77"><a href="#MassSpecBase-77"><span class="linenos">  77</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="MassSpecBase-78"><a href="#MassSpecBase-78"><span class="linenos">  78</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecBase-79"><a href="#MassSpecBase-79"><span class="linenos">  79</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="MassSpecBase-80"><a href="#MassSpecBase-80"><span class="linenos">  80</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecBase-81"><a href="#MassSpecBase-81"><span class="linenos">  81</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="MassSpecBase-82"><a href="#MassSpecBase-82"><span class="linenos">  82</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="MassSpecBase-83"><a href="#MassSpecBase-83"><span class="linenos">  83</span></a><span class="sd">    _dict_nominal_masses_indexes : dict</span>
</span><span id="MassSpecBase-84"><a href="#MassSpecBase-84"><span class="linenos">  84</span></a><span class="sd">        A dictionary of nominal masses and their indexes.</span>
</span><span id="MassSpecBase-85"><a href="#MassSpecBase-85"><span class="linenos">  85</span></a><span class="sd">    _baseline_noise : float</span>
</span><span id="MassSpecBase-86"><a href="#MassSpecBase-86"><span class="linenos">  86</span></a><span class="sd">        The baseline noise of the mass spectrum.</span>
</span><span id="MassSpecBase-87"><a href="#MassSpecBase-87"><span class="linenos">  87</span></a><span class="sd">    _baseline_noise_std : float</span>
</span><span id="MassSpecBase-88"><a href="#MassSpecBase-88"><span class="linenos">  88</span></a><span class="sd">        The standard deviation of the baseline noise of the mass spectrum.</span>
</span><span id="MassSpecBase-89"><a href="#MassSpecBase-89"><span class="linenos">  89</span></a><span class="sd">    _dynamic_range : float or None</span>
</span><span id="MassSpecBase-90"><a href="#MassSpecBase-90"><span class="linenos">  90</span></a><span class="sd">        The dynamic range of the mass spectrum.</span>
</span><span id="MassSpecBase-91"><a href="#MassSpecBase-91"><span class="linenos">  91</span></a><span class="sd">    _transient_settings : None or TransientSettings</span>
</span><span id="MassSpecBase-92"><a href="#MassSpecBase-92"><span class="linenos">  92</span></a><span class="sd">        The transient settings of the mass spectrum.</span>
</span><span id="MassSpecBase-93"><a href="#MassSpecBase-93"><span class="linenos">  93</span></a><span class="sd">    _frequency_domain : None or FrequencyDomain</span>
</span><span id="MassSpecBase-94"><a href="#MassSpecBase-94"><span class="linenos">  94</span></a><span class="sd">        The frequency domain of the mass spectrum.</span>
</span><span id="MassSpecBase-95"><a href="#MassSpecBase-95"><span class="linenos">  95</span></a><span class="sd">    _mz_cal_profile : None or MzCalibrationProfile</span>
</span><span id="MassSpecBase-96"><a href="#MassSpecBase-96"><span class="linenos">  96</span></a><span class="sd">        The m/z calibration profile of the mass spectrum.</span>
</span><span id="MassSpecBase-97"><a href="#MassSpecBase-97"><span class="linenos">  97</span></a>
</span><span id="MassSpecBase-98"><a href="#MassSpecBase-98"><span class="linenos">  98</span></a><span class="sd">    Methods</span>
</span><span id="MassSpecBase-99"><a href="#MassSpecBase-99"><span class="linenos">  99</span></a><span class="sd">    -------</span>
</span><span id="MassSpecBase-100"><a href="#MassSpecBase-100"><span class="linenos"> 100</span></a><span class="sd">    * process_mass_spec(). Main function to process the mass spectrum,</span>
</span><span id="MassSpecBase-101"><a href="#MassSpecBase-101"><span class="linenos"> 101</span></a><span class="sd">    including calculating the noise threshold, peak picking, and resetting the MSpeak indexes.</span>
</span><span id="MassSpecBase-102"><a href="#MassSpecBase-102"><span class="linenos"> 102</span></a>
</span><span id="MassSpecBase-103"><a href="#MassSpecBase-103"><span class="linenos"> 103</span></a><span class="sd">    See also: MassSpecCentroid(), MassSpecfromFreq(), MassSpecProfile()</span>
</span><span id="MassSpecBase-104"><a href="#MassSpecBase-104"><span class="linenos"> 104</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-105"><a href="#MassSpecBase-105"><span class="linenos"> 105</span></a>
</span><span id="MassSpecBase-106"><a href="#MassSpecBase-106"><span class="linenos"> 106</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_exp</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MassSpecBase-107"><a href="#MassSpecBase-107"><span class="linenos"> 107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">abundance</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="MassSpecBase-108"><a href="#MassSpecBase-108"><span class="linenos"> 108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="MassSpecBase-109"><a href="#MassSpecBase-109"><span class="linenos"> 109</span></a>
</span><span id="MassSpecBase-110"><a href="#MassSpecBase-110"><span class="linenos"> 110</span></a>        <span class="c1"># objects created after process_mass_spec() function</span>
</span><span id="MassSpecBase-111"><a href="#MassSpecBase-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase-112"><a href="#MassSpecBase-112"><span class="linenos"> 112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase-113"><a href="#MassSpecBase-113"><span class="linenos"> 113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MassSpecBase-114"><a href="#MassSpecBase-114"><span class="linenos"> 114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="MassSpecBase-115"><a href="#MassSpecBase-115"><span class="linenos"> 115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="MassSpecBase-116"><a href="#MassSpecBase-116"><span class="linenos"> 116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-117"><a href="#MassSpecBase-117"><span class="linenos"> 117</span></a>        <span class="c1"># set to None: initialization occurs inside subclass MassSpecfromFreq</span>
</span><span id="MassSpecBase-118"><a href="#MassSpecBase-118"><span class="linenos"> 118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transient_settings</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-119"><a href="#MassSpecBase-119"><span class="linenos"> 119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-120"><a href="#MassSpecBase-120"><span class="linenos"> 120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-121"><a href="#MassSpecBase-121"><span class="linenos"> 121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase-122"><a href="#MassSpecBase-122"><span class="linenos"> 122</span></a>
</span><span id="MassSpecBase-123"><a href="#MassSpecBase-123"><span class="linenos"> 123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecBase-124"><a href="#MassSpecBase-124"><span class="linenos"> 124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span><span id="MassSpecBase-125"><a href="#MassSpecBase-125"><span class="linenos"> 125</span></a>
</span><span id="MassSpecBase-126"><a href="#MassSpecBase-126"><span class="linenos"> 126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase-127"><a href="#MassSpecBase-127"><span class="linenos"> 127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase-128"><a href="#MassSpecBase-128"><span class="linenos"> 128</span></a>
</span><span id="MassSpecBase-129"><a href="#MassSpecBase-129"><span class="linenos"> 129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_order</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-130"><a href="#MassSpecBase-130"><span class="linenos"> 130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-131"><a href="#MassSpecBase-131"><span class="linenos"> 131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_ref_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-132"><a href="#MassSpecBase-132"><span class="linenos"> 132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_meas_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-133"><a href="#MassSpecBase-133"><span class="linenos"> 133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_RMS</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-134"><a href="#MassSpecBase-134"><span class="linenos"> 134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_segment</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-135"><a href="#MassSpecBase-135"><span class="linenos"> 135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_median</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-136"><a href="#MassSpecBase-136"><span class="linenos"> 136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_stdev</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-137"><a href="#MassSpecBase-137"><span class="linenos"> 137</span></a>
</span><span id="MassSpecBase-138"><a href="#MassSpecBase-138"><span class="linenos"> 138</span></a>    <span class="k">def</span> <span class="nf">_init_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-139"><a href="#MassSpecBase-139"><span class="linenos"> 139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the settings for the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-140"><a href="#MassSpecBase-140"><span class="linenos"> 140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">MSParameters</span><span class="p">()</span>
</span><span id="MassSpecBase-141"><a href="#MassSpecBase-141"><span class="linenos"> 141</span></a>
</span><span id="MassSpecBase-142"><a href="#MassSpecBase-142"><span class="linenos"> 142</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-143"><a href="#MassSpecBase-143"><span class="linenos"> 143</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-144"><a href="#MassSpecBase-144"><span class="linenos"> 144</span></a>
</span><span id="MassSpecBase-145"><a href="#MassSpecBase-145"><span class="linenos"> 145</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MSPeak</span><span class="p">:</span>
</span><span id="MassSpecBase-146"><a href="#MassSpecBase-146"><span class="linenos"> 146</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>
</span><span id="MassSpecBase-147"><a href="#MassSpecBase-147"><span class="linenos"> 147</span></a>
</span><span id="MassSpecBase-148"><a href="#MassSpecBase-148"><span class="linenos"> 148</span></a>    <span class="k">def</span> <span class="nf">set_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="MassSpecBase-149"><a href="#MassSpecBase-149"><span class="linenos"> 149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the mass spectrum to iterate over only the selected MSpeaks indexes.</span>
</span><span id="MassSpecBase-150"><a href="#MassSpecBase-150"><span class="linenos"> 150</span></a>
</span><span id="MassSpecBase-151"><a href="#MassSpecBase-151"><span class="linenos"> 151</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-152"><a href="#MassSpecBase-152"><span class="linenos"> 152</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-153"><a href="#MassSpecBase-153"><span class="linenos"> 153</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="MassSpecBase-154"><a href="#MassSpecBase-154"><span class="linenos"> 154</span></a><span class="sd">            A list of integers representing the indexes of the MSpeaks to iterate over.</span>
</span><span id="MassSpecBase-155"><a href="#MassSpecBase-155"><span class="linenos"> 155</span></a>
</span><span id="MassSpecBase-156"><a href="#MassSpecBase-156"><span class="linenos"> 156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-157"><a href="#MassSpecBase-157"><span class="linenos"> 157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_indexes</span><span class="p">]</span>
</span><span id="MassSpecBase-158"><a href="#MassSpecBase-158"><span class="linenos"> 158</span></a>
</span><span id="MassSpecBase-159"><a href="#MassSpecBase-159"><span class="linenos"> 159</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase-160"><a href="#MassSpecBase-160"><span class="linenos"> 160</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase-161"><a href="#MassSpecBase-161"><span class="linenos"> 161</span></a>
</span><span id="MassSpecBase-162"><a href="#MassSpecBase-162"><span class="linenos"> 162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase-163"><a href="#MassSpecBase-163"><span class="linenos"> 163</span></a>
</span><span id="MassSpecBase-164"><a href="#MassSpecBase-164"><span class="linenos"> 164</span></a>    <span class="k">def</span> <span class="nf">reset_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-165"><a href="#MassSpecBase-165"><span class="linenos"> 165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the mass spectrum to iterate over all MSpeaks objects.</span>
</span><span id="MassSpecBase-166"><a href="#MassSpecBase-166"><span class="linenos"> 166</span></a>
</span><span id="MassSpecBase-167"><a href="#MassSpecBase-167"><span class="linenos"> 167</span></a><span class="sd">        This method resets the mass spectrum to its original state, allowing iteration over all MSpeaks objects.</span>
</span><span id="MassSpecBase-168"><a href="#MassSpecBase-168"><span class="linenos"> 168</span></a><span class="sd">        It also sets the index of each MSpeak object to its corresponding position in the mass spectrum.</span>
</span><span id="MassSpecBase-169"><a href="#MassSpecBase-169"><span class="linenos"> 169</span></a>
</span><span id="MassSpecBase-170"><a href="#MassSpecBase-170"><span class="linenos"> 170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-171"><a href="#MassSpecBase-171"><span class="linenos"> 171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="MassSpecBase-172"><a href="#MassSpecBase-172"><span class="linenos"> 172</span></a>
</span><span id="MassSpecBase-173"><a href="#MassSpecBase-173"><span class="linenos"> 173</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase-174"><a href="#MassSpecBase-174"><span class="linenos"> 174</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase-175"><a href="#MassSpecBase-175"><span class="linenos"> 175</span></a>
</span><span id="MassSpecBase-176"><a href="#MassSpecBase-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase-177"><a href="#MassSpecBase-177"><span class="linenos"> 177</span></a>
</span><span id="MassSpecBase-178"><a href="#MassSpecBase-178"><span class="linenos"> 178</span></a>    <span class="k">def</span> <span class="nf">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecBase-179"><a href="#MassSpecBase-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecBase-180"><a href="#MassSpecBase-180"><span class="linenos"> 180</span></a>        <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecBase-181"><a href="#MassSpecBase-181"><span class="linenos"> 181</span></a>        <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="MassSpecBase-182"><a href="#MassSpecBase-182"><span class="linenos"> 182</span></a>        <span class="n">abundance</span><span class="p">,</span>
</span><span id="MassSpecBase-183"><a href="#MassSpecBase-183"><span class="linenos"> 183</span></a>        <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="MassSpecBase-184"><a href="#MassSpecBase-184"><span class="linenos"> 184</span></a>        <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="MassSpecBase-185"><a href="#MassSpecBase-185"><span class="linenos"> 185</span></a>        <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecBase-186"><a href="#MassSpecBase-186"><span class="linenos"> 186</span></a>        <span class="n">exp_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MassSpecBase-187"><a href="#MassSpecBase-187"><span class="linenos"> 187</span></a>        <span class="n">ms_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MassSpecBase-188"><a href="#MassSpecBase-188"><span class="linenos"> 188</span></a>    <span class="p">):</span>
</span><span id="MassSpecBase-189"><a href="#MassSpecBase-189"><span class="linenos"> 189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new MSPeak object to the MassSpectrum object.</span>
</span><span id="MassSpecBase-190"><a href="#MassSpecBase-190"><span class="linenos"> 190</span></a>
</span><span id="MassSpecBase-191"><a href="#MassSpecBase-191"><span class="linenos"> 191</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-192"><a href="#MassSpecBase-192"><span class="linenos"> 192</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-193"><a href="#MassSpecBase-193"><span class="linenos"> 193</span></a><span class="sd">        ion_charge : int</span>
</span><span id="MassSpecBase-194"><a href="#MassSpecBase-194"><span class="linenos"> 194</span></a><span class="sd">            The ion charge of the MSPeak.</span>
</span><span id="MassSpecBase-195"><a href="#MassSpecBase-195"><span class="linenos"> 195</span></a><span class="sd">        mz_exp : float</span>
</span><span id="MassSpecBase-196"><a href="#MassSpecBase-196"><span class="linenos"> 196</span></a><span class="sd">            The experimental m/z value of the MSPeak.</span>
</span><span id="MassSpecBase-197"><a href="#MassSpecBase-197"><span class="linenos"> 197</span></a><span class="sd">        abundance : float</span>
</span><span id="MassSpecBase-198"><a href="#MassSpecBase-198"><span class="linenos"> 198</span></a><span class="sd">            The abundance of the MSPeak.</span>
</span><span id="MassSpecBase-199"><a href="#MassSpecBase-199"><span class="linenos"> 199</span></a><span class="sd">        resolving_power : float</span>
</span><span id="MassSpecBase-200"><a href="#MassSpecBase-200"><span class="linenos"> 200</span></a><span class="sd">            The resolving power of the MSPeak.</span>
</span><span id="MassSpecBase-201"><a href="#MassSpecBase-201"><span class="linenos"> 201</span></a><span class="sd">        signal_to_noise : float</span>
</span><span id="MassSpecBase-202"><a href="#MassSpecBase-202"><span class="linenos"> 202</span></a><span class="sd">            The signal-to-noise ratio of the MSPeak.</span>
</span><span id="MassSpecBase-203"><a href="#MassSpecBase-203"><span class="linenos"> 203</span></a><span class="sd">        massspec_indexes : list</span>
</span><span id="MassSpecBase-204"><a href="#MassSpecBase-204"><span class="linenos"> 204</span></a><span class="sd">            A list of indexes of the MSPeak in the MassSpectrum object.</span>
</span><span id="MassSpecBase-205"><a href="#MassSpecBase-205"><span class="linenos"> 205</span></a><span class="sd">        exp_freq : float, optional</span>
</span><span id="MassSpecBase-206"><a href="#MassSpecBase-206"><span class="linenos"> 206</span></a><span class="sd">            The experimental frequency of the MSPeak. Defaults to None.</span>
</span><span id="MassSpecBase-207"><a href="#MassSpecBase-207"><span class="linenos"> 207</span></a><span class="sd">        ms_parent : MSParent, optional</span>
</span><span id="MassSpecBase-208"><a href="#MassSpecBase-208"><span class="linenos"> 208</span></a><span class="sd">            The MSParent object associated with the MSPeak. Defaults to None.</span>
</span><span id="MassSpecBase-209"><a href="#MassSpecBase-209"><span class="linenos"> 209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-210"><a href="#MassSpecBase-210"><span class="linenos"> 210</span></a>        <span class="n">mspeak</span> <span class="o">=</span> <span class="n">MSPeak</span><span class="p">(</span>
</span><span id="MassSpecBase-211"><a href="#MassSpecBase-211"><span class="linenos"> 211</span></a>            <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecBase-212"><a href="#MassSpecBase-212"><span class="linenos"> 212</span></a>            <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="MassSpecBase-213"><a href="#MassSpecBase-213"><span class="linenos"> 213</span></a>            <span class="n">abundance</span><span class="p">,</span>
</span><span id="MassSpecBase-214"><a href="#MassSpecBase-214"><span class="linenos"> 214</span></a>            <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="MassSpecBase-215"><a href="#MassSpecBase-215"><span class="linenos"> 215</span></a>            <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="MassSpecBase-216"><a href="#MassSpecBase-216"><span class="linenos"> 216</span></a>            <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecBase-217"><a href="#MassSpecBase-217"><span class="linenos"> 217</span></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">),</span>
</span><span id="MassSpecBase-218"><a href="#MassSpecBase-218"><span class="linenos"> 218</span></a>            <span class="n">exp_freq</span><span class="o">=</span><span class="n">exp_freq</span><span class="p">,</span>
</span><span id="MassSpecBase-219"><a href="#MassSpecBase-219"><span class="linenos"> 219</span></a>            <span class="n">ms_parent</span><span class="o">=</span><span class="n">ms_parent</span><span class="p">,</span>
</span><span id="MassSpecBase-220"><a href="#MassSpecBase-220"><span class="linenos"> 220</span></a>        <span class="p">)</span>
</span><span id="MassSpecBase-221"><a href="#MassSpecBase-221"><span class="linenos"> 221</span></a>
</span><span id="MassSpecBase-222"><a href="#MassSpecBase-222"><span class="linenos"> 222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mspeak</span><span class="p">)</span>
</span><span id="MassSpecBase-223"><a href="#MassSpecBase-223"><span class="linenos"> 223</span></a>
</span><span id="MassSpecBase-224"><a href="#MassSpecBase-224"><span class="linenos"> 224</span></a>    <span class="k">def</span> <span class="nf">_set_parameters_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d_params</span><span class="p">):</span>
</span><span id="MassSpecBase-225"><a href="#MassSpecBase-225"><span class="linenos"> 225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the parameters of the MassSpectrum object.</span>
</span><span id="MassSpecBase-226"><a href="#MassSpecBase-226"><span class="linenos"> 226</span></a>
</span><span id="MassSpecBase-227"><a href="#MassSpecBase-227"><span class="linenos"> 227</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-228"><a href="#MassSpecBase-228"><span class="linenos"> 228</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-229"><a href="#MassSpecBase-229"><span class="linenos"> 229</span></a><span class="sd">        d_params : dict</span>
</span><span id="MassSpecBase-230"><a href="#MassSpecBase-230"><span class="linenos"> 230</span></a><span class="sd">            A dictionary containing the parameters to set.</span>
</span><span id="MassSpecBase-231"><a href="#MassSpecBase-231"><span class="linenos"> 231</span></a>
</span><span id="MassSpecBase-232"><a href="#MassSpecBase-232"><span class="linenos"> 232</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecBase-233"><a href="#MassSpecBase-233"><span class="linenos"> 233</span></a><span class="sd">        -----</span>
</span><span id="MassSpecBase-234"><a href="#MassSpecBase-234"><span class="linenos"> 234</span></a><span class="sd">        This method sets the following parameters of the MassSpectrum object:</span>
</span><span id="MassSpecBase-235"><a href="#MassSpecBase-235"><span class="linenos"> 235</span></a><span class="sd">        - _calibration_terms</span>
</span><span id="MassSpecBase-236"><a href="#MassSpecBase-236"><span class="linenos"> 236</span></a><span class="sd">        - label</span>
</span><span id="MassSpecBase-237"><a href="#MassSpecBase-237"><span class="linenos"> 237</span></a><span class="sd">        - analyzer</span>
</span><span id="MassSpecBase-238"><a href="#MassSpecBase-238"><span class="linenos"> 238</span></a><span class="sd">        - acquisition_time</span>
</span><span id="MassSpecBase-239"><a href="#MassSpecBase-239"><span class="linenos"> 239</span></a><span class="sd">        - instrument_label</span>
</span><span id="MassSpecBase-240"><a href="#MassSpecBase-240"><span class="linenos"> 240</span></a><span class="sd">        - polarity</span>
</span><span id="MassSpecBase-241"><a href="#MassSpecBase-241"><span class="linenos"> 241</span></a><span class="sd">        - scan_number</span>
</span><span id="MassSpecBase-242"><a href="#MassSpecBase-242"><span class="linenos"> 242</span></a><span class="sd">        - retention_time</span>
</span><span id="MassSpecBase-243"><a href="#MassSpecBase-243"><span class="linenos"> 243</span></a><span class="sd">        - mobility_rt</span>
</span><span id="MassSpecBase-244"><a href="#MassSpecBase-244"><span class="linenos"> 244</span></a><span class="sd">        - mobility_scan</span>
</span><span id="MassSpecBase-245"><a href="#MassSpecBase-245"><span class="linenos"> 245</span></a><span class="sd">        - _filename</span>
</span><span id="MassSpecBase-246"><a href="#MassSpecBase-246"><span class="linenos"> 246</span></a><span class="sd">        - _dir_location</span>
</span><span id="MassSpecBase-247"><a href="#MassSpecBase-247"><span class="linenos"> 247</span></a><span class="sd">        - _baseline_noise</span>
</span><span id="MassSpecBase-248"><a href="#MassSpecBase-248"><span class="linenos"> 248</span></a><span class="sd">        - _baseline_noise_std</span>
</span><span id="MassSpecBase-249"><a href="#MassSpecBase-249"><span class="linenos"> 249</span></a><span class="sd">        - sample_name</span>
</span><span id="MassSpecBase-250"><a href="#MassSpecBase-250"><span class="linenos"> 250</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-251"><a href="#MassSpecBase-251"><span class="linenos"> 251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecBase-252"><a href="#MassSpecBase-252"><span class="linenos"> 252</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Aterm&quot;</span><span class="p">),</span>
</span><span id="MassSpecBase-253"><a href="#MassSpecBase-253"><span class="linenos"> 253</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Bterm&quot;</span><span class="p">),</span>
</span><span id="MassSpecBase-254"><a href="#MassSpecBase-254"><span class="linenos"> 254</span></a>            <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Cterm&quot;</span><span class="p">),</span>
</span><span id="MassSpecBase-255"><a href="#MassSpecBase-255"><span class="linenos"> 255</span></a>        <span class="p">)</span>
</span><span id="MassSpecBase-256"><a href="#MassSpecBase-256"><span class="linenos"> 256</span></a>
</span><span id="MassSpecBase-257"><a href="#MassSpecBase-257"><span class="linenos"> 257</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>
</span><span id="MassSpecBase-258"><a href="#MassSpecBase-258"><span class="linenos"> 258</span></a>
</span><span id="MassSpecBase-259"><a href="#MassSpecBase-259"><span class="linenos"> 259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;analyzer&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-260"><a href="#MassSpecBase-260"><span class="linenos"> 260</span></a>
</span><span id="MassSpecBase-261"><a href="#MassSpecBase-261"><span class="linenos"> 261</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">acquisition_time</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;acquisition_time&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-262"><a href="#MassSpecBase-262"><span class="linenos"> 262</span></a>
</span><span id="MassSpecBase-263"><a href="#MassSpecBase-263"><span class="linenos"> 263</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;instrument_label&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-264"><a href="#MassSpecBase-264"><span class="linenos"> 264</span></a>
</span><span id="MassSpecBase-265"><a href="#MassSpecBase-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;polarity&quot;</span><span class="p">))</span>
</span><span id="MassSpecBase-266"><a href="#MassSpecBase-266"><span class="linenos"> 266</span></a>
</span><span id="MassSpecBase-267"><a href="#MassSpecBase-267"><span class="linenos"> 267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_number</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;scan_number&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-268"><a href="#MassSpecBase-268"><span class="linenos"> 268</span></a>
</span><span id="MassSpecBase-269"><a href="#MassSpecBase-269"><span class="linenos"> 269</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">retention_time</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;rt&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-270"><a href="#MassSpecBase-270"><span class="linenos"> 270</span></a>
</span><span id="MassSpecBase-271"><a href="#MassSpecBase-271"><span class="linenos"> 271</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mobility_rt</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mobility_rt&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-272"><a href="#MassSpecBase-272"><span class="linenos"> 272</span></a>
</span><span id="MassSpecBase-273"><a href="#MassSpecBase-273"><span class="linenos"> 273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mobility_scan</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mobility_scan&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-274"><a href="#MassSpecBase-274"><span class="linenos"> 274</span></a>
</span><span id="MassSpecBase-275"><a href="#MassSpecBase-275"><span class="linenos"> 275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename_path&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-276"><a href="#MassSpecBase-276"><span class="linenos"> 276</span></a>
</span><span id="MassSpecBase-277"><a href="#MassSpecBase-277"><span class="linenos"> 277</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_location</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dir_location&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-278"><a href="#MassSpecBase-278"><span class="linenos"> 278</span></a>
</span><span id="MassSpecBase-279"><a href="#MassSpecBase-279"><span class="linenos"> 279</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-280"><a href="#MassSpecBase-280"><span class="linenos"> 280</span></a>
</span><span id="MassSpecBase-281"><a href="#MassSpecBase-281"><span class="linenos"> 281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-282"><a href="#MassSpecBase-282"><span class="linenos"> 282</span></a>
</span><span id="MassSpecBase-283"><a href="#MassSpecBase-283"><span class="linenos"> 283</span></a>        <span class="k">if</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sample_name&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;Unknown&quot;</span><span class="p">:</span>
</span><span id="MassSpecBase-284"><a href="#MassSpecBase-284"><span class="linenos"> 284</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;sample_name&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-285"><a href="#MassSpecBase-285"><span class="linenos"> 285</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">:</span>
</span><span id="MassSpecBase-286"><a href="#MassSpecBase-286"><span class="linenos"> 286</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span>
</span><span id="MassSpecBase-287"><a href="#MassSpecBase-287"><span class="linenos"> 287</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-288"><a href="#MassSpecBase-288"><span class="linenos"> 288</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="o">.</span><span class="n">stem</span>
</span><span id="MassSpecBase-289"><a href="#MassSpecBase-289"><span class="linenos"> 289</span></a>
</span><span id="MassSpecBase-290"><a href="#MassSpecBase-290"><span class="linenos"> 290</span></a>    <span class="k">def</span> <span class="nf">reset_cal_therms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">fas</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="MassSpecBase-291"><a href="#MassSpecBase-291"><span class="linenos"> 291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset calibration terms and recalculate the mass-to-charge ratio and abundance.</span>
</span><span id="MassSpecBase-292"><a href="#MassSpecBase-292"><span class="linenos"> 292</span></a>
</span><span id="MassSpecBase-293"><a href="#MassSpecBase-293"><span class="linenos"> 293</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-294"><a href="#MassSpecBase-294"><span class="linenos"> 294</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-295"><a href="#MassSpecBase-295"><span class="linenos"> 295</span></a><span class="sd">        Aterm : float</span>
</span><span id="MassSpecBase-296"><a href="#MassSpecBase-296"><span class="linenos"> 296</span></a><span class="sd">            The A-term calibration coefficient.</span>
</span><span id="MassSpecBase-297"><a href="#MassSpecBase-297"><span class="linenos"> 297</span></a><span class="sd">        Bterm : float</span>
</span><span id="MassSpecBase-298"><a href="#MassSpecBase-298"><span class="linenos"> 298</span></a><span class="sd">            The B-term calibration coefficient.</span>
</span><span id="MassSpecBase-299"><a href="#MassSpecBase-299"><span class="linenos"> 299</span></a><span class="sd">        C : float</span>
</span><span id="MassSpecBase-300"><a href="#MassSpecBase-300"><span class="linenos"> 300</span></a><span class="sd">            The C-term calibration coefficient.</span>
</span><span id="MassSpecBase-301"><a href="#MassSpecBase-301"><span class="linenos"> 301</span></a><span class="sd">        fas : float, optional</span>
</span><span id="MassSpecBase-302"><a href="#MassSpecBase-302"><span class="linenos"> 302</span></a><span class="sd">            The frequency amplitude scaling factor. Default is 0.</span>
</span><span id="MassSpecBase-303"><a href="#MassSpecBase-303"><span class="linenos"> 303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-304"><a href="#MassSpecBase-304"><span class="linenos"> 304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span> <span class="o">=</span> <span class="p">(</span><span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</span><span id="MassSpecBase-305"><a href="#MassSpecBase-305"><span class="linenos"> 305</span></a>
</span><span id="MassSpecBase-306"><a href="#MassSpecBase-306"><span class="linenos"> 306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz</span><span class="p">()</span>
</span><span id="MassSpecBase-307"><a href="#MassSpecBase-307"><span class="linenos"> 307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="MassSpecBase-308"><a href="#MassSpecBase-308"><span class="linenos"> 308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="MassSpecBase-309"><a href="#MassSpecBase-309"><span class="linenos"> 309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase-310"><a href="#MassSpecBase-310"><span class="linenos"> 310</span></a>
</span><span id="MassSpecBase-311"><a href="#MassSpecBase-311"><span class="linenos"> 311</span></a>    <span class="k">def</span> <span class="nf">clear_molecular_formulas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-312"><a href="#MassSpecBase-312"><span class="linenos"> 312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the molecular formulas for all mspeaks in the MassSpectrum.</span>
</span><span id="MassSpecBase-313"><a href="#MassSpecBase-313"><span class="linenos"> 313</span></a>
</span><span id="MassSpecBase-314"><a href="#MassSpecBase-314"><span class="linenos"> 314</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-315"><a href="#MassSpecBase-315"><span class="linenos"> 315</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-316"><a href="#MassSpecBase-316"><span class="linenos"> 316</span></a><span class="sd">        numpy.ndarray</span>
</span><span id="MassSpecBase-317"><a href="#MassSpecBase-317"><span class="linenos"> 317</span></a><span class="sd">            An array of the cleared molecular formulas for each mspeak in the MassSpectrum.</span>
</span><span id="MassSpecBase-318"><a href="#MassSpecBase-318"><span class="linenos"> 318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-319"><a href="#MassSpecBase-319"><span class="linenos"> 319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-320"><a href="#MassSpecBase-320"><span class="linenos"> 320</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-321"><a href="#MassSpecBase-321"><span class="linenos"> 321</span></a>
</span><span id="MassSpecBase-322"><a href="#MassSpecBase-322"><span class="linenos"> 322</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase-323"><a href="#MassSpecBase-323"><span class="linenos"> 323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.</span>
</span><span id="MassSpecBase-324"><a href="#MassSpecBase-324"><span class="linenos"> 324</span></a>
</span><span id="MassSpecBase-325"><a href="#MassSpecBase-325"><span class="linenos"> 325</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-326"><a href="#MassSpecBase-326"><span class="linenos"> 326</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-327"><a href="#MassSpecBase-327"><span class="linenos"> 327</span></a><span class="sd">        keep_profile : bool, optional</span>
</span><span id="MassSpecBase-328"><a href="#MassSpecBase-328"><span class="linenos"> 328</span></a><span class="sd">            Whether to keep the profile data after processing. Defaults to True.</span>
</span><span id="MassSpecBase-329"><a href="#MassSpecBase-329"><span class="linenos"> 329</span></a>
</span><span id="MassSpecBase-330"><a href="#MassSpecBase-330"><span class="linenos"> 330</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecBase-331"><a href="#MassSpecBase-331"><span class="linenos"> 331</span></a><span class="sd">        -----</span>
</span><span id="MassSpecBase-332"><a href="#MassSpecBase-332"><span class="linenos"> 332</span></a><span class="sd">        This method does the following:</span>
</span><span id="MassSpecBase-333"><a href="#MassSpecBase-333"><span class="linenos"> 333</span></a><span class="sd">        - calculates the noise threshold</span>
</span><span id="MassSpecBase-334"><a href="#MassSpecBase-334"><span class="linenos"> 334</span></a><span class="sd">        - does peak picking (creates mspeak_objs)</span>
</span><span id="MassSpecBase-335"><a href="#MassSpecBase-335"><span class="linenos"> 335</span></a><span class="sd">        - resets the mspeak_obj indexes</span>
</span><span id="MassSpecBase-336"><a href="#MassSpecBase-336"><span class="linenos"> 336</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-337"><a href="#MassSpecBase-337"><span class="linenos"> 337</span></a>
</span><span id="MassSpecBase-338"><a href="#MassSpecBase-338"><span class="linenos"> 338</span></a>        <span class="c1"># if runned mannually make sure to rerun filter_by_noise_threshold</span>
</span><span id="MassSpecBase-339"><a href="#MassSpecBase-339"><span class="linenos"> 339</span></a>        <span class="c1"># calculates noise threshold</span>
</span><span id="MassSpecBase-340"><a href="#MassSpecBase-340"><span class="linenos"> 340</span></a>        <span class="c1"># do peak picking( create mspeak_objs)</span>
</span><span id="MassSpecBase-341"><a href="#MassSpecBase-341"><span class="linenos"> 341</span></a>        <span class="c1"># reset mspeak_obj the indexes</span>
</span><span id="MassSpecBase-342"><a href="#MassSpecBase-342"><span class="linenos"> 342</span></a>
</span><span id="MassSpecBase-343"><a href="#MassSpecBase-343"><span class="linenos"> 343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cal_noise_threshold</span><span class="p">()</span>
</span><span id="MassSpecBase-344"><a href="#MassSpecBase-344"><span class="linenos"> 344</span></a>
</span><span id="MassSpecBase-345"><a href="#MassSpecBase-345"><span class="linenos"> 345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="MassSpecBase-346"><a href="#MassSpecBase-346"><span class="linenos"> 346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase-347"><a href="#MassSpecBase-347"><span class="linenos"> 347</span></a>
</span><span id="MassSpecBase-348"><a href="#MassSpecBase-348"><span class="linenos"> 348</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase-349"><a href="#MassSpecBase-349"><span class="linenos"> 349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="MassSpecBase-350"><a href="#MassSpecBase-350"><span class="linenos"> 350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-351"><a href="#MassSpecBase-351"><span class="linenos"> 351</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MassSpecBase-352"><a href="#MassSpecBase-352"><span class="linenos"> 352</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_profile</span><span class="p">:</span>
</span><span id="MassSpecBase-353"><a href="#MassSpecBase-353"><span class="linenos"> 353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">*=</span> <span class="mi">0</span>
</span><span id="MassSpecBase-354"><a href="#MassSpecBase-354"><span class="linenos"> 354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">*=</span> <span class="mi">0</span>
</span><span id="MassSpecBase-355"><a href="#MassSpecBase-355"><span class="linenos"> 355</span></a>
</span><span id="MassSpecBase-356"><a href="#MassSpecBase-356"><span class="linenos"> 356</span></a>    <span class="k">def</span> <span class="nf">cal_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-357"><a href="#MassSpecBase-357"><span class="linenos"> 357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the noise threshold of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-358"><a href="#MassSpecBase-358"><span class="linenos"> 358</span></a>
</span><span id="MassSpecBase-359"><a href="#MassSpecBase-359"><span class="linenos"> 359</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">simulated_profile</span><span class="p">:</span>
</span><span id="MassSpecBase-360"><a href="#MassSpecBase-360"><span class="linenos"> 360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="MassSpecBase-361"><a href="#MassSpecBase-361"><span class="linenos"> 361</span></a>
</span><span id="MassSpecBase-362"><a href="#MassSpecBase-362"><span class="linenos"> 362</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="MassSpecBase-363"><a href="#MassSpecBase-363"><span class="linenos"> 363</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecBase-364"><a href="#MassSpecBase-364"><span class="linenos"> 364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_log_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecBase-365"><a href="#MassSpecBase-365"><span class="linenos"> 365</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-366"><a href="#MassSpecBase-366"><span class="linenos"> 366</span></a>
</span><span id="MassSpecBase-367"><a href="#MassSpecBase-367"><span class="linenos"> 367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-368"><a href="#MassSpecBase-368"><span class="linenos"> 368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecBase-369"><a href="#MassSpecBase-369"><span class="linenos"> 369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecBase-370"><a href="#MassSpecBase-370"><span class="linenos"> 370</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-371"><a href="#MassSpecBase-371"><span class="linenos"> 371</span></a>
</span><span id="MassSpecBase-372"><a href="#MassSpecBase-372"><span class="linenos"> 372</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-373"><a href="#MassSpecBase-373"><span class="linenos"> 373</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-374"><a href="#MassSpecBase-374"><span class="linenos"> 374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-375"><a href="#MassSpecBase-375"><span class="linenos"> 375</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="MassSpecBase-376"><a href="#MassSpecBase-376"><span class="linenos"> 376</span></a>
</span><span id="MassSpecBase-377"><a href="#MassSpecBase-377"><span class="linenos"> 377</span></a>    <span class="nd">@parameters</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-378"><a href="#MassSpecBase-378"><span class="linenos"> 378</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MSParameters</span><span class="p">):</span>
</span><span id="MassSpecBase-379"><a href="#MassSpecBase-379"><span class="linenos"> 379</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">instance_MSParameters</span>
</span><span id="MassSpecBase-380"><a href="#MassSpecBase-380"><span class="linenos"> 380</span></a>
</span><span id="MassSpecBase-381"><a href="#MassSpecBase-381"><span class="linenos"> 381</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="MassSpecBase-382"><a href="#MassSpecBase-382"><span class="linenos"> 382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the parameters of the mass spectrum from a JSON file.</span>
</span><span id="MassSpecBase-383"><a href="#MassSpecBase-383"><span class="linenos"> 383</span></a>
</span><span id="MassSpecBase-384"><a href="#MassSpecBase-384"><span class="linenos"> 384</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-385"><a href="#MassSpecBase-385"><span class="linenos"> 385</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-386"><a href="#MassSpecBase-386"><span class="linenos"> 386</span></a><span class="sd">        parameters_path : str</span>
</span><span id="MassSpecBase-387"><a href="#MassSpecBase-387"><span class="linenos"> 387</span></a><span class="sd">            The path to the JSON file containing the parameters.</span>
</span><span id="MassSpecBase-388"><a href="#MassSpecBase-388"><span class="linenos"> 388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-389"><a href="#MassSpecBase-389"><span class="linenos"> 389</span></a>        <span class="n">load_and_set_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span><span id="MassSpecBase-390"><a href="#MassSpecBase-390"><span class="linenos"> 390</span></a>
</span><span id="MassSpecBase-391"><a href="#MassSpecBase-391"><span class="linenos"> 391</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="MassSpecBase-392"><a href="#MassSpecBase-392"><span class="linenos"> 392</span></a>        <span class="n">load_and_set_toml_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span><span id="MassSpecBase-393"><a href="#MassSpecBase-393"><span class="linenos"> 393</span></a>
</span><span id="MassSpecBase-394"><a href="#MassSpecBase-394"><span class="linenos"> 394</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-395"><a href="#MassSpecBase-395"><span class="linenos"> 395</span></a>    <span class="k">def</span> <span class="nf">mspeaks_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-396"><a href="#MassSpecBase-396"><span class="linenos"> 396</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the MS peak settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-397"><a href="#MassSpecBase-397"><span class="linenos"> 397</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span>
</span><span id="MassSpecBase-398"><a href="#MassSpecBase-398"><span class="linenos"> 398</span></a>
</span><span id="MassSpecBase-399"><a href="#MassSpecBase-399"><span class="linenos"> 399</span></a>    <span class="nd">@mspeaks_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-400"><a href="#MassSpecBase-400"><span class="linenos"> 400</span></a>    <span class="k">def</span> <span class="nf">mspeaks_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MassSpecPeakSetting</span><span class="p">):</span>
</span><span id="MassSpecBase-401"><a href="#MassSpecBase-401"><span class="linenos"> 401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span> <span class="o">=</span> <span class="n">instance_MassSpecPeakSetting</span>
</span><span id="MassSpecBase-402"><a href="#MassSpecBase-402"><span class="linenos"> 402</span></a>
</span><span id="MassSpecBase-403"><a href="#MassSpecBase-403"><span class="linenos"> 403</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-404"><a href="#MassSpecBase-404"><span class="linenos"> 404</span></a>    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-405"><a href="#MassSpecBase-405"><span class="linenos"> 405</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-406"><a href="#MassSpecBase-406"><span class="linenos"> 406</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span>
</span><span id="MassSpecBase-407"><a href="#MassSpecBase-407"><span class="linenos"> 407</span></a>
</span><span id="MassSpecBase-408"><a href="#MassSpecBase-408"><span class="linenos"> 408</span></a>    <span class="nd">@settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-409"><a href="#MassSpecBase-409"><span class="linenos"> 409</span></a>    <span class="k">def</span> <span class="nf">settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MassSpectrumSetting</span><span class="p">):</span>
</span><span id="MassSpecBase-410"><a href="#MassSpecBase-410"><span class="linenos"> 410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span> <span class="o">=</span> <span class="n">instance_MassSpectrumSetting</span>
</span><span id="MassSpecBase-411"><a href="#MassSpecBase-411"><span class="linenos"> 411</span></a>
</span><span id="MassSpecBase-412"><a href="#MassSpecBase-412"><span class="linenos"> 412</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-413"><a href="#MassSpecBase-413"><span class="linenos"> 413</span></a>    <span class="k">def</span> <span class="nf">molecular_search_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-414"><a href="#MassSpecBase-414"><span class="linenos"> 414</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the molecular search settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-415"><a href="#MassSpecBase-415"><span class="linenos"> 415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">molecular_search</span>
</span><span id="MassSpecBase-416"><a href="#MassSpecBase-416"><span class="linenos"> 416</span></a>
</span><span id="MassSpecBase-417"><a href="#MassSpecBase-417"><span class="linenos"> 417</span></a>    <span class="nd">@molecular_search_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-418"><a href="#MassSpecBase-418"><span class="linenos"> 418</span></a>    <span class="k">def</span> <span class="nf">molecular_search_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_MolecularFormulaSearchSettings</span><span class="p">):</span>
</span><span id="MassSpecBase-419"><a href="#MassSpecBase-419"><span class="linenos"> 419</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">molecular_search</span> <span class="o">=</span> <span class="n">instance_MolecularFormulaSearchSettings</span>
</span><span id="MassSpecBase-420"><a href="#MassSpecBase-420"><span class="linenos"> 420</span></a>
</span><span id="MassSpecBase-421"><a href="#MassSpecBase-421"><span class="linenos"> 421</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-422"><a href="#MassSpecBase-422"><span class="linenos"> 422</span></a>    <span class="k">def</span> <span class="nf">mz_cal_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-423"><a href="#MassSpecBase-423"><span class="linenos"> 423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the calibrated m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-424"><a href="#MassSpecBase-424"><span class="linenos"> 424</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span>
</span><span id="MassSpecBase-425"><a href="#MassSpecBase-425"><span class="linenos"> 425</span></a>
</span><span id="MassSpecBase-426"><a href="#MassSpecBase-426"><span class="linenos"> 426</span></a>    <span class="nd">@mz_cal_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-427"><a href="#MassSpecBase-427"><span class="linenos"> 427</span></a>    <span class="k">def</span> <span class="nf">mz_cal_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="MassSpecBase-428"><a href="#MassSpecBase-428"><span class="linenos"> 428</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">):</span>
</span><span id="MassSpecBase-429"><a href="#MassSpecBase-429"><span class="linenos"> 429</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span> <span class="o">=</span> <span class="n">mz_cal_list</span>
</span><span id="MassSpecBase-430"><a href="#MassSpecBase-430"><span class="linenos"> 430</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-431"><a href="#MassSpecBase-431"><span class="linenos"> 431</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase-432"><a href="#MassSpecBase-432"><span class="linenos"> 432</span></a>                <span class="s2">&quot;calibrated array (</span><span class="si">%i</span><span class="s2">) is not of the same size of the data (</span><span class="si">%i</span><span class="s2">)&quot;</span>
</span><span id="MassSpecBase-433"><a href="#MassSpecBase-433"><span class="linenos"> 433</span></a>                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">))</span>
</span><span id="MassSpecBase-434"><a href="#MassSpecBase-434"><span class="linenos"> 434</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-435"><a href="#MassSpecBase-435"><span class="linenos"> 435</span></a>
</span><span id="MassSpecBase-436"><a href="#MassSpecBase-436"><span class="linenos"> 436</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-437"><a href="#MassSpecBase-437"><span class="linenos"> 437</span></a>    <span class="k">def</span> <span class="nf">mz_cal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-438"><a href="#MassSpecBase-438"><span class="linenos"> 438</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the calibrated m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-439"><a href="#MassSpecBase-439"><span class="linenos"> 439</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_cal</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-440"><a href="#MassSpecBase-440"><span class="linenos"> 440</span></a>
</span><span id="MassSpecBase-441"><a href="#MassSpecBase-441"><span class="linenos"> 441</span></a>    <span class="nd">@mz_cal</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-442"><a href="#MassSpecBase-442"><span class="linenos"> 442</span></a>    <span class="k">def</span> <span class="nf">mz_cal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="MassSpecBase-443"><a href="#MassSpecBase-443"><span class="linenos"> 443</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase-444"><a href="#MassSpecBase-444"><span class="linenos"> 444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecBase-445"><a href="#MassSpecBase-445"><span class="linenos"> 445</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mz_cal</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">):</span>
</span><span id="MassSpecBase-446"><a href="#MassSpecBase-446"><span class="linenos"> 446</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">mz_cal</span> <span class="o">=</span> <span class="n">mz_cal</span>
</span><span id="MassSpecBase-447"><a href="#MassSpecBase-447"><span class="linenos"> 447</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-448"><a href="#MassSpecBase-448"><span class="linenos"> 448</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase-449"><a href="#MassSpecBase-449"><span class="linenos"> 449</span></a>                <span class="s2">&quot;calibrated array (</span><span class="si">%i</span><span class="s2">) is not of the same size of the data (</span><span class="si">%i</span><span class="s2">)&quot;</span>
</span><span id="MassSpecBase-450"><a href="#MassSpecBase-450"><span class="linenos"> 450</span></a>                <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mz_cal_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">))</span>
</span><span id="MassSpecBase-451"><a href="#MassSpecBase-451"><span class="linenos"> 451</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-452"><a href="#MassSpecBase-452"><span class="linenos"> 452</span></a>
</span><span id="MassSpecBase-453"><a href="#MassSpecBase-453"><span class="linenos"> 453</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-454"><a href="#MassSpecBase-454"><span class="linenos"> 454</span></a>    <span class="k">def</span> <span class="nf">mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-455"><a href="#MassSpecBase-455"><span class="linenos"> 455</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-456"><a href="#MassSpecBase-456"><span class="linenos"> 456</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-457"><a href="#MassSpecBase-457"><span class="linenos"> 457</span></a>
</span><span id="MassSpecBase-458"><a href="#MassSpecBase-458"><span class="linenos"> 458</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span><span class="p">:</span>
</span><span id="MassSpecBase-459"><a href="#MassSpecBase-459"><span class="linenos"> 459</span></a>            <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_cal</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-460"><a href="#MassSpecBase-460"><span class="linenos"> 460</span></a>
</span><span id="MassSpecBase-461"><a href="#MassSpecBase-461"><span class="linenos"> 461</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-462"><a href="#MassSpecBase-462"><span class="linenos"> 462</span></a>            <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-463"><a href="#MassSpecBase-463"><span class="linenos"> 463</span></a>
</span><span id="MassSpecBase-464"><a href="#MassSpecBase-464"><span class="linenos"> 464</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-465"><a href="#MassSpecBase-465"><span class="linenos"> 465</span></a>    <span class="k">def</span> <span class="nf">freq_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-466"><a href="#MassSpecBase-466"><span class="linenos"> 466</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-467"><a href="#MassSpecBase-467"><span class="linenos"> 467</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span>
</span><span id="MassSpecBase-468"><a href="#MassSpecBase-468"><span class="linenos"> 468</span></a>
</span><span id="MassSpecBase-469"><a href="#MassSpecBase-469"><span class="linenos"> 469</span></a>    <span class="nd">@freq_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-470"><a href="#MassSpecBase-470"><span class="linenos"> 470</span></a>    <span class="k">def</span> <span class="nf">freq_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="MassSpecBase-471"><a href="#MassSpecBase-471"><span class="linenos"> 471</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="MassSpecBase-472"><a href="#MassSpecBase-472"><span class="linenos"> 472</span></a>
</span><span id="MassSpecBase-473"><a href="#MassSpecBase-473"><span class="linenos"> 473</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-474"><a href="#MassSpecBase-474"><span class="linenos"> 474</span></a>    <span class="k">def</span> <span class="nf">freq_exp_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-475"><a href="#MassSpecBase-475"><span class="linenos"> 475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency values of the mass spectrum that are used for peak picking.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-476"><a href="#MassSpecBase-476"><span class="linenos"> 476</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">freq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="MassSpecBase-477"><a href="#MassSpecBase-477"><span class="linenos"> 477</span></a>        <span class="k">return</span> <span class="n">freq</span>
</span><span id="MassSpecBase-478"><a href="#MassSpecBase-478"><span class="linenos"> 478</span></a>
</span><span id="MassSpecBase-479"><a href="#MassSpecBase-479"><span class="linenos"> 479</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-480"><a href="#MassSpecBase-480"><span class="linenos"> 480</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-481"><a href="#MassSpecBase-481"><span class="linenos"> 481</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-482"><a href="#MassSpecBase-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span><span class="p">:</span>
</span><span id="MassSpecBase-483"><a href="#MassSpecBase-483"><span class="linenos"> 483</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_cal_profile</span>
</span><span id="MassSpecBase-484"><a href="#MassSpecBase-484"><span class="linenos"> 484</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-485"><a href="#MassSpecBase-485"><span class="linenos"> 485</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span>
</span><span id="MassSpecBase-486"><a href="#MassSpecBase-486"><span class="linenos"> 486</span></a>
</span><span id="MassSpecBase-487"><a href="#MassSpecBase-487"><span class="linenos"> 487</span></a>    <span class="nd">@mz_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-488"><a href="#MassSpecBase-488"><span class="linenos"> 488</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="MassSpecBase-489"><a href="#MassSpecBase-489"><span class="linenos"> 489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="MassSpecBase-490"><a href="#MassSpecBase-490"><span class="linenos"> 490</span></a>
</span><span id="MassSpecBase-491"><a href="#MassSpecBase-491"><span class="linenos"> 491</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-492"><a href="#MassSpecBase-492"><span class="linenos"> 492</span></a>    <span class="k">def</span> <span class="nf">mz_exp_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-493"><a href="#MassSpecBase-493"><span class="linenos"> 493</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental m/z values of the mass spectrum that are used for peak picking.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-494"><a href="#MassSpecBase-494"><span class="linenos"> 494</span></a>        <span class="n">mz</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="MassSpecBase-495"><a href="#MassSpecBase-495"><span class="linenos"> 495</span></a>        <span class="k">return</span> <span class="n">mz</span>
</span><span id="MassSpecBase-496"><a href="#MassSpecBase-496"><span class="linenos"> 496</span></a>
</span><span id="MassSpecBase-497"><a href="#MassSpecBase-497"><span class="linenos"> 497</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-498"><a href="#MassSpecBase-498"><span class="linenos"> 498</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-499"><a href="#MassSpecBase-499"><span class="linenos"> 499</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-500"><a href="#MassSpecBase-500"><span class="linenos"> 500</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="MassSpecBase-501"><a href="#MassSpecBase-501"><span class="linenos"> 501</span></a>
</span><span id="MassSpecBase-502"><a href="#MassSpecBase-502"><span class="linenos"> 502</span></a>    <span class="nd">@abundance_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecBase-503"><a href="#MassSpecBase-503"><span class="linenos"> 503</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_data</span><span class="p">):</span>
</span><span id="MassSpecBase-504"><a href="#MassSpecBase-504"><span class="linenos"> 504</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="MassSpecBase-505"><a href="#MassSpecBase-505"><span class="linenos"> 505</span></a>
</span><span id="MassSpecBase-506"><a href="#MassSpecBase-506"><span class="linenos"> 506</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-507"><a href="#MassSpecBase-507"><span class="linenos"> 507</span></a>    <span class="k">def</span> <span class="nf">abundance_profile_pp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-508"><a href="#MassSpecBase-508"><span class="linenos"> 508</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum that is used for peak picking.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-509"><a href="#MassSpecBase-509"><span class="linenos"> 509</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_peak_picking_data</span><span class="p">()</span>
</span><span id="MassSpecBase-510"><a href="#MassSpecBase-510"><span class="linenos"> 510</span></a>        <span class="k">return</span> <span class="n">abundance</span>
</span><span id="MassSpecBase-511"><a href="#MassSpecBase-511"><span class="linenos"> 511</span></a>
</span><span id="MassSpecBase-512"><a href="#MassSpecBase-512"><span class="linenos"> 512</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-513"><a href="#MassSpecBase-513"><span class="linenos"> 513</span></a>    <span class="k">def</span> <span class="nf">abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-514"><a href="#MassSpecBase-514"><span class="linenos"> 514</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-515"><a href="#MassSpecBase-515"><span class="linenos"> 515</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-516"><a href="#MassSpecBase-516"><span class="linenos"> 516</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-517"><a href="#MassSpecBase-517"><span class="linenos"> 517</span></a>
</span><span id="MassSpecBase-518"><a href="#MassSpecBase-518"><span class="linenos"> 518</span></a>    <span class="k">def</span> <span class="nf">freq_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-519"><a href="#MassSpecBase-519"><span class="linenos"> 519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-520"><a href="#MassSpecBase-520"><span class="linenos"> 520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-521"><a href="#MassSpecBase-521"><span class="linenos"> 521</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">freq_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-522"><a href="#MassSpecBase-522"><span class="linenos"> 522</span></a>
</span><span id="MassSpecBase-523"><a href="#MassSpecBase-523"><span class="linenos"> 523</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-524"><a href="#MassSpecBase-524"><span class="linenos"> 524</span></a>    <span class="k">def</span> <span class="nf">resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-525"><a href="#MassSpecBase-525"><span class="linenos"> 525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the resolving power values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-526"><a href="#MassSpecBase-526"><span class="linenos"> 526</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-527"><a href="#MassSpecBase-527"><span class="linenos"> 527</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-528"><a href="#MassSpecBase-528"><span class="linenos"> 528</span></a>
</span><span id="MassSpecBase-529"><a href="#MassSpecBase-529"><span class="linenos"> 529</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-530"><a href="#MassSpecBase-530"><span class="linenos"> 530</span></a>    <span class="k">def</span> <span class="nf">signal_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-531"><a href="#MassSpecBase-531"><span class="linenos"> 531</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-532"><a href="#MassSpecBase-532"><span class="linenos"> 532</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-533"><a href="#MassSpecBase-533"><span class="linenos"> 533</span></a>
</span><span id="MassSpecBase-534"><a href="#MassSpecBase-534"><span class="linenos"> 534</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-535"><a href="#MassSpecBase-535"><span class="linenos"> 535</span></a>    <span class="k">def</span> <span class="nf">nominal_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-536"><a href="#MassSpecBase-536"><span class="linenos"> 536</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the nominal m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-537"><a href="#MassSpecBase-537"><span class="linenos"> 537</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="p">:</span>
</span><span id="MassSpecBase-538"><a href="#MassSpecBase-538"><span class="linenos"> 538</span></a>            <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</span><span id="MassSpecBase-539"><a href="#MassSpecBase-539"><span class="linenos"> 539</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-540"><a href="#MassSpecBase-540"><span class="linenos"> 540</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Nominal indexes not yet set&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-541"><a href="#MassSpecBase-541"><span class="linenos"> 541</span></a>
</span><span id="MassSpecBase-542"><a href="#MassSpecBase-542"><span class="linenos"> 542</span></a>    <span class="k">def</span> <span class="nf">get_mz_and_abundance_peaks_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-543"><a href="#MassSpecBase-543"><span class="linenos"> 543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of tuples containing the m/z and abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-544"><a href="#MassSpecBase-544"><span class="linenos"> 544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-545"><a href="#MassSpecBase-545"><span class="linenos"> 545</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]</span>
</span><span id="MassSpecBase-546"><a href="#MassSpecBase-546"><span class="linenos"> 546</span></a>
</span><span id="MassSpecBase-547"><a href="#MassSpecBase-547"><span class="linenos"> 547</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-548"><a href="#MassSpecBase-548"><span class="linenos"> 548</span></a>    <span class="k">def</span> <span class="nf">kmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-549"><a href="#MassSpecBase-549"><span class="linenos"> 549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Kendrick mass defect values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-550"><a href="#MassSpecBase-550"><span class="linenos"> 550</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-551"><a href="#MassSpecBase-551"><span class="linenos"> 551</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">kmd</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-552"><a href="#MassSpecBase-552"><span class="linenos"> 552</span></a>
</span><span id="MassSpecBase-553"><a href="#MassSpecBase-553"><span class="linenos"> 553</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-554"><a href="#MassSpecBase-554"><span class="linenos"> 554</span></a>    <span class="k">def</span> <span class="nf">kendrick_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-555"><a href="#MassSpecBase-555"><span class="linenos"> 555</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the Kendrick mass values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-556"><a href="#MassSpecBase-556"><span class="linenos"> 556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase-557"><a href="#MassSpecBase-557"><span class="linenos"> 557</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">kendrick_mass</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-558"><a href="#MassSpecBase-558"><span class="linenos"> 558</span></a>
</span><span id="MassSpecBase-559"><a href="#MassSpecBase-559"><span class="linenos"> 559</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-560"><a href="#MassSpecBase-560"><span class="linenos"> 560</span></a>    <span class="k">def</span> <span class="nf">max_mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-561"><a href="#MassSpecBase-561"><span class="linenos"> 561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum experimental m/z value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-562"><a href="#MassSpecBase-562"><span class="linenos"> 562</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-563"><a href="#MassSpecBase-563"><span class="linenos"> 563</span></a>
</span><span id="MassSpecBase-564"><a href="#MassSpecBase-564"><span class="linenos"> 564</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-565"><a href="#MassSpecBase-565"><span class="linenos"> 565</span></a>    <span class="k">def</span> <span class="nf">min_mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-566"><a href="#MassSpecBase-566"><span class="linenos"> 566</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the minimum experimental m/z value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-567"><a href="#MassSpecBase-567"><span class="linenos"> 567</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-568"><a href="#MassSpecBase-568"><span class="linenos"> 568</span></a>
</span><span id="MassSpecBase-569"><a href="#MassSpecBase-569"><span class="linenos"> 569</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-570"><a href="#MassSpecBase-570"><span class="linenos"> 570</span></a>    <span class="k">def</span> <span class="nf">max_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-571"><a href="#MassSpecBase-571"><span class="linenos"> 571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum abundance value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-572"><a href="#MassSpecBase-572"><span class="linenos"> 572</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-573"><a href="#MassSpecBase-573"><span class="linenos"> 573</span></a>
</span><span id="MassSpecBase-574"><a href="#MassSpecBase-574"><span class="linenos"> 574</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-575"><a href="#MassSpecBase-575"><span class="linenos"> 575</span></a>    <span class="k">def</span> <span class="nf">max_signal_to_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-576"><a href="#MassSpecBase-576"><span class="linenos"> 576</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the maximum signal-to-noise ratio of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-577"><a href="#MassSpecBase-577"><span class="linenos"> 577</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-578"><a href="#MassSpecBase-578"><span class="linenos"> 578</span></a>
</span><span id="MassSpecBase-579"><a href="#MassSpecBase-579"><span class="linenos"> 579</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-580"><a href="#MassSpecBase-580"><span class="linenos"> 580</span></a>    <span class="k">def</span> <span class="nf">most_abundant_mspeak</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-581"><a href="#MassSpecBase-581"><span class="linenos"> 581</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the most abundant MSpeak object of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-582"><a href="#MassSpecBase-582"><span class="linenos"> 582</span></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="MassSpecBase-583"><a href="#MassSpecBase-583"><span class="linenos"> 583</span></a>
</span><span id="MassSpecBase-584"><a href="#MassSpecBase-584"><span class="linenos"> 584</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-585"><a href="#MassSpecBase-585"><span class="linenos"> 585</span></a>    <span class="k">def</span> <span class="nf">min_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-586"><a href="#MassSpecBase-586"><span class="linenos"> 586</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the minimum abundance value of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-587"><a href="#MassSpecBase-587"><span class="linenos"> 587</span></a>        <span class="k">return</span> <span class="nb">min</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span><span id="MassSpecBase-588"><a href="#MassSpecBase-588"><span class="linenos"> 588</span></a>
</span><span id="MassSpecBase-589"><a href="#MassSpecBase-589"><span class="linenos"> 589</span></a>    <span class="c1"># takes too much cpu time</span>
</span><span id="MassSpecBase-590"><a href="#MassSpecBase-590"><span class="linenos"> 590</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-591"><a href="#MassSpecBase-591"><span class="linenos"> 591</span></a>    <span class="k">def</span> <span class="nf">dynamic_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-592"><a href="#MassSpecBase-592"><span class="linenos"> 592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the dynamic range of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-593"><a href="#MassSpecBase-593"><span class="linenos"> 593</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span>
</span><span id="MassSpecBase-594"><a href="#MassSpecBase-594"><span class="linenos"> 594</span></a>
</span><span id="MassSpecBase-595"><a href="#MassSpecBase-595"><span class="linenos"> 595</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-596"><a href="#MassSpecBase-596"><span class="linenos"> 596</span></a>    <span class="k">def</span> <span class="nf">baseline_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-597"><a href="#MassSpecBase-597"><span class="linenos"> 597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the baseline noise of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-598"><a href="#MassSpecBase-598"><span class="linenos"> 598</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">:</span>
</span><span id="MassSpecBase-599"><a href="#MassSpecBase-599"><span class="linenos"> 599</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span>
</span><span id="MassSpecBase-600"><a href="#MassSpecBase-600"><span class="linenos"> 600</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-601"><a href="#MassSpecBase-601"><span class="linenos"> 601</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MassSpecBase-602"><a href="#MassSpecBase-602"><span class="linenos"> 602</span></a>
</span><span id="MassSpecBase-603"><a href="#MassSpecBase-603"><span class="linenos"> 603</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-604"><a href="#MassSpecBase-604"><span class="linenos"> 604</span></a>    <span class="k">def</span> <span class="nf">baseline_noise_std</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-605"><a href="#MassSpecBase-605"><span class="linenos"> 605</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the standard deviation of the baseline noise of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-606"><a href="#MassSpecBase-606"><span class="linenos"> 606</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="MassSpecBase-607"><a href="#MassSpecBase-607"><span class="linenos"> 607</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span>
</span><span id="MassSpecBase-608"><a href="#MassSpecBase-608"><span class="linenos"> 608</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span><span class="p">:</span>
</span><span id="MassSpecBase-609"><a href="#MassSpecBase-609"><span class="linenos"> 609</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span>
</span><span id="MassSpecBase-610"><a href="#MassSpecBase-610"><span class="linenos"> 610</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-611"><a href="#MassSpecBase-611"><span class="linenos"> 611</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="MassSpecBase-612"><a href="#MassSpecBase-612"><span class="linenos"> 612</span></a>
</span><span id="MassSpecBase-613"><a href="#MassSpecBase-613"><span class="linenos"> 613</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-614"><a href="#MassSpecBase-614"><span class="linenos"> 614</span></a>    <span class="k">def</span> <span class="nf">Aterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-615"><a href="#MassSpecBase-615"><span class="linenos"> 615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the A-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-616"><a href="#MassSpecBase-616"><span class="linenos"> 616</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MassSpecBase-617"><a href="#MassSpecBase-617"><span class="linenos"> 617</span></a>
</span><span id="MassSpecBase-618"><a href="#MassSpecBase-618"><span class="linenos"> 618</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-619"><a href="#MassSpecBase-619"><span class="linenos"> 619</span></a>    <span class="k">def</span> <span class="nf">Bterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-620"><a href="#MassSpecBase-620"><span class="linenos"> 620</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the B-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-621"><a href="#MassSpecBase-621"><span class="linenos"> 621</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MassSpecBase-622"><a href="#MassSpecBase-622"><span class="linenos"> 622</span></a>
</span><span id="MassSpecBase-623"><a href="#MassSpecBase-623"><span class="linenos"> 623</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-624"><a href="#MassSpecBase-624"><span class="linenos"> 624</span></a>    <span class="k">def</span> <span class="nf">Cterm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-625"><a href="#MassSpecBase-625"><span class="linenos"> 625</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the C-term calibration coefficient of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-626"><a href="#MassSpecBase-626"><span class="linenos"> 626</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span><span id="MassSpecBase-627"><a href="#MassSpecBase-627"><span class="linenos"> 627</span></a>
</span><span id="MassSpecBase-628"><a href="#MassSpecBase-628"><span class="linenos"> 628</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-629"><a href="#MassSpecBase-629"><span class="linenos"> 629</span></a>    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-630"><a href="#MassSpecBase-630"><span class="linenos"> 630</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the filename of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-631"><a href="#MassSpecBase-631"><span class="linenos"> 631</span></a>        <span class="k">return</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filename</span><span class="p">)</span>
</span><span id="MassSpecBase-632"><a href="#MassSpecBase-632"><span class="linenos"> 632</span></a>
</span><span id="MassSpecBase-633"><a href="#MassSpecBase-633"><span class="linenos"> 633</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-634"><a href="#MassSpecBase-634"><span class="linenos"> 634</span></a>    <span class="k">def</span> <span class="nf">dir_location</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-635"><a href="#MassSpecBase-635"><span class="linenos"> 635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the directory location of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-636"><a href="#MassSpecBase-636"><span class="linenos"> 636</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dir_location</span>
</span><span id="MassSpecBase-637"><a href="#MassSpecBase-637"><span class="linenos"> 637</span></a>
</span><span id="MassSpecBase-638"><a href="#MassSpecBase-638"><span class="linenos"> 638</span></a>    <span class="k">def</span> <span class="nf">sort_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-639"><a href="#MassSpecBase-639"><span class="linenos"> 639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by m/z values.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-640"><a href="#MassSpecBase-640"><span class="linenos"> 640</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">)</span>
</span><span id="MassSpecBase-641"><a href="#MassSpecBase-641"><span class="linenos"> 641</span></a>
</span><span id="MassSpecBase-642"><a href="#MassSpecBase-642"><span class="linenos"> 642</span></a>    <span class="k">def</span> <span class="nf">sort_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase-643"><a href="#MassSpecBase-643"><span class="linenos"> 643</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by abundance values.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-644"><a href="#MassSpecBase-644"><span class="linenos"> 644</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</span><span id="MassSpecBase-645"><a href="#MassSpecBase-645"><span class="linenos"> 645</span></a>
</span><span id="MassSpecBase-646"><a href="#MassSpecBase-646"><span class="linenos"> 646</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecBase-647"><a href="#MassSpecBase-647"><span class="linenos"> 647</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-648"><a href="#MassSpecBase-648"><span class="linenos"> 648</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-649"><a href="#MassSpecBase-649"><span class="linenos"> 649</span></a>        <span class="k">return</span> <span class="n">trapz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">)</span>
</span><span id="MassSpecBase-650"><a href="#MassSpecBase-650"><span class="linenos"> 650</span></a>
</span><span id="MassSpecBase-651"><a href="#MassSpecBase-651"><span class="linenos"> 651</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-652"><a href="#MassSpecBase-652"><span class="linenos"> 652</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="MassSpecBase-653"><a href="#MassSpecBase-653"><span class="linenos"> 653</span></a>
</span><span id="MassSpecBase-654"><a href="#MassSpecBase-654"><span class="linenos"> 654</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase-655"><a href="#MassSpecBase-655"><span class="linenos"> 655</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase-656"><a href="#MassSpecBase-656"><span class="linenos"> 656</span></a><span class="sd">        Warning</span>
</span><span id="MassSpecBase-657"><a href="#MassSpecBase-657"><span class="linenos"> 657</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="MassSpecBase-658"><a href="#MassSpecBase-658"><span class="linenos"> 658</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-659"><a href="#MassSpecBase-659"><span class="linenos"> 659</span></a>        <span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="MassSpecBase-660"><a href="#MassSpecBase-660"><span class="linenos"> 660</span></a>
</span><span id="MassSpecBase-661"><a href="#MassSpecBase-661"><span class="linenos"> 661</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase-662"><a href="#MassSpecBase-662"><span class="linenos"> 662</span></a>            <span class="k">pass</span>
</span><span id="MassSpecBase-663"><a href="#MassSpecBase-663"><span class="linenos"> 663</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-664"><a href="#MassSpecBase-664"><span class="linenos"> 664</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;mspeaks list is empty, continuing without filtering data&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-665"><a href="#MassSpecBase-665"><span class="linenos"> 665</span></a>
</span><span id="MassSpecBase-666"><a href="#MassSpecBase-666"><span class="linenos"> 666</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-667"><a href="#MassSpecBase-667"><span class="linenos"> 667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="MassSpecBase-668"><a href="#MassSpecBase-668"><span class="linenos"> 668</span></a>
</span><span id="MassSpecBase-669"><a href="#MassSpecBase-669"><span class="linenos"> 669</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase-670"><a href="#MassSpecBase-670"><span class="linenos"> 670</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase-671"><a href="#MassSpecBase-671"><span class="linenos"> 671</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase-672"><a href="#MassSpecBase-672"><span class="linenos"> 672</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="MassSpecBase-673"><a href="#MassSpecBase-673"><span class="linenos"> 673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-674"><a href="#MassSpecBase-674"><span class="linenos"> 674</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase-675"><a href="#MassSpecBase-675"><span class="linenos"> 675</span></a>            <span class="k">pass</span>
</span><span id="MassSpecBase-676"><a href="#MassSpecBase-676"><span class="linenos"> 676</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-677"><a href="#MassSpecBase-677"><span class="linenos"> 677</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase-678"><a href="#MassSpecBase-678"><span class="linenos"> 678</span></a>                <span class="s2">&quot;mspeaks list is empty, please run process_mass_spec() first&quot;</span>
</span><span id="MassSpecBase-679"><a href="#MassSpecBase-679"><span class="linenos"> 679</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-680"><a href="#MassSpecBase-680"><span class="linenos"> 680</span></a>
</span><span id="MassSpecBase-681"><a href="#MassSpecBase-681"><span class="linenos"> 681</span></a>    <span class="k">def</span> <span class="nf">remove_assignment_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexes</span><span class="p">):</span>
</span><span id="MassSpecBase-682"><a href="#MassSpecBase-682"><span class="linenos"> 682</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the molecular formula assignment of the MSpeaks objects at the specified indexes.</span>
</span><span id="MassSpecBase-683"><a href="#MassSpecBase-683"><span class="linenos"> 683</span></a>
</span><span id="MassSpecBase-684"><a href="#MassSpecBase-684"><span class="linenos"> 684</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-685"><a href="#MassSpecBase-685"><span class="linenos"> 685</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-686"><a href="#MassSpecBase-686"><span class="linenos"> 686</span></a><span class="sd">        indexes : list of int</span>
</span><span id="MassSpecBase-687"><a href="#MassSpecBase-687"><span class="linenos"> 687</span></a><span class="sd">            A list of indexes of the MSpeaks objects to remove the molecular formula assignment from.</span>
</span><span id="MassSpecBase-688"><a href="#MassSpecBase-688"><span class="linenos"> 688</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-689"><a href="#MassSpecBase-689"><span class="linenos"> 689</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span><span id="MassSpecBase-690"><a href="#MassSpecBase-690"><span class="linenos"> 690</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span>
</span><span id="MassSpecBase-691"><a href="#MassSpecBase-691"><span class="linenos"> 691</span></a>
</span><span id="MassSpecBase-692"><a href="#MassSpecBase-692"><span class="linenos"> 692</span></a>    <span class="k">def</span> <span class="nf">filter_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="MassSpecBase-693"><a href="#MassSpecBase-693"><span class="linenos"> 693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified indexes.</span>
</span><span id="MassSpecBase-694"><a href="#MassSpecBase-694"><span class="linenos"> 694</span></a>
</span><span id="MassSpecBase-695"><a href="#MassSpecBase-695"><span class="linenos"> 695</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-696"><a href="#MassSpecBase-696"><span class="linenos"> 696</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-697"><a href="#MassSpecBase-697"><span class="linenos"> 697</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="MassSpecBase-698"><a href="#MassSpecBase-698"><span class="linenos"> 698</span></a><span class="sd">            A list of indexes of the MSpeaks objects to drop.</span>
</span><span id="MassSpecBase-699"><a href="#MassSpecBase-699"><span class="linenos"> 699</span></a>
</span><span id="MassSpecBase-700"><a href="#MassSpecBase-700"><span class="linenos"> 700</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-701"><a href="#MassSpecBase-701"><span class="linenos"> 701</span></a>
</span><span id="MassSpecBase-702"><a href="#MassSpecBase-702"><span class="linenos"> 702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-703"><a href="#MassSpecBase-703"><span class="linenos"> 703</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_indexes</span>
</span><span id="MassSpecBase-704"><a href="#MassSpecBase-704"><span class="linenos"> 704</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase-705"><a href="#MassSpecBase-705"><span class="linenos"> 705</span></a>
</span><span id="MassSpecBase-706"><a href="#MassSpecBase-706"><span class="linenos"> 706</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase-707"><a href="#MassSpecBase-707"><span class="linenos"> 707</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase-708"><a href="#MassSpecBase-708"><span class="linenos"> 708</span></a>
</span><span id="MassSpecBase-709"><a href="#MassSpecBase-709"><span class="linenos"> 709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase-710"><a href="#MassSpecBase-710"><span class="linenos"> 710</span></a>
</span><span id="MassSpecBase-711"><a href="#MassSpecBase-711"><span class="linenos"> 711</span></a>    <span class="k">def</span> <span class="nf">filter_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_mz</span><span class="p">,</span> <span class="n">max_mz</span><span class="p">):</span>
</span><span id="MassSpecBase-712"><a href="#MassSpecBase-712"><span class="linenos"> 712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified m/z range.</span>
</span><span id="MassSpecBase-713"><a href="#MassSpecBase-713"><span class="linenos"> 713</span></a>
</span><span id="MassSpecBase-714"><a href="#MassSpecBase-714"><span class="linenos"> 714</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-715"><a href="#MassSpecBase-715"><span class="linenos"> 715</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-716"><a href="#MassSpecBase-716"><span class="linenos"> 716</span></a><span class="sd">        min_mz : float</span>
</span><span id="MassSpecBase-717"><a href="#MassSpecBase-717"><span class="linenos"> 717</span></a><span class="sd">            The minimum m/z value to keep.</span>
</span><span id="MassSpecBase-718"><a href="#MassSpecBase-718"><span class="linenos"> 718</span></a><span class="sd">        max_mz : float</span>
</span><span id="MassSpecBase-719"><a href="#MassSpecBase-719"><span class="linenos"> 719</span></a><span class="sd">            The maximum m/z value to keep.</span>
</span><span id="MassSpecBase-720"><a href="#MassSpecBase-720"><span class="linenos"> 720</span></a>
</span><span id="MassSpecBase-721"><a href="#MassSpecBase-721"><span class="linenos"> 721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-722"><a href="#MassSpecBase-722"><span class="linenos"> 722</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-723"><a href="#MassSpecBase-723"><span class="linenos"> 723</span></a>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-724"><a href="#MassSpecBase-724"><span class="linenos"> 724</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase-725"><a href="#MassSpecBase-725"><span class="linenos"> 725</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-726"><a href="#MassSpecBase-726"><span class="linenos"> 726</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">min_mz</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz</span>
</span><span id="MassSpecBase-727"><a href="#MassSpecBase-727"><span class="linenos"> 727</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase-728"><a href="#MassSpecBase-728"><span class="linenos"> 728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="MassSpecBase-729"><a href="#MassSpecBase-729"><span class="linenos"> 729</span></a>
</span><span id="MassSpecBase-730"><a href="#MassSpecBase-730"><span class="linenos"> 730</span></a>    <span class="k">def</span> <span class="nf">filter_by_s2n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_s2n</span><span class="p">,</span> <span class="n">max_s2n</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase-731"><a href="#MassSpecBase-731"><span class="linenos"> 731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified signal-to-noise ratio range.</span>
</span><span id="MassSpecBase-732"><a href="#MassSpecBase-732"><span class="linenos"> 732</span></a>
</span><span id="MassSpecBase-733"><a href="#MassSpecBase-733"><span class="linenos"> 733</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-734"><a href="#MassSpecBase-734"><span class="linenos"> 734</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-735"><a href="#MassSpecBase-735"><span class="linenos"> 735</span></a><span class="sd">        min_s2n : float</span>
</span><span id="MassSpecBase-736"><a href="#MassSpecBase-736"><span class="linenos"> 736</span></a><span class="sd">            The minimum signal-to-noise ratio to keep.</span>
</span><span id="MassSpecBase-737"><a href="#MassSpecBase-737"><span class="linenos"> 737</span></a><span class="sd">        max_s2n : float, optional</span>
</span><span id="MassSpecBase-738"><a href="#MassSpecBase-738"><span class="linenos"> 738</span></a><span class="sd">            The maximum signal-to-noise ratio to keep. Defaults to False (no maximum).</span>
</span><span id="MassSpecBase-739"><a href="#MassSpecBase-739"><span class="linenos"> 739</span></a>
</span><span id="MassSpecBase-740"><a href="#MassSpecBase-740"><span class="linenos"> 740</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-741"><a href="#MassSpecBase-741"><span class="linenos"> 741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-742"><a href="#MassSpecBase-742"><span class="linenos"> 742</span></a>        <span class="k">if</span> <span class="n">max_s2n</span><span class="p">:</span>
</span><span id="MassSpecBase-743"><a href="#MassSpecBase-743"><span class="linenos"> 743</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-744"><a href="#MassSpecBase-744"><span class="linenos"> 744</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase-745"><a href="#MassSpecBase-745"><span class="linenos"> 745</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-746"><a href="#MassSpecBase-746"><span class="linenos"> 746</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_s2n</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">max_s2n</span>
</span><span id="MassSpecBase-747"><a href="#MassSpecBase-747"><span class="linenos"> 747</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase-748"><a href="#MassSpecBase-748"><span class="linenos"> 748</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-749"><a href="#MassSpecBase-749"><span class="linenos"> 749</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-750"><a href="#MassSpecBase-750"><span class="linenos"> 750</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase-751"><a href="#MassSpecBase-751"><span class="linenos"> 751</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-752"><a href="#MassSpecBase-752"><span class="linenos"> 752</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">min_s2n</span>
</span><span id="MassSpecBase-753"><a href="#MassSpecBase-753"><span class="linenos"> 753</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase-754"><a href="#MassSpecBase-754"><span class="linenos"> 754</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="MassSpecBase-755"><a href="#MassSpecBase-755"><span class="linenos"> 755</span></a>
</span><span id="MassSpecBase-756"><a href="#MassSpecBase-756"><span class="linenos"> 756</span></a>    <span class="k">def</span> <span class="nf">filter_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_abund</span><span class="p">,</span> <span class="n">max_abund</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase-757"><a href="#MassSpecBase-757"><span class="linenos"> 757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified abundance range.</span>
</span><span id="MassSpecBase-758"><a href="#MassSpecBase-758"><span class="linenos"> 758</span></a>
</span><span id="MassSpecBase-759"><a href="#MassSpecBase-759"><span class="linenos"> 759</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-760"><a href="#MassSpecBase-760"><span class="linenos"> 760</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-761"><a href="#MassSpecBase-761"><span class="linenos"> 761</span></a><span class="sd">        min_abund : float</span>
</span><span id="MassSpecBase-762"><a href="#MassSpecBase-762"><span class="linenos"> 762</span></a><span class="sd">            The minimum abundance to keep.</span>
</span><span id="MassSpecBase-763"><a href="#MassSpecBase-763"><span class="linenos"> 763</span></a><span class="sd">        max_abund : float, optional</span>
</span><span id="MassSpecBase-764"><a href="#MassSpecBase-764"><span class="linenos"> 764</span></a><span class="sd">            The maximum abundance to keep. Defaults to False (no maximum).</span>
</span><span id="MassSpecBase-765"><a href="#MassSpecBase-765"><span class="linenos"> 765</span></a>
</span><span id="MassSpecBase-766"><a href="#MassSpecBase-766"><span class="linenos"> 766</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-767"><a href="#MassSpecBase-767"><span class="linenos"> 767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-768"><a href="#MassSpecBase-768"><span class="linenos"> 768</span></a>        <span class="k">if</span> <span class="n">max_abund</span><span class="p">:</span>
</span><span id="MassSpecBase-769"><a href="#MassSpecBase-769"><span class="linenos"> 769</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-770"><a href="#MassSpecBase-770"><span class="linenos"> 770</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase-771"><a href="#MassSpecBase-771"><span class="linenos"> 771</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-772"><a href="#MassSpecBase-772"><span class="linenos"> 772</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_abund</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">max_abund</span>
</span><span id="MassSpecBase-773"><a href="#MassSpecBase-773"><span class="linenos"> 773</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase-774"><a href="#MassSpecBase-774"><span class="linenos"> 774</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-775"><a href="#MassSpecBase-775"><span class="linenos"> 775</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-776"><a href="#MassSpecBase-776"><span class="linenos"> 776</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase-777"><a href="#MassSpecBase-777"><span class="linenos"> 777</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-778"><a href="#MassSpecBase-778"><span class="linenos"> 778</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">min_abund</span>
</span><span id="MassSpecBase-779"><a href="#MassSpecBase-779"><span class="linenos"> 779</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase-780"><a href="#MassSpecBase-780"><span class="linenos"> 780</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span><span id="MassSpecBase-781"><a href="#MassSpecBase-781"><span class="linenos"> 781</span></a>
</span><span id="MassSpecBase-782"><a href="#MassSpecBase-782"><span class="linenos"> 782</span></a>    <span class="k">def</span> <span class="nf">filter_by_max_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="MassSpecBase-783"><a href="#MassSpecBase-783"><span class="linenos"> 783</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified maximum resolving power.</span>
</span><span id="MassSpecBase-784"><a href="#MassSpecBase-784"><span class="linenos"> 784</span></a>
</span><span id="MassSpecBase-785"><a href="#MassSpecBase-785"><span class="linenos"> 785</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-786"><a href="#MassSpecBase-786"><span class="linenos"> 786</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-787"><a href="#MassSpecBase-787"><span class="linenos"> 787</span></a><span class="sd">        B : float</span>
</span><span id="MassSpecBase-788"><a href="#MassSpecBase-788"><span class="linenos"> 788</span></a><span class="sd">        T : float</span>
</span><span id="MassSpecBase-789"><a href="#MassSpecBase-789"><span class="linenos"> 789</span></a>
</span><span id="MassSpecBase-790"><a href="#MassSpecBase-790"><span class="linenos"> 790</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-791"><a href="#MassSpecBase-791"><span class="linenos"> 791</span></a>
</span><span id="MassSpecBase-792"><a href="#MassSpecBase-792"><span class="linenos"> 792</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="MassSpecBase-793"><a href="#MassSpecBase-793"><span class="linenos"> 793</span></a>
</span><span id="MassSpecBase-794"><a href="#MassSpecBase-794"><span class="linenos"> 794</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-795"><a href="#MassSpecBase-795"><span class="linenos"> 795</span></a>
</span><span id="MassSpecBase-796"><a href="#MassSpecBase-796"><span class="linenos"> 796</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-797"><a href="#MassSpecBase-797"><span class="linenos"> 797</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase-798"><a href="#MassSpecBase-798"><span class="linenos"> 798</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-799"><a href="#MassSpecBase-799"><span class="linenos"> 799</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&gt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="MassSpecBase-800"><a href="#MassSpecBase-800"><span class="linenos"> 800</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase-801"><a href="#MassSpecBase-801"><span class="linenos"> 801</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="MassSpecBase-802"><a href="#MassSpecBase-802"><span class="linenos"> 802</span></a>
</span><span id="MassSpecBase-803"><a href="#MassSpecBase-803"><span class="linenos"> 803</span></a>    <span class="k">def</span> <span class="nf">filter_by_mean_resolving_power</span><span class="p">(</span>
</span><span id="MassSpecBase-804"><a href="#MassSpecBase-804"><span class="linenos"> 804</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">guess_pars</span><span class="o">=</span><span class="kc">False</span>
</span><span id="MassSpecBase-805"><a href="#MassSpecBase-805"><span class="linenos"> 805</span></a>    <span class="p">):</span>
</span><span id="MassSpecBase-806"><a href="#MassSpecBase-806"><span class="linenos"> 806</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified mean resolving power.</span>
</span><span id="MassSpecBase-807"><a href="#MassSpecBase-807"><span class="linenos"> 807</span></a>
</span><span id="MassSpecBase-808"><a href="#MassSpecBase-808"><span class="linenos"> 808</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-809"><a href="#MassSpecBase-809"><span class="linenos"> 809</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-810"><a href="#MassSpecBase-810"><span class="linenos"> 810</span></a><span class="sd">        ndeviations : float, optional</span>
</span><span id="MassSpecBase-811"><a href="#MassSpecBase-811"><span class="linenos"> 811</span></a><span class="sd">            The number of standard deviations to use for filtering. Defaults to 3.</span>
</span><span id="MassSpecBase-812"><a href="#MassSpecBase-812"><span class="linenos"> 812</span></a><span class="sd">        plot : bool, optional</span>
</span><span id="MassSpecBase-813"><a href="#MassSpecBase-813"><span class="linenos"> 813</span></a><span class="sd">            Whether to plot the resolving power distribution. Defaults to False.</span>
</span><span id="MassSpecBase-814"><a href="#MassSpecBase-814"><span class="linenos"> 814</span></a><span class="sd">        guess_pars : bool, optional</span>
</span><span id="MassSpecBase-815"><a href="#MassSpecBase-815"><span class="linenos"> 815</span></a><span class="sd">            Whether to guess the parameters for the Gaussian model. Defaults to False.</span>
</span><span id="MassSpecBase-816"><a href="#MassSpecBase-816"><span class="linenos"> 816</span></a>
</span><span id="MassSpecBase-817"><a href="#MassSpecBase-817"><span class="linenos"> 817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-818"><a href="#MassSpecBase-818"><span class="linenos"> 818</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-819"><a href="#MassSpecBase-819"><span class="linenos"> 819</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="n">MeanResolvingPowerFilter</span><span class="p">(</span>
</span><span id="MassSpecBase-820"><a href="#MassSpecBase-820"><span class="linenos"> 820</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">guess_pars</span>
</span><span id="MassSpecBase-821"><a href="#MassSpecBase-821"><span class="linenos"> 821</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span><span id="MassSpecBase-822"><a href="#MassSpecBase-822"><span class="linenos"> 822</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="MassSpecBase-823"><a href="#MassSpecBase-823"><span class="linenos"> 823</span></a>
</span><span id="MassSpecBase-824"><a href="#MassSpecBase-824"><span class="linenos"> 824</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="MassSpecBase-825"><a href="#MassSpecBase-825"><span class="linenos"> 825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified minimum resolving power.</span>
</span><span id="MassSpecBase-826"><a href="#MassSpecBase-826"><span class="linenos"> 826</span></a>
</span><span id="MassSpecBase-827"><a href="#MassSpecBase-827"><span class="linenos"> 827</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-828"><a href="#MassSpecBase-828"><span class="linenos"> 828</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-829"><a href="#MassSpecBase-829"><span class="linenos"> 829</span></a><span class="sd">        B : float</span>
</span><span id="MassSpecBase-830"><a href="#MassSpecBase-830"><span class="linenos"> 830</span></a><span class="sd">        T : float</span>
</span><span id="MassSpecBase-831"><a href="#MassSpecBase-831"><span class="linenos"> 831</span></a>
</span><span id="MassSpecBase-832"><a href="#MassSpecBase-832"><span class="linenos"> 832</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-833"><a href="#MassSpecBase-833"><span class="linenos"> 833</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="MassSpecBase-834"><a href="#MassSpecBase-834"><span class="linenos"> 834</span></a>
</span><span id="MassSpecBase-835"><a href="#MassSpecBase-835"><span class="linenos"> 835</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-836"><a href="#MassSpecBase-836"><span class="linenos"> 836</span></a>
</span><span id="MassSpecBase-837"><a href="#MassSpecBase-837"><span class="linenos"> 837</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-838"><a href="#MassSpecBase-838"><span class="linenos"> 838</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase-839"><a href="#MassSpecBase-839"><span class="linenos"> 839</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-840"><a href="#MassSpecBase-840"><span class="linenos"> 840</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&lt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="MassSpecBase-841"><a href="#MassSpecBase-841"><span class="linenos"> 841</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase-842"><a href="#MassSpecBase-842"><span class="linenos"> 842</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="MassSpecBase-843"><a href="#MassSpecBase-843"><span class="linenos"> 843</span></a>
</span><span id="MassSpecBase-844"><a href="#MassSpecBase-844"><span class="linenos"> 844</span></a>    <span class="k">def</span> <span class="nf">filter_by_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-845"><a href="#MassSpecBase-845"><span class="linenos"> 845</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the noise threshold.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-846"><a href="#MassSpecBase-846"><span class="linenos"> 846</span></a>
</span><span id="MassSpecBase-847"><a href="#MassSpecBase-847"><span class="linenos"> 847</span></a>        <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MassSpecBase-848"><a href="#MassSpecBase-848"><span class="linenos"> 848</span></a>
</span><span id="MassSpecBase-849"><a href="#MassSpecBase-849"><span class="linenos"> 849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase-850"><a href="#MassSpecBase-850"><span class="linenos"> 850</span></a>
</span><span id="MassSpecBase-851"><a href="#MassSpecBase-851"><span class="linenos"> 851</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase-852"><a href="#MassSpecBase-852"><span class="linenos"> 852</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase-853"><a href="#MassSpecBase-853"><span class="linenos"> 853</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-854"><a href="#MassSpecBase-854"><span class="linenos"> 854</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">threshold</span>
</span><span id="MassSpecBase-855"><a href="#MassSpecBase-855"><span class="linenos"> 855</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase-856"><a href="#MassSpecBase-856"><span class="linenos"> 856</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span><span id="MassSpecBase-857"><a href="#MassSpecBase-857"><span class="linenos"> 857</span></a>
</span><span id="MassSpecBase-858"><a href="#MassSpecBase-858"><span class="linenos"> 858</span></a>    <span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-859"><a href="#MassSpecBase-859"><span class="linenos"> 859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the peaks of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-860"><a href="#MassSpecBase-860"><span class="linenos"> 860</span></a>        <span class="c1"># needs to clear previous results from peak_picking</span>
</span><span id="MassSpecBase-861"><a href="#MassSpecBase-861"><span class="linenos"> 861</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase-862"><a href="#MassSpecBase-862"><span class="linenos"> 862</span></a>
</span><span id="MassSpecBase-863"><a href="#MassSpecBase-863"><span class="linenos"> 863</span></a>        <span class="c1"># then do peak picking</span>
</span><span id="MassSpecBase-864"><a href="#MassSpecBase-864"><span class="linenos"> 864</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_peak_picking</span><span class="p">()</span>
</span><span id="MassSpecBase-865"><a href="#MassSpecBase-865"><span class="linenos"> 865</span></a>        <span class="c1"># print(&quot;A total of %i peaks were found&quot; % len(self._mspeaks))</span>
</span><span id="MassSpecBase-866"><a href="#MassSpecBase-866"><span class="linenos"> 866</span></a>
</span><span id="MassSpecBase-867"><a href="#MassSpecBase-867"><span class="linenos"> 867</span></a>    <span class="k">def</span> <span class="nf">change_kendrick_base_all_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kendrick_dict_base</span><span class="p">):</span>
</span><span id="MassSpecBase-868"><a href="#MassSpecBase-868"><span class="linenos"> 868</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Change the Kendrick base of all MSpeaks objects.</span>
</span><span id="MassSpecBase-869"><a href="#MassSpecBase-869"><span class="linenos"> 869</span></a>
</span><span id="MassSpecBase-870"><a href="#MassSpecBase-870"><span class="linenos"> 870</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-871"><a href="#MassSpecBase-871"><span class="linenos"> 871</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-872"><a href="#MassSpecBase-872"><span class="linenos"> 872</span></a><span class="sd">        kendrick_dict_base : dict</span>
</span><span id="MassSpecBase-873"><a href="#MassSpecBase-873"><span class="linenos"> 873</span></a><span class="sd">            A dictionary of the Kendrick base to change to.</span>
</span><span id="MassSpecBase-874"><a href="#MassSpecBase-874"><span class="linenos"> 874</span></a>
</span><span id="MassSpecBase-875"><a href="#MassSpecBase-875"><span class="linenos"> 875</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecBase-876"><a href="#MassSpecBase-876"><span class="linenos"> 876</span></a><span class="sd">        -----</span>
</span><span id="MassSpecBase-877"><a href="#MassSpecBase-877"><span class="linenos"> 877</span></a><span class="sd">        Example of kendrick_dict_base parameter: kendrick_dict_base = {&quot;C&quot;: 1, &quot;H&quot;: 2} or {&quot;C&quot;: 1, &quot;H&quot;: 1, &quot;O&quot;:1} etc</span>
</span><span id="MassSpecBase-878"><a href="#MassSpecBase-878"><span class="linenos"> 878</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-879"><a href="#MassSpecBase-879"><span class="linenos"> 879</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span><span class="o">.</span><span class="n">kendrick_base</span> <span class="o">=</span> <span class="n">kendrick_dict_base</span>
</span><span id="MassSpecBase-880"><a href="#MassSpecBase-880"><span class="linenos"> 880</span></a>
</span><span id="MassSpecBase-881"><a href="#MassSpecBase-881"><span class="linenos"> 881</span></a>        <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase-882"><a href="#MassSpecBase-882"><span class="linenos"> 882</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">change_kendrick_base</span><span class="p">(</span><span class="n">kendrick_dict_base</span><span class="p">)</span>
</span><span id="MassSpecBase-883"><a href="#MassSpecBase-883"><span class="linenos"> 883</span></a>
</span><span id="MassSpecBase-884"><a href="#MassSpecBase-884"><span class="linenos"> 884</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mz_first_last_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">):</span>
</span><span id="MassSpecBase-885"><a href="#MassSpecBase-885"><span class="linenos"> 885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase-886"><a href="#MassSpecBase-886"><span class="linenos"> 886</span></a>
</span><span id="MassSpecBase-887"><a href="#MassSpecBase-887"><span class="linenos"> 887</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-888"><a href="#MassSpecBase-888"><span class="linenos"> 888</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-889"><a href="#MassSpecBase-889"><span class="linenos"> 889</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="MassSpecBase-890"><a href="#MassSpecBase-890"><span class="linenos"> 890</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="MassSpecBase-891"><a href="#MassSpecBase-891"><span class="linenos"> 891</span></a>
</span><span id="MassSpecBase-892"><a href="#MassSpecBase-892"><span class="linenos"> 892</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-893"><a href="#MassSpecBase-893"><span class="linenos"> 893</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-894"><a href="#MassSpecBase-894"><span class="linenos"> 894</span></a><span class="sd">        tuple</span>
</span><span id="MassSpecBase-895"><a href="#MassSpecBase-895"><span class="linenos"> 895</span></a><span class="sd">            A tuple containing the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase-896"><a href="#MassSpecBase-896"><span class="linenos"> 896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-897"><a href="#MassSpecBase-897"><span class="linenos"> 897</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="p">:</span>
</span><span id="MassSpecBase-898"><a href="#MassSpecBase-898"><span class="linenos"> 898</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="MassSpecBase-899"><a href="#MassSpecBase-899"><span class="linenos"> 899</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="MassSpecBase-900"><a href="#MassSpecBase-900"><span class="linenos"> 900</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="MassSpecBase-901"><a href="#MassSpecBase-901"><span class="linenos"> 901</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="MassSpecBase-902"><a href="#MassSpecBase-902"><span class="linenos"> 902</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase-903"><a href="#MassSpecBase-903"><span class="linenos"> 903</span></a>
</span><span id="MassSpecBase-904"><a href="#MassSpecBase-904"><span class="linenos"> 904</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-905"><a href="#MassSpecBase-905"><span class="linenos"> 905</span></a>                <span class="c1"># import warnings</span>
</span><span id="MassSpecBase-906"><a href="#MassSpecBase-906"><span class="linenos"> 906</span></a>                <span class="c1"># uncomment warn to distribution</span>
</span><span id="MassSpecBase-907"><a href="#MassSpecBase-907"><span class="linenos"> 907</span></a>                <span class="c1"># warnings.warn(&quot;Nominal mass not found in _dict_nominal_masses_indexes, returning (0, 0) for nominal mass %i&quot;%nominal_mass)</span>
</span><span id="MassSpecBase-908"><a href="#MassSpecBase-908"><span class="linenos"> 908</span></a>                <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecBase-909"><a href="#MassSpecBase-909"><span class="linenos"> 909</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-910"><a href="#MassSpecBase-910"><span class="linenos"> 910</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase-911"><a href="#MassSpecBase-911"><span class="linenos"> 911</span></a>                <span class="s2">&quot;run process_mass_spec() function before trying to access the data&quot;</span>
</span><span id="MassSpecBase-912"><a href="#MassSpecBase-912"><span class="linenos"> 912</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-913"><a href="#MassSpecBase-913"><span class="linenos"> 913</span></a>
</span><span id="MassSpecBase-914"><a href="#MassSpecBase-914"><span class="linenos"> 914</span></a>    <span class="k">def</span> <span class="nf">get_masses_count_by_nominal_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-915"><a href="#MassSpecBase-915"><span class="linenos"> 915</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-916"><a href="#MassSpecBase-916"><span class="linenos"> 916</span></a>
</span><span id="MassSpecBase-917"><a href="#MassSpecBase-917"><span class="linenos"> 917</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MassSpecBase-918"><a href="#MassSpecBase-918"><span class="linenos"> 918</span></a>
</span><span id="MassSpecBase-919"><a href="#MassSpecBase-919"><span class="linenos"> 919</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="MassSpecBase-920"><a href="#MassSpecBase-920"><span class="linenos"> 920</span></a>
</span><span id="MassSpecBase-921"><a href="#MassSpecBase-921"><span class="linenos"> 921</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="MassSpecBase-922"><a href="#MassSpecBase-922"><span class="linenos"> 922</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="MassSpecBase-923"><a href="#MassSpecBase-923"><span class="linenos"> 923</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecBase-924"><a href="#MassSpecBase-924"><span class="linenos"> 924</span></a>                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_mass_indexes</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">))</span>
</span><span id="MassSpecBase-925"><a href="#MassSpecBase-925"><span class="linenos"> 925</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase-926"><a href="#MassSpecBase-926"><span class="linenos"> 926</span></a>
</span><span id="MassSpecBase-927"><a href="#MassSpecBase-927"><span class="linenos"> 927</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span><span id="MassSpecBase-928"><a href="#MassSpecBase-928"><span class="linenos"> 928</span></a>
</span><span id="MassSpecBase-929"><a href="#MassSpecBase-929"><span class="linenos"> 929</span></a>    <span class="k">def</span> <span class="nf">datapoints_count_by_nominal_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="MassSpecBase-930"><a href="#MassSpecBase-930"><span class="linenos"> 930</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.</span>
</span><span id="MassSpecBase-931"><a href="#MassSpecBase-931"><span class="linenos"> 931</span></a>
</span><span id="MassSpecBase-932"><a href="#MassSpecBase-932"><span class="linenos"> 932</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-933"><a href="#MassSpecBase-933"><span class="linenos"> 933</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-934"><a href="#MassSpecBase-934"><span class="linenos"> 934</span></a><span class="sd">        mz_overlay : float, optional</span>
</span><span id="MassSpecBase-935"><a href="#MassSpecBase-935"><span class="linenos"> 935</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="MassSpecBase-936"><a href="#MassSpecBase-936"><span class="linenos"> 936</span></a>
</span><span id="MassSpecBase-937"><a href="#MassSpecBase-937"><span class="linenos"> 937</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-938"><a href="#MassSpecBase-938"><span class="linenos"> 938</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-939"><a href="#MassSpecBase-939"><span class="linenos"> 939</span></a><span class="sd">        dict</span>
</span><span id="MassSpecBase-940"><a href="#MassSpecBase-940"><span class="linenos"> 940</span></a><span class="sd">            A dictionary of the nominal masses and their counts.</span>
</span><span id="MassSpecBase-941"><a href="#MassSpecBase-941"><span class="linenos"> 941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-942"><a href="#MassSpecBase-942"><span class="linenos"> 942</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MassSpecBase-943"><a href="#MassSpecBase-943"><span class="linenos"> 943</span></a>
</span><span id="MassSpecBase-944"><a href="#MassSpecBase-944"><span class="linenos"> 944</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="MassSpecBase-945"><a href="#MassSpecBase-945"><span class="linenos"> 945</span></a>
</span><span id="MassSpecBase-946"><a href="#MassSpecBase-946"><span class="linenos"> 946</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="MassSpecBase-947"><a href="#MassSpecBase-947"><span class="linenos"> 947</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="MassSpecBase-948"><a href="#MassSpecBase-948"><span class="linenos"> 948</span></a>                <span class="n">min_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">mz_overlay</span>
</span><span id="MassSpecBase-949"><a href="#MassSpecBase-949"><span class="linenos"> 949</span></a>
</span><span id="MassSpecBase-950"><a href="#MassSpecBase-950"><span class="linenos"> 950</span></a>                <span class="n">max_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">mz_overlay</span>
</span><span id="MassSpecBase-951"><a href="#MassSpecBase-951"><span class="linenos"> 951</span></a>
</span><span id="MassSpecBase-952"><a href="#MassSpecBase-952"><span class="linenos"> 952</span></a>                <span class="n">indexes</span> <span class="o">=</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span>
</span><span id="MassSpecBase-953"><a href="#MassSpecBase-953"><span class="linenos"> 953</span></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&gt;</span> <span class="n">min_mz</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&lt;</span> <span class="n">max_mz</span><span class="p">)</span>
</span><span id="MassSpecBase-954"><a href="#MassSpecBase-954"><span class="linenos"> 954</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase-955"><a href="#MassSpecBase-955"><span class="linenos"> 955</span></a>
</span><span id="MassSpecBase-956"><a href="#MassSpecBase-956"><span class="linenos"> 956</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</span><span id="MassSpecBase-957"><a href="#MassSpecBase-957"><span class="linenos"> 957</span></a>
</span><span id="MassSpecBase-958"><a href="#MassSpecBase-958"><span class="linenos"> 958</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span><span id="MassSpecBase-959"><a href="#MassSpecBase-959"><span class="linenos"> 959</span></a>
</span><span id="MassSpecBase-960"><a href="#MassSpecBase-960"><span class="linenos"> 960</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mass_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="MassSpecBase-961"><a href="#MassSpecBase-961"><span class="linenos"> 961</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase-962"><a href="#MassSpecBase-962"><span class="linenos"> 962</span></a>
</span><span id="MassSpecBase-963"><a href="#MassSpecBase-963"><span class="linenos"> 963</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-964"><a href="#MassSpecBase-964"><span class="linenos"> 964</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-965"><a href="#MassSpecBase-965"><span class="linenos"> 965</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="MassSpecBase-966"><a href="#MassSpecBase-966"><span class="linenos"> 966</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="MassSpecBase-967"><a href="#MassSpecBase-967"><span class="linenos"> 967</span></a><span class="sd">        overlay : float, optional</span>
</span><span id="MassSpecBase-968"><a href="#MassSpecBase-968"><span class="linenos"> 968</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="MassSpecBase-969"><a href="#MassSpecBase-969"><span class="linenos"> 969</span></a>
</span><span id="MassSpecBase-970"><a href="#MassSpecBase-970"><span class="linenos"> 970</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-971"><a href="#MassSpecBase-971"><span class="linenos"> 971</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-972"><a href="#MassSpecBase-972"><span class="linenos"> 972</span></a><span class="sd">        generator</span>
</span><span id="MassSpecBase-973"><a href="#MassSpecBase-973"><span class="linenos"> 973</span></a><span class="sd">            A generator of the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase-974"><a href="#MassSpecBase-974"><span class="linenos"> 974</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-975"><a href="#MassSpecBase-975"><span class="linenos"> 975</span></a>        <span class="n">min_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">overlay</span>
</span><span id="MassSpecBase-976"><a href="#MassSpecBase-976"><span class="linenos"> 976</span></a>        <span class="n">max_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">overlay</span>
</span><span id="MassSpecBase-977"><a href="#MassSpecBase-977"><span class="linenos"> 977</span></a>
</span><span id="MassSpecBase-978"><a href="#MassSpecBase-978"><span class="linenos"> 978</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="MassSpecBase-979"><a href="#MassSpecBase-979"><span class="linenos"> 979</span></a>            <span class="n">i</span>
</span><span id="MassSpecBase-980"><a href="#MassSpecBase-980"><span class="linenos"> 980</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span>
</span><span id="MassSpecBase-981"><a href="#MassSpecBase-981"><span class="linenos"> 981</span></a>            <span class="k">if</span> <span class="n">min_mz_to_look</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz_to_look</span>
</span><span id="MassSpecBase-982"><a href="#MassSpecBase-982"><span class="linenos"> 982</span></a>        <span class="p">)</span>
</span><span id="MassSpecBase-983"><a href="#MassSpecBase-983"><span class="linenos"> 983</span></a>
</span><span id="MassSpecBase-984"><a href="#MassSpecBase-984"><span class="linenos"> 984</span></a>        <span class="c1"># indexes = (i for i in range(len(self.mspeaks)) if min_mz_to_look &lt;= self.mspeaks[i].mz_exp &lt;= max_mz_to_look)</span>
</span><span id="MassSpecBase-985"><a href="#MassSpecBase-985"><span class="linenos"> 985</span></a>        <span class="c1"># return indexes</span>
</span><span id="MassSpecBase-986"><a href="#MassSpecBase-986"><span class="linenos"> 986</span></a>
</span><span id="MassSpecBase-987"><a href="#MassSpecBase-987"><span class="linenos"> 987</span></a>    <span class="k">def</span> <span class="nf">_set_nominal_masses_start_final_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-988"><a href="#MassSpecBase-988"><span class="linenos"> 988</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the start and final indexes of the MSpeaks objects for all nominal masses.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-989"><a href="#MassSpecBase-989"><span class="linenos"> 989</span></a>        <span class="n">dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MassSpecBase-990"><a href="#MassSpecBase-990"><span class="linenos"> 990</span></a>
</span><span id="MassSpecBase-991"><a href="#MassSpecBase-991"><span class="linenos"> 991</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase-992"><a href="#MassSpecBase-992"><span class="linenos"> 992</span></a>
</span><span id="MassSpecBase-993"><a href="#MassSpecBase-993"><span class="linenos"> 993</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="MassSpecBase-994"><a href="#MassSpecBase-994"><span class="linenos"> 994</span></a>            <span class="c1"># indexes = self.get_nominal_mass_indexes(nominal_mass)</span>
</span><span id="MassSpecBase-995"><a href="#MassSpecBase-995"><span class="linenos"> 995</span></a>            <span class="c1"># Convert the iterator to a list to avoid multiple calls</span>
</span><span id="MassSpecBase-996"><a href="#MassSpecBase-996"><span class="linenos"> 996</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_mass_indexes</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">))</span>
</span><span id="MassSpecBase-997"><a href="#MassSpecBase-997"><span class="linenos"> 997</span></a>
</span><span id="MassSpecBase-998"><a href="#MassSpecBase-998"><span class="linenos"> 998</span></a>            <span class="c1"># If the list is not empty, find the first and last; otherwise, set None</span>
</span><span id="MassSpecBase-999"><a href="#MassSpecBase-999"><span class="linenos"> 999</span></a>            <span class="k">if</span> <span class="n">indexes</span><span class="p">:</span>
</span><span id="MassSpecBase-1000"><a href="#MassSpecBase-1000"><span class="linenos">1000</span></a>                <span class="n">first</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MassSpecBase-1001"><a href="#MassSpecBase-1001"><span class="linenos">1001</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-1002"><a href="#MassSpecBase-1002"><span class="linenos">1002</span></a>                <span class="n">first</span> <span class="o">=</span> <span class="n">last</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase-1003"><a href="#MassSpecBase-1003"><span class="linenos">1003</span></a>            <span class="c1"># defaultvalue = None</span>
</span><span id="MassSpecBase-1004"><a href="#MassSpecBase-1004"><span class="linenos">1004</span></a>            <span class="c1"># first = last = next(indexes, defaultvalue)</span>
</span><span id="MassSpecBase-1005"><a href="#MassSpecBase-1005"><span class="linenos">1005</span></a>            <span class="c1"># for last in indexes:</span>
</span><span id="MassSpecBase-1006"><a href="#MassSpecBase-1006"><span class="linenos">1006</span></a>            <span class="c1">#    pass</span>
</span><span id="MassSpecBase-1007"><a href="#MassSpecBase-1007"><span class="linenos">1007</span></a>
</span><span id="MassSpecBase-1008"><a href="#MassSpecBase-1008"><span class="linenos">1008</span></a>            <span class="n">dict_nominal_masses_indexes</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">last</span><span class="p">)</span>
</span><span id="MassSpecBase-1009"><a href="#MassSpecBase-1009"><span class="linenos">1009</span></a>
</span><span id="MassSpecBase-1010"><a href="#MassSpecBase-1010"><span class="linenos">1010</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="n">dict_nominal_masses_indexes</span>
</span><span id="MassSpecBase-1011"><a href="#MassSpecBase-1011"><span class="linenos">1011</span></a>
</span><span id="MassSpecBase-1012"><a href="#MassSpecBase-1012"><span class="linenos">1012</span></a>    <span class="k">def</span> <span class="nf">plot_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">):</span>
</span><span id="MassSpecBase-1013"><a href="#MassSpecBase-1013"><span class="linenos">1013</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the centroid data of the mass spectrum.</span>
</span><span id="MassSpecBase-1014"><a href="#MassSpecBase-1014"><span class="linenos">1014</span></a>
</span><span id="MassSpecBase-1015"><a href="#MassSpecBase-1015"><span class="linenos">1015</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1016"><a href="#MassSpecBase-1016"><span class="linenos">1016</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1017"><a href="#MassSpecBase-1017"><span class="linenos">1017</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase-1018"><a href="#MassSpecBase-1018"><span class="linenos">1018</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase-1019"><a href="#MassSpecBase-1019"><span class="linenos">1019</span></a><span class="sd">        c : str, optional</span>
</span><span id="MassSpecBase-1020"><a href="#MassSpecBase-1020"><span class="linenos">1020</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;g&#39; (green).</span>
</span><span id="MassSpecBase-1021"><a href="#MassSpecBase-1021"><span class="linenos">1021</span></a>
</span><span id="MassSpecBase-1022"><a href="#MassSpecBase-1022"><span class="linenos">1022</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1023"><a href="#MassSpecBase-1023"><span class="linenos">1023</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1024"><a href="#MassSpecBase-1024"><span class="linenos">1024</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase-1025"><a href="#MassSpecBase-1025"><span class="linenos">1025</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase-1026"><a href="#MassSpecBase-1026"><span class="linenos">1026</span></a>
</span><span id="MassSpecBase-1027"><a href="#MassSpecBase-1027"><span class="linenos">1027</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase-1028"><a href="#MassSpecBase-1028"><span class="linenos">1028</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase-1029"><a href="#MassSpecBase-1029"><span class="linenos">1029</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase-1030"><a href="#MassSpecBase-1030"><span class="linenos">1030</span></a><span class="sd">            If no centroid data is found.</span>
</span><span id="MassSpecBase-1031"><a href="#MassSpecBase-1031"><span class="linenos">1031</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1032"><a href="#MassSpecBase-1032"><span class="linenos">1032</span></a>
</span><span id="MassSpecBase-1033"><a href="#MassSpecBase-1033"><span class="linenos">1033</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase-1034"><a href="#MassSpecBase-1034"><span class="linenos">1034</span></a>
</span><span id="MassSpecBase-1035"><a href="#MassSpecBase-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase-1036"><a href="#MassSpecBase-1036"><span class="linenos">1036</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase-1037"><a href="#MassSpecBase-1037"><span class="linenos">1037</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase-1038"><a href="#MassSpecBase-1038"><span class="linenos">1038</span></a>
</span><span id="MassSpecBase-1039"><a href="#MassSpecBase-1039"><span class="linenos">1039</span></a>            <span class="n">markerline_a</span><span class="p">,</span> <span class="n">stemlines_a</span><span class="p">,</span> <span class="n">baseline_a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
</span><span id="MassSpecBase-1040"><a href="#MassSpecBase-1040"><span class="linenos">1040</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
</span><span id="MassSpecBase-1041"><a href="#MassSpecBase-1041"><span class="linenos">1041</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-1042"><a href="#MassSpecBase-1042"><span class="linenos">1042</span></a>
</span><span id="MassSpecBase-1043"><a href="#MassSpecBase-1043"><span class="linenos">1043</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase-1044"><a href="#MassSpecBase-1044"><span class="linenos">1044</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase-1045"><a href="#MassSpecBase-1045"><span class="linenos">1045</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase-1046"><a href="#MassSpecBase-1046"><span class="linenos">1046</span></a>
</span><span id="MassSpecBase-1047"><a href="#MassSpecBase-1047"><span class="linenos">1047</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1048"><a href="#MassSpecBase-1048"><span class="linenos">1048</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1049"><a href="#MassSpecBase-1049"><span class="linenos">1049</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1050"><a href="#MassSpecBase-1050"><span class="linenos">1050</span></a>
</span><span id="MassSpecBase-1051"><a href="#MassSpecBase-1051"><span class="linenos">1051</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1052"><a href="#MassSpecBase-1052"><span class="linenos">1052</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1053"><a href="#MassSpecBase-1053"><span class="linenos">1053</span></a>
</span><span id="MassSpecBase-1054"><a href="#MassSpecBase-1054"><span class="linenos">1054</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1055"><a href="#MassSpecBase-1055"><span class="linenos">1055</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1056"><a href="#MassSpecBase-1056"><span class="linenos">1056</span></a>
</span><span id="MassSpecBase-1057"><a href="#MassSpecBase-1057"><span class="linenos">1057</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-1058"><a href="#MassSpecBase-1058"><span class="linenos">1058</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No centroid data found, please run process_mass_spec&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-1059"><a href="#MassSpecBase-1059"><span class="linenos">1059</span></a>
</span><span id="MassSpecBase-1060"><a href="#MassSpecBase-1060"><span class="linenos">1060</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="MassSpecBase-1061"><a href="#MassSpecBase-1061"><span class="linenos">1061</span></a>
</span><span id="MassSpecBase-1062"><a href="#MassSpecBase-1062"><span class="linenos">1062</span></a>    <span class="k">def</span> <span class="nf">plot_profile_and_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase-1063"><a href="#MassSpecBase-1063"><span class="linenos">1063</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the profile data and noise threshold of the mass spectrum.</span>
</span><span id="MassSpecBase-1064"><a href="#MassSpecBase-1064"><span class="linenos">1064</span></a>
</span><span id="MassSpecBase-1065"><a href="#MassSpecBase-1065"><span class="linenos">1065</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1066"><a href="#MassSpecBase-1066"><span class="linenos">1066</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1067"><a href="#MassSpecBase-1067"><span class="linenos">1067</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase-1068"><a href="#MassSpecBase-1068"><span class="linenos">1068</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase-1069"><a href="#MassSpecBase-1069"><span class="linenos">1069</span></a><span class="sd">        legend : bool, optional</span>
</span><span id="MassSpecBase-1070"><a href="#MassSpecBase-1070"><span class="linenos">1070</span></a><span class="sd">            Whether to show the legend. Defaults to False.</span>
</span><span id="MassSpecBase-1071"><a href="#MassSpecBase-1071"><span class="linenos">1071</span></a>
</span><span id="MassSpecBase-1072"><a href="#MassSpecBase-1072"><span class="linenos">1072</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1073"><a href="#MassSpecBase-1073"><span class="linenos">1073</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1074"><a href="#MassSpecBase-1074"><span class="linenos">1074</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase-1075"><a href="#MassSpecBase-1075"><span class="linenos">1075</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase-1076"><a href="#MassSpecBase-1076"><span class="linenos">1076</span></a>
</span><span id="MassSpecBase-1077"><a href="#MassSpecBase-1077"><span class="linenos">1077</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase-1078"><a href="#MassSpecBase-1078"><span class="linenos">1078</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase-1079"><a href="#MassSpecBase-1079"><span class="linenos">1079</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase-1080"><a href="#MassSpecBase-1080"><span class="linenos">1080</span></a><span class="sd">            If no noise threshold is found.</span>
</span><span id="MassSpecBase-1081"><a href="#MassSpecBase-1081"><span class="linenos">1081</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1082"><a href="#MassSpecBase-1082"><span class="linenos">1082</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase-1083"><a href="#MassSpecBase-1083"><span class="linenos">1083</span></a>
</span><span id="MassSpecBase-1084"><a href="#MassSpecBase-1084"><span class="linenos">1084</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span><span class="p">:</span>
</span><span id="MassSpecBase-1085"><a href="#MassSpecBase-1085"><span class="linenos">1085</span></a>            <span class="c1"># x = (self.mz_exp_profile.min(), self.mz_exp_profile.max())</span>
</span><span id="MassSpecBase-1086"><a href="#MassSpecBase-1086"><span class="linenos">1086</span></a>            <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">)</span>
</span><span id="MassSpecBase-1087"><a href="#MassSpecBase-1087"><span class="linenos">1087</span></a>
</span><span id="MassSpecBase-1088"><a href="#MassSpecBase-1088"><span class="linenos">1088</span></a>            <span class="c1"># std = self.parameters.mass_spectrum.noise_threshold_min_std</span>
</span><span id="MassSpecBase-1089"><a href="#MassSpecBase-1089"><span class="linenos">1089</span></a>            <span class="c1"># threshold = self.baseline_noise_std + (std * self.baseline_noise_std)</span>
</span><span id="MassSpecBase-1090"><a href="#MassSpecBase-1090"><span class="linenos">1090</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()</span>
</span><span id="MassSpecBase-1091"><a href="#MassSpecBase-1091"><span class="linenos">1091</span></a>
</span><span id="MassSpecBase-1092"><a href="#MassSpecBase-1092"><span class="linenos">1092</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase-1093"><a href="#MassSpecBase-1093"><span class="linenos">1093</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase-1094"><a href="#MassSpecBase-1094"><span class="linenos">1094</span></a>
</span><span id="MassSpecBase-1095"><a href="#MassSpecBase-1095"><span class="linenos">1095</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="MassSpecBase-1096"><a href="#MassSpecBase-1096"><span class="linenos">1096</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span>
</span><span id="MassSpecBase-1097"><a href="#MassSpecBase-1097"><span class="linenos">1097</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span>
</span><span id="MassSpecBase-1098"><a href="#MassSpecBase-1098"><span class="linenos">1098</span></a>                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
</span><span id="MassSpecBase-1099"><a href="#MassSpecBase-1099"><span class="linenos">1099</span></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spectrum&quot;</span><span class="p">,</span>
</span><span id="MassSpecBase-1100"><a href="#MassSpecBase-1100"><span class="linenos">1100</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase-1101"><a href="#MassSpecBase-1101"><span class="linenos">1101</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">baseline</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Baseline Noise&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-1102"><a href="#MassSpecBase-1102"><span class="linenos">1102</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noise Threshold&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-1103"><a href="#MassSpecBase-1103"><span class="linenos">1103</span></a>
</span><span id="MassSpecBase-1104"><a href="#MassSpecBase-1104"><span class="linenos">1104</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1105"><a href="#MassSpecBase-1105"><span class="linenos">1105</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1106"><a href="#MassSpecBase-1106"><span class="linenos">1106</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase-1107"><a href="#MassSpecBase-1107"><span class="linenos">1107</span></a>
</span><span id="MassSpecBase-1108"><a href="#MassSpecBase-1108"><span class="linenos">1108</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1109"><a href="#MassSpecBase-1109"><span class="linenos">1109</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1110"><a href="#MassSpecBase-1110"><span class="linenos">1110</span></a>
</span><span id="MassSpecBase-1111"><a href="#MassSpecBase-1111"><span class="linenos">1111</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1112"><a href="#MassSpecBase-1112"><span class="linenos">1112</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase-1113"><a href="#MassSpecBase-1113"><span class="linenos">1113</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="MassSpecBase-1114"><a href="#MassSpecBase-1114"><span class="linenos">1114</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="MassSpecBase-1115"><a href="#MassSpecBase-1115"><span class="linenos">1115</span></a>
</span><span id="MassSpecBase-1116"><a href="#MassSpecBase-1116"><span class="linenos">1116</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase-1117"><a href="#MassSpecBase-1117"><span class="linenos">1117</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Calculate noise threshold first&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-1118"><a href="#MassSpecBase-1118"><span class="linenos">1118</span></a>
</span><span id="MassSpecBase-1119"><a href="#MassSpecBase-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="MassSpecBase-1120"><a href="#MassSpecBase-1120"><span class="linenos">1120</span></a>
</span><span id="MassSpecBase-1121"><a href="#MassSpecBase-1121"><span class="linenos">1121</span></a>    <span class="k">def</span> <span class="nf">plot_mz_domain_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MassSpecBase-1122"><a href="#MassSpecBase-1122"><span class="linenos">1122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the m/z domain profile of the mass spectrum.</span>
</span><span id="MassSpecBase-1123"><a href="#MassSpecBase-1123"><span class="linenos">1123</span></a>
</span><span id="MassSpecBase-1124"><a href="#MassSpecBase-1124"><span class="linenos">1124</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1125"><a href="#MassSpecBase-1125"><span class="linenos">1125</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1126"><a href="#MassSpecBase-1126"><span class="linenos">1126</span></a><span class="sd">        color : str, optional</span>
</span><span id="MassSpecBase-1127"><a href="#MassSpecBase-1127"><span class="linenos">1127</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;green&#39;.</span>
</span><span id="MassSpecBase-1128"><a href="#MassSpecBase-1128"><span class="linenos">1128</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase-1129"><a href="#MassSpecBase-1129"><span class="linenos">1129</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase-1130"><a href="#MassSpecBase-1130"><span class="linenos">1130</span></a>
</span><span id="MassSpecBase-1131"><a href="#MassSpecBase-1131"><span class="linenos">1131</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1132"><a href="#MassSpecBase-1132"><span class="linenos">1132</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1133"><a href="#MassSpecBase-1133"><span class="linenos">1133</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase-1134"><a href="#MassSpecBase-1134"><span class="linenos">1134</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase-1135"><a href="#MassSpecBase-1135"><span class="linenos">1135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1136"><a href="#MassSpecBase-1136"><span class="linenos">1136</span></a>
</span><span id="MassSpecBase-1137"><a href="#MassSpecBase-1137"><span class="linenos">1137</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase-1138"><a href="#MassSpecBase-1138"><span class="linenos">1138</span></a>
</span><span id="MassSpecBase-1139"><a href="#MassSpecBase-1139"><span class="linenos">1139</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase-1140"><a href="#MassSpecBase-1140"><span class="linenos">1140</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase-1141"><a href="#MassSpecBase-1141"><span class="linenos">1141</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="MassSpecBase-1142"><a href="#MassSpecBase-1142"><span class="linenos">1142</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;m/z&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;abundance&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase-1143"><a href="#MassSpecBase-1143"><span class="linenos">1143</span></a>
</span><span id="MassSpecBase-1144"><a href="#MassSpecBase-1144"><span class="linenos">1144</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span><span id="MassSpecBase-1145"><a href="#MassSpecBase-1145"><span class="linenos">1145</span></a>
</span><span id="MassSpecBase-1146"><a href="#MassSpecBase-1146"><span class="linenos">1146</span></a>    <span class="k">def</span> <span class="nf">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase-1147"><a href="#MassSpecBase-1147"><span class="linenos">1147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an Excel file.</span>
</span><span id="MassSpecBase-1148"><a href="#MassSpecBase-1148"><span class="linenos">1148</span></a>
</span><span id="MassSpecBase-1149"><a href="#MassSpecBase-1149"><span class="linenos">1149</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1150"><a href="#MassSpecBase-1150"><span class="linenos">1150</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1151"><a href="#MassSpecBase-1151"><span class="linenos">1151</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase-1152"><a href="#MassSpecBase-1152"><span class="linenos">1152</span></a><span class="sd">            The path to the Excel file to export to.</span>
</span><span id="MassSpecBase-1153"><a href="#MassSpecBase-1153"><span class="linenos">1153</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase-1154"><a href="#MassSpecBase-1154"><span class="linenos">1154</span></a><span class="sd">            Whether to write the metadata to the Excel file. Defaults to True.</span>
</span><span id="MassSpecBase-1155"><a href="#MassSpecBase-1155"><span class="linenos">1155</span></a>
</span><span id="MassSpecBase-1156"><a href="#MassSpecBase-1156"><span class="linenos">1156</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1157"><a href="#MassSpecBase-1157"><span class="linenos">1157</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1158"><a href="#MassSpecBase-1158"><span class="linenos">1158</span></a><span class="sd">        None</span>
</span><span id="MassSpecBase-1159"><a href="#MassSpecBase-1159"><span class="linenos">1159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1160"><a href="#MassSpecBase-1160"><span class="linenos">1160</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1161"><a href="#MassSpecBase-1161"><span class="linenos">1161</span></a>
</span><span id="MassSpecBase-1162"><a href="#MassSpecBase-1162"><span class="linenos">1162</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1163"><a href="#MassSpecBase-1163"><span class="linenos">1163</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="MassSpecBase-1164"><a href="#MassSpecBase-1164"><span class="linenos">1164</span></a>
</span><span id="MassSpecBase-1165"><a href="#MassSpecBase-1165"><span class="linenos">1165</span></a>    <span class="k">def</span> <span class="nf">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">):</span>
</span><span id="MassSpecBase-1166"><a href="#MassSpecBase-1166"><span class="linenos">1166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an HDF file.</span>
</span><span id="MassSpecBase-1167"><a href="#MassSpecBase-1167"><span class="linenos">1167</span></a>
</span><span id="MassSpecBase-1168"><a href="#MassSpecBase-1168"><span class="linenos">1168</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1169"><a href="#MassSpecBase-1169"><span class="linenos">1169</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1170"><a href="#MassSpecBase-1170"><span class="linenos">1170</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase-1171"><a href="#MassSpecBase-1171"><span class="linenos">1171</span></a><span class="sd">            The path to the HDF file to export to.</span>
</span><span id="MassSpecBase-1172"><a href="#MassSpecBase-1172"><span class="linenos">1172</span></a>
</span><span id="MassSpecBase-1173"><a href="#MassSpecBase-1173"><span class="linenos">1173</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1174"><a href="#MassSpecBase-1174"><span class="linenos">1174</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1175"><a href="#MassSpecBase-1175"><span class="linenos">1175</span></a><span class="sd">        None</span>
</span><span id="MassSpecBase-1176"><a href="#MassSpecBase-1176"><span class="linenos">1176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1177"><a href="#MassSpecBase-1177"><span class="linenos">1177</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1178"><a href="#MassSpecBase-1178"><span class="linenos">1178</span></a>
</span><span id="MassSpecBase-1179"><a href="#MassSpecBase-1179"><span class="linenos">1179</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1180"><a href="#MassSpecBase-1180"><span class="linenos">1180</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">()</span>
</span><span id="MassSpecBase-1181"><a href="#MassSpecBase-1181"><span class="linenos">1181</span></a>
</span><span id="MassSpecBase-1182"><a href="#MassSpecBase-1182"><span class="linenos">1182</span></a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase-1183"><a href="#MassSpecBase-1183"><span class="linenos">1183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a CSV file.</span>
</span><span id="MassSpecBase-1184"><a href="#MassSpecBase-1184"><span class="linenos">1184</span></a>
</span><span id="MassSpecBase-1185"><a href="#MassSpecBase-1185"><span class="linenos">1185</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1186"><a href="#MassSpecBase-1186"><span class="linenos">1186</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1187"><a href="#MassSpecBase-1187"><span class="linenos">1187</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase-1188"><a href="#MassSpecBase-1188"><span class="linenos">1188</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="MassSpecBase-1189"><a href="#MassSpecBase-1189"><span class="linenos">1189</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase-1190"><a href="#MassSpecBase-1190"><span class="linenos">1190</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="MassSpecBase-1191"><a href="#MassSpecBase-1191"><span class="linenos">1191</span></a>
</span><span id="MassSpecBase-1192"><a href="#MassSpecBase-1192"><span class="linenos">1192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1193"><a href="#MassSpecBase-1193"><span class="linenos">1193</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1194"><a href="#MassSpecBase-1194"><span class="linenos">1194</span></a>
</span><span id="MassSpecBase-1195"><a href="#MassSpecBase-1195"><span class="linenos">1195</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1196"><a href="#MassSpecBase-1196"><span class="linenos">1196</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="MassSpecBase-1197"><a href="#MassSpecBase-1197"><span class="linenos">1197</span></a>
</span><span id="MassSpecBase-1198"><a href="#MassSpecBase-1198"><span class="linenos">1198</span></a>    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase-1199"><a href="#MassSpecBase-1199"><span class="linenos">1199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a Pandas dataframe with pkl extension.</span>
</span><span id="MassSpecBase-1200"><a href="#MassSpecBase-1200"><span class="linenos">1200</span></a>
</span><span id="MassSpecBase-1201"><a href="#MassSpecBase-1201"><span class="linenos">1201</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1202"><a href="#MassSpecBase-1202"><span class="linenos">1202</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1203"><a href="#MassSpecBase-1203"><span class="linenos">1203</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase-1204"><a href="#MassSpecBase-1204"><span class="linenos">1204</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="MassSpecBase-1205"><a href="#MassSpecBase-1205"><span class="linenos">1205</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase-1206"><a href="#MassSpecBase-1206"><span class="linenos">1206</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="MassSpecBase-1207"><a href="#MassSpecBase-1207"><span class="linenos">1207</span></a>
</span><span id="MassSpecBase-1208"><a href="#MassSpecBase-1208"><span class="linenos">1208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1209"><a href="#MassSpecBase-1209"><span class="linenos">1209</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1210"><a href="#MassSpecBase-1210"><span class="linenos">1210</span></a>
</span><span id="MassSpecBase-1211"><a href="#MassSpecBase-1211"><span class="linenos">1211</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1212"><a href="#MassSpecBase-1212"><span class="linenos">1212</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span><span id="MassSpecBase-1213"><a href="#MassSpecBase-1213"><span class="linenos">1213</span></a>
</span><span id="MassSpecBase-1214"><a href="#MassSpecBase-1214"><span class="linenos">1214</span></a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">additional_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MassSpecBase-1215"><a href="#MassSpecBase-1215"><span class="linenos">1215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a Pandas dataframe.</span>
</span><span id="MassSpecBase-1216"><a href="#MassSpecBase-1216"><span class="linenos">1216</span></a>
</span><span id="MassSpecBase-1217"><a href="#MassSpecBase-1217"><span class="linenos">1217</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase-1218"><a href="#MassSpecBase-1218"><span class="linenos">1218</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase-1219"><a href="#MassSpecBase-1219"><span class="linenos">1219</span></a><span class="sd">        additional_columns : list, optional</span>
</span><span id="MassSpecBase-1220"><a href="#MassSpecBase-1220"><span class="linenos">1220</span></a><span class="sd">            A list of additional columns to include in the dataframe. Defaults to None.</span>
</span><span id="MassSpecBase-1221"><a href="#MassSpecBase-1221"><span class="linenos">1221</span></a><span class="sd">            Suitable columns are: &quot;Aromaticity Index&quot;, &quot;Aromaticity Index (modified)&quot;, and &quot;NOSC&quot;</span>
</span><span id="MassSpecBase-1222"><a href="#MassSpecBase-1222"><span class="linenos">1222</span></a>
</span><span id="MassSpecBase-1223"><a href="#MassSpecBase-1223"><span class="linenos">1223</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase-1224"><a href="#MassSpecBase-1224"><span class="linenos">1224</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase-1225"><a href="#MassSpecBase-1225"><span class="linenos">1225</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="MassSpecBase-1226"><a href="#MassSpecBase-1226"><span class="linenos">1226</span></a><span class="sd">            The mass spectrum as a Pandas dataframe.</span>
</span><span id="MassSpecBase-1227"><a href="#MassSpecBase-1227"><span class="linenos">1227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1228"><a href="#MassSpecBase-1228"><span class="linenos">1228</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1229"><a href="#MassSpecBase-1229"><span class="linenos">1229</span></a>
</span><span id="MassSpecBase-1230"><a href="#MassSpecBase-1230"><span class="linenos">1230</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1231"><a href="#MassSpecBase-1231"><span class="linenos">1231</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">get_pandas_df</span><span class="p">(</span><span class="n">additional_columns</span><span class="o">=</span><span class="n">additional_columns</span><span class="p">)</span>
</span><span id="MassSpecBase-1232"><a href="#MassSpecBase-1232"><span class="linenos">1232</span></a>
</span><span id="MassSpecBase-1233"><a href="#MassSpecBase-1233"><span class="linenos">1233</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-1234"><a href="#MassSpecBase-1234"><span class="linenos">1234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a JSON file.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1235"><a href="#MassSpecBase-1235"><span class="linenos">1235</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1236"><a href="#MassSpecBase-1236"><span class="linenos">1236</span></a>
</span><span id="MassSpecBase-1237"><a href="#MassSpecBase-1237"><span class="linenos">1237</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1238"><a href="#MassSpecBase-1238"><span class="linenos">1238</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span><span id="MassSpecBase-1239"><a href="#MassSpecBase-1239"><span class="linenos">1239</span></a>
</span><span id="MassSpecBase-1240"><a href="#MassSpecBase-1240"><span class="linenos">1240</span></a>    <span class="k">def</span> <span class="nf">parameters_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-1241"><a href="#MassSpecBase-1241"><span class="linenos">1241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a JSON string.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1242"><a href="#MassSpecBase-1242"><span class="linenos">1242</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1243"><a href="#MassSpecBase-1243"><span class="linenos">1243</span></a>
</span><span id="MassSpecBase-1244"><a href="#MassSpecBase-1244"><span class="linenos">1244</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1245"><a href="#MassSpecBase-1245"><span class="linenos">1245</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_json</span><span class="p">()</span>
</span><span id="MassSpecBase-1246"><a href="#MassSpecBase-1246"><span class="linenos">1246</span></a>
</span><span id="MassSpecBase-1247"><a href="#MassSpecBase-1247"><span class="linenos">1247</span></a>    <span class="k">def</span> <span class="nf">parameters_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase-1248"><a href="#MassSpecBase-1248"><span class="linenos">1248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a TOML string.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase-1249"><a href="#MassSpecBase-1249"><span class="linenos">1249</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase-1250"><a href="#MassSpecBase-1250"><span class="linenos">1250</span></a>
</span><span id="MassSpecBase-1251"><a href="#MassSpecBase-1251"><span class="linenos">1251</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase-1252"><a href="#MassSpecBase-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_toml</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>A mass spectrum base class, stores the profile data and instrument settings.</p>

<p>Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.
_mspeaks is populated under the hood by calling process_mass_spec method.
Iteration is null if _mspeaks is empty.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mz_exp</strong> (array_like):
The m/z values of the mass spectrum.</li>
<li><strong>abundance</strong> (array_like):
The abundance values of the mass spectrum.</li>
<li><strong>d_params</strong> (dict):
A dictionary of parameters for the mass spectrum.</li>
<li><strong>**kwargs</strong>: Additional keyword arguments.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>mspeaks</strong> (list):
A list of mass peaks.</li>
<li><strong>is_calibrated</strong> (bool):
Whether the mass spectrum is calibrated.</li>
<li><strong>is_centroid</strong> (bool):
Whether the mass spectrum is centroided.</li>
<li><strong>has_frequency</strong> (bool):
Whether the mass spectrum has a frequency domain.</li>
<li><strong>calibration_order</strong> (None or int):
The order of the mass spectrum's calibration.</li>
<li><strong>calibration_points</strong> (None or ndarray):
The calibration points of the mass spectrum.</li>
<li><strong>calibration_ref_mzs</strong> (None or ndarray):
The reference m/z values of the mass spectrum's calibration.</li>
<li><strong>calibration_meas_mzs</strong> (None or ndarray):
The measured m/z values of the mass spectrum's calibration.</li>
<li><strong>calibration_RMS</strong> (None or float):
The root mean square of the mass spectrum's calibration.</li>
<li><strong>calibration_segment</strong> (None or CalibrationSegment):
The calibration segment of the mass spectrum.</li>
<li><strong>_abundance</strong> (ndarray):
The abundance values of the mass spectrum.</li>
<li><strong>_mz_exp</strong> (ndarray):
The m/z values of the mass spectrum.</li>
<li><strong>_mspeaks</strong> (list):
A list of mass peaks.</li>
<li><strong>_dict_nominal_masses_indexes</strong> (dict):
A dictionary of nominal masses and their indexes.</li>
<li><strong>_baseline_noise</strong> (float):
The baseline noise of the mass spectrum.</li>
<li><strong>_baseline_noise_std</strong> (float):
The standard deviation of the baseline noise of the mass spectrum.</li>
<li><strong>_dynamic_range</strong> (float or None):
The dynamic range of the mass spectrum.</li>
<li><strong>_transient_settings</strong> (None or TransientSettings):
The transient settings of the mass spectrum.</li>
<li><strong>_frequency_domain</strong> (None or FrequencyDomain):
The frequency domain of the mass spectrum.</li>
<li><strong>_mz_cal_profile</strong> (None or MzCalibrationProfile):
The m/z calibration profile of the mass spectrum.</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>process_mass_spec(). Main function to process the mass spectrum,
including calculating the noise threshold, peak picking, and resetting the MSpeak indexes.</li>
</ul>

<p>See also: MassSpecCentroid(), MassSpecfromFreq(), MassSpecProfile()</p>
</div>


                            <div id="MassSpecBase.__init__" class="classattr">
                                        <input id="MassSpecBase.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MassSpecBase</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mz_exp</span>, </span><span class="param"><span class="n">abundance</span>, </span><span class="param"><span class="n">d_params</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="MassSpecBase.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.__init__-106"><a href="#MassSpecBase.__init__-106"><span class="linenos">106</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_exp</span><span class="p">,</span> <span class="n">abundance</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="MassSpecBase.__init__-107"><a href="#MassSpecBase.__init__-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">abundance</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="MassSpecBase.__init__-108"><a href="#MassSpecBase.__init__-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)</span>
</span><span id="MassSpecBase.__init__-109"><a href="#MassSpecBase.__init__-109"><span class="linenos">109</span></a>
</span><span id="MassSpecBase.__init__-110"><a href="#MassSpecBase.__init__-110"><span class="linenos">110</span></a>        <span class="c1"># objects created after process_mass_spec() function</span>
</span><span id="MassSpecBase.__init__-111"><a href="#MassSpecBase.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase.__init__-112"><a href="#MassSpecBase.__init__-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase.__init__-113"><a href="#MassSpecBase.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</span><span id="MassSpecBase.__init__-114"><a href="#MassSpecBase.__init__-114"><span class="linenos">114</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="MassSpecBase.__init__-115"><a href="#MassSpecBase.__init__-115"><span class="linenos">115</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.001</span>
</span><span id="MassSpecBase.__init__-116"><a href="#MassSpecBase.__init__-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-117"><a href="#MassSpecBase.__init__-117"><span class="linenos">117</span></a>        <span class="c1"># set to None: initialization occurs inside subclass MassSpecfromFreq</span>
</span><span id="MassSpecBase.__init__-118"><a href="#MassSpecBase.__init__-118"><span class="linenos">118</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_transient_settings</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-119"><a href="#MassSpecBase.__init__-119"><span class="linenos">119</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-120"><a href="#MassSpecBase.__init__-120"><span class="linenos">120</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_cal_profile</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-121"><a href="#MassSpecBase.__init__-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_calibrated</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase.__init__-122"><a href="#MassSpecBase.__init__-122"><span class="linenos">122</span></a>
</span><span id="MassSpecBase.__init__-123"><a href="#MassSpecBase.__init__-123"><span class="linenos">123</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecBase.__init__-124"><a href="#MassSpecBase.__init__-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span><span id="MassSpecBase.__init__-125"><a href="#MassSpecBase.__init__-125"><span class="linenos">125</span></a>
</span><span id="MassSpecBase.__init__-126"><a href="#MassSpecBase.__init__-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase.__init__-127"><a href="#MassSpecBase.__init__-127"><span class="linenos">127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecBase.__init__-128"><a href="#MassSpecBase.__init__-128"><span class="linenos">128</span></a>
</span><span id="MassSpecBase.__init__-129"><a href="#MassSpecBase.__init__-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_order</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-130"><a href="#MassSpecBase.__init__-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_points</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-131"><a href="#MassSpecBase.__init__-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_ref_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-132"><a href="#MassSpecBase.__init__-132"><span class="linenos">132</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_meas_mzs</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-133"><a href="#MassSpecBase.__init__-133"><span class="linenos">133</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_RMS</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-134"><a href="#MassSpecBase.__init__-134"><span class="linenos">134</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_segment</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-135"><a href="#MassSpecBase.__init__-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_median</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecBase.__init__-136"><a href="#MassSpecBase.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">calibration_raw_error_stdev</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="MassSpecBase.mspeaks" class="classattr">
                                <div class="attr variable">
            <span class="name">mspeaks</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mspeaks"></a>
    
    

                            </div>
                            <div id="MassSpecBase.is_calibrated" class="classattr">
                                <div class="attr variable">
            <span class="name">is_calibrated</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.is_calibrated"></a>
    
    

                            </div>
                            <div id="MassSpecBase.is_centroid" class="classattr">
                                <div class="attr variable">
            <span class="name">is_centroid</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.is_centroid"></a>
    
    

                            </div>
                            <div id="MassSpecBase.has_frequency" class="classattr">
                                <div class="attr variable">
            <span class="name">has_frequency</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.has_frequency"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_order" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_order</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_order"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_points" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_points</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_points"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_ref_mzs" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_ref_mzs</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_ref_mzs"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_meas_mzs" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_meas_mzs</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_meas_mzs"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_RMS" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_RMS</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_RMS"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_segment" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_segment</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_segment"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_raw_error_median" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_raw_error_median</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_raw_error_median"></a>
    
    

                            </div>
                            <div id="MassSpecBase.calibration_raw_error_stdev" class="classattr">
                                <div class="attr variable">
            <span class="name">calibration_raw_error_stdev</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.calibration_raw_error_stdev"></a>
    
    

                            </div>
                            <div id="MassSpecBase.set_indexes" class="classattr">
                                        <input id="MassSpecBase.set_indexes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_indexes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">list_indexes</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.set_indexes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.set_indexes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.set_indexes-148"><a href="#MassSpecBase.set_indexes-148"><span class="linenos">148</span></a>    <span class="k">def</span> <span class="nf">set_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="MassSpecBase.set_indexes-149"><a href="#MassSpecBase.set_indexes-149"><span class="linenos">149</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the mass spectrum to iterate over only the selected MSpeaks indexes.</span>
</span><span id="MassSpecBase.set_indexes-150"><a href="#MassSpecBase.set_indexes-150"><span class="linenos">150</span></a>
</span><span id="MassSpecBase.set_indexes-151"><a href="#MassSpecBase.set_indexes-151"><span class="linenos">151</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.set_indexes-152"><a href="#MassSpecBase.set_indexes-152"><span class="linenos">152</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.set_indexes-153"><a href="#MassSpecBase.set_indexes-153"><span class="linenos">153</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="MassSpecBase.set_indexes-154"><a href="#MassSpecBase.set_indexes-154"><span class="linenos">154</span></a><span class="sd">            A list of integers representing the indexes of the MSpeaks to iterate over.</span>
</span><span id="MassSpecBase.set_indexes-155"><a href="#MassSpecBase.set_indexes-155"><span class="linenos">155</span></a>
</span><span id="MassSpecBase.set_indexes-156"><a href="#MassSpecBase.set_indexes-156"><span class="linenos">156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.set_indexes-157"><a href="#MassSpecBase.set_indexes-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">list_indexes</span><span class="p">]</span>
</span><span id="MassSpecBase.set_indexes-158"><a href="#MassSpecBase.set_indexes-158"><span class="linenos">158</span></a>
</span><span id="MassSpecBase.set_indexes-159"><a href="#MassSpecBase.set_indexes-159"><span class="linenos">159</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase.set_indexes-160"><a href="#MassSpecBase.set_indexes-160"><span class="linenos">160</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase.set_indexes-161"><a href="#MassSpecBase.set_indexes-161"><span class="linenos">161</span></a>
</span><span id="MassSpecBase.set_indexes-162"><a href="#MassSpecBase.set_indexes-162"><span class="linenos">162</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Set the mass spectrum to iterate over only the selected MSpeaks indexes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>list_indexes</strong> (list of int):
A list of integers representing the indexes of the MSpeaks to iterate over.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.reset_indexes" class="classattr">
                                        <input id="MassSpecBase.reset_indexes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset_indexes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.reset_indexes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.reset_indexes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.reset_indexes-164"><a href="#MassSpecBase.reset_indexes-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="nf">reset_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.reset_indexes-165"><a href="#MassSpecBase.reset_indexes-165"><span class="linenos">165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset the mass spectrum to iterate over all MSpeaks objects.</span>
</span><span id="MassSpecBase.reset_indexes-166"><a href="#MassSpecBase.reset_indexes-166"><span class="linenos">166</span></a>
</span><span id="MassSpecBase.reset_indexes-167"><a href="#MassSpecBase.reset_indexes-167"><span class="linenos">167</span></a><span class="sd">        This method resets the mass spectrum to its original state, allowing iteration over all MSpeaks objects.</span>
</span><span id="MassSpecBase.reset_indexes-168"><a href="#MassSpecBase.reset_indexes-168"><span class="linenos">168</span></a><span class="sd">        It also sets the index of each MSpeak object to its corresponding position in the mass spectrum.</span>
</span><span id="MassSpecBase.reset_indexes-169"><a href="#MassSpecBase.reset_indexes-169"><span class="linenos">169</span></a>
</span><span id="MassSpecBase.reset_indexes-170"><a href="#MassSpecBase.reset_indexes-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.reset_indexes-171"><a href="#MassSpecBase.reset_indexes-171"><span class="linenos">171</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="MassSpecBase.reset_indexes-172"><a href="#MassSpecBase.reset_indexes-172"><span class="linenos">172</span></a>
</span><span id="MassSpecBase.reset_indexes-173"><a href="#MassSpecBase.reset_indexes-173"><span class="linenos">173</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase.reset_indexes-174"><a href="#MassSpecBase.reset_indexes-174"><span class="linenos">174</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase.reset_indexes-175"><a href="#MassSpecBase.reset_indexes-175"><span class="linenos">175</span></a>
</span><span id="MassSpecBase.reset_indexes-176"><a href="#MassSpecBase.reset_indexes-176"><span class="linenos">176</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Reset the mass spectrum to iterate over all MSpeaks objects.</p>

<p>This method resets the mass spectrum to its original state, allowing iteration over all MSpeaks objects.
It also sets the index of each MSpeak object to its corresponding position in the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.add_mspeak" class="classattr">
                                        <input id="MassSpecBase.add_mspeak-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_mspeak</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ion_charge</span>,</span><span class="param">	<span class="n">mz_exp</span>,</span><span class="param">	<span class="n">abundance</span>,</span><span class="param">	<span class="n">resolving_power</span>,</span><span class="param">	<span class="n">signal_to_noise</span>,</span><span class="param">	<span class="n">massspec_indexes</span>,</span><span class="param">	<span class="n">exp_freq</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">ms_parent</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.add_mspeak-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.add_mspeak"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.add_mspeak-178"><a href="#MassSpecBase.add_mspeak-178"><span class="linenos">178</span></a>    <span class="k">def</span> <span class="nf">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecBase.add_mspeak-179"><a href="#MassSpecBase.add_mspeak-179"><span class="linenos">179</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-180"><a href="#MassSpecBase.add_mspeak-180"><span class="linenos">180</span></a>        <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-181"><a href="#MassSpecBase.add_mspeak-181"><span class="linenos">181</span></a>        <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-182"><a href="#MassSpecBase.add_mspeak-182"><span class="linenos">182</span></a>        <span class="n">abundance</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-183"><a href="#MassSpecBase.add_mspeak-183"><span class="linenos">183</span></a>        <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-184"><a href="#MassSpecBase.add_mspeak-184"><span class="linenos">184</span></a>        <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-185"><a href="#MassSpecBase.add_mspeak-185"><span class="linenos">185</span></a>        <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-186"><a href="#MassSpecBase.add_mspeak-186"><span class="linenos">186</span></a>        <span class="n">exp_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-187"><a href="#MassSpecBase.add_mspeak-187"><span class="linenos">187</span></a>        <span class="n">ms_parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-188"><a href="#MassSpecBase.add_mspeak-188"><span class="linenos">188</span></a>    <span class="p">):</span>
</span><span id="MassSpecBase.add_mspeak-189"><a href="#MassSpecBase.add_mspeak-189"><span class="linenos">189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a new MSPeak object to the MassSpectrum object.</span>
</span><span id="MassSpecBase.add_mspeak-190"><a href="#MassSpecBase.add_mspeak-190"><span class="linenos">190</span></a>
</span><span id="MassSpecBase.add_mspeak-191"><a href="#MassSpecBase.add_mspeak-191"><span class="linenos">191</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.add_mspeak-192"><a href="#MassSpecBase.add_mspeak-192"><span class="linenos">192</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.add_mspeak-193"><a href="#MassSpecBase.add_mspeak-193"><span class="linenos">193</span></a><span class="sd">        ion_charge : int</span>
</span><span id="MassSpecBase.add_mspeak-194"><a href="#MassSpecBase.add_mspeak-194"><span class="linenos">194</span></a><span class="sd">            The ion charge of the MSPeak.</span>
</span><span id="MassSpecBase.add_mspeak-195"><a href="#MassSpecBase.add_mspeak-195"><span class="linenos">195</span></a><span class="sd">        mz_exp : float</span>
</span><span id="MassSpecBase.add_mspeak-196"><a href="#MassSpecBase.add_mspeak-196"><span class="linenos">196</span></a><span class="sd">            The experimental m/z value of the MSPeak.</span>
</span><span id="MassSpecBase.add_mspeak-197"><a href="#MassSpecBase.add_mspeak-197"><span class="linenos">197</span></a><span class="sd">        abundance : float</span>
</span><span id="MassSpecBase.add_mspeak-198"><a href="#MassSpecBase.add_mspeak-198"><span class="linenos">198</span></a><span class="sd">            The abundance of the MSPeak.</span>
</span><span id="MassSpecBase.add_mspeak-199"><a href="#MassSpecBase.add_mspeak-199"><span class="linenos">199</span></a><span class="sd">        resolving_power : float</span>
</span><span id="MassSpecBase.add_mspeak-200"><a href="#MassSpecBase.add_mspeak-200"><span class="linenos">200</span></a><span class="sd">            The resolving power of the MSPeak.</span>
</span><span id="MassSpecBase.add_mspeak-201"><a href="#MassSpecBase.add_mspeak-201"><span class="linenos">201</span></a><span class="sd">        signal_to_noise : float</span>
</span><span id="MassSpecBase.add_mspeak-202"><a href="#MassSpecBase.add_mspeak-202"><span class="linenos">202</span></a><span class="sd">            The signal-to-noise ratio of the MSPeak.</span>
</span><span id="MassSpecBase.add_mspeak-203"><a href="#MassSpecBase.add_mspeak-203"><span class="linenos">203</span></a><span class="sd">        massspec_indexes : list</span>
</span><span id="MassSpecBase.add_mspeak-204"><a href="#MassSpecBase.add_mspeak-204"><span class="linenos">204</span></a><span class="sd">            A list of indexes of the MSPeak in the MassSpectrum object.</span>
</span><span id="MassSpecBase.add_mspeak-205"><a href="#MassSpecBase.add_mspeak-205"><span class="linenos">205</span></a><span class="sd">        exp_freq : float, optional</span>
</span><span id="MassSpecBase.add_mspeak-206"><a href="#MassSpecBase.add_mspeak-206"><span class="linenos">206</span></a><span class="sd">            The experimental frequency of the MSPeak. Defaults to None.</span>
</span><span id="MassSpecBase.add_mspeak-207"><a href="#MassSpecBase.add_mspeak-207"><span class="linenos">207</span></a><span class="sd">        ms_parent : MSParent, optional</span>
</span><span id="MassSpecBase.add_mspeak-208"><a href="#MassSpecBase.add_mspeak-208"><span class="linenos">208</span></a><span class="sd">            The MSParent object associated with the MSPeak. Defaults to None.</span>
</span><span id="MassSpecBase.add_mspeak-209"><a href="#MassSpecBase.add_mspeak-209"><span class="linenos">209</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.add_mspeak-210"><a href="#MassSpecBase.add_mspeak-210"><span class="linenos">210</span></a>        <span class="n">mspeak</span> <span class="o">=</span> <span class="n">MSPeak</span><span class="p">(</span>
</span><span id="MassSpecBase.add_mspeak-211"><a href="#MassSpecBase.add_mspeak-211"><span class="linenos">211</span></a>            <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-212"><a href="#MassSpecBase.add_mspeak-212"><span class="linenos">212</span></a>            <span class="n">mz_exp</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-213"><a href="#MassSpecBase.add_mspeak-213"><span class="linenos">213</span></a>            <span class="n">abundance</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-214"><a href="#MassSpecBase.add_mspeak-214"><span class="linenos">214</span></a>            <span class="n">resolving_power</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-215"><a href="#MassSpecBase.add_mspeak-215"><span class="linenos">215</span></a>            <span class="n">signal_to_noise</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-216"><a href="#MassSpecBase.add_mspeak-216"><span class="linenos">216</span></a>            <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-217"><a href="#MassSpecBase.add_mspeak-217"><span class="linenos">217</span></a>            <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">),</span>
</span><span id="MassSpecBase.add_mspeak-218"><a href="#MassSpecBase.add_mspeak-218"><span class="linenos">218</span></a>            <span class="n">exp_freq</span><span class="o">=</span><span class="n">exp_freq</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-219"><a href="#MassSpecBase.add_mspeak-219"><span class="linenos">219</span></a>            <span class="n">ms_parent</span><span class="o">=</span><span class="n">ms_parent</span><span class="p">,</span>
</span><span id="MassSpecBase.add_mspeak-220"><a href="#MassSpecBase.add_mspeak-220"><span class="linenos">220</span></a>        <span class="p">)</span>
</span><span id="MassSpecBase.add_mspeak-221"><a href="#MassSpecBase.add_mspeak-221"><span class="linenos">221</span></a>
</span><span id="MassSpecBase.add_mspeak-222"><a href="#MassSpecBase.add_mspeak-222"><span class="linenos">222</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mspeak</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add a new MSPeak object to the MassSpectrum object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ion_charge</strong> (int):
The ion charge of the MSPeak.</li>
<li><strong>mz_exp</strong> (float):
The experimental m/z value of the MSPeak.</li>
<li><strong>abundance</strong> (float):
The abundance of the MSPeak.</li>
<li><strong>resolving_power</strong> (float):
The resolving power of the MSPeak.</li>
<li><strong>signal_to_noise</strong> (float):
The signal-to-noise ratio of the MSPeak.</li>
<li><strong>massspec_indexes</strong> (list):
A list of indexes of the MSPeak in the MassSpectrum object.</li>
<li><strong>exp_freq</strong> (float, optional):
The experimental frequency of the MSPeak. Defaults to None.</li>
<li><strong>ms_parent</strong> (MSParent, optional):
The MSParent object associated with the MSPeak. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.reset_cal_therms" class="classattr">
                                        <input id="MassSpecBase.reset_cal_therms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reset_cal_therms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">Aterm</span>, </span><span class="param"><span class="n">Bterm</span>, </span><span class="param"><span class="n">C</span>, </span><span class="param"><span class="n">fas</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.reset_cal_therms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.reset_cal_therms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.reset_cal_therms-290"><a href="#MassSpecBase.reset_cal_therms-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">reset_cal_therms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">fas</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="MassSpecBase.reset_cal_therms-291"><a href="#MassSpecBase.reset_cal_therms-291"><span class="linenos">291</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Reset calibration terms and recalculate the mass-to-charge ratio and abundance.</span>
</span><span id="MassSpecBase.reset_cal_therms-292"><a href="#MassSpecBase.reset_cal_therms-292"><span class="linenos">292</span></a>
</span><span id="MassSpecBase.reset_cal_therms-293"><a href="#MassSpecBase.reset_cal_therms-293"><span class="linenos">293</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.reset_cal_therms-294"><a href="#MassSpecBase.reset_cal_therms-294"><span class="linenos">294</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.reset_cal_therms-295"><a href="#MassSpecBase.reset_cal_therms-295"><span class="linenos">295</span></a><span class="sd">        Aterm : float</span>
</span><span id="MassSpecBase.reset_cal_therms-296"><a href="#MassSpecBase.reset_cal_therms-296"><span class="linenos">296</span></a><span class="sd">            The A-term calibration coefficient.</span>
</span><span id="MassSpecBase.reset_cal_therms-297"><a href="#MassSpecBase.reset_cal_therms-297"><span class="linenos">297</span></a><span class="sd">        Bterm : float</span>
</span><span id="MassSpecBase.reset_cal_therms-298"><a href="#MassSpecBase.reset_cal_therms-298"><span class="linenos">298</span></a><span class="sd">            The B-term calibration coefficient.</span>
</span><span id="MassSpecBase.reset_cal_therms-299"><a href="#MassSpecBase.reset_cal_therms-299"><span class="linenos">299</span></a><span class="sd">        C : float</span>
</span><span id="MassSpecBase.reset_cal_therms-300"><a href="#MassSpecBase.reset_cal_therms-300"><span class="linenos">300</span></a><span class="sd">            The C-term calibration coefficient.</span>
</span><span id="MassSpecBase.reset_cal_therms-301"><a href="#MassSpecBase.reset_cal_therms-301"><span class="linenos">301</span></a><span class="sd">        fas : float, optional</span>
</span><span id="MassSpecBase.reset_cal_therms-302"><a href="#MassSpecBase.reset_cal_therms-302"><span class="linenos">302</span></a><span class="sd">            The frequency amplitude scaling factor. Default is 0.</span>
</span><span id="MassSpecBase.reset_cal_therms-303"><a href="#MassSpecBase.reset_cal_therms-303"><span class="linenos">303</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.reset_cal_therms-304"><a href="#MassSpecBase.reset_cal_therms-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_calibration_terms</span> <span class="o">=</span> <span class="p">(</span><span class="n">Aterm</span><span class="p">,</span> <span class="n">Bterm</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
</span><span id="MassSpecBase.reset_cal_therms-305"><a href="#MassSpecBase.reset_cal_therms-305"><span class="linenos">305</span></a>
</span><span id="MassSpecBase.reset_cal_therms-306"><a href="#MassSpecBase.reset_cal_therms-306"><span class="linenos">306</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz</span><span class="p">()</span>
</span><span id="MassSpecBase.reset_cal_therms-307"><a href="#MassSpecBase.reset_cal_therms-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="MassSpecBase.reset_cal_therms-308"><a href="#MassSpecBase.reset_cal_therms-308"><span class="linenos">308</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="MassSpecBase.reset_cal_therms-309"><a href="#MassSpecBase.reset_cal_therms-309"><span class="linenos">309</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Reset calibration terms and recalculate the mass-to-charge ratio and abundance.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>Aterm</strong> (float):
The A-term calibration coefficient.</li>
<li><strong>Bterm</strong> (float):
The B-term calibration coefficient.</li>
<li><strong>C</strong> (float):
The C-term calibration coefficient.</li>
<li><strong>fas</strong> (float, optional):
The frequency amplitude scaling factor. Default is 0.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.clear_molecular_formulas" class="classattr">
                                        <input id="MassSpecBase.clear_molecular_formulas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_molecular_formulas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.clear_molecular_formulas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.clear_molecular_formulas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.clear_molecular_formulas-311"><a href="#MassSpecBase.clear_molecular_formulas-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">clear_molecular_formulas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.clear_molecular_formulas-312"><a href="#MassSpecBase.clear_molecular_formulas-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the molecular formulas for all mspeaks in the MassSpectrum.</span>
</span><span id="MassSpecBase.clear_molecular_formulas-313"><a href="#MassSpecBase.clear_molecular_formulas-313"><span class="linenos">313</span></a>
</span><span id="MassSpecBase.clear_molecular_formulas-314"><a href="#MassSpecBase.clear_molecular_formulas-314"><span class="linenos">314</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.clear_molecular_formulas-315"><a href="#MassSpecBase.clear_molecular_formulas-315"><span class="linenos">315</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.clear_molecular_formulas-316"><a href="#MassSpecBase.clear_molecular_formulas-316"><span class="linenos">316</span></a><span class="sd">        numpy.ndarray</span>
</span><span id="MassSpecBase.clear_molecular_formulas-317"><a href="#MassSpecBase.clear_molecular_formulas-317"><span class="linenos">317</span></a><span class="sd">            An array of the cleared molecular formulas for each mspeak in the MassSpectrum.</span>
</span><span id="MassSpecBase.clear_molecular_formulas-318"><a href="#MassSpecBase.clear_molecular_formulas-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.clear_molecular_formulas-319"><a href="#MassSpecBase.clear_molecular_formulas-319"><span class="linenos">319</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase.clear_molecular_formulas-320"><a href="#MassSpecBase.clear_molecular_formulas-320"><span class="linenos">320</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Clear the molecular formulas for all mspeaks in the MassSpectrum.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>numpy.ndarray</strong>: An array of the cleared molecular formulas for each mspeak in the MassSpectrum.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.process_mass_spec" class="classattr">
                                        <input id="MassSpecBase.process_mass_spec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_mass_spec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.process_mass_spec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.process_mass_spec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.process_mass_spec-322"><a href="#MassSpecBase.process_mass_spec-322"><span class="linenos">322</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase.process_mass_spec-323"><a href="#MassSpecBase.process_mass_spec-323"><span class="linenos">323</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.</span>
</span><span id="MassSpecBase.process_mass_spec-324"><a href="#MassSpecBase.process_mass_spec-324"><span class="linenos">324</span></a>
</span><span id="MassSpecBase.process_mass_spec-325"><a href="#MassSpecBase.process_mass_spec-325"><span class="linenos">325</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.process_mass_spec-326"><a href="#MassSpecBase.process_mass_spec-326"><span class="linenos">326</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.process_mass_spec-327"><a href="#MassSpecBase.process_mass_spec-327"><span class="linenos">327</span></a><span class="sd">        keep_profile : bool, optional</span>
</span><span id="MassSpecBase.process_mass_spec-328"><a href="#MassSpecBase.process_mass_spec-328"><span class="linenos">328</span></a><span class="sd">            Whether to keep the profile data after processing. Defaults to True.</span>
</span><span id="MassSpecBase.process_mass_spec-329"><a href="#MassSpecBase.process_mass_spec-329"><span class="linenos">329</span></a>
</span><span id="MassSpecBase.process_mass_spec-330"><a href="#MassSpecBase.process_mass_spec-330"><span class="linenos">330</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecBase.process_mass_spec-331"><a href="#MassSpecBase.process_mass_spec-331"><span class="linenos">331</span></a><span class="sd">        -----</span>
</span><span id="MassSpecBase.process_mass_spec-332"><a href="#MassSpecBase.process_mass_spec-332"><span class="linenos">332</span></a><span class="sd">        This method does the following:</span>
</span><span id="MassSpecBase.process_mass_spec-333"><a href="#MassSpecBase.process_mass_spec-333"><span class="linenos">333</span></a><span class="sd">        - calculates the noise threshold</span>
</span><span id="MassSpecBase.process_mass_spec-334"><a href="#MassSpecBase.process_mass_spec-334"><span class="linenos">334</span></a><span class="sd">        - does peak picking (creates mspeak_objs)</span>
</span><span id="MassSpecBase.process_mass_spec-335"><a href="#MassSpecBase.process_mass_spec-335"><span class="linenos">335</span></a><span class="sd">        - resets the mspeak_obj indexes</span>
</span><span id="MassSpecBase.process_mass_spec-336"><a href="#MassSpecBase.process_mass_spec-336"><span class="linenos">336</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.process_mass_spec-337"><a href="#MassSpecBase.process_mass_spec-337"><span class="linenos">337</span></a>
</span><span id="MassSpecBase.process_mass_spec-338"><a href="#MassSpecBase.process_mass_spec-338"><span class="linenos">338</span></a>        <span class="c1"># if runned mannually make sure to rerun filter_by_noise_threshold</span>
</span><span id="MassSpecBase.process_mass_spec-339"><a href="#MassSpecBase.process_mass_spec-339"><span class="linenos">339</span></a>        <span class="c1"># calculates noise threshold</span>
</span><span id="MassSpecBase.process_mass_spec-340"><a href="#MassSpecBase.process_mass_spec-340"><span class="linenos">340</span></a>        <span class="c1"># do peak picking( create mspeak_objs)</span>
</span><span id="MassSpecBase.process_mass_spec-341"><a href="#MassSpecBase.process_mass_spec-341"><span class="linenos">341</span></a>        <span class="c1"># reset mspeak_obj the indexes</span>
</span><span id="MassSpecBase.process_mass_spec-342"><a href="#MassSpecBase.process_mass_spec-342"><span class="linenos">342</span></a>
</span><span id="MassSpecBase.process_mass_spec-343"><a href="#MassSpecBase.process_mass_spec-343"><span class="linenos">343</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cal_noise_threshold</span><span class="p">()</span>
</span><span id="MassSpecBase.process_mass_spec-344"><a href="#MassSpecBase.process_mass_spec-344"><span class="linenos">344</span></a>
</span><span id="MassSpecBase.process_mass_spec-345"><a href="#MassSpecBase.process_mass_spec-345"><span class="linenos">345</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">find_peaks</span><span class="p">()</span>
</span><span id="MassSpecBase.process_mass_spec-346"><a href="#MassSpecBase.process_mass_spec-346"><span class="linenos">346</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">reset_indexes</span><span class="p">()</span>
</span><span id="MassSpecBase.process_mass_spec-347"><a href="#MassSpecBase.process_mass_spec-347"><span class="linenos">347</span></a>
</span><span id="MassSpecBase.process_mass_spec-348"><a href="#MassSpecBase.process_mass_spec-348"><span class="linenos">348</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase.process_mass_spec-349"><a href="#MassSpecBase.process_mass_spec-349"><span class="linenos">349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="MassSpecBase.process_mass_spec-350"><a href="#MassSpecBase.process_mass_spec-350"><span class="linenos">350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.process_mass_spec-351"><a href="#MassSpecBase.process_mass_spec-351"><span class="linenos">351</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="MassSpecBase.process_mass_spec-352"><a href="#MassSpecBase.process_mass_spec-352"><span class="linenos">352</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">keep_profile</span><span class="p">:</span>
</span><span id="MassSpecBase.process_mass_spec-353"><a href="#MassSpecBase.process_mass_spec-353"><span class="linenos">353</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">*=</span> <span class="mi">0</span>
</span><span id="MassSpecBase.process_mass_spec-354"><a href="#MassSpecBase.process_mass_spec-354"><span class="linenos">354</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">*=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>Process the mass spectrum.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>keep_profile</strong> (bool, optional):
Whether to keep the profile data after processing. Defaults to True.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>This method does the following:</p>

<ul>
<li>calculates the noise threshold</li>
<li>does peak picking (creates mspeak_objs)</li>
<li>resets the mspeak_obj indexes</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.cal_noise_threshold" class="classattr">
                                        <input id="MassSpecBase.cal_noise_threshold-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cal_noise_threshold</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.cal_noise_threshold-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.cal_noise_threshold"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.cal_noise_threshold-356"><a href="#MassSpecBase.cal_noise_threshold-356"><span class="linenos">356</span></a>    <span class="k">def</span> <span class="nf">cal_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.cal_noise_threshold-357"><a href="#MassSpecBase.cal_noise_threshold-357"><span class="linenos">357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the noise threshold of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.cal_noise_threshold-358"><a href="#MassSpecBase.cal_noise_threshold-358"><span class="linenos">358</span></a>
</span><span id="MassSpecBase.cal_noise_threshold-359"><a href="#MassSpecBase.cal_noise_threshold-359"><span class="linenos">359</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">simulated_profile</span><span class="p">:</span>
</span><span id="MassSpecBase.cal_noise_threshold-360"><a href="#MassSpecBase.cal_noise_threshold-360"><span class="linenos">360</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span>
</span><span id="MassSpecBase.cal_noise_threshold-361"><a href="#MassSpecBase.cal_noise_threshold-361"><span class="linenos">361</span></a>
</span><span id="MassSpecBase.cal_noise_threshold-362"><a href="#MassSpecBase.cal_noise_threshold-362"><span class="linenos">362</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="MassSpecBase.cal_noise_threshold-363"><a href="#MassSpecBase.cal_noise_threshold-363"><span class="linenos">363</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecBase.cal_noise_threshold-364"><a href="#MassSpecBase.cal_noise_threshold-364"><span class="linenos">364</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_log_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecBase.cal_noise_threshold-365"><a href="#MassSpecBase.cal_noise_threshold-365"><span class="linenos">365</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase.cal_noise_threshold-366"><a href="#MassSpecBase.cal_noise_threshold-366"><span class="linenos">366</span></a>
</span><span id="MassSpecBase.cal_noise_threshold-367"><a href="#MassSpecBase.cal_noise_threshold-367"><span class="linenos">367</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.cal_noise_threshold-368"><a href="#MassSpecBase.cal_noise_threshold-368"><span class="linenos">368</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecBase.cal_noise_threshold-369"><a href="#MassSpecBase.cal_noise_threshold-369"><span class="linenos">369</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecBase.cal_noise_threshold-370"><a href="#MassSpecBase.cal_noise_threshold-370"><span class="linenos">370</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the noise threshold of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.parameters" class="classattr">
                                <div class="attr variable">
            <span class="name">parameters</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.parameters"></a>
    
            <div class="docstring"><p>Return the parameters of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.set_parameter_from_json" class="classattr">
                                        <input id="MassSpecBase.set_parameter_from_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_parameter_from_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">parameters_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.set_parameter_from_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.set_parameter_from_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.set_parameter_from_json-381"><a href="#MassSpecBase.set_parameter_from_json-381"><span class="linenos">381</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="MassSpecBase.set_parameter_from_json-382"><a href="#MassSpecBase.set_parameter_from_json-382"><span class="linenos">382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the parameters of the mass spectrum from a JSON file.</span>
</span><span id="MassSpecBase.set_parameter_from_json-383"><a href="#MassSpecBase.set_parameter_from_json-383"><span class="linenos">383</span></a>
</span><span id="MassSpecBase.set_parameter_from_json-384"><a href="#MassSpecBase.set_parameter_from_json-384"><span class="linenos">384</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.set_parameter_from_json-385"><a href="#MassSpecBase.set_parameter_from_json-385"><span class="linenos">385</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.set_parameter_from_json-386"><a href="#MassSpecBase.set_parameter_from_json-386"><span class="linenos">386</span></a><span class="sd">        parameters_path : str</span>
</span><span id="MassSpecBase.set_parameter_from_json-387"><a href="#MassSpecBase.set_parameter_from_json-387"><span class="linenos">387</span></a><span class="sd">            The path to the JSON file containing the parameters.</span>
</span><span id="MassSpecBase.set_parameter_from_json-388"><a href="#MassSpecBase.set_parameter_from_json-388"><span class="linenos">388</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.set_parameter_from_json-389"><a href="#MassSpecBase.set_parameter_from_json-389"><span class="linenos">389</span></a>        <span class="n">load_and_set_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the parameters of the mass spectrum from a JSON file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>parameters_path</strong> (str):
The path to the JSON file containing the parameters.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.set_parameter_from_toml" class="classattr">
                                        <input id="MassSpecBase.set_parameter_from_toml-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_parameter_from_toml</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">parameters_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.set_parameter_from_toml-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.set_parameter_from_toml"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.set_parameter_from_toml-391"><a href="#MassSpecBase.set_parameter_from_toml-391"><span class="linenos">391</span></a>    <span class="k">def</span> <span class="nf">set_parameter_from_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="p">):</span>
</span><span id="MassSpecBase.set_parameter_from_toml-392"><a href="#MassSpecBase.set_parameter_from_toml-392"><span class="linenos">392</span></a>        <span class="n">load_and_set_toml_parameters_ms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters_path</span><span class="o">=</span><span class="n">parameters_path</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MassSpecBase.mspeaks_settings" class="classattr">
                                <div class="attr variable">
            <span class="name">mspeaks_settings</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mspeaks_settings"></a>
    
            <div class="docstring"><p>Return the MS peak settings of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.settings" class="classattr">
                                <div class="attr variable">
            <span class="name">settings</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.settings"></a>
    
            <div class="docstring"><p>Return the settings of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.molecular_search_settings" class="classattr">
                                <div class="attr variable">
            <span class="name">molecular_search_settings</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.molecular_search_settings"></a>
    
            <div class="docstring"><p>Return the molecular search settings of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.mz_cal_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_cal_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mz_cal_profile"></a>
    
            <div class="docstring"><p>Return the calibrated m/z profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.mz_cal" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_cal</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mz_cal"></a>
    
            <div class="docstring"><p>Return the calibrated m/z values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.mz_exp" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_exp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mz_exp"></a>
    
            <div class="docstring"><p>Return the experimental m/z values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.freq_exp_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">freq_exp_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.freq_exp_profile"></a>
    
            <div class="docstring"><p>Return the experimental frequency profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.freq_exp_pp" class="classattr">
                                <div class="attr variable">
            <span class="name">freq_exp_pp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.freq_exp_pp"></a>
    
            <div class="docstring"><p>Return the experimental frequency values of the mass spectrum that are used for peak picking.</p>
</div>


                            </div>
                            <div id="MassSpecBase.mz_exp_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_exp_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mz_exp_profile"></a>
    
            <div class="docstring"><p>Return the experimental m/z profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.mz_exp_pp" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_exp_pp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.mz_exp_pp"></a>
    
            <div class="docstring"><p>Return the experimental m/z values of the mass spectrum that are used for peak picking.</p>
</div>


                            </div>
                            <div id="MassSpecBase.abundance_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">abundance_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.abundance_profile"></a>
    
            <div class="docstring"><p>Return the abundance profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.abundance_profile_pp" class="classattr">
                                <div class="attr variable">
            <span class="name">abundance_profile_pp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.abundance_profile_pp"></a>
    
            <div class="docstring"><p>Return the abundance profile of the mass spectrum that is used for peak picking.</p>
</div>


                            </div>
                            <div id="MassSpecBase.abundance" class="classattr">
                                <div class="attr variable">
            <span class="name">abundance</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.abundance"></a>
    
            <div class="docstring"><p>Return the abundance values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.freq_exp" class="classattr">
                                        <input id="MassSpecBase.freq_exp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">freq_exp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.freq_exp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.freq_exp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.freq_exp-518"><a href="#MassSpecBase.freq_exp-518"><span class="linenos">518</span></a>    <span class="k">def</span> <span class="nf">freq_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.freq_exp-519"><a href="#MassSpecBase.freq_exp-519"><span class="linenos">519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the experimental frequency values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.freq_exp-520"><a href="#MassSpecBase.freq_exp-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase.freq_exp-521"><a href="#MassSpecBase.freq_exp-521"><span class="linenos">521</span></a>        <span class="k">return</span> <span class="n">array</span><span class="p">([</span><span class="n">mspeak</span><span class="o">.</span><span class="n">freq_exp</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">])</span>
</span></pre></div>


            <div class="docstring"><p>Return the experimental frequency values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.resolving_power" class="classattr">
                                <div class="attr variable">
            <span class="name">resolving_power</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.resolving_power"></a>
    
            <div class="docstring"><p>Return the resolving power values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.signal_to_noise" class="classattr">
                                <div class="attr variable">
            <span class="name">signal_to_noise</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.signal_to_noise"></a>
    
    

                            </div>
                            <div id="MassSpecBase.nominal_mz" class="classattr">
                                <div class="attr variable">
            <span class="name">nominal_mz</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.nominal_mz"></a>
    
            <div class="docstring"><p>Return the nominal m/z values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.get_mz_and_abundance_peaks_tuples" class="classattr">
                                        <input id="MassSpecBase.get_mz_and_abundance_peaks_tuples-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_mz_and_abundance_peaks_tuples</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.get_mz_and_abundance_peaks_tuples-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.get_mz_and_abundance_peaks_tuples"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.get_mz_and_abundance_peaks_tuples-542"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples-542"><span class="linenos">542</span></a>    <span class="k">def</span> <span class="nf">get_mz_and_abundance_peaks_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.get_mz_and_abundance_peaks_tuples-543"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples-543"><span class="linenos">543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of tuples containing the m/z and abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.get_mz_and_abundance_peaks_tuples-544"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples-544"><span class="linenos">544</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks</span><span class="p">()</span>
</span><span id="MassSpecBase.get_mz_and_abundance_peaks_tuples-545"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples-545"><span class="linenos">545</span></a>        <span class="k">return</span> <span class="p">[(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span> <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of tuples containing the m/z and abundance values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.kmd" class="classattr">
                                <div class="attr variable">
            <span class="name">kmd</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.kmd"></a>
    
            <div class="docstring"><p>Return the Kendrick mass defect values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.kendrick_mass" class="classattr">
                                <div class="attr variable">
            <span class="name">kendrick_mass</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.kendrick_mass"></a>
    
            <div class="docstring"><p>Return the Kendrick mass values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.max_mz_exp" class="classattr">
                                <div class="attr variable">
            <span class="name">max_mz_exp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.max_mz_exp"></a>
    
            <div class="docstring"><p>Return the maximum experimental m/z value of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.min_mz_exp" class="classattr">
                                <div class="attr variable">
            <span class="name">min_mz_exp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.min_mz_exp"></a>
    
            <div class="docstring"><p>Return the minimum experimental m/z value of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.max_abundance" class="classattr">
                                <div class="attr variable">
            <span class="name">max_abundance</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.max_abundance"></a>
    
            <div class="docstring"><p>Return the maximum abundance value of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.max_signal_to_noise" class="classattr">
                                <div class="attr variable">
            <span class="name">max_signal_to_noise</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.max_signal_to_noise"></a>
    
            <div class="docstring"><p>Return the maximum signal-to-noise ratio of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.most_abundant_mspeak" class="classattr">
                                <div class="attr variable">
            <span class="name">most_abundant_mspeak</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.most_abundant_mspeak"></a>
    
            <div class="docstring"><p>Return the most abundant MSpeak object of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.min_abundance" class="classattr">
                                <div class="attr variable">
            <span class="name">min_abundance</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.min_abundance"></a>
    
            <div class="docstring"><p>Return the minimum abundance value of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.dynamic_range" class="classattr">
                                <div class="attr variable">
            <span class="name">dynamic_range</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.dynamic_range"></a>
    
            <div class="docstring"><p>Return the dynamic range of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.baseline_noise" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_noise</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.baseline_noise"></a>
    
            <div class="docstring"><p>Return the baseline noise of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.baseline_noise_std" class="classattr">
                                <div class="attr variable">
            <span class="name">baseline_noise_std</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.baseline_noise_std"></a>
    
            <div class="docstring"><p>Return the standard deviation of the baseline noise of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.Aterm" class="classattr">
                                <div class="attr variable">
            <span class="name">Aterm</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.Aterm"></a>
    
            <div class="docstring"><p>Return the A-term calibration coefficient of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.Bterm" class="classattr">
                                <div class="attr variable">
            <span class="name">Bterm</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.Bterm"></a>
    
            <div class="docstring"><p>Return the B-term calibration coefficient of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.Cterm" class="classattr">
                                <div class="attr variable">
            <span class="name">Cterm</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.Cterm"></a>
    
            <div class="docstring"><p>Return the C-term calibration coefficient of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.filename" class="classattr">
                                <div class="attr variable">
            <span class="name">filename</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.filename"></a>
    
            <div class="docstring"><p>Return the filename of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.dir_location" class="classattr">
                                <div class="attr variable">
            <span class="name">dir_location</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.dir_location"></a>
    
            <div class="docstring"><p>Return the directory location of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.sort_by_mz" class="classattr">
                                        <input id="MassSpecBase.sort_by_mz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_by_mz</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.sort_by_mz-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.sort_by_mz"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.sort_by_mz-638"><a href="#MassSpecBase.sort_by_mz-638"><span class="linenos">638</span></a>    <span class="k">def</span> <span class="nf">sort_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.sort_by_mz-639"><a href="#MassSpecBase.sort_by_mz-639"><span class="linenos">639</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by m/z values.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.sort_by_mz-640"><a href="#MassSpecBase.sort_by_mz-640"><span class="linenos">640</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sort the mass spectrum by m/z values.</p>
</div>


                            </div>
                            <div id="MassSpecBase.sort_by_abundance" class="classattr">
                                        <input id="MassSpecBase.sort_by_abundance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sort_by_abundance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">reverse</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.sort_by_abundance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.sort_by_abundance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.sort_by_abundance-642"><a href="#MassSpecBase.sort_by_abundance-642"><span class="linenos">642</span></a>    <span class="k">def</span> <span class="nf">sort_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase.sort_by_abundance-643"><a href="#MassSpecBase.sort_by_abundance-643"><span class="linenos">643</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by abundance values.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.sort_by_abundance-644"><a href="#MassSpecBase.sort_by_abundance-644"><span class="linenos">644</span></a>        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sort the mass spectrum by abundance values.</p>
</div>


                            </div>
                            <div id="MassSpecBase.tic" class="classattr">
                                <div class="attr variable">
            <span class="name">tic</span>

        
    </div>
    <a class="headerlink" href="#MassSpecBase.tic"></a>
    
            <div class="docstring"><p>Return the total ion current of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.check_mspeaks_warning" class="classattr">
                                        <input id="MassSpecBase.check_mspeaks_warning-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_mspeaks_warning</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.check_mspeaks_warning-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.check_mspeaks_warning"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.check_mspeaks_warning-651"><a href="#MassSpecBase.check_mspeaks_warning-651"><span class="linenos">651</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.check_mspeaks_warning-652"><a href="#MassSpecBase.check_mspeaks_warning-652"><span class="linenos">652</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="MassSpecBase.check_mspeaks_warning-653"><a href="#MassSpecBase.check_mspeaks_warning-653"><span class="linenos">653</span></a>
</span><span id="MassSpecBase.check_mspeaks_warning-654"><a href="#MassSpecBase.check_mspeaks_warning-654"><span class="linenos">654</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase.check_mspeaks_warning-655"><a href="#MassSpecBase.check_mspeaks_warning-655"><span class="linenos">655</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase.check_mspeaks_warning-656"><a href="#MassSpecBase.check_mspeaks_warning-656"><span class="linenos">656</span></a><span class="sd">        Warning</span>
</span><span id="MassSpecBase.check_mspeaks_warning-657"><a href="#MassSpecBase.check_mspeaks_warning-657"><span class="linenos">657</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="MassSpecBase.check_mspeaks_warning-658"><a href="#MassSpecBase.check_mspeaks_warning-658"><span class="linenos">658</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.check_mspeaks_warning-659"><a href="#MassSpecBase.check_mspeaks_warning-659"><span class="linenos">659</span></a>        <span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="MassSpecBase.check_mspeaks_warning-660"><a href="#MassSpecBase.check_mspeaks_warning-660"><span class="linenos">660</span></a>
</span><span id="MassSpecBase.check_mspeaks_warning-661"><a href="#MassSpecBase.check_mspeaks_warning-661"><span class="linenos">661</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase.check_mspeaks_warning-662"><a href="#MassSpecBase.check_mspeaks_warning-662"><span class="linenos">662</span></a>            <span class="k">pass</span>
</span><span id="MassSpecBase.check_mspeaks_warning-663"><a href="#MassSpecBase.check_mspeaks_warning-663"><span class="linenos">663</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.check_mspeaks_warning-664"><a href="#MassSpecBase.check_mspeaks_warning-664"><span class="linenos">664</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;mspeaks list is empty, continuing without filtering data&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check if the mass spectrum has MSpeaks objects.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>Warning</strong>: If the mass spectrum has no MSpeaks objects.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.check_mspeaks" class="classattr">
                                        <input id="MassSpecBase.check_mspeaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_mspeaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.check_mspeaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.check_mspeaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.check_mspeaks-666"><a href="#MassSpecBase.check_mspeaks-666"><span class="linenos">666</span></a>    <span class="k">def</span> <span class="nf">check_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.check_mspeaks-667"><a href="#MassSpecBase.check_mspeaks-667"><span class="linenos">667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if the mass spectrum has MSpeaks objects.</span>
</span><span id="MassSpecBase.check_mspeaks-668"><a href="#MassSpecBase.check_mspeaks-668"><span class="linenos">668</span></a>
</span><span id="MassSpecBase.check_mspeaks-669"><a href="#MassSpecBase.check_mspeaks-669"><span class="linenos">669</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase.check_mspeaks-670"><a href="#MassSpecBase.check_mspeaks-670"><span class="linenos">670</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase.check_mspeaks-671"><a href="#MassSpecBase.check_mspeaks-671"><span class="linenos">671</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase.check_mspeaks-672"><a href="#MassSpecBase.check_mspeaks-672"><span class="linenos">672</span></a><span class="sd">            If the mass spectrum has no MSpeaks objects.</span>
</span><span id="MassSpecBase.check_mspeaks-673"><a href="#MassSpecBase.check_mspeaks-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.check_mspeaks-674"><a href="#MassSpecBase.check_mspeaks-674"><span class="linenos">674</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase.check_mspeaks-675"><a href="#MassSpecBase.check_mspeaks-675"><span class="linenos">675</span></a>            <span class="k">pass</span>
</span><span id="MassSpecBase.check_mspeaks-676"><a href="#MassSpecBase.check_mspeaks-676"><span class="linenos">676</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.check_mspeaks-677"><a href="#MassSpecBase.check_mspeaks-677"><span class="linenos">677</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase.check_mspeaks-678"><a href="#MassSpecBase.check_mspeaks-678"><span class="linenos">678</span></a>                <span class="s2">&quot;mspeaks list is empty, please run process_mass_spec() first&quot;</span>
</span><span id="MassSpecBase.check_mspeaks-679"><a href="#MassSpecBase.check_mspeaks-679"><span class="linenos">679</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Check if the mass spectrum has MSpeaks objects.</p>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>Exception</strong>: If the mass spectrum has no MSpeaks objects.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.remove_assignment_by_index" class="classattr">
                                        <input id="MassSpecBase.remove_assignment_by_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_assignment_by_index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">indexes</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.remove_assignment_by_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.remove_assignment_by_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.remove_assignment_by_index-681"><a href="#MassSpecBase.remove_assignment_by_index-681"><span class="linenos">681</span></a>    <span class="k">def</span> <span class="nf">remove_assignment_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexes</span><span class="p">):</span>
</span><span id="MassSpecBase.remove_assignment_by_index-682"><a href="#MassSpecBase.remove_assignment_by_index-682"><span class="linenos">682</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove the molecular formula assignment of the MSpeaks objects at the specified indexes.</span>
</span><span id="MassSpecBase.remove_assignment_by_index-683"><a href="#MassSpecBase.remove_assignment_by_index-683"><span class="linenos">683</span></a>
</span><span id="MassSpecBase.remove_assignment_by_index-684"><a href="#MassSpecBase.remove_assignment_by_index-684"><span class="linenos">684</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.remove_assignment_by_index-685"><a href="#MassSpecBase.remove_assignment_by_index-685"><span class="linenos">685</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.remove_assignment_by_index-686"><a href="#MassSpecBase.remove_assignment_by_index-686"><span class="linenos">686</span></a><span class="sd">        indexes : list of int</span>
</span><span id="MassSpecBase.remove_assignment_by_index-687"><a href="#MassSpecBase.remove_assignment_by_index-687"><span class="linenos">687</span></a><span class="sd">            A list of indexes of the MSpeaks objects to remove the molecular formula assignment from.</span>
</span><span id="MassSpecBase.remove_assignment_by_index-688"><a href="#MassSpecBase.remove_assignment_by_index-688"><span class="linenos">688</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.remove_assignment_by_index-689"><a href="#MassSpecBase.remove_assignment_by_index-689"><span class="linenos">689</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">:</span>
</span><span id="MassSpecBase.remove_assignment_by_index-690"><a href="#MassSpecBase.remove_assignment_by_index-690"><span class="linenos">690</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">clear_molecular_formulas</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Remove the molecular formula assignment of the MSpeaks objects at the specified indexes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>indexes</strong> (list of int):
A list of indexes of the MSpeaks objects to remove the molecular formula assignment from.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_index" class="classattr">
                                        <input id="MassSpecBase.filter_by_index-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_index</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">list_indexes</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_index-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_index"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_index-692"><a href="#MassSpecBase.filter_by_index-692"><span class="linenos">692</span></a>    <span class="k">def</span> <span class="nf">filter_by_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_indexes</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_index-693"><a href="#MassSpecBase.filter_by_index-693"><span class="linenos">693</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified indexes.</span>
</span><span id="MassSpecBase.filter_by_index-694"><a href="#MassSpecBase.filter_by_index-694"><span class="linenos">694</span></a>
</span><span id="MassSpecBase.filter_by_index-695"><a href="#MassSpecBase.filter_by_index-695"><span class="linenos">695</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_index-696"><a href="#MassSpecBase.filter_by_index-696"><span class="linenos">696</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_index-697"><a href="#MassSpecBase.filter_by_index-697"><span class="linenos">697</span></a><span class="sd">        list_indexes : list of int</span>
</span><span id="MassSpecBase.filter_by_index-698"><a href="#MassSpecBase.filter_by_index-698"><span class="linenos">698</span></a><span class="sd">            A list of indexes of the MSpeaks objects to drop.</span>
</span><span id="MassSpecBase.filter_by_index-699"><a href="#MassSpecBase.filter_by_index-699"><span class="linenos">699</span></a>
</span><span id="MassSpecBase.filter_by_index-700"><a href="#MassSpecBase.filter_by_index-700"><span class="linenos">700</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_index-701"><a href="#MassSpecBase.filter_by_index-701"><span class="linenos">701</span></a>
</span><span id="MassSpecBase.filter_by_index-702"><a href="#MassSpecBase.filter_by_index-702"><span class="linenos">702</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_index-703"><a href="#MassSpecBase.filter_by_index-703"><span class="linenos">703</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_indexes</span>
</span><span id="MassSpecBase.filter_by_index-704"><a href="#MassSpecBase.filter_by_index-704"><span class="linenos">704</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_index-705"><a href="#MassSpecBase.filter_by_index-705"><span class="linenos">705</span></a>
</span><span id="MassSpecBase.filter_by_index-706"><a href="#MassSpecBase.filter_by_index-706"><span class="linenos">706</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_index-707"><a href="#MassSpecBase.filter_by_index-707"><span class="linenos">707</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="MassSpecBase.filter_by_index-708"><a href="#MassSpecBase.filter_by_index-708"><span class="linenos">708</span></a>
</span><span id="MassSpecBase.filter_by_index-709"><a href="#MassSpecBase.filter_by_index-709"><span class="linenos">709</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified indexes.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>list_indexes</strong> (list of int):
A list of indexes of the MSpeaks objects to drop.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_mz" class="classattr">
                                        <input id="MassSpecBase.filter_by_mz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_mz</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">min_mz</span>, </span><span class="param"><span class="n">max_mz</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_mz-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_mz"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_mz-711"><a href="#MassSpecBase.filter_by_mz-711"><span class="linenos">711</span></a>    <span class="k">def</span> <span class="nf">filter_by_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_mz</span><span class="p">,</span> <span class="n">max_mz</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_mz-712"><a href="#MassSpecBase.filter_by_mz-712"><span class="linenos">712</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified m/z range.</span>
</span><span id="MassSpecBase.filter_by_mz-713"><a href="#MassSpecBase.filter_by_mz-713"><span class="linenos">713</span></a>
</span><span id="MassSpecBase.filter_by_mz-714"><a href="#MassSpecBase.filter_by_mz-714"><span class="linenos">714</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_mz-715"><a href="#MassSpecBase.filter_by_mz-715"><span class="linenos">715</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_mz-716"><a href="#MassSpecBase.filter_by_mz-716"><span class="linenos">716</span></a><span class="sd">        min_mz : float</span>
</span><span id="MassSpecBase.filter_by_mz-717"><a href="#MassSpecBase.filter_by_mz-717"><span class="linenos">717</span></a><span class="sd">            The minimum m/z value to keep.</span>
</span><span id="MassSpecBase.filter_by_mz-718"><a href="#MassSpecBase.filter_by_mz-718"><span class="linenos">718</span></a><span class="sd">        max_mz : float</span>
</span><span id="MassSpecBase.filter_by_mz-719"><a href="#MassSpecBase.filter_by_mz-719"><span class="linenos">719</span></a><span class="sd">            The maximum m/z value to keep.</span>
</span><span id="MassSpecBase.filter_by_mz-720"><a href="#MassSpecBase.filter_by_mz-720"><span class="linenos">720</span></a>
</span><span id="MassSpecBase.filter_by_mz-721"><a href="#MassSpecBase.filter_by_mz-721"><span class="linenos">721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_mz-722"><a href="#MassSpecBase.filter_by_mz-722"><span class="linenos">722</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_mz-723"><a href="#MassSpecBase.filter_by_mz-723"><span class="linenos">723</span></a>        <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_mz-724"><a href="#MassSpecBase.filter_by_mz-724"><span class="linenos">724</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_mz-725"><a href="#MassSpecBase.filter_by_mz-725"><span class="linenos">725</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_mz-726"><a href="#MassSpecBase.filter_by_mz-726"><span class="linenos">726</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">min_mz</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz</span>
</span><span id="MassSpecBase.filter_by_mz-727"><a href="#MassSpecBase.filter_by_mz-727"><span class="linenos">727</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_mz-728"><a href="#MassSpecBase.filter_by_mz-728"><span class="linenos">728</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified m/z range.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>min_mz</strong> (float):
The minimum m/z value to keep.</li>
<li><strong>max_mz</strong> (float):
The maximum m/z value to keep.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_s2n" class="classattr">
                                        <input id="MassSpecBase.filter_by_s2n-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_s2n</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">min_s2n</span>, </span><span class="param"><span class="n">max_s2n</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_s2n-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_s2n"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_s2n-730"><a href="#MassSpecBase.filter_by_s2n-730"><span class="linenos">730</span></a>    <span class="k">def</span> <span class="nf">filter_by_s2n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_s2n</span><span class="p">,</span> <span class="n">max_s2n</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_s2n-731"><a href="#MassSpecBase.filter_by_s2n-731"><span class="linenos">731</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified signal-to-noise ratio range.</span>
</span><span id="MassSpecBase.filter_by_s2n-732"><a href="#MassSpecBase.filter_by_s2n-732"><span class="linenos">732</span></a>
</span><span id="MassSpecBase.filter_by_s2n-733"><a href="#MassSpecBase.filter_by_s2n-733"><span class="linenos">733</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_s2n-734"><a href="#MassSpecBase.filter_by_s2n-734"><span class="linenos">734</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_s2n-735"><a href="#MassSpecBase.filter_by_s2n-735"><span class="linenos">735</span></a><span class="sd">        min_s2n : float</span>
</span><span id="MassSpecBase.filter_by_s2n-736"><a href="#MassSpecBase.filter_by_s2n-736"><span class="linenos">736</span></a><span class="sd">            The minimum signal-to-noise ratio to keep.</span>
</span><span id="MassSpecBase.filter_by_s2n-737"><a href="#MassSpecBase.filter_by_s2n-737"><span class="linenos">737</span></a><span class="sd">        max_s2n : float, optional</span>
</span><span id="MassSpecBase.filter_by_s2n-738"><a href="#MassSpecBase.filter_by_s2n-738"><span class="linenos">738</span></a><span class="sd">            The maximum signal-to-noise ratio to keep. Defaults to False (no maximum).</span>
</span><span id="MassSpecBase.filter_by_s2n-739"><a href="#MassSpecBase.filter_by_s2n-739"><span class="linenos">739</span></a>
</span><span id="MassSpecBase.filter_by_s2n-740"><a href="#MassSpecBase.filter_by_s2n-740"><span class="linenos">740</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_s2n-741"><a href="#MassSpecBase.filter_by_s2n-741"><span class="linenos">741</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_s2n-742"><a href="#MassSpecBase.filter_by_s2n-742"><span class="linenos">742</span></a>        <span class="k">if</span> <span class="n">max_s2n</span><span class="p">:</span>
</span><span id="MassSpecBase.filter_by_s2n-743"><a href="#MassSpecBase.filter_by_s2n-743"><span class="linenos">743</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_s2n-744"><a href="#MassSpecBase.filter_by_s2n-744"><span class="linenos">744</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_s2n-745"><a href="#MassSpecBase.filter_by_s2n-745"><span class="linenos">745</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_s2n-746"><a href="#MassSpecBase.filter_by_s2n-746"><span class="linenos">746</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_s2n</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">max_s2n</span>
</span><span id="MassSpecBase.filter_by_s2n-747"><a href="#MassSpecBase.filter_by_s2n-747"><span class="linenos">747</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_s2n-748"><a href="#MassSpecBase.filter_by_s2n-748"><span class="linenos">748</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.filter_by_s2n-749"><a href="#MassSpecBase.filter_by_s2n-749"><span class="linenos">749</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_s2n-750"><a href="#MassSpecBase.filter_by_s2n-750"><span class="linenos">750</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_s2n-751"><a href="#MassSpecBase.filter_by_s2n-751"><span class="linenos">751</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_s2n-752"><a href="#MassSpecBase.filter_by_s2n-752"><span class="linenos">752</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">signal_to_noise</span> <span class="o">&lt;=</span> <span class="n">min_s2n</span>
</span><span id="MassSpecBase.filter_by_s2n-753"><a href="#MassSpecBase.filter_by_s2n-753"><span class="linenos">753</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_s2n-754"><a href="#MassSpecBase.filter_by_s2n-754"><span class="linenos">754</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified signal-to-noise ratio range.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>min_s2n</strong> (float):
The minimum signal-to-noise ratio to keep.</li>
<li><strong>max_s2n</strong> (float, optional):
The maximum signal-to-noise ratio to keep. Defaults to False (no maximum).</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_abundance" class="classattr">
                                        <input id="MassSpecBase.filter_by_abundance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_abundance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">min_abund</span>, </span><span class="param"><span class="n">max_abund</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_abundance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_abundance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_abundance-756"><a href="#MassSpecBase.filter_by_abundance-756"><span class="linenos">756</span></a>    <span class="k">def</span> <span class="nf">filter_by_abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_abund</span><span class="p">,</span> <span class="n">max_abund</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_abundance-757"><a href="#MassSpecBase.filter_by_abundance-757"><span class="linenos">757</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified abundance range.</span>
</span><span id="MassSpecBase.filter_by_abundance-758"><a href="#MassSpecBase.filter_by_abundance-758"><span class="linenos">758</span></a>
</span><span id="MassSpecBase.filter_by_abundance-759"><a href="#MassSpecBase.filter_by_abundance-759"><span class="linenos">759</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_abundance-760"><a href="#MassSpecBase.filter_by_abundance-760"><span class="linenos">760</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_abundance-761"><a href="#MassSpecBase.filter_by_abundance-761"><span class="linenos">761</span></a><span class="sd">        min_abund : float</span>
</span><span id="MassSpecBase.filter_by_abundance-762"><a href="#MassSpecBase.filter_by_abundance-762"><span class="linenos">762</span></a><span class="sd">            The minimum abundance to keep.</span>
</span><span id="MassSpecBase.filter_by_abundance-763"><a href="#MassSpecBase.filter_by_abundance-763"><span class="linenos">763</span></a><span class="sd">        max_abund : float, optional</span>
</span><span id="MassSpecBase.filter_by_abundance-764"><a href="#MassSpecBase.filter_by_abundance-764"><span class="linenos">764</span></a><span class="sd">            The maximum abundance to keep. Defaults to False (no maximum).</span>
</span><span id="MassSpecBase.filter_by_abundance-765"><a href="#MassSpecBase.filter_by_abundance-765"><span class="linenos">765</span></a>
</span><span id="MassSpecBase.filter_by_abundance-766"><a href="#MassSpecBase.filter_by_abundance-766"><span class="linenos">766</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_abundance-767"><a href="#MassSpecBase.filter_by_abundance-767"><span class="linenos">767</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_abundance-768"><a href="#MassSpecBase.filter_by_abundance-768"><span class="linenos">768</span></a>        <span class="k">if</span> <span class="n">max_abund</span><span class="p">:</span>
</span><span id="MassSpecBase.filter_by_abundance-769"><a href="#MassSpecBase.filter_by_abundance-769"><span class="linenos">769</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_abundance-770"><a href="#MassSpecBase.filter_by_abundance-770"><span class="linenos">770</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_abundance-771"><a href="#MassSpecBase.filter_by_abundance-771"><span class="linenos">771</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_abundance-772"><a href="#MassSpecBase.filter_by_abundance-772"><span class="linenos">772</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">min_abund</span> <span class="o">&lt;=</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">max_abund</span>
</span><span id="MassSpecBase.filter_by_abundance-773"><a href="#MassSpecBase.filter_by_abundance-773"><span class="linenos">773</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_abundance-774"><a href="#MassSpecBase.filter_by_abundance-774"><span class="linenos">774</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.filter_by_abundance-775"><a href="#MassSpecBase.filter_by_abundance-775"><span class="linenos">775</span></a>            <span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_abundance-776"><a href="#MassSpecBase.filter_by_abundance-776"><span class="linenos">776</span></a>                <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_abundance-777"><a href="#MassSpecBase.filter_by_abundance-777"><span class="linenos">777</span></a>                <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_abundance-778"><a href="#MassSpecBase.filter_by_abundance-778"><span class="linenos">778</span></a>                <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">min_abund</span>
</span><span id="MassSpecBase.filter_by_abundance-779"><a href="#MassSpecBase.filter_by_abundance-779"><span class="linenos">779</span></a>            <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_abundance-780"><a href="#MassSpecBase.filter_by_abundance-780"><span class="linenos">780</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified abundance range.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>min_abund</strong> (float):
The minimum abundance to keep.</li>
<li><strong>max_abund</strong> (float, optional):
The maximum abundance to keep. Defaults to False (no maximum).</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_max_resolving_power" class="classattr">
                                        <input id="MassSpecBase.filter_by_max_resolving_power-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_max_resolving_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">B</span>, </span><span class="param"><span class="n">T</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_max_resolving_power-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_max_resolving_power"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_max_resolving_power-782"><a href="#MassSpecBase.filter_by_max_resolving_power-782"><span class="linenos">782</span></a>    <span class="k">def</span> <span class="nf">filter_by_max_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-783"><a href="#MassSpecBase.filter_by_max_resolving_power-783"><span class="linenos">783</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified maximum resolving power.</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-784"><a href="#MassSpecBase.filter_by_max_resolving_power-784"><span class="linenos">784</span></a>
</span><span id="MassSpecBase.filter_by_max_resolving_power-785"><a href="#MassSpecBase.filter_by_max_resolving_power-785"><span class="linenos">785</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-786"><a href="#MassSpecBase.filter_by_max_resolving_power-786"><span class="linenos">786</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-787"><a href="#MassSpecBase.filter_by_max_resolving_power-787"><span class="linenos">787</span></a><span class="sd">        B : float</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-788"><a href="#MassSpecBase.filter_by_max_resolving_power-788"><span class="linenos">788</span></a><span class="sd">        T : float</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-789"><a href="#MassSpecBase.filter_by_max_resolving_power-789"><span class="linenos">789</span></a>
</span><span id="MassSpecBase.filter_by_max_resolving_power-790"><a href="#MassSpecBase.filter_by_max_resolving_power-790"><span class="linenos">790</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-791"><a href="#MassSpecBase.filter_by_max_resolving_power-791"><span class="linenos">791</span></a>
</span><span id="MassSpecBase.filter_by_max_resolving_power-792"><a href="#MassSpecBase.filter_by_max_resolving_power-792"><span class="linenos">792</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-793"><a href="#MassSpecBase.filter_by_max_resolving_power-793"><span class="linenos">793</span></a>
</span><span id="MassSpecBase.filter_by_max_resolving_power-794"><a href="#MassSpecBase.filter_by_max_resolving_power-794"><span class="linenos">794</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-795"><a href="#MassSpecBase.filter_by_max_resolving_power-795"><span class="linenos">795</span></a>
</span><span id="MassSpecBase.filter_by_max_resolving_power-796"><a href="#MassSpecBase.filter_by_max_resolving_power-796"><span class="linenos">796</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-797"><a href="#MassSpecBase.filter_by_max_resolving_power-797"><span class="linenos">797</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-798"><a href="#MassSpecBase.filter_by_max_resolving_power-798"><span class="linenos">798</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-799"><a href="#MassSpecBase.filter_by_max_resolving_power-799"><span class="linenos">799</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&gt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-800"><a href="#MassSpecBase.filter_by_max_resolving_power-800"><span class="linenos">800</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_max_resolving_power-801"><a href="#MassSpecBase.filter_by_max_resolving_power-801"><span class="linenos">801</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified maximum resolving power.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>B</strong> (float):</p></li>
<li><p><strong>T</strong> (float):</p></li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_mean_resolving_power" class="classattr">
                                        <input id="MassSpecBase.filter_by_mean_resolving_power-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_mean_resolving_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ndeviations</span><span class="o">=</span><span class="mi">3</span>, </span><span class="param"><span class="n">plot</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="n">guess_pars</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_mean_resolving_power-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_mean_resolving_power"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_mean_resolving_power-803"><a href="#MassSpecBase.filter_by_mean_resolving_power-803"><span class="linenos">803</span></a>    <span class="k">def</span> <span class="nf">filter_by_mean_resolving_power</span><span class="p">(</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-804"><a href="#MassSpecBase.filter_by_mean_resolving_power-804"><span class="linenos">804</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">guess_pars</span><span class="o">=</span><span class="kc">False</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-805"><a href="#MassSpecBase.filter_by_mean_resolving_power-805"><span class="linenos">805</span></a>    <span class="p">):</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-806"><a href="#MassSpecBase.filter_by_mean_resolving_power-806"><span class="linenos">806</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified mean resolving power.</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-807"><a href="#MassSpecBase.filter_by_mean_resolving_power-807"><span class="linenos">807</span></a>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-808"><a href="#MassSpecBase.filter_by_mean_resolving_power-808"><span class="linenos">808</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-809"><a href="#MassSpecBase.filter_by_mean_resolving_power-809"><span class="linenos">809</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-810"><a href="#MassSpecBase.filter_by_mean_resolving_power-810"><span class="linenos">810</span></a><span class="sd">        ndeviations : float, optional</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-811"><a href="#MassSpecBase.filter_by_mean_resolving_power-811"><span class="linenos">811</span></a><span class="sd">            The number of standard deviations to use for filtering. Defaults to 3.</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-812"><a href="#MassSpecBase.filter_by_mean_resolving_power-812"><span class="linenos">812</span></a><span class="sd">        plot : bool, optional</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-813"><a href="#MassSpecBase.filter_by_mean_resolving_power-813"><span class="linenos">813</span></a><span class="sd">            Whether to plot the resolving power distribution. Defaults to False.</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-814"><a href="#MassSpecBase.filter_by_mean_resolving_power-814"><span class="linenos">814</span></a><span class="sd">        guess_pars : bool, optional</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-815"><a href="#MassSpecBase.filter_by_mean_resolving_power-815"><span class="linenos">815</span></a><span class="sd">            Whether to guess the parameters for the Gaussian model. Defaults to False.</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-816"><a href="#MassSpecBase.filter_by_mean_resolving_power-816"><span class="linenos">816</span></a>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-817"><a href="#MassSpecBase.filter_by_mean_resolving_power-817"><span class="linenos">817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-818"><a href="#MassSpecBase.filter_by_mean_resolving_power-818"><span class="linenos">818</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-819"><a href="#MassSpecBase.filter_by_mean_resolving_power-819"><span class="linenos">819</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="n">MeanResolvingPowerFilter</span><span class="p">(</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-820"><a href="#MassSpecBase.filter_by_mean_resolving_power-820"><span class="linenos">820</span></a>            <span class="bp">self</span><span class="p">,</span> <span class="n">ndeviations</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">guess_pars</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-821"><a href="#MassSpecBase.filter_by_mean_resolving_power-821"><span class="linenos">821</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_mean_resolving_power-822"><a href="#MassSpecBase.filter_by_mean_resolving_power-822"><span class="linenos">822</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified mean resolving power.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ndeviations</strong> (float, optional):
The number of standard deviations to use for filtering. Defaults to 3.</li>
<li><strong>plot</strong> (bool, optional):
Whether to plot the resolving power distribution. Defaults to False.</li>
<li><strong>guess_pars</strong> (bool, optional):
Whether to guess the parameters for the Gaussian model. Defaults to False.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_min_resolving_power" class="classattr">
                                        <input id="MassSpecBase.filter_by_min_resolving_power-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_min_resolving_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">B</span>, </span><span class="param"><span class="n">T</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_min_resolving_power-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_min_resolving_power"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_min_resolving_power-824"><a href="#MassSpecBase.filter_by_min_resolving_power-824"><span class="linenos">824</span></a>    <span class="k">def</span> <span class="nf">filter_by_min_resolving_power</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-825"><a href="#MassSpecBase.filter_by_min_resolving_power-825"><span class="linenos">825</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the specified minimum resolving power.</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-826"><a href="#MassSpecBase.filter_by_min_resolving_power-826"><span class="linenos">826</span></a>
</span><span id="MassSpecBase.filter_by_min_resolving_power-827"><a href="#MassSpecBase.filter_by_min_resolving_power-827"><span class="linenos">827</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-828"><a href="#MassSpecBase.filter_by_min_resolving_power-828"><span class="linenos">828</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-829"><a href="#MassSpecBase.filter_by_min_resolving_power-829"><span class="linenos">829</span></a><span class="sd">        B : float</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-830"><a href="#MassSpecBase.filter_by_min_resolving_power-830"><span class="linenos">830</span></a><span class="sd">        T : float</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-831"><a href="#MassSpecBase.filter_by_min_resolving_power-831"><span class="linenos">831</span></a>
</span><span id="MassSpecBase.filter_by_min_resolving_power-832"><a href="#MassSpecBase.filter_by_min_resolving_power-832"><span class="linenos">832</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-833"><a href="#MassSpecBase.filter_by_min_resolving_power-833"><span class="linenos">833</span></a>        <span class="n">rpe</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">m</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.274e7</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">B</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-834"><a href="#MassSpecBase.filter_by_min_resolving_power-834"><span class="linenos">834</span></a>
</span><span id="MassSpecBase.filter_by_min_resolving_power-835"><a href="#MassSpecBase.filter_by_min_resolving_power-835"><span class="linenos">835</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-836"><a href="#MassSpecBase.filter_by_min_resolving_power-836"><span class="linenos">836</span></a>
</span><span id="MassSpecBase.filter_by_min_resolving_power-837"><a href="#MassSpecBase.filter_by_min_resolving_power-837"><span class="linenos">837</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-838"><a href="#MassSpecBase.filter_by_min_resolving_power-838"><span class="linenos">838</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-839"><a href="#MassSpecBase.filter_by_min_resolving_power-839"><span class="linenos">839</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-840"><a href="#MassSpecBase.filter_by_min_resolving_power-840"><span class="linenos">840</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">resolving_power</span> <span class="o">&lt;=</span> <span class="n">rpe</span><span class="p">(</span><span class="n">mspeak</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">ion_charge</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-841"><a href="#MassSpecBase.filter_by_min_resolving_power-841"><span class="linenos">841</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_min_resolving_power-842"><a href="#MassSpecBase.filter_by_min_resolving_power-842"><span class="linenos">842</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the specified minimum resolving power.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><p><strong>B</strong> (float):</p></li>
<li><p><strong>T</strong> (float):</p></li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.filter_by_noise_threshold" class="classattr">
                                        <input id="MassSpecBase.filter_by_noise_threshold-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_noise_threshold</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.filter_by_noise_threshold-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.filter_by_noise_threshold"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.filter_by_noise_threshold-844"><a href="#MassSpecBase.filter_by_noise_threshold-844"><span class="linenos">844</span></a>    <span class="k">def</span> <span class="nf">filter_by_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-845"><a href="#MassSpecBase.filter_by_noise_threshold-845"><span class="linenos">845</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the mass spectrum by the noise threshold.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-846"><a href="#MassSpecBase.filter_by_noise_threshold-846"><span class="linenos">846</span></a>
</span><span id="MassSpecBase.filter_by_noise_threshold-847"><a href="#MassSpecBase.filter_by_noise_threshold-847"><span class="linenos">847</span></a>        <span class="n">threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-848"><a href="#MassSpecBase.filter_by_noise_threshold-848"><span class="linenos">848</span></a>
</span><span id="MassSpecBase.filter_by_noise_threshold-849"><a href="#MassSpecBase.filter_by_noise_threshold-849"><span class="linenos">849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">check_mspeaks_warning</span><span class="p">()</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-850"><a href="#MassSpecBase.filter_by_noise_threshold-850"><span class="linenos">850</span></a>
</span><span id="MassSpecBase.filter_by_noise_threshold-851"><a href="#MassSpecBase.filter_by_noise_threshold-851"><span class="linenos">851</span></a>        <span class="n">indexes_to_remove</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-852"><a href="#MassSpecBase.filter_by_noise_threshold-852"><span class="linenos">852</span></a>            <span class="n">index</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-853"><a href="#MassSpecBase.filter_by_noise_threshold-853"><span class="linenos">853</span></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">)</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-854"><a href="#MassSpecBase.filter_by_noise_threshold-854"><span class="linenos">854</span></a>            <span class="k">if</span> <span class="n">mspeak</span><span class="o">.</span><span class="n">abundance</span> <span class="o">&lt;=</span> <span class="n">threshold</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-855"><a href="#MassSpecBase.filter_by_noise_threshold-855"><span class="linenos">855</span></a>        <span class="p">]</span>
</span><span id="MassSpecBase.filter_by_noise_threshold-856"><a href="#MassSpecBase.filter_by_noise_threshold-856"><span class="linenos">856</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">filter_by_index</span><span class="p">(</span><span class="n">indexes_to_remove</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Filter the mass spectrum by the noise threshold.</p>
</div>


                            </div>
                            <div id="MassSpecBase.find_peaks" class="classattr">
                                        <input id="MassSpecBase.find_peaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">find_peaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.find_peaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.find_peaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.find_peaks-858"><a href="#MassSpecBase.find_peaks-858"><span class="linenos">858</span></a>    <span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.find_peaks-859"><a href="#MassSpecBase.find_peaks-859"><span class="linenos">859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the peaks of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.find_peaks-860"><a href="#MassSpecBase.find_peaks-860"><span class="linenos">860</span></a>        <span class="c1"># needs to clear previous results from peak_picking</span>
</span><span id="MassSpecBase.find_peaks-861"><a href="#MassSpecBase.find_peaks-861"><span class="linenos">861</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="MassSpecBase.find_peaks-862"><a href="#MassSpecBase.find_peaks-862"><span class="linenos">862</span></a>
</span><span id="MassSpecBase.find_peaks-863"><a href="#MassSpecBase.find_peaks-863"><span class="linenos">863</span></a>        <span class="c1"># then do peak picking</span>
</span><span id="MassSpecBase.find_peaks-864"><a href="#MassSpecBase.find_peaks-864"><span class="linenos">864</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">do_peak_picking</span><span class="p">()</span>
</span><span id="MassSpecBase.find_peaks-865"><a href="#MassSpecBase.find_peaks-865"><span class="linenos">865</span></a>        <span class="c1"># print(&quot;A total of %i peaks were found&quot; % len(self._mspeaks))</span>
</span></pre></div>


            <div class="docstring"><p>Find the peaks of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecBase.change_kendrick_base_all_mspeaks" class="classattr">
                                        <input id="MassSpecBase.change_kendrick_base_all_mspeaks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_kendrick_base_all_mspeaks</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">kendrick_dict_base</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.change_kendrick_base_all_mspeaks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.change_kendrick_base_all_mspeaks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-867"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-867"><span class="linenos">867</span></a>    <span class="k">def</span> <span class="nf">change_kendrick_base_all_mspeaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kendrick_dict_base</span><span class="p">):</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-868"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-868"><span class="linenos">868</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Change the Kendrick base of all MSpeaks objects.</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-869"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-869"><span class="linenos">869</span></a>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-870"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-870"><span class="linenos">870</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-871"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-871"><span class="linenos">871</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-872"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-872"><span class="linenos">872</span></a><span class="sd">        kendrick_dict_base : dict</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-873"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-873"><span class="linenos">873</span></a><span class="sd">            A dictionary of the Kendrick base to change to.</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-874"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-874"><span class="linenos">874</span></a>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-875"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-875"><span class="linenos">875</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-876"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-876"><span class="linenos">876</span></a><span class="sd">        -----</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-877"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-877"><span class="linenos">877</span></a><span class="sd">        Example of kendrick_dict_base parameter: kendrick_dict_base = {&quot;C&quot;: 1, &quot;H&quot;: 2} or {&quot;C&quot;: 1, &quot;H&quot;: 1, &quot;O&quot;:1} etc</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-878"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-878"><span class="linenos">878</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-879"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-879"><span class="linenos">879</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">ms_peak</span><span class="o">.</span><span class="n">kendrick_base</span> <span class="o">=</span> <span class="n">kendrick_dict_base</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-880"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-880"><span class="linenos">880</span></a>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-881"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-881"><span class="linenos">881</span></a>        <span class="k">for</span> <span class="n">mspeak</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase.change_kendrick_base_all_mspeaks-882"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks-882"><span class="linenos">882</span></a>            <span class="n">mspeak</span><span class="o">.</span><span class="n">change_kendrick_base</span><span class="p">(</span><span class="n">kendrick_dict_base</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Change the Kendrick base of all MSpeaks objects.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>kendrick_dict_base</strong> (dict):
A dictionary of the Kendrick base to change to.</li>
</ul>

<h6 id="notes">Notes</h6>

<p>Example of kendrick_dict_base parameter: kendrick_dict_base = {"C": 1, "H": 2} or {"C": 1, "H": 1, "O":1} etc</p>
</div>


                            </div>
                            <div id="MassSpecBase.get_nominal_mz_first_last_indexes" class="classattr">
                                        <input id="MassSpecBase.get_nominal_mz_first_last_indexes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_nominal_mz_first_last_indexes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nominal_mass</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.get_nominal_mz_first_last_indexes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.get_nominal_mz_first_last_indexes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-884"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-884"><span class="linenos">884</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mz_first_last_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">):</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-885"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-885"><span class="linenos">885</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-886"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-886"><span class="linenos">886</span></a>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-887"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-887"><span class="linenos">887</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-888"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-888"><span class="linenos">888</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-889"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-889"><span class="linenos">889</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-890"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-890"><span class="linenos">890</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-891"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-891"><span class="linenos">891</span></a>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-892"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-892"><span class="linenos">892</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-893"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-893"><span class="linenos">893</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-894"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-894"><span class="linenos">894</span></a><span class="sd">        tuple</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-895"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-895"><span class="linenos">895</span></a><span class="sd">            A tuple containing the first and last indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-896"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-897"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-897"><span class="linenos">897</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="p">:</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-898"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-898"><span class="linenos">898</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-899"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-899"><span class="linenos">899</span></a>                <span class="k">return</span> <span class="p">(</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-900"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-900"><span class="linenos">900</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-901"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-901"><span class="linenos">901</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_dict_nominal_masses_indexes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-902"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-902"><span class="linenos">902</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-903"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-903"><span class="linenos">903</span></a>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-904"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-904"><span class="linenos">904</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-905"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-905"><span class="linenos">905</span></a>                <span class="c1"># import warnings</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-906"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-906"><span class="linenos">906</span></a>                <span class="c1"># uncomment warn to distribution</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-907"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-907"><span class="linenos">907</span></a>                <span class="c1"># warnings.warn(&quot;Nominal mass not found in _dict_nominal_masses_indexes, returning (0, 0) for nominal mass %i&quot;%nominal_mass)</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-908"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-908"><span class="linenos">908</span></a>                <span class="k">return</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-909"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-909"><span class="linenos">909</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-910"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-910"><span class="linenos">910</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-911"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-911"><span class="linenos">911</span></a>                <span class="s2">&quot;run process_mass_spec() function before trying to access the data&quot;</span>
</span><span id="MassSpecBase.get_nominal_mz_first_last_indexes-912"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes-912"><span class="linenos">912</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the first and last indexes of the MSpeaks objects with the specified nominal mass.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nominal_mass</strong> (int):
The nominal mass to get the indexes for.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: A tuple containing the first and last indexes of the MSpeaks objects with the specified nominal mass.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.get_masses_count_by_nominal_mass" class="classattr">
                                        <input id="MassSpecBase.get_masses_count_by_nominal_mass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_masses_count_by_nominal_mass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.get_masses_count_by_nominal_mass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.get_masses_count_by_nominal_mass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.get_masses_count_by_nominal_mass-914"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-914"><span class="linenos">914</span></a>    <span class="k">def</span> <span class="nf">get_masses_count_by_nominal_mass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-915"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-915"><span class="linenos">915</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-916"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-916"><span class="linenos">916</span></a>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-917"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-917"><span class="linenos">917</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-918"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-918"><span class="linenos">918</span></a>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-919"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-919"><span class="linenos">919</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-920"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-920"><span class="linenos">920</span></a>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-921"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-921"><span class="linenos">921</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-922"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-922"><span class="linenos">922</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-923"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-923"><span class="linenos">923</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-924"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-924"><span class="linenos">924</span></a>                    <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_nominal_mass_indexes</span><span class="p">(</span><span class="n">nominal_mass</span><span class="p">))</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-925"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-925"><span class="linenos">925</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-926"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-926"><span class="linenos">926</span></a>
</span><span id="MassSpecBase.get_masses_count_by_nominal_mass-927"><a href="#MassSpecBase.get_masses_count_by_nominal_mass-927"><span class="linenos">927</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span></pre></div>


            <div class="docstring"><p>Return a dictionary of the nominal masses and their counts.</p>
</div>


                            </div>
                            <div id="MassSpecBase.datapoints_count_by_nominal_mz" class="classattr">
                                        <input id="MassSpecBase.datapoints_count_by_nominal_mz-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">datapoints_count_by_nominal_mz</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mz_overlay</span><span class="o">=</span><span class="mf">0.1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.datapoints_count_by_nominal_mz-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.datapoints_count_by_nominal_mz"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.datapoints_count_by_nominal_mz-929"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-929"><span class="linenos">929</span></a>    <span class="k">def</span> <span class="nf">datapoints_count_by_nominal_mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mz_overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-930"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-930"><span class="linenos">930</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dictionary of the nominal masses and their counts.</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-931"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-931"><span class="linenos">931</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-932"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-932"><span class="linenos">932</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-933"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-933"><span class="linenos">933</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-934"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-934"><span class="linenos">934</span></a><span class="sd">        mz_overlay : float, optional</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-935"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-935"><span class="linenos">935</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-936"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-936"><span class="linenos">936</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-937"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-937"><span class="linenos">937</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-938"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-938"><span class="linenos">938</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-939"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-939"><span class="linenos">939</span></a><span class="sd">        dict</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-940"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-940"><span class="linenos">940</span></a><span class="sd">            A dictionary of the nominal masses and their counts.</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-941"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-941"><span class="linenos">941</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-942"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-942"><span class="linenos">942</span></a>        <span class="n">dict_nominal_masses_count</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-943"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-943"><span class="linenos">943</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-944"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-944"><span class="linenos">944</span></a>        <span class="n">all_nominal_masses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">nominal_mz_exp</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">]))</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-945"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-945"><span class="linenos">945</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-946"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-946"><span class="linenos">946</span></a>        <span class="k">for</span> <span class="n">nominal_mass</span> <span class="ow">in</span> <span class="n">all_nominal_masses</span><span class="p">:</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-947"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-947"><span class="linenos">947</span></a>            <span class="k">if</span> <span class="n">nominal_mass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_nominal_masses_count</span><span class="p">:</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-948"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-948"><span class="linenos">948</span></a>                <span class="n">min_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">mz_overlay</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-949"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-949"><span class="linenos">949</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-950"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-950"><span class="linenos">950</span></a>                <span class="n">max_mz</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">mz_overlay</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-951"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-951"><span class="linenos">951</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-952"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-952"><span class="linenos">952</span></a>                <span class="n">indexes</span> <span class="o">=</span> <span class="n">indexes</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-953"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-953"><span class="linenos">953</span></a>                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&gt;</span> <span class="n">min_mz</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span> <span class="o">&lt;</span> <span class="n">max_mz</span><span class="p">)</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-954"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-954"><span class="linenos">954</span></a>                <span class="p">)</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-955"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-955"><span class="linenos">955</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-956"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-956"><span class="linenos">956</span></a>                <span class="n">dict_nominal_masses_count</span><span class="p">[</span><span class="n">nominal_mass</span><span class="p">]</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-957"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-957"><span class="linenos">957</span></a>
</span><span id="MassSpecBase.datapoints_count_by_nominal_mz-958"><a href="#MassSpecBase.datapoints_count_by_nominal_mz-958"><span class="linenos">958</span></a>        <span class="k">return</span> <span class="n">dict_nominal_masses_count</span>
</span></pre></div>


            <div class="docstring"><p>Return a dictionary of the nominal masses and their counts.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mz_overlay</strong> (float, optional):
The m/z overlay to use for counting. Defaults to 0.1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>dict</strong>: A dictionary of the nominal masses and their counts.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.get_nominal_mass_indexes" class="classattr">
                                        <input id="MassSpecBase.get_nominal_mass_indexes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_nominal_mass_indexes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nominal_mass</span>, </span><span class="param"><span class="n">overlay</span><span class="o">=</span><span class="mf">0.1</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.get_nominal_mass_indexes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.get_nominal_mass_indexes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.get_nominal_mass_indexes-960"><a href="#MassSpecBase.get_nominal_mass_indexes-960"><span class="linenos">960</span></a>    <span class="k">def</span> <span class="nf">get_nominal_mass_indexes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nominal_mass</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-961"><a href="#MassSpecBase.get_nominal_mass_indexes-961"><span class="linenos">961</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-962"><a href="#MassSpecBase.get_nominal_mass_indexes-962"><span class="linenos">962</span></a>
</span><span id="MassSpecBase.get_nominal_mass_indexes-963"><a href="#MassSpecBase.get_nominal_mass_indexes-963"><span class="linenos">963</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-964"><a href="#MassSpecBase.get_nominal_mass_indexes-964"><span class="linenos">964</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-965"><a href="#MassSpecBase.get_nominal_mass_indexes-965"><span class="linenos">965</span></a><span class="sd">        nominal_mass : int</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-966"><a href="#MassSpecBase.get_nominal_mass_indexes-966"><span class="linenos">966</span></a><span class="sd">            The nominal mass to get the indexes for.</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-967"><a href="#MassSpecBase.get_nominal_mass_indexes-967"><span class="linenos">967</span></a><span class="sd">        overlay : float, optional</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-968"><a href="#MassSpecBase.get_nominal_mass_indexes-968"><span class="linenos">968</span></a><span class="sd">            The m/z overlay to use for counting. Defaults to 0.1.</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-969"><a href="#MassSpecBase.get_nominal_mass_indexes-969"><span class="linenos">969</span></a>
</span><span id="MassSpecBase.get_nominal_mass_indexes-970"><a href="#MassSpecBase.get_nominal_mass_indexes-970"><span class="linenos">970</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-971"><a href="#MassSpecBase.get_nominal_mass_indexes-971"><span class="linenos">971</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-972"><a href="#MassSpecBase.get_nominal_mass_indexes-972"><span class="linenos">972</span></a><span class="sd">        generator</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-973"><a href="#MassSpecBase.get_nominal_mass_indexes-973"><span class="linenos">973</span></a><span class="sd">            A generator of the indexes of the MSpeaks objects with the specified nominal mass.</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-974"><a href="#MassSpecBase.get_nominal_mass_indexes-974"><span class="linenos">974</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-975"><a href="#MassSpecBase.get_nominal_mass_indexes-975"><span class="linenos">975</span></a>        <span class="n">min_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">-</span> <span class="n">overlay</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-976"><a href="#MassSpecBase.get_nominal_mass_indexes-976"><span class="linenos">976</span></a>        <span class="n">max_mz_to_look</span> <span class="o">=</span> <span class="n">nominal_mass</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">overlay</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-977"><a href="#MassSpecBase.get_nominal_mass_indexes-977"><span class="linenos">977</span></a>
</span><span id="MassSpecBase.get_nominal_mass_indexes-978"><a href="#MassSpecBase.get_nominal_mass_indexes-978"><span class="linenos">978</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-979"><a href="#MassSpecBase.get_nominal_mass_indexes-979"><span class="linenos">979</span></a>            <span class="n">i</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-980"><a href="#MassSpecBase.get_nominal_mass_indexes-980"><span class="linenos">980</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">))</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-981"><a href="#MassSpecBase.get_nominal_mass_indexes-981"><span class="linenos">981</span></a>            <span class="k">if</span> <span class="n">min_mz_to_look</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mz_exp</span> <span class="o">&lt;=</span> <span class="n">max_mz_to_look</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-982"><a href="#MassSpecBase.get_nominal_mass_indexes-982"><span class="linenos">982</span></a>        <span class="p">)</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-983"><a href="#MassSpecBase.get_nominal_mass_indexes-983"><span class="linenos">983</span></a>
</span><span id="MassSpecBase.get_nominal_mass_indexes-984"><a href="#MassSpecBase.get_nominal_mass_indexes-984"><span class="linenos">984</span></a>        <span class="c1"># indexes = (i for i in range(len(self.mspeaks)) if min_mz_to_look &lt;= self.mspeaks[i].mz_exp &lt;= max_mz_to_look)</span>
</span><span id="MassSpecBase.get_nominal_mass_indexes-985"><a href="#MassSpecBase.get_nominal_mass_indexes-985"><span class="linenos">985</span></a>        <span class="c1"># return indexes</span>
</span></pre></div>


            <div class="docstring"><p>Return the indexes of the MSpeaks objects with the specified nominal mass.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>nominal_mass</strong> (int):
The nominal mass to get the indexes for.</li>
<li><strong>overlay</strong> (float, optional):
The m/z overlay to use for counting. Defaults to 0.1.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>generator</strong>: A generator of the indexes of the MSpeaks objects with the specified nominal mass.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.plot_centroid" class="classattr">
                                        <input id="MassSpecBase.plot_centroid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_centroid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.plot_centroid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.plot_centroid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.plot_centroid-1012"><a href="#MassSpecBase.plot_centroid-1012"><span class="linenos">1012</span></a>    <span class="k">def</span> <span class="nf">plot_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">):</span>
</span><span id="MassSpecBase.plot_centroid-1013"><a href="#MassSpecBase.plot_centroid-1013"><span class="linenos">1013</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the centroid data of the mass spectrum.</span>
</span><span id="MassSpecBase.plot_centroid-1014"><a href="#MassSpecBase.plot_centroid-1014"><span class="linenos">1014</span></a>
</span><span id="MassSpecBase.plot_centroid-1015"><a href="#MassSpecBase.plot_centroid-1015"><span class="linenos">1015</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.plot_centroid-1016"><a href="#MassSpecBase.plot_centroid-1016"><span class="linenos">1016</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.plot_centroid-1017"><a href="#MassSpecBase.plot_centroid-1017"><span class="linenos">1017</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase.plot_centroid-1018"><a href="#MassSpecBase.plot_centroid-1018"><span class="linenos">1018</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase.plot_centroid-1019"><a href="#MassSpecBase.plot_centroid-1019"><span class="linenos">1019</span></a><span class="sd">        c : str, optional</span>
</span><span id="MassSpecBase.plot_centroid-1020"><a href="#MassSpecBase.plot_centroid-1020"><span class="linenos">1020</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;g&#39; (green).</span>
</span><span id="MassSpecBase.plot_centroid-1021"><a href="#MassSpecBase.plot_centroid-1021"><span class="linenos">1021</span></a>
</span><span id="MassSpecBase.plot_centroid-1022"><a href="#MassSpecBase.plot_centroid-1022"><span class="linenos">1022</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.plot_centroid-1023"><a href="#MassSpecBase.plot_centroid-1023"><span class="linenos">1023</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.plot_centroid-1024"><a href="#MassSpecBase.plot_centroid-1024"><span class="linenos">1024</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase.plot_centroid-1025"><a href="#MassSpecBase.plot_centroid-1025"><span class="linenos">1025</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase.plot_centroid-1026"><a href="#MassSpecBase.plot_centroid-1026"><span class="linenos">1026</span></a>
</span><span id="MassSpecBase.plot_centroid-1027"><a href="#MassSpecBase.plot_centroid-1027"><span class="linenos">1027</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase.plot_centroid-1028"><a href="#MassSpecBase.plot_centroid-1028"><span class="linenos">1028</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase.plot_centroid-1029"><a href="#MassSpecBase.plot_centroid-1029"><span class="linenos">1029</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase.plot_centroid-1030"><a href="#MassSpecBase.plot_centroid-1030"><span class="linenos">1030</span></a><span class="sd">            If no centroid data is found.</span>
</span><span id="MassSpecBase.plot_centroid-1031"><a href="#MassSpecBase.plot_centroid-1031"><span class="linenos">1031</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.plot_centroid-1032"><a href="#MassSpecBase.plot_centroid-1032"><span class="linenos">1032</span></a>
</span><span id="MassSpecBase.plot_centroid-1033"><a href="#MassSpecBase.plot_centroid-1033"><span class="linenos">1033</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase.plot_centroid-1034"><a href="#MassSpecBase.plot_centroid-1034"><span class="linenos">1034</span></a>
</span><span id="MassSpecBase.plot_centroid-1035"><a href="#MassSpecBase.plot_centroid-1035"><span class="linenos">1035</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_centroid-1036"><a href="#MassSpecBase.plot_centroid-1036"><span class="linenos">1036</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_centroid-1037"><a href="#MassSpecBase.plot_centroid-1037"><span class="linenos">1037</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase.plot_centroid-1038"><a href="#MassSpecBase.plot_centroid-1038"><span class="linenos">1038</span></a>
</span><span id="MassSpecBase.plot_centroid-1039"><a href="#MassSpecBase.plot_centroid-1039"><span class="linenos">1039</span></a>            <span class="n">markerline_a</span><span class="p">,</span> <span class="n">stemlines_a</span><span class="p">,</span> <span class="n">baseline_a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span>
</span><span id="MassSpecBase.plot_centroid-1040"><a href="#MassSpecBase.plot_centroid-1040"><span class="linenos">1040</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">,</span> <span class="n">linefmt</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s2">&quot; &quot;</span>
</span><span id="MassSpecBase.plot_centroid-1041"><a href="#MassSpecBase.plot_centroid-1041"><span class="linenos">1041</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1042"><a href="#MassSpecBase.plot_centroid-1042"><span class="linenos">1042</span></a>
</span><span id="MassSpecBase.plot_centroid-1043"><a href="#MassSpecBase.plot_centroid-1043"><span class="linenos">1043</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1044"><a href="#MassSpecBase.plot_centroid-1044"><span class="linenos">1044</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemlines_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1045"><a href="#MassSpecBase.plot_centroid-1045"><span class="linenos">1045</span></a>            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">baseline_a</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1046"><a href="#MassSpecBase.plot_centroid-1046"><span class="linenos">1046</span></a>
</span><span id="MassSpecBase.plot_centroid-1047"><a href="#MassSpecBase.plot_centroid-1047"><span class="linenos">1047</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1048"><a href="#MassSpecBase.plot_centroid-1048"><span class="linenos">1048</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1049"><a href="#MassSpecBase.plot_centroid-1049"><span class="linenos">1049</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1050"><a href="#MassSpecBase.plot_centroid-1050"><span class="linenos">1050</span></a>
</span><span id="MassSpecBase.plot_centroid-1051"><a href="#MassSpecBase.plot_centroid-1051"><span class="linenos">1051</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1052"><a href="#MassSpecBase.plot_centroid-1052"><span class="linenos">1052</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1053"><a href="#MassSpecBase.plot_centroid-1053"><span class="linenos">1053</span></a>
</span><span id="MassSpecBase.plot_centroid-1054"><a href="#MassSpecBase.plot_centroid-1054"><span class="linenos">1054</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1055"><a href="#MassSpecBase.plot_centroid-1055"><span class="linenos">1055</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1056"><a href="#MassSpecBase.plot_centroid-1056"><span class="linenos">1056</span></a>
</span><span id="MassSpecBase.plot_centroid-1057"><a href="#MassSpecBase.plot_centroid-1057"><span class="linenos">1057</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_centroid-1058"><a href="#MassSpecBase.plot_centroid-1058"><span class="linenos">1058</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;No centroid data found, please run process_mass_spec&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_centroid-1059"><a href="#MassSpecBase.plot_centroid-1059"><span class="linenos">1059</span></a>
</span><span id="MassSpecBase.plot_centroid-1060"><a href="#MassSpecBase.plot_centroid-1060"><span class="linenos">1060</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Plot the centroid data of the mass spectrum.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ax</strong> (matplotlib.axes.Axes, optional):
The matplotlib axes to plot on. Defaults to None.</li>
<li><strong>c</strong> (str, optional):
The color to use for the plot. Defaults to 'g' (green).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>matplotlib.axes.Axes</strong>: The matplotlib axes containing the plot.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>Exception</strong>: If no centroid data is found.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.plot_profile_and_noise_threshold" class="classattr">
                                        <input id="MassSpecBase.plot_profile_and_noise_threshold-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_profile_and_noise_threshold</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">legend</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.plot_profile_and_noise_threshold-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.plot_profile_and_noise_threshold"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.plot_profile_and_noise_threshold-1062"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1062"><span class="linenos">1062</span></a>    <span class="k">def</span> <span class="nf">plot_profile_and_noise_threshold</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1063"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1063"><span class="linenos">1063</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the profile data and noise threshold of the mass spectrum.</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1064"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1064"><span class="linenos">1064</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1065"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1065"><span class="linenos">1065</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1066"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1066"><span class="linenos">1066</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1067"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1067"><span class="linenos">1067</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1068"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1068"><span class="linenos">1068</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1069"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1069"><span class="linenos">1069</span></a><span class="sd">        legend : bool, optional</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1070"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1070"><span class="linenos">1070</span></a><span class="sd">            Whether to show the legend. Defaults to False.</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1071"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1071"><span class="linenos">1071</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1072"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1072"><span class="linenos">1072</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1073"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1073"><span class="linenos">1073</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1074"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1074"><span class="linenos">1074</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1075"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1075"><span class="linenos">1075</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1076"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1076"><span class="linenos">1076</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1077"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1077"><span class="linenos">1077</span></a><span class="sd">        Raises</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1078"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1078"><span class="linenos">1078</span></a><span class="sd">        ------</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1079"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1079"><span class="linenos">1079</span></a><span class="sd">        Exception</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1080"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1080"><span class="linenos">1080</span></a><span class="sd">            If no noise threshold is found.</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1081"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1081"><span class="linenos">1081</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1082"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1082"><span class="linenos">1082</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1083"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1083"><span class="linenos">1083</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1084"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1084"><span class="linenos">1084</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise_std</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1085"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1085"><span class="linenos">1085</span></a>            <span class="c1"># x = (self.mz_exp_profile.min(), self.mz_exp_profile.max())</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1086"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1086"><span class="linenos">1086</span></a>            <span class="n">baseline</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline_noise</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1087"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1087"><span class="linenos">1087</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1088"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1088"><span class="linenos">1088</span></a>            <span class="c1"># std = self.parameters.mass_spectrum.noise_threshold_min_std</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1089"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1089"><span class="linenos">1089</span></a>            <span class="c1"># threshold = self.baseline_noise_std + (std * self.baseline_noise_std)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1090"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1090"><span class="linenos">1090</span></a>            <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_noise_threshold</span><span class="p">()</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1091"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1091"><span class="linenos">1091</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1092"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1092"><span class="linenos">1092</span></a>            <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1093"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1093"><span class="linenos">1093</span></a>                <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1094"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1094"><span class="linenos">1094</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1095"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1095"><span class="linenos">1095</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1096"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1096"><span class="linenos">1096</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1097"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1097"><span class="linenos">1097</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1098"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1098"><span class="linenos">1098</span></a>                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1099"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1099"><span class="linenos">1099</span></a>                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Spectrum&quot;</span><span class="p">,</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1100"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1100"><span class="linenos">1100</span></a>            <span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1101"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1101"><span class="linenos">1101</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">baseline</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Baseline Noise&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1102"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1102"><span class="linenos">1102</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Noise Threshold&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1103"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1103"><span class="linenos">1103</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1104"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1104"><span class="linenos">1104</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\t</span><span class="s2">{m/z}$&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1105"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1105"><span class="linenos">1105</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Abundance&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1106"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1106"><span class="linenos">1106</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1107"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1107"><span class="linenos">1107</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1108"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1108"><span class="linenos">1108</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1109"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1109"><span class="linenos">1109</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1110"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1110"><span class="linenos">1110</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1111"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1111"><span class="linenos">1111</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1112"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1112"><span class="linenos">1112</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1113"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1113"><span class="linenos">1113</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1114"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1114"><span class="linenos">1114</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1115"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1115"><span class="linenos">1115</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1116"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1116"><span class="linenos">1116</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1117"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1117"><span class="linenos">1117</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Calculate noise threshold first&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1118"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1118"><span class="linenos">1118</span></a>
</span><span id="MassSpecBase.plot_profile_and_noise_threshold-1119"><a href="#MassSpecBase.plot_profile_and_noise_threshold-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Plot the profile data and noise threshold of the mass spectrum.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>ax</strong> (matplotlib.axes.Axes, optional):
The matplotlib axes to plot on. Defaults to None.</li>
<li><strong>legend</strong> (bool, optional):
Whether to show the legend. Defaults to False.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>matplotlib.axes.Axes</strong>: The matplotlib axes containing the plot.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>Exception</strong>: If no noise threshold is found.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.plot_mz_domain_profile" class="classattr">
                                        <input id="MassSpecBase.plot_mz_domain_profile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_mz_domain_profile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>, </span><span class="param"><span class="n">ax</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.plot_mz_domain_profile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.plot_mz_domain_profile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.plot_mz_domain_profile-1121"><a href="#MassSpecBase.plot_mz_domain_profile-1121"><span class="linenos">1121</span></a>    <span class="k">def</span> <span class="nf">plot_mz_domain_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1122"><a href="#MassSpecBase.plot_mz_domain_profile-1122"><span class="linenos">1122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the m/z domain profile of the mass spectrum.</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1123"><a href="#MassSpecBase.plot_mz_domain_profile-1123"><span class="linenos">1123</span></a>
</span><span id="MassSpecBase.plot_mz_domain_profile-1124"><a href="#MassSpecBase.plot_mz_domain_profile-1124"><span class="linenos">1124</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1125"><a href="#MassSpecBase.plot_mz_domain_profile-1125"><span class="linenos">1125</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1126"><a href="#MassSpecBase.plot_mz_domain_profile-1126"><span class="linenos">1126</span></a><span class="sd">        color : str, optional</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1127"><a href="#MassSpecBase.plot_mz_domain_profile-1127"><span class="linenos">1127</span></a><span class="sd">            The color to use for the plot. Defaults to &#39;green&#39;.</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1128"><a href="#MassSpecBase.plot_mz_domain_profile-1128"><span class="linenos">1128</span></a><span class="sd">        ax : matplotlib.axes.Axes, optional</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1129"><a href="#MassSpecBase.plot_mz_domain_profile-1129"><span class="linenos">1129</span></a><span class="sd">            The matplotlib axes to plot on. Defaults to None.</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1130"><a href="#MassSpecBase.plot_mz_domain_profile-1130"><span class="linenos">1130</span></a>
</span><span id="MassSpecBase.plot_mz_domain_profile-1131"><a href="#MassSpecBase.plot_mz_domain_profile-1131"><span class="linenos">1131</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1132"><a href="#MassSpecBase.plot_mz_domain_profile-1132"><span class="linenos">1132</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1133"><a href="#MassSpecBase.plot_mz_domain_profile-1133"><span class="linenos">1133</span></a><span class="sd">        matplotlib.axes.Axes</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1134"><a href="#MassSpecBase.plot_mz_domain_profile-1134"><span class="linenos">1134</span></a><span class="sd">            The matplotlib axes containing the plot.</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1135"><a href="#MassSpecBase.plot_mz_domain_profile-1135"><span class="linenos">1135</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1136"><a href="#MassSpecBase.plot_mz_domain_profile-1136"><span class="linenos">1136</span></a>
</span><span id="MassSpecBase.plot_mz_domain_profile-1137"><a href="#MassSpecBase.plot_mz_domain_profile-1137"><span class="linenos">1137</span></a>        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1138"><a href="#MassSpecBase.plot_mz_domain_profile-1138"><span class="linenos">1138</span></a>
</span><span id="MassSpecBase.plot_mz_domain_profile-1139"><a href="#MassSpecBase.plot_mz_domain_profile-1139"><span class="linenos">1139</span></a>        <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1140"><a href="#MassSpecBase.plot_mz_domain_profile-1140"><span class="linenos">1140</span></a>            <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1141"><a href="#MassSpecBase.plot_mz_domain_profile-1141"><span class="linenos">1141</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp_profile</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance_profile</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1142"><a href="#MassSpecBase.plot_mz_domain_profile-1142"><span class="linenos">1142</span></a>        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;m/z&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;abundance&quot;</span><span class="p">)</span>
</span><span id="MassSpecBase.plot_mz_domain_profile-1143"><a href="#MassSpecBase.plot_mz_domain_profile-1143"><span class="linenos">1143</span></a>
</span><span id="MassSpecBase.plot_mz_domain_profile-1144"><a href="#MassSpecBase.plot_mz_domain_profile-1144"><span class="linenos">1144</span></a>        <span class="k">return</span> <span class="n">ax</span>
</span></pre></div>


            <div class="docstring"><p>Plot the m/z domain profile of the mass spectrum.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>color</strong> (str, optional):
The color to use for the plot. Defaults to 'green'.</li>
<li><strong>ax</strong> (matplotlib.axes.Axes, optional):
The matplotlib axes to plot on. Defaults to None.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>matplotlib.axes.Axes</strong>: The matplotlib axes containing the plot.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_excel" class="classattr">
                                        <input id="MassSpecBase.to_excel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_excel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">out_file_path</span>, </span><span class="param"><span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_excel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_excel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_excel-1146"><a href="#MassSpecBase.to_excel-1146"><span class="linenos">1146</span></a>    <span class="k">def</span> <span class="nf">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase.to_excel-1147"><a href="#MassSpecBase.to_excel-1147"><span class="linenos">1147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an Excel file.</span>
</span><span id="MassSpecBase.to_excel-1148"><a href="#MassSpecBase.to_excel-1148"><span class="linenos">1148</span></a>
</span><span id="MassSpecBase.to_excel-1149"><a href="#MassSpecBase.to_excel-1149"><span class="linenos">1149</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.to_excel-1150"><a href="#MassSpecBase.to_excel-1150"><span class="linenos">1150</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.to_excel-1151"><a href="#MassSpecBase.to_excel-1151"><span class="linenos">1151</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase.to_excel-1152"><a href="#MassSpecBase.to_excel-1152"><span class="linenos">1152</span></a><span class="sd">            The path to the Excel file to export to.</span>
</span><span id="MassSpecBase.to_excel-1153"><a href="#MassSpecBase.to_excel-1153"><span class="linenos">1153</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase.to_excel-1154"><a href="#MassSpecBase.to_excel-1154"><span class="linenos">1154</span></a><span class="sd">            Whether to write the metadata to the Excel file. Defaults to True.</span>
</span><span id="MassSpecBase.to_excel-1155"><a href="#MassSpecBase.to_excel-1155"><span class="linenos">1155</span></a>
</span><span id="MassSpecBase.to_excel-1156"><a href="#MassSpecBase.to_excel-1156"><span class="linenos">1156</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.to_excel-1157"><a href="#MassSpecBase.to_excel-1157"><span class="linenos">1157</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.to_excel-1158"><a href="#MassSpecBase.to_excel-1158"><span class="linenos">1158</span></a><span class="sd">        None</span>
</span><span id="MassSpecBase.to_excel-1159"><a href="#MassSpecBase.to_excel-1159"><span class="linenos">1159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_excel-1160"><a href="#MassSpecBase.to_excel-1160"><span class="linenos">1160</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_excel-1161"><a href="#MassSpecBase.to_excel-1161"><span class="linenos">1161</span></a>
</span><span id="MassSpecBase.to_excel-1162"><a href="#MassSpecBase.to_excel-1162"><span class="linenos">1162</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_excel-1163"><a href="#MassSpecBase.to_excel-1163"><span class="linenos">1163</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export the mass spectrum to an Excel file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>out_file_path</strong> (str):
The path to the Excel file to export to.</li>
<li><strong>write_metadata</strong> (bool, optional):
Whether to write the metadata to the Excel file. Defaults to True.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_hdf" class="classattr">
                                        <input id="MassSpecBase.to_hdf-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_hdf</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">out_file_path</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_hdf-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_hdf"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_hdf-1165"><a href="#MassSpecBase.to_hdf-1165"><span class="linenos">1165</span></a>    <span class="k">def</span> <span class="nf">to_hdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">):</span>
</span><span id="MassSpecBase.to_hdf-1166"><a href="#MassSpecBase.to_hdf-1166"><span class="linenos">1166</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to an HDF file.</span>
</span><span id="MassSpecBase.to_hdf-1167"><a href="#MassSpecBase.to_hdf-1167"><span class="linenos">1167</span></a>
</span><span id="MassSpecBase.to_hdf-1168"><a href="#MassSpecBase.to_hdf-1168"><span class="linenos">1168</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.to_hdf-1169"><a href="#MassSpecBase.to_hdf-1169"><span class="linenos">1169</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.to_hdf-1170"><a href="#MassSpecBase.to_hdf-1170"><span class="linenos">1170</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase.to_hdf-1171"><a href="#MassSpecBase.to_hdf-1171"><span class="linenos">1171</span></a><span class="sd">            The path to the HDF file to export to.</span>
</span><span id="MassSpecBase.to_hdf-1172"><a href="#MassSpecBase.to_hdf-1172"><span class="linenos">1172</span></a>
</span><span id="MassSpecBase.to_hdf-1173"><a href="#MassSpecBase.to_hdf-1173"><span class="linenos">1173</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.to_hdf-1174"><a href="#MassSpecBase.to_hdf-1174"><span class="linenos">1174</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.to_hdf-1175"><a href="#MassSpecBase.to_hdf-1175"><span class="linenos">1175</span></a><span class="sd">        None</span>
</span><span id="MassSpecBase.to_hdf-1176"><a href="#MassSpecBase.to_hdf-1176"><span class="linenos">1176</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_hdf-1177"><a href="#MassSpecBase.to_hdf-1177"><span class="linenos">1177</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_hdf-1178"><a href="#MassSpecBase.to_hdf-1178"><span class="linenos">1178</span></a>
</span><span id="MassSpecBase.to_hdf-1179"><a href="#MassSpecBase.to_hdf-1179"><span class="linenos">1179</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_hdf-1180"><a href="#MassSpecBase.to_hdf-1180"><span class="linenos">1180</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_hdf</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Export the mass spectrum to an HDF file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>out_file_path</strong> (str):
The path to the HDF file to export to.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_csv" class="classattr">
                                        <input id="MassSpecBase.to_csv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_csv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">out_file_path</span>, </span><span class="param"><span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_csv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_csv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_csv-1182"><a href="#MassSpecBase.to_csv-1182"><span class="linenos">1182</span></a>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase.to_csv-1183"><a href="#MassSpecBase.to_csv-1183"><span class="linenos">1183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a CSV file.</span>
</span><span id="MassSpecBase.to_csv-1184"><a href="#MassSpecBase.to_csv-1184"><span class="linenos">1184</span></a>
</span><span id="MassSpecBase.to_csv-1185"><a href="#MassSpecBase.to_csv-1185"><span class="linenos">1185</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.to_csv-1186"><a href="#MassSpecBase.to_csv-1186"><span class="linenos">1186</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.to_csv-1187"><a href="#MassSpecBase.to_csv-1187"><span class="linenos">1187</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase.to_csv-1188"><a href="#MassSpecBase.to_csv-1188"><span class="linenos">1188</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="MassSpecBase.to_csv-1189"><a href="#MassSpecBase.to_csv-1189"><span class="linenos">1189</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase.to_csv-1190"><a href="#MassSpecBase.to_csv-1190"><span class="linenos">1190</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="MassSpecBase.to_csv-1191"><a href="#MassSpecBase.to_csv-1191"><span class="linenos">1191</span></a>
</span><span id="MassSpecBase.to_csv-1192"><a href="#MassSpecBase.to_csv-1192"><span class="linenos">1192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_csv-1193"><a href="#MassSpecBase.to_csv-1193"><span class="linenos">1193</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_csv-1194"><a href="#MassSpecBase.to_csv-1194"><span class="linenos">1194</span></a>
</span><span id="MassSpecBase.to_csv-1195"><a href="#MassSpecBase.to_csv-1195"><span class="linenos">1195</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_csv-1196"><a href="#MassSpecBase.to_csv-1196"><span class="linenos">1196</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export the mass spectrum to a CSV file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>out_file_path</strong> (str):
The path to the CSV file to export to.</li>
<li><strong>write_metadata</strong> (bool, optional):
Whether to write the metadata to the CSV file. Defaults to True.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_pandas" class="classattr">
                                        <input id="MassSpecBase.to_pandas-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_pandas</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">out_file_path</span>, </span><span class="param"><span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_pandas-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_pandas"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_pandas-1198"><a href="#MassSpecBase.to_pandas-1198"><span class="linenos">1198</span></a>    <span class="k">def</span> <span class="nf">to_pandas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_file_path</span><span class="p">,</span> <span class="n">write_metadata</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecBase.to_pandas-1199"><a href="#MassSpecBase.to_pandas-1199"><span class="linenos">1199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Export the mass spectrum to a Pandas dataframe with pkl extension.</span>
</span><span id="MassSpecBase.to_pandas-1200"><a href="#MassSpecBase.to_pandas-1200"><span class="linenos">1200</span></a>
</span><span id="MassSpecBase.to_pandas-1201"><a href="#MassSpecBase.to_pandas-1201"><span class="linenos">1201</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.to_pandas-1202"><a href="#MassSpecBase.to_pandas-1202"><span class="linenos">1202</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.to_pandas-1203"><a href="#MassSpecBase.to_pandas-1203"><span class="linenos">1203</span></a><span class="sd">        out_file_path : str</span>
</span><span id="MassSpecBase.to_pandas-1204"><a href="#MassSpecBase.to_pandas-1204"><span class="linenos">1204</span></a><span class="sd">            The path to the CSV file to export to.</span>
</span><span id="MassSpecBase.to_pandas-1205"><a href="#MassSpecBase.to_pandas-1205"><span class="linenos">1205</span></a><span class="sd">        write_metadata : bool, optional</span>
</span><span id="MassSpecBase.to_pandas-1206"><a href="#MassSpecBase.to_pandas-1206"><span class="linenos">1206</span></a><span class="sd">            Whether to write the metadata to the CSV file. Defaults to True.</span>
</span><span id="MassSpecBase.to_pandas-1207"><a href="#MassSpecBase.to_pandas-1207"><span class="linenos">1207</span></a>
</span><span id="MassSpecBase.to_pandas-1208"><a href="#MassSpecBase.to_pandas-1208"><span class="linenos">1208</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_pandas-1209"><a href="#MassSpecBase.to_pandas-1209"><span class="linenos">1209</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_pandas-1210"><a href="#MassSpecBase.to_pandas-1210"><span class="linenos">1210</span></a>
</span><span id="MassSpecBase.to_pandas-1211"><a href="#MassSpecBase.to_pandas-1211"><span class="linenos">1211</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="n">out_file_path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_pandas-1212"><a href="#MassSpecBase.to_pandas-1212"><span class="linenos">1212</span></a>        <span class="n">exportMS</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">(</span><span class="n">write_metadata</span><span class="o">=</span><span class="n">write_metadata</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Export the mass spectrum to a Pandas dataframe with pkl extension.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>out_file_path</strong> (str):
The path to the CSV file to export to.</li>
<li><strong>write_metadata</strong> (bool, optional):
Whether to write the metadata to the CSV file. Defaults to True.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_dataframe" class="classattr">
                                        <input id="MassSpecBase.to_dataframe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_dataframe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">additional_columns</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_dataframe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_dataframe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_dataframe-1214"><a href="#MassSpecBase.to_dataframe-1214"><span class="linenos">1214</span></a>    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">additional_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="MassSpecBase.to_dataframe-1215"><a href="#MassSpecBase.to_dataframe-1215"><span class="linenos">1215</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a Pandas dataframe.</span>
</span><span id="MassSpecBase.to_dataframe-1216"><a href="#MassSpecBase.to_dataframe-1216"><span class="linenos">1216</span></a>
</span><span id="MassSpecBase.to_dataframe-1217"><a href="#MassSpecBase.to_dataframe-1217"><span class="linenos">1217</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecBase.to_dataframe-1218"><a href="#MassSpecBase.to_dataframe-1218"><span class="linenos">1218</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecBase.to_dataframe-1219"><a href="#MassSpecBase.to_dataframe-1219"><span class="linenos">1219</span></a><span class="sd">        additional_columns : list, optional</span>
</span><span id="MassSpecBase.to_dataframe-1220"><a href="#MassSpecBase.to_dataframe-1220"><span class="linenos">1220</span></a><span class="sd">            A list of additional columns to include in the dataframe. Defaults to None.</span>
</span><span id="MassSpecBase.to_dataframe-1221"><a href="#MassSpecBase.to_dataframe-1221"><span class="linenos">1221</span></a><span class="sd">            Suitable columns are: &quot;Aromaticity Index&quot;, &quot;Aromaticity Index (modified)&quot;, and &quot;NOSC&quot;</span>
</span><span id="MassSpecBase.to_dataframe-1222"><a href="#MassSpecBase.to_dataframe-1222"><span class="linenos">1222</span></a>
</span><span id="MassSpecBase.to_dataframe-1223"><a href="#MassSpecBase.to_dataframe-1223"><span class="linenos">1223</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecBase.to_dataframe-1224"><a href="#MassSpecBase.to_dataframe-1224"><span class="linenos">1224</span></a><span class="sd">        -------</span>
</span><span id="MassSpecBase.to_dataframe-1225"><a href="#MassSpecBase.to_dataframe-1225"><span class="linenos">1225</span></a><span class="sd">        pandas.DataFrame</span>
</span><span id="MassSpecBase.to_dataframe-1226"><a href="#MassSpecBase.to_dataframe-1226"><span class="linenos">1226</span></a><span class="sd">            The mass spectrum as a Pandas dataframe.</span>
</span><span id="MassSpecBase.to_dataframe-1227"><a href="#MassSpecBase.to_dataframe-1227"><span class="linenos">1227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_dataframe-1228"><a href="#MassSpecBase.to_dataframe-1228"><span class="linenos">1228</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_dataframe-1229"><a href="#MassSpecBase.to_dataframe-1229"><span class="linenos">1229</span></a>
</span><span id="MassSpecBase.to_dataframe-1230"><a href="#MassSpecBase.to_dataframe-1230"><span class="linenos">1230</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_dataframe-1231"><a href="#MassSpecBase.to_dataframe-1231"><span class="linenos">1231</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">get_pandas_df</span><span class="p">(</span><span class="n">additional_columns</span><span class="o">=</span><span class="n">additional_columns</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return the mass spectrum as a Pandas dataframe.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>additional_columns</strong> (list, optional):
A list of additional columns to include in the dataframe. Defaults to None.
Suitable columns are: "Aromaticity Index", "Aromaticity Index (modified)", and "NOSC"</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>pandas.DataFrame</strong>: The mass spectrum as a Pandas dataframe.</li>
</ul>
</div>


                            </div>
                            <div id="MassSpecBase.to_json" class="classattr">
                                        <input id="MassSpecBase.to_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.to_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.to_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.to_json-1233"><a href="#MassSpecBase.to_json-1233"><span class="linenos">1233</span></a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.to_json-1234"><a href="#MassSpecBase.to_json-1234"><span class="linenos">1234</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the mass spectrum as a JSON file.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.to_json-1235"><a href="#MassSpecBase.to_json-1235"><span class="linenos">1235</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.to_json-1236"><a href="#MassSpecBase.to_json-1236"><span class="linenos">1236</span></a>
</span><span id="MassSpecBase.to_json-1237"><a href="#MassSpecBase.to_json-1237"><span class="linenos">1237</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.to_json-1238"><a href="#MassSpecBase.to_json-1238"><span class="linenos">1238</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Return the mass spectrum as a JSON file.</p>
</div>


                            </div>
                            <div id="MassSpecBase.parameters_json" class="classattr">
                                        <input id="MassSpecBase.parameters_json-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parameters_json</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.parameters_json-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.parameters_json"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.parameters_json-1240"><a href="#MassSpecBase.parameters_json-1240"><span class="linenos">1240</span></a>    <span class="k">def</span> <span class="nf">parameters_json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.parameters_json-1241"><a href="#MassSpecBase.parameters_json-1241"><span class="linenos">1241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a JSON string.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.parameters_json-1242"><a href="#MassSpecBase.parameters_json-1242"><span class="linenos">1242</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.parameters_json-1243"><a href="#MassSpecBase.parameters_json-1243"><span class="linenos">1243</span></a>
</span><span id="MassSpecBase.parameters_json-1244"><a href="#MassSpecBase.parameters_json-1244"><span class="linenos">1244</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.parameters_json-1245"><a href="#MassSpecBase.parameters_json-1245"><span class="linenos">1245</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_json</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Return the parameters of the mass spectrum as a JSON string.</p>
</div>


                            </div>
                            <div id="MassSpecBase.parameters_toml" class="classattr">
                                        <input id="MassSpecBase.parameters_toml-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parameters_toml</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecBase.parameters_toml-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecBase.parameters_toml"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecBase.parameters_toml-1247"><a href="#MassSpecBase.parameters_toml-1247"><span class="linenos">1247</span></a>    <span class="k">def</span> <span class="nf">parameters_toml</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecBase.parameters_toml-1248"><a href="#MassSpecBase.parameters_toml-1248"><span class="linenos">1248</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the parameters of the mass spectrum as a TOML string.&quot;&quot;&quot;</span>
</span><span id="MassSpecBase.parameters_toml-1249"><a href="#MassSpecBase.parameters_toml-1249"><span class="linenos">1249</span></a>        <span class="kn">from</span> <span class="nn">corems.mass_spectrum.output.export</span> <span class="kn">import</span> <span class="n">HighResMassSpecExport</span>
</span><span id="MassSpecBase.parameters_toml-1250"><a href="#MassSpecBase.parameters_toml-1250"><span class="linenos">1250</span></a>
</span><span id="MassSpecBase.parameters_toml-1251"><a href="#MassSpecBase.parameters_toml-1251"><span class="linenos">1251</span></a>        <span class="n">exportMS</span> <span class="o">=</span> <span class="n">HighResMassSpecExport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</span><span id="MassSpecBase.parameters_toml-1252"><a href="#MassSpecBase.parameters_toml-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="n">exportMS</span><span class="o">.</span><span class="n">parameters_to_toml</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Return the parameters of the mass spectrum as a TOML string.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></dt>
                                <dd id="MassSpecBase.percentile_assigned" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.percentile_assigned">percentile_assigned</a></dd>
                <dd id="MassSpecBase.resolving_power_calc" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.resolving_power_calc">resolving_power_calc</a></dd>
                <dd id="MassSpecBase.number_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.number_average_molecular_weight">number_average_molecular_weight</a></dd>
                <dd id="MassSpecBase.weight_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.weight_average_molecular_weight">weight_average_molecular_weight</a></dd>

            </div>
            <div><dt><a href="../calc/PeakPicking.html#PeakPicking">corems.mass_spectrum.calc.PeakPicking.PeakPicking</a></dt>
                                <dd id="MassSpecBase.prepare_peak_picking_data" class="function"><a href="../calc/PeakPicking.html#PeakPicking.prepare_peak_picking_data">prepare_peak_picking_data</a></dd>
                <dd id="MassSpecBase.cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cut_mz_domain_peak_picking">cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecBase.legacy_cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.legacy_cut_mz_domain_peak_picking">legacy_cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecBase.extrapolate_axis" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axis">extrapolate_axis</a></dd>
                <dd id="MassSpecBase.extrapolate_axes_for_pp" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axes_for_pp">extrapolate_axes_for_pp</a></dd>
                <dd id="MassSpecBase.do_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.do_peak_picking">do_peak_picking</a></dd>
                <dd id="MassSpecBase.find_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_minima">find_minima</a></dd>
                <dd id="MassSpecBase.linear_fit_calc" class="function"><a href="../calc/PeakPicking.html#PeakPicking.linear_fit_calc">linear_fit_calc</a></dd>
                <dd id="MassSpecBase.calculate_resolving_power" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calculate_resolving_power">calculate_resolving_power</a></dd>
                <dd id="MassSpecBase.cal_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cal_minima">cal_minima</a></dd>
                <dd id="MassSpecBase.calc_centroid" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid">calc_centroid</a></dd>
                <dd id="MassSpecBase.get_threshold" class="function"><a href="../calc/PeakPicking.html#PeakPicking.get_threshold">get_threshold</a></dd>
                <dd id="MassSpecBase.algebraic_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.algebraic_quadratic">algebraic_quadratic</a></dd>
                <dd id="MassSpecBase.find_apex_fit_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_apex_fit_quadratic">find_apex_fit_quadratic</a></dd>
                <dd id="MassSpecBase.check_prominence" class="function"><a href="../calc/PeakPicking.html#PeakPicking.check_prominence">check_prominence</a></dd>
                <dd id="MassSpecBase.use_the_max" class="function"><a href="../calc/PeakPicking.html#PeakPicking.use_the_max">use_the_max</a></dd>
                <dd id="MassSpecBase.calc_centroid_legacy" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid_legacy">calc_centroid_legacy</a></dd>

            </div>
            <div><dt><a href="../calc/NoiseCalc.html#NoiseThresholdCalc">corems.mass_spectrum.calc.NoiseCalc.NoiseThresholdCalc</a></dt>
                                <dd id="MassSpecBase.get_noise_threshold" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_threshold">get_noise_threshold</a></dd>
                <dd id="MassSpecBase.cut_mz_domain_noise" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.cut_mz_domain_noise">cut_mz_domain_noise</a></dd>
                <dd id="MassSpecBase.get_noise_average" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_average">get_noise_average</a></dd>
                <dd id="MassSpecBase.get_abundance_minima_centroid" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_abundance_minima_centroid">get_abundance_minima_centroid</a></dd>
                <dd id="MassSpecBase.run_log_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_log_noise_threshold_calc">run_log_noise_threshold_calc</a></dd>
                <dd id="MassSpecBase.run_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_noise_threshold_calc">run_noise_threshold_calc</a></dd>

            </div>
            <div><dt><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></dt>
                                <dd id="MassSpecBase.mz_odd_even_index_lists" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.mz_odd_even_index_lists">mz_odd_even_index_lists</a></dd>
                <dd id="MassSpecBase.calc_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.calc_error">calc_error</a></dd>
                <dd id="MassSpecBase.populate_kendrick_index_dict_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_error">populate_kendrick_index_dict_error</a></dd>
                <dd id="MassSpecBase.populate_kendrick_index_dict_rounding" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_rounding">populate_kendrick_index_dict_rounding</a></dd>
                <dd id="MassSpecBase.sort_abundance_kendrick_dict" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.sort_abundance_kendrick_dict">sort_abundance_kendrick_dict</a></dd>
                <dd id="MassSpecBase.kendrick_groups_indexes" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.kendrick_groups_indexes">kendrick_groups_indexes</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MassSpecProfile">
                            <input id="MassSpecProfile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MassSpecProfile</span><wbr>(<span class="base"><a href="#MassSpecBase">MassSpecBase</a></span>):

                <label class="view-source-button" for="MassSpecProfile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecProfile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecProfile-1255"><a href="#MassSpecProfile-1255"><span class="linenos">1255</span></a><span class="k">class</span> <span class="nc">MassSpecProfile</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="MassSpecProfile-1256"><a href="#MassSpecProfile-1256"><span class="linenos">1256</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on profile format</span>
</span><span id="MassSpecProfile-1257"><a href="#MassSpecProfile-1257"><span class="linenos">1257</span></a>
</span><span id="MassSpecProfile-1258"><a href="#MassSpecProfile-1258"><span class="linenos">1258</span></a><span class="sd">    Notes</span>
</span><span id="MassSpecProfile-1259"><a href="#MassSpecProfile-1259"><span class="linenos">1259</span></a><span class="sd">    -----</span>
</span><span id="MassSpecProfile-1260"><a href="#MassSpecProfile-1260"><span class="linenos">1260</span></a><span class="sd">    Stores the profile data and instrument settings.</span>
</span><span id="MassSpecProfile-1261"><a href="#MassSpecProfile-1261"><span class="linenos">1261</span></a><span class="sd">    Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.</span>
</span><span id="MassSpecProfile-1262"><a href="#MassSpecProfile-1262"><span class="linenos">1262</span></a><span class="sd">    _mspeaks is populated under the hood by calling process_mass_spec method.</span>
</span><span id="MassSpecProfile-1263"><a href="#MassSpecProfile-1263"><span class="linenos">1263</span></a><span class="sd">    Iteration is null if _mspeaks is empty. Many more attributes and methods inherited from MassSpecBase().</span>
</span><span id="MassSpecProfile-1264"><a href="#MassSpecProfile-1264"><span class="linenos">1264</span></a>
</span><span id="MassSpecProfile-1265"><a href="#MassSpecProfile-1265"><span class="linenos">1265</span></a><span class="sd">    Parameters</span>
</span><span id="MassSpecProfile-1266"><a href="#MassSpecProfile-1266"><span class="linenos">1266</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecProfile-1267"><a href="#MassSpecProfile-1267"><span class="linenos">1267</span></a><span class="sd">    data_dict : dict</span>
</span><span id="MassSpecProfile-1268"><a href="#MassSpecProfile-1268"><span class="linenos">1268</span></a><span class="sd">        A dictionary containing the profile data.</span>
</span><span id="MassSpecProfile-1269"><a href="#MassSpecProfile-1269"><span class="linenos">1269</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="MassSpecProfile-1270"><a href="#MassSpecProfile-1270"><span class="linenos">1270</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="MassSpecProfile-1271"><a href="#MassSpecProfile-1271"><span class="linenos">1271</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="MassSpecProfile-1272"><a href="#MassSpecProfile-1272"><span class="linenos">1272</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="MassSpecProfile-1273"><a href="#MassSpecProfile-1273"><span class="linenos">1273</span></a>
</span><span id="MassSpecProfile-1274"><a href="#MassSpecProfile-1274"><span class="linenos">1274</span></a>
</span><span id="MassSpecProfile-1275"><a href="#MassSpecProfile-1275"><span class="linenos">1275</span></a><span class="sd">    Attributes</span>
</span><span id="MassSpecProfile-1276"><a href="#MassSpecProfile-1276"><span class="linenos">1276</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecProfile-1277"><a href="#MassSpecProfile-1277"><span class="linenos">1277</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="MassSpecProfile-1278"><a href="#MassSpecProfile-1278"><span class="linenos">1278</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecProfile-1279"><a href="#MassSpecProfile-1279"><span class="linenos">1279</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="MassSpecProfile-1280"><a href="#MassSpecProfile-1280"><span class="linenos">1280</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecProfile-1281"><a href="#MassSpecProfile-1281"><span class="linenos">1281</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="MassSpecProfile-1282"><a href="#MassSpecProfile-1282"><span class="linenos">1282</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="MassSpecProfile-1283"><a href="#MassSpecProfile-1283"><span class="linenos">1283</span></a>
</span><span id="MassSpecProfile-1284"><a href="#MassSpecProfile-1284"><span class="linenos">1284</span></a><span class="sd">    Methods</span>
</span><span id="MassSpecProfile-1285"><a href="#MassSpecProfile-1285"><span class="linenos">1285</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecProfile-1286"><a href="#MassSpecProfile-1286"><span class="linenos">1286</span></a><span class="sd">    * process_mass_spec(). Process the mass spectrum.</span>
</span><span id="MassSpecProfile-1287"><a href="#MassSpecProfile-1287"><span class="linenos">1287</span></a>
</span><span id="MassSpecProfile-1288"><a href="#MassSpecProfile-1288"><span class="linenos">1288</span></a><span class="sd">    see also: MassSpecBase(), MassSpecfromFreq(), MassSpecCentroid()</span>
</span><span id="MassSpecProfile-1289"><a href="#MassSpecProfile-1289"><span class="linenos">1289</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MassSpecProfile-1290"><a href="#MassSpecProfile-1290"><span class="linenos">1290</span></a>
</span><span id="MassSpecProfile-1291"><a href="#MassSpecProfile-1291"><span class="linenos">1291</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecProfile-1292"><a href="#MassSpecProfile-1292"><span class="linenos">1292</span></a>        <span class="c1"># print(data_dict.keys())</span>
</span><span id="MassSpecProfile-1293"><a href="#MassSpecProfile-1293"><span class="linenos">1293</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MassSpecProfile-1294"><a href="#MassSpecProfile-1294"><span class="linenos">1294</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">),</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">),</span> <span class="n">d_params</span>
</span><span id="MassSpecProfile-1295"><a href="#MassSpecProfile-1295"><span class="linenos">1295</span></a>        <span class="p">)</span>
</span><span id="MassSpecProfile-1296"><a href="#MassSpecProfile-1296"><span class="linenos">1296</span></a>
</span><span id="MassSpecProfile-1297"><a href="#MassSpecProfile-1297"><span class="linenos">1297</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecProfile-1298"><a href="#MassSpecProfile-1298"><span class="linenos">1298</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>A mass spectrum class when the entry point is on profile format</p>

<h6 id="notes">Notes</h6>

<p>Stores the profile data and instrument settings.
Iteration over a list of MSPeaks classes stored at the _mspeaks attributes.
_mspeaks is populated under the hood by calling process_mass_spec method.
Iteration is null if _mspeaks is empty. Many more attributes and methods inherited from MassSpecBase().</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>data_dict</strong> (dict):
A dictionary containing the profile data.</li>
<li><strong>d_params : dict{'str'</strong> (float, int or str}):
contains the instrument settings and processing settings</li>
<li><strong>auto_process</strong> (bool, optional):
Whether to automatically process the mass spectrum. Defaults to True.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>_abundance</strong> (ndarray):
The abundance values of the mass spectrum.</li>
<li><strong>_mz_exp</strong> (ndarray):
The m/z values of the mass spectrum.</li>
<li><strong>_mspeaks</strong> (list):
A list of mass peaks.</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>process_mass_spec(). Process the mass spectrum.</li>
</ul>

<p>see also: MassSpecBase(), MassSpecfromFreq(), MassSpecCentroid()</p>
</div>


                            <div id="MassSpecProfile.__init__" class="classattr">
                                        <input id="MassSpecProfile.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MassSpecProfile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dict</span>, </span><span class="param"><span class="n">d_params</span>, </span><span class="param"><span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="MassSpecProfile.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecProfile.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecProfile.__init__-1291"><a href="#MassSpecProfile.__init__-1291"><span class="linenos">1291</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecProfile.__init__-1292"><a href="#MassSpecProfile.__init__-1292"><span class="linenos">1292</span></a>        <span class="c1"># print(data_dict.keys())</span>
</span><span id="MassSpecProfile.__init__-1293"><a href="#MassSpecProfile.__init__-1293"><span class="linenos">1293</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
</span><span id="MassSpecProfile.__init__-1294"><a href="#MassSpecProfile.__init__-1294"><span class="linenos">1294</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">),</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">),</span> <span class="n">d_params</span>
</span><span id="MassSpecProfile.__init__-1295"><a href="#MassSpecProfile.__init__-1295"><span class="linenos">1295</span></a>        <span class="p">)</span>
</span><span id="MassSpecProfile.__init__-1296"><a href="#MassSpecProfile.__init__-1296"><span class="linenos">1296</span></a>
</span><span id="MassSpecProfile.__init__-1297"><a href="#MassSpecProfile.__init__-1297"><span class="linenos">1297</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecProfile.__init__-1298"><a href="#MassSpecProfile.__init__-1298"><span class="linenos">1298</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#MassSpecBase">MassSpecBase</a></dt>
                                <dd id="MassSpecProfile.mspeaks" class="variable"><a href="#MassSpecBase.mspeaks">mspeaks</a></dd>
                <dd id="MassSpecProfile.is_calibrated" class="variable"><a href="#MassSpecBase.is_calibrated">is_calibrated</a></dd>
                <dd id="MassSpecProfile.is_centroid" class="variable"><a href="#MassSpecBase.is_centroid">is_centroid</a></dd>
                <dd id="MassSpecProfile.has_frequency" class="variable"><a href="#MassSpecBase.has_frequency">has_frequency</a></dd>
                <dd id="MassSpecProfile.calibration_order" class="variable"><a href="#MassSpecBase.calibration_order">calibration_order</a></dd>
                <dd id="MassSpecProfile.calibration_points" class="variable"><a href="#MassSpecBase.calibration_points">calibration_points</a></dd>
                <dd id="MassSpecProfile.calibration_ref_mzs" class="variable"><a href="#MassSpecBase.calibration_ref_mzs">calibration_ref_mzs</a></dd>
                <dd id="MassSpecProfile.calibration_meas_mzs" class="variable"><a href="#MassSpecBase.calibration_meas_mzs">calibration_meas_mzs</a></dd>
                <dd id="MassSpecProfile.calibration_RMS" class="variable"><a href="#MassSpecBase.calibration_RMS">calibration_RMS</a></dd>
                <dd id="MassSpecProfile.calibration_segment" class="variable"><a href="#MassSpecBase.calibration_segment">calibration_segment</a></dd>
                <dd id="MassSpecProfile.calibration_raw_error_median" class="variable"><a href="#MassSpecBase.calibration_raw_error_median">calibration_raw_error_median</a></dd>
                <dd id="MassSpecProfile.calibration_raw_error_stdev" class="variable"><a href="#MassSpecBase.calibration_raw_error_stdev">calibration_raw_error_stdev</a></dd>
                <dd id="MassSpecProfile.set_indexes" class="function"><a href="#MassSpecBase.set_indexes">set_indexes</a></dd>
                <dd id="MassSpecProfile.reset_indexes" class="function"><a href="#MassSpecBase.reset_indexes">reset_indexes</a></dd>
                <dd id="MassSpecProfile.add_mspeak" class="function"><a href="#MassSpecBase.add_mspeak">add_mspeak</a></dd>
                <dd id="MassSpecProfile.reset_cal_therms" class="function"><a href="#MassSpecBase.reset_cal_therms">reset_cal_therms</a></dd>
                <dd id="MassSpecProfile.clear_molecular_formulas" class="function"><a href="#MassSpecBase.clear_molecular_formulas">clear_molecular_formulas</a></dd>
                <dd id="MassSpecProfile.process_mass_spec" class="function"><a href="#MassSpecBase.process_mass_spec">process_mass_spec</a></dd>
                <dd id="MassSpecProfile.cal_noise_threshold" class="function"><a href="#MassSpecBase.cal_noise_threshold">cal_noise_threshold</a></dd>
                <dd id="MassSpecProfile.parameters" class="variable"><a href="#MassSpecBase.parameters">parameters</a></dd>
                <dd id="MassSpecProfile.set_parameter_from_json" class="function"><a href="#MassSpecBase.set_parameter_from_json">set_parameter_from_json</a></dd>
                <dd id="MassSpecProfile.set_parameter_from_toml" class="function"><a href="#MassSpecBase.set_parameter_from_toml">set_parameter_from_toml</a></dd>
                <dd id="MassSpecProfile.mspeaks_settings" class="variable"><a href="#MassSpecBase.mspeaks_settings">mspeaks_settings</a></dd>
                <dd id="MassSpecProfile.settings" class="variable"><a href="#MassSpecBase.settings">settings</a></dd>
                <dd id="MassSpecProfile.molecular_search_settings" class="variable"><a href="#MassSpecBase.molecular_search_settings">molecular_search_settings</a></dd>
                <dd id="MassSpecProfile.mz_cal_profile" class="variable"><a href="#MassSpecBase.mz_cal_profile">mz_cal_profile</a></dd>
                <dd id="MassSpecProfile.mz_cal" class="variable"><a href="#MassSpecBase.mz_cal">mz_cal</a></dd>
                <dd id="MassSpecProfile.mz_exp" class="variable"><a href="#MassSpecBase.mz_exp">mz_exp</a></dd>
                <dd id="MassSpecProfile.freq_exp_profile" class="variable"><a href="#MassSpecBase.freq_exp_profile">freq_exp_profile</a></dd>
                <dd id="MassSpecProfile.freq_exp_pp" class="variable"><a href="#MassSpecBase.freq_exp_pp">freq_exp_pp</a></dd>
                <dd id="MassSpecProfile.mz_exp_profile" class="variable"><a href="#MassSpecBase.mz_exp_profile">mz_exp_profile</a></dd>
                <dd id="MassSpecProfile.mz_exp_pp" class="variable"><a href="#MassSpecBase.mz_exp_pp">mz_exp_pp</a></dd>
                <dd id="MassSpecProfile.abundance_profile" class="variable"><a href="#MassSpecBase.abundance_profile">abundance_profile</a></dd>
                <dd id="MassSpecProfile.abundance_profile_pp" class="variable"><a href="#MassSpecBase.abundance_profile_pp">abundance_profile_pp</a></dd>
                <dd id="MassSpecProfile.abundance" class="variable"><a href="#MassSpecBase.abundance">abundance</a></dd>
                <dd id="MassSpecProfile.freq_exp" class="function"><a href="#MassSpecBase.freq_exp">freq_exp</a></dd>
                <dd id="MassSpecProfile.resolving_power" class="variable"><a href="#MassSpecBase.resolving_power">resolving_power</a></dd>
                <dd id="MassSpecProfile.signal_to_noise" class="variable"><a href="#MassSpecBase.signal_to_noise">signal_to_noise</a></dd>
                <dd id="MassSpecProfile.nominal_mz" class="variable"><a href="#MassSpecBase.nominal_mz">nominal_mz</a></dd>
                <dd id="MassSpecProfile.get_mz_and_abundance_peaks_tuples" class="function"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples">get_mz_and_abundance_peaks_tuples</a></dd>
                <dd id="MassSpecProfile.kmd" class="variable"><a href="#MassSpecBase.kmd">kmd</a></dd>
                <dd id="MassSpecProfile.kendrick_mass" class="variable"><a href="#MassSpecBase.kendrick_mass">kendrick_mass</a></dd>
                <dd id="MassSpecProfile.max_mz_exp" class="variable"><a href="#MassSpecBase.max_mz_exp">max_mz_exp</a></dd>
                <dd id="MassSpecProfile.min_mz_exp" class="variable"><a href="#MassSpecBase.min_mz_exp">min_mz_exp</a></dd>
                <dd id="MassSpecProfile.max_abundance" class="variable"><a href="#MassSpecBase.max_abundance">max_abundance</a></dd>
                <dd id="MassSpecProfile.max_signal_to_noise" class="variable"><a href="#MassSpecBase.max_signal_to_noise">max_signal_to_noise</a></dd>
                <dd id="MassSpecProfile.most_abundant_mspeak" class="variable"><a href="#MassSpecBase.most_abundant_mspeak">most_abundant_mspeak</a></dd>
                <dd id="MassSpecProfile.min_abundance" class="variable"><a href="#MassSpecBase.min_abundance">min_abundance</a></dd>
                <dd id="MassSpecProfile.dynamic_range" class="variable"><a href="#MassSpecBase.dynamic_range">dynamic_range</a></dd>
                <dd id="MassSpecProfile.baseline_noise" class="variable"><a href="#MassSpecBase.baseline_noise">baseline_noise</a></dd>
                <dd id="MassSpecProfile.baseline_noise_std" class="variable"><a href="#MassSpecBase.baseline_noise_std">baseline_noise_std</a></dd>
                <dd id="MassSpecProfile.Aterm" class="variable"><a href="#MassSpecBase.Aterm">Aterm</a></dd>
                <dd id="MassSpecProfile.Bterm" class="variable"><a href="#MassSpecBase.Bterm">Bterm</a></dd>
                <dd id="MassSpecProfile.Cterm" class="variable"><a href="#MassSpecBase.Cterm">Cterm</a></dd>
                <dd id="MassSpecProfile.filename" class="variable"><a href="#MassSpecBase.filename">filename</a></dd>
                <dd id="MassSpecProfile.dir_location" class="variable"><a href="#MassSpecBase.dir_location">dir_location</a></dd>
                <dd id="MassSpecProfile.sort_by_mz" class="function"><a href="#MassSpecBase.sort_by_mz">sort_by_mz</a></dd>
                <dd id="MassSpecProfile.sort_by_abundance" class="function"><a href="#MassSpecBase.sort_by_abundance">sort_by_abundance</a></dd>
                <dd id="MassSpecProfile.tic" class="variable"><a href="#MassSpecBase.tic">tic</a></dd>
                <dd id="MassSpecProfile.check_mspeaks_warning" class="function"><a href="#MassSpecBase.check_mspeaks_warning">check_mspeaks_warning</a></dd>
                <dd id="MassSpecProfile.check_mspeaks" class="function"><a href="#MassSpecBase.check_mspeaks">check_mspeaks</a></dd>
                <dd id="MassSpecProfile.remove_assignment_by_index" class="function"><a href="#MassSpecBase.remove_assignment_by_index">remove_assignment_by_index</a></dd>
                <dd id="MassSpecProfile.filter_by_index" class="function"><a href="#MassSpecBase.filter_by_index">filter_by_index</a></dd>
                <dd id="MassSpecProfile.filter_by_mz" class="function"><a href="#MassSpecBase.filter_by_mz">filter_by_mz</a></dd>
                <dd id="MassSpecProfile.filter_by_s2n" class="function"><a href="#MassSpecBase.filter_by_s2n">filter_by_s2n</a></dd>
                <dd id="MassSpecProfile.filter_by_abundance" class="function"><a href="#MassSpecBase.filter_by_abundance">filter_by_abundance</a></dd>
                <dd id="MassSpecProfile.filter_by_max_resolving_power" class="function"><a href="#MassSpecBase.filter_by_max_resolving_power">filter_by_max_resolving_power</a></dd>
                <dd id="MassSpecProfile.filter_by_mean_resolving_power" class="function"><a href="#MassSpecBase.filter_by_mean_resolving_power">filter_by_mean_resolving_power</a></dd>
                <dd id="MassSpecProfile.filter_by_min_resolving_power" class="function"><a href="#MassSpecBase.filter_by_min_resolving_power">filter_by_min_resolving_power</a></dd>
                <dd id="MassSpecProfile.filter_by_noise_threshold" class="function"><a href="#MassSpecBase.filter_by_noise_threshold">filter_by_noise_threshold</a></dd>
                <dd id="MassSpecProfile.find_peaks" class="function"><a href="#MassSpecBase.find_peaks">find_peaks</a></dd>
                <dd id="MassSpecProfile.change_kendrick_base_all_mspeaks" class="function"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks">change_kendrick_base_all_mspeaks</a></dd>
                <dd id="MassSpecProfile.get_nominal_mz_first_last_indexes" class="function"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes">get_nominal_mz_first_last_indexes</a></dd>
                <dd id="MassSpecProfile.get_masses_count_by_nominal_mass" class="function"><a href="#MassSpecBase.get_masses_count_by_nominal_mass">get_masses_count_by_nominal_mass</a></dd>
                <dd id="MassSpecProfile.datapoints_count_by_nominal_mz" class="function"><a href="#MassSpecBase.datapoints_count_by_nominal_mz">datapoints_count_by_nominal_mz</a></dd>
                <dd id="MassSpecProfile.get_nominal_mass_indexes" class="function"><a href="#MassSpecBase.get_nominal_mass_indexes">get_nominal_mass_indexes</a></dd>
                <dd id="MassSpecProfile.plot_centroid" class="function"><a href="#MassSpecBase.plot_centroid">plot_centroid</a></dd>
                <dd id="MassSpecProfile.plot_profile_and_noise_threshold" class="function"><a href="#MassSpecBase.plot_profile_and_noise_threshold">plot_profile_and_noise_threshold</a></dd>
                <dd id="MassSpecProfile.plot_mz_domain_profile" class="function"><a href="#MassSpecBase.plot_mz_domain_profile">plot_mz_domain_profile</a></dd>
                <dd id="MassSpecProfile.to_excel" class="function"><a href="#MassSpecBase.to_excel">to_excel</a></dd>
                <dd id="MassSpecProfile.to_hdf" class="function"><a href="#MassSpecBase.to_hdf">to_hdf</a></dd>
                <dd id="MassSpecProfile.to_csv" class="function"><a href="#MassSpecBase.to_csv">to_csv</a></dd>
                <dd id="MassSpecProfile.to_pandas" class="function"><a href="#MassSpecBase.to_pandas">to_pandas</a></dd>
                <dd id="MassSpecProfile.to_dataframe" class="function"><a href="#MassSpecBase.to_dataframe">to_dataframe</a></dd>
                <dd id="MassSpecProfile.to_json" class="function"><a href="#MassSpecBase.to_json">to_json</a></dd>
                <dd id="MassSpecProfile.parameters_json" class="function"><a href="#MassSpecBase.parameters_json">parameters_json</a></dd>
                <dd id="MassSpecProfile.parameters_toml" class="function"><a href="#MassSpecBase.parameters_toml">parameters_toml</a></dd>

            </div>
            <div><dt><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></dt>
                                <dd id="MassSpecProfile.percentile_assigned" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.percentile_assigned">percentile_assigned</a></dd>
                <dd id="MassSpecProfile.resolving_power_calc" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.resolving_power_calc">resolving_power_calc</a></dd>
                <dd id="MassSpecProfile.number_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.number_average_molecular_weight">number_average_molecular_weight</a></dd>
                <dd id="MassSpecProfile.weight_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.weight_average_molecular_weight">weight_average_molecular_weight</a></dd>

            </div>
            <div><dt><a href="../calc/PeakPicking.html#PeakPicking">corems.mass_spectrum.calc.PeakPicking.PeakPicking</a></dt>
                                <dd id="MassSpecProfile.prepare_peak_picking_data" class="function"><a href="../calc/PeakPicking.html#PeakPicking.prepare_peak_picking_data">prepare_peak_picking_data</a></dd>
                <dd id="MassSpecProfile.cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cut_mz_domain_peak_picking">cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecProfile.legacy_cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.legacy_cut_mz_domain_peak_picking">legacy_cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecProfile.extrapolate_axis" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axis">extrapolate_axis</a></dd>
                <dd id="MassSpecProfile.extrapolate_axes_for_pp" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axes_for_pp">extrapolate_axes_for_pp</a></dd>
                <dd id="MassSpecProfile.do_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.do_peak_picking">do_peak_picking</a></dd>
                <dd id="MassSpecProfile.find_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_minima">find_minima</a></dd>
                <dd id="MassSpecProfile.linear_fit_calc" class="function"><a href="../calc/PeakPicking.html#PeakPicking.linear_fit_calc">linear_fit_calc</a></dd>
                <dd id="MassSpecProfile.calculate_resolving_power" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calculate_resolving_power">calculate_resolving_power</a></dd>
                <dd id="MassSpecProfile.cal_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cal_minima">cal_minima</a></dd>
                <dd id="MassSpecProfile.calc_centroid" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid">calc_centroid</a></dd>
                <dd id="MassSpecProfile.get_threshold" class="function"><a href="../calc/PeakPicking.html#PeakPicking.get_threshold">get_threshold</a></dd>
                <dd id="MassSpecProfile.algebraic_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.algebraic_quadratic">algebraic_quadratic</a></dd>
                <dd id="MassSpecProfile.find_apex_fit_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_apex_fit_quadratic">find_apex_fit_quadratic</a></dd>
                <dd id="MassSpecProfile.check_prominence" class="function"><a href="../calc/PeakPicking.html#PeakPicking.check_prominence">check_prominence</a></dd>
                <dd id="MassSpecProfile.use_the_max" class="function"><a href="../calc/PeakPicking.html#PeakPicking.use_the_max">use_the_max</a></dd>
                <dd id="MassSpecProfile.calc_centroid_legacy" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid_legacy">calc_centroid_legacy</a></dd>

            </div>
            <div><dt><a href="../calc/NoiseCalc.html#NoiseThresholdCalc">corems.mass_spectrum.calc.NoiseCalc.NoiseThresholdCalc</a></dt>
                                <dd id="MassSpecProfile.get_noise_threshold" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_threshold">get_noise_threshold</a></dd>
                <dd id="MassSpecProfile.cut_mz_domain_noise" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.cut_mz_domain_noise">cut_mz_domain_noise</a></dd>
                <dd id="MassSpecProfile.get_noise_average" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_average">get_noise_average</a></dd>
                <dd id="MassSpecProfile.get_abundance_minima_centroid" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_abundance_minima_centroid">get_abundance_minima_centroid</a></dd>
                <dd id="MassSpecProfile.run_log_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_log_noise_threshold_calc">run_log_noise_threshold_calc</a></dd>
                <dd id="MassSpecProfile.run_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_noise_threshold_calc">run_noise_threshold_calc</a></dd>

            </div>
            <div><dt><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></dt>
                                <dd id="MassSpecProfile.mz_odd_even_index_lists" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.mz_odd_even_index_lists">mz_odd_even_index_lists</a></dd>
                <dd id="MassSpecProfile.calc_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.calc_error">calc_error</a></dd>
                <dd id="MassSpecProfile.populate_kendrick_index_dict_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_error">populate_kendrick_index_dict_error</a></dd>
                <dd id="MassSpecProfile.populate_kendrick_index_dict_rounding" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_rounding">populate_kendrick_index_dict_rounding</a></dd>
                <dd id="MassSpecProfile.sort_abundance_kendrick_dict" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.sort_abundance_kendrick_dict">sort_abundance_kendrick_dict</a></dd>
                <dd id="MassSpecProfile.kendrick_groups_indexes" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.kendrick_groups_indexes">kendrick_groups_indexes</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MassSpecfromFreq">
                            <input id="MassSpecfromFreq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MassSpecfromFreq</span><wbr>(<span class="base"><a href="#MassSpecBase">MassSpecBase</a></span>):

                <label class="view-source-button" for="MassSpecfromFreq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecfromFreq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecfromFreq-1301"><a href="#MassSpecfromFreq-1301"><span class="linenos">1301</span></a><span class="k">class</span> <span class="nc">MassSpecfromFreq</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1302"><a href="#MassSpecfromFreq-1302"><span class="linenos">1302</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when data entry is on frequency domain</span>
</span><span id="MassSpecfromFreq-1303"><a href="#MassSpecfromFreq-1303"><span class="linenos">1303</span></a>
</span><span id="MassSpecfromFreq-1304"><a href="#MassSpecfromFreq-1304"><span class="linenos">1304</span></a><span class="sd">    Notes</span>
</span><span id="MassSpecfromFreq-1305"><a href="#MassSpecfromFreq-1305"><span class="linenos">1305</span></a><span class="sd">    -----</span>
</span><span id="MassSpecfromFreq-1306"><a href="#MassSpecfromFreq-1306"><span class="linenos">1306</span></a><span class="sd">    - Transform to m/z based on the settings stored at d_params</span>
</span><span id="MassSpecfromFreq-1307"><a href="#MassSpecfromFreq-1307"><span class="linenos">1307</span></a><span class="sd">    - Stores the profile data and instrument settings</span>
</span><span id="MassSpecfromFreq-1308"><a href="#MassSpecfromFreq-1308"><span class="linenos">1308</span></a><span class="sd">    - Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</span>
</span><span id="MassSpecfromFreq-1309"><a href="#MassSpecfromFreq-1309"><span class="linenos">1309</span></a><span class="sd">    - _mspeaks is populated under the hood by calling process_mass_spec method</span>
</span><span id="MassSpecfromFreq-1310"><a href="#MassSpecfromFreq-1310"><span class="linenos">1310</span></a><span class="sd">    - iteration is null if _mspeaks is empty</span>
</span><span id="MassSpecfromFreq-1311"><a href="#MassSpecfromFreq-1311"><span class="linenos">1311</span></a>
</span><span id="MassSpecfromFreq-1312"><a href="#MassSpecfromFreq-1312"><span class="linenos">1312</span></a><span class="sd">    Parameters</span>
</span><span id="MassSpecfromFreq-1313"><a href="#MassSpecfromFreq-1313"><span class="linenos">1313</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecfromFreq-1314"><a href="#MassSpecfromFreq-1314"><span class="linenos">1314</span></a><span class="sd">    frequency_domain : list(float)</span>
</span><span id="MassSpecfromFreq-1315"><a href="#MassSpecfromFreq-1315"><span class="linenos">1315</span></a><span class="sd">        all datapoints in frequency domain in Hz</span>
</span><span id="MassSpecfromFreq-1316"><a href="#MassSpecfromFreq-1316"><span class="linenos">1316</span></a><span class="sd">    magnitude :  frequency_domain : list(float)</span>
</span><span id="MassSpecfromFreq-1317"><a href="#MassSpecfromFreq-1317"><span class="linenos">1317</span></a><span class="sd">        all datapoints in for magnitude of each frequency datapoint</span>
</span><span id="MassSpecfromFreq-1318"><a href="#MassSpecfromFreq-1318"><span class="linenos">1318</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="MassSpecfromFreq-1319"><a href="#MassSpecfromFreq-1319"><span class="linenos">1319</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="MassSpecfromFreq-1320"><a href="#MassSpecfromFreq-1320"><span class="linenos">1320</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="MassSpecfromFreq-1321"><a href="#MassSpecfromFreq-1321"><span class="linenos">1321</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="MassSpecfromFreq-1322"><a href="#MassSpecfromFreq-1322"><span class="linenos">1322</span></a><span class="sd">    keep_profile : bool, optional</span>
</span><span id="MassSpecfromFreq-1323"><a href="#MassSpecfromFreq-1323"><span class="linenos">1323</span></a><span class="sd">        Whether to keep the profile data. Defaults to True.</span>
</span><span id="MassSpecfromFreq-1324"><a href="#MassSpecfromFreq-1324"><span class="linenos">1324</span></a>
</span><span id="MassSpecfromFreq-1325"><a href="#MassSpecfromFreq-1325"><span class="linenos">1325</span></a><span class="sd">    Attributes</span>
</span><span id="MassSpecfromFreq-1326"><a href="#MassSpecfromFreq-1326"><span class="linenos">1326</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecfromFreq-1327"><a href="#MassSpecfromFreq-1327"><span class="linenos">1327</span></a><span class="sd">    has_frequency : bool</span>
</span><span id="MassSpecfromFreq-1328"><a href="#MassSpecfromFreq-1328"><span class="linenos">1328</span></a><span class="sd">        Whether the mass spectrum has frequency data.</span>
</span><span id="MassSpecfromFreq-1329"><a href="#MassSpecfromFreq-1329"><span class="linenos">1329</span></a><span class="sd">    _frequency_domain : list(float)</span>
</span><span id="MassSpecfromFreq-1330"><a href="#MassSpecfromFreq-1330"><span class="linenos">1330</span></a><span class="sd">        Frequency domain in Hz</span>
</span><span id="MassSpecfromFreq-1331"><a href="#MassSpecfromFreq-1331"><span class="linenos">1331</span></a><span class="sd">    label : str</span>
</span><span id="MassSpecfromFreq-1332"><a href="#MassSpecfromFreq-1332"><span class="linenos">1332</span></a><span class="sd">        store label (Bruker, Midas Transient, see Labels class ). It across distinct processing points</span>
</span><span id="MassSpecfromFreq-1333"><a href="#MassSpecfromFreq-1333"><span class="linenos">1333</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="MassSpecfromFreq-1334"><a href="#MassSpecfromFreq-1334"><span class="linenos">1334</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecfromFreq-1335"><a href="#MassSpecfromFreq-1335"><span class="linenos">1335</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="MassSpecfromFreq-1336"><a href="#MassSpecfromFreq-1336"><span class="linenos">1336</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecfromFreq-1337"><a href="#MassSpecfromFreq-1337"><span class="linenos">1337</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="MassSpecfromFreq-1338"><a href="#MassSpecfromFreq-1338"><span class="linenos">1338</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="MassSpecfromFreq-1339"><a href="#MassSpecfromFreq-1339"><span class="linenos">1339</span></a><span class="sd">    See Also: all the attributes of MassSpecBase class</span>
</span><span id="MassSpecfromFreq-1340"><a href="#MassSpecfromFreq-1340"><span class="linenos">1340</span></a>
</span><span id="MassSpecfromFreq-1341"><a href="#MassSpecfromFreq-1341"><span class="linenos">1341</span></a><span class="sd">    Methods</span>
</span><span id="MassSpecfromFreq-1342"><a href="#MassSpecfromFreq-1342"><span class="linenos">1342</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecfromFreq-1343"><a href="#MassSpecfromFreq-1343"><span class="linenos">1343</span></a><span class="sd">    * _set_mz_domain().</span>
</span><span id="MassSpecfromFreq-1344"><a href="#MassSpecfromFreq-1344"><span class="linenos">1344</span></a><span class="sd">        calculates the m_z based on the setting of d_params</span>
</span><span id="MassSpecfromFreq-1345"><a href="#MassSpecfromFreq-1345"><span class="linenos">1345</span></a><span class="sd">    * process_mass_spec().  Process the mass spectrum.</span>
</span><span id="MassSpecfromFreq-1346"><a href="#MassSpecfromFreq-1346"><span class="linenos">1346</span></a>
</span><span id="MassSpecfromFreq-1347"><a href="#MassSpecfromFreq-1347"><span class="linenos">1347</span></a><span class="sd">    see also: MassSpecBase(), MassSpecProfile(), MassSpecCentroid()</span>
</span><span id="MassSpecfromFreq-1348"><a href="#MassSpecfromFreq-1348"><span class="linenos">1348</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq-1349"><a href="#MassSpecfromFreq-1349"><span class="linenos">1349</span></a>
</span><span id="MassSpecfromFreq-1350"><a href="#MassSpecfromFreq-1350"><span class="linenos">1350</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="MassSpecfromFreq-1351"><a href="#MassSpecfromFreq-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1352"><a href="#MassSpecfromFreq-1352"><span class="linenos">1352</span></a>        <span class="n">frequency_domain</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1353"><a href="#MassSpecfromFreq-1353"><span class="linenos">1353</span></a>        <span class="n">magnitude</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1354"><a href="#MassSpecfromFreq-1354"><span class="linenos">1354</span></a>        <span class="n">d_params</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1355"><a href="#MassSpecfromFreq-1355"><span class="linenos">1355</span></a>        <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1356"><a href="#MassSpecfromFreq-1356"><span class="linenos">1356</span></a>        <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1357"><a href="#MassSpecfromFreq-1357"><span class="linenos">1357</span></a>    <span class="p">):</span>
</span><span id="MassSpecfromFreq-1358"><a href="#MassSpecfromFreq-1358"><span class="linenos">1358</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecfromFreq-1359"><a href="#MassSpecfromFreq-1359"><span class="linenos">1359</span></a>
</span><span id="MassSpecfromFreq-1360"><a href="#MassSpecfromFreq-1360"><span class="linenos">1360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="n">frequency_domain</span>
</span><span id="MassSpecfromFreq-1361"><a href="#MassSpecfromFreq-1361"><span class="linenos">1361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecfromFreq-1362"><a href="#MassSpecfromFreq-1362"><span class="linenos">1362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mz_domain</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1363"><a href="#MassSpecfromFreq-1363"><span class="linenos">1363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sort_mz_domain</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1364"><a href="#MassSpecfromFreq-1364"><span class="linenos">1364</span></a>
</span><span id="MassSpecfromFreq-1365"><a href="#MassSpecfromFreq-1365"><span class="linenos">1365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecfromFreq-1366"><a href="#MassSpecfromFreq-1366"><span class="linenos">1366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecfromFreq-1367"><a href="#MassSpecfromFreq-1367"><span class="linenos">1367</span></a>
</span><span id="MassSpecfromFreq-1368"><a href="#MassSpecfromFreq-1368"><span class="linenos">1368</span></a>        <span class="c1"># use this call to automatically process data as the object is created, Setting need to be changed before initiating the class to be in effect</span>
</span><span id="MassSpecfromFreq-1369"><a href="#MassSpecfromFreq-1369"><span class="linenos">1369</span></a>
</span><span id="MassSpecfromFreq-1370"><a href="#MassSpecfromFreq-1370"><span class="linenos">1370</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecfromFreq-1371"><a href="#MassSpecfromFreq-1371"><span class="linenos">1371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">(</span><span class="n">keep_profile</span><span class="o">=</span><span class="n">keep_profile</span><span class="p">)</span>
</span><span id="MassSpecfromFreq-1372"><a href="#MassSpecfromFreq-1372"><span class="linenos">1372</span></a>
</span><span id="MassSpecfromFreq-1373"><a href="#MassSpecfromFreq-1373"><span class="linenos">1373</span></a>    <span class="k">def</span> <span class="nf">_sort_mz_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1374"><a href="#MassSpecfromFreq-1374"><span class="linenos">1374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the mass spectrum by m/z values.&quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq-1375"><a href="#MassSpecfromFreq-1375"><span class="linenos">1375</span></a>
</span><span id="MassSpecfromFreq-1376"><a href="#MassSpecfromFreq-1376"><span class="linenos">1376</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
</span><span id="MassSpecfromFreq-1377"><a href="#MassSpecfromFreq-1377"><span class="linenos">1377</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MassSpecfromFreq-1378"><a href="#MassSpecfromFreq-1378"><span class="linenos">1378</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MassSpecfromFreq-1379"><a href="#MassSpecfromFreq-1379"><span class="linenos">1379</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="MassSpecfromFreq-1380"><a href="#MassSpecfromFreq-1380"><span class="linenos">1380</span></a>
</span><span id="MassSpecfromFreq-1381"><a href="#MassSpecfromFreq-1381"><span class="linenos">1381</span></a>    <span class="k">def</span> <span class="nf">_set_mz_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1382"><a href="#MassSpecfromFreq-1382"><span class="linenos">1382</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the m/z domain of the mass spectrum based on the settings of d_params.&quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq-1383"><a href="#MassSpecfromFreq-1383"><span class="linenos">1383</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">bruker_frequency</span><span class="p">:</span>
</span><span id="MassSpecfromFreq-1384"><a href="#MassSpecfromFreq-1384"><span class="linenos">1384</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz_bruker</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1385"><a href="#MassSpecfromFreq-1385"><span class="linenos">1385</span></a>
</span><span id="MassSpecfromFreq-1386"><a href="#MassSpecfromFreq-1386"><span class="linenos">1386</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecfromFreq-1387"><a href="#MassSpecfromFreq-1387"><span class="linenos">1387</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_f_to_mz</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1388"><a href="#MassSpecfromFreq-1388"><span class="linenos">1388</span></a>
</span><span id="MassSpecfromFreq-1389"><a href="#MassSpecfromFreq-1389"><span class="linenos">1389</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecfromFreq-1390"><a href="#MassSpecfromFreq-1390"><span class="linenos">1390</span></a>    <span class="k">def</span> <span class="nf">transient_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1391"><a href="#MassSpecfromFreq-1391"><span class="linenos">1391</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the transient settings of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq-1392"><a href="#MassSpecfromFreq-1392"><span class="linenos">1392</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transient</span>
</span><span id="MassSpecfromFreq-1393"><a href="#MassSpecfromFreq-1393"><span class="linenos">1393</span></a>
</span><span id="MassSpecfromFreq-1394"><a href="#MassSpecfromFreq-1394"><span class="linenos">1394</span></a>    <span class="nd">@transient_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecfromFreq-1395"><a href="#MassSpecfromFreq-1395"><span class="linenos">1395</span></a>    <span class="k">def</span> <span class="nf">transient_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_TransientSetting</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1396"><a href="#MassSpecfromFreq-1396"><span class="linenos">1396</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">transient</span> <span class="o">=</span> <span class="n">instance_TransientSetting</span>
</span><span id="MassSpecfromFreq-1397"><a href="#MassSpecfromFreq-1397"><span class="linenos">1397</span></a>
</span><span id="MassSpecfromFreq-1398"><a href="#MassSpecfromFreq-1398"><span class="linenos">1398</span></a>    <span class="k">def</span> <span class="nf">calc_magnetron_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_magnetron_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">magnetron_freq_bins</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
</span><span id="MassSpecfromFreq-1399"><a href="#MassSpecfromFreq-1399"><span class="linenos">1399</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the magnetron frequency of the mass spectrum.</span>
</span><span id="MassSpecfromFreq-1400"><a href="#MassSpecfromFreq-1400"><span class="linenos">1400</span></a>
</span><span id="MassSpecfromFreq-1401"><a href="#MassSpecfromFreq-1401"><span class="linenos">1401</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecfromFreq-1402"><a href="#MassSpecfromFreq-1402"><span class="linenos">1402</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecfromFreq-1403"><a href="#MassSpecfromFreq-1403"><span class="linenos">1403</span></a><span class="sd">        max_magnetron_freq : float, optional</span>
</span><span id="MassSpecfromFreq-1404"><a href="#MassSpecfromFreq-1404"><span class="linenos">1404</span></a><span class="sd">            The maximum magnetron frequency. Defaults to 50.</span>
</span><span id="MassSpecfromFreq-1405"><a href="#MassSpecfromFreq-1405"><span class="linenos">1405</span></a><span class="sd">        magnetron_freq_bins : int, optional</span>
</span><span id="MassSpecfromFreq-1406"><a href="#MassSpecfromFreq-1406"><span class="linenos">1406</span></a><span class="sd">            The number of bins to use for the histogram. Defaults to 300.</span>
</span><span id="MassSpecfromFreq-1407"><a href="#MassSpecfromFreq-1407"><span class="linenos">1407</span></a>
</span><span id="MassSpecfromFreq-1408"><a href="#MassSpecfromFreq-1408"><span class="linenos">1408</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecfromFreq-1409"><a href="#MassSpecfromFreq-1409"><span class="linenos">1409</span></a><span class="sd">        -------</span>
</span><span id="MassSpecfromFreq-1410"><a href="#MassSpecfromFreq-1410"><span class="linenos">1410</span></a><span class="sd">        None</span>
</span><span id="MassSpecfromFreq-1411"><a href="#MassSpecfromFreq-1411"><span class="linenos">1411</span></a>
</span><span id="MassSpecfromFreq-1412"><a href="#MassSpecfromFreq-1412"><span class="linenos">1412</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecfromFreq-1413"><a href="#MassSpecfromFreq-1413"><span class="linenos">1413</span></a><span class="sd">        -----</span>
</span><span id="MassSpecfromFreq-1414"><a href="#MassSpecfromFreq-1414"><span class="linenos">1414</span></a><span class="sd">        Calculates the magnetron frequency by examining all the picked peaks and the distances between them in the frequency domain.</span>
</span><span id="MassSpecfromFreq-1415"><a href="#MassSpecfromFreq-1415"><span class="linenos">1415</span></a><span class="sd">        A histogram of those values below the threshold &#39;max_magnetron_freq&#39; with the &#39;magnetron_freq_bins&#39; number of bins is calculated.</span>
</span><span id="MassSpecfromFreq-1416"><a href="#MassSpecfromFreq-1416"><span class="linenos">1416</span></a><span class="sd">        A gaussian model is fit to this histogram - the center value of this (statistically probably) the magnetron frequency.</span>
</span><span id="MassSpecfromFreq-1417"><a href="#MassSpecfromFreq-1417"><span class="linenos">1417</span></a><span class="sd">        This appears to work well or nOmega datasets, but may not work well for 1x datasets or those with very low magnetron peaks.</span>
</span><span id="MassSpecfromFreq-1418"><a href="#MassSpecfromFreq-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq-1419"><a href="#MassSpecfromFreq-1419"><span class="linenos">1419</span></a>        <span class="n">ms_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_exp</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">])</span>
</span><span id="MassSpecfromFreq-1420"><a href="#MassSpecfromFreq-1420"><span class="linenos">1420</span></a>        <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1421"><a href="#MassSpecfromFreq-1421"><span class="linenos">1421</span></a>
</span><span id="MassSpecfromFreq-1422"><a href="#MassSpecfromFreq-1422"><span class="linenos">1422</span></a>        <span class="n">freq_hist</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span>
</span><span id="MassSpecfromFreq-1423"><a href="#MassSpecfromFreq-1423"><span class="linenos">1423</span></a>            <span class="n">ms_df</span><span class="p">[</span><span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_magnetron_freq</span><span class="p">][</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">],</span>
</span><span id="MassSpecfromFreq-1424"><a href="#MassSpecfromFreq-1424"><span class="linenos">1424</span></a>            <span class="n">bins</span><span class="o">=</span><span class="n">magnetron_freq_bins</span><span class="p">,</span>
</span><span id="MassSpecfromFreq-1425"><a href="#MassSpecfromFreq-1425"><span class="linenos">1425</span></a>        <span class="p">)</span>
</span><span id="MassSpecfromFreq-1426"><a href="#MassSpecfromFreq-1426"><span class="linenos">1426</span></a>
</span><span id="MassSpecfromFreq-1427"><a href="#MassSpecfromFreq-1427"><span class="linenos">1427</span></a>        <span class="n">mod</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
</span><span id="MassSpecfromFreq-1428"><a href="#MassSpecfromFreq-1428"><span class="linenos">1428</span></a>        <span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MassSpecfromFreq-1429"><a href="#MassSpecfromFreq-1429"><span class="linenos">1429</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MassSpecfromFreq-1430"><a href="#MassSpecfromFreq-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span>
</span><span id="MassSpecfromFreq-1431"><a href="#MassSpecfromFreq-1431"><span class="linenos">1431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>A mass spectrum class when data entry is on frequency domain</p>

<h6 id="notes">Notes</h6>

<ul>
<li>Transform to m/z based on the settings stored at d_params</li>
<li>Stores the profile data and instrument settings</li>
<li>Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</li>
<li>_mspeaks is populated under the hood by calling process_mass_spec method</li>
<li>iteration is null if _mspeaks is empty</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>frequency_domain</strong> (list(float)):
all datapoints in frequency domain in Hz</li>
<li><strong>magnitude :  frequency_domain</strong> (list(float)):
all datapoints in for magnitude of each frequency datapoint</li>
<li><strong>d_params : dict{'str'</strong> (float, int or str}):
contains the instrument settings and processing settings</li>
<li><strong>auto_process</strong> (bool, optional):
Whether to automatically process the mass spectrum. Defaults to True.</li>
<li><strong>keep_profile</strong> (bool, optional):
Whether to keep the profile data. Defaults to True.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>has_frequency</strong> (bool):
Whether the mass spectrum has frequency data.</li>
<li><strong>_frequency_domain</strong> (list(float)):
Frequency domain in Hz</li>
<li><strong>label</strong> (str):
store label (Bruker, Midas Transient, see Labels class ). It across distinct processing points</li>
<li><strong>_abundance</strong> (ndarray):
The abundance values of the mass spectrum.</li>
<li><strong>_mz_exp</strong> (ndarray):
The m/z values of the mass spectrum.</li>
<li><strong>_mspeaks</strong> (list):
A list of mass peaks.</li>
<li><strong>See Also</strong> (all the attributes of MassSpecBase class):</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>_set_mz_domain().
calculates the m_z based on the setting of d_params</li>
<li>process_mass_spec().  Process the mass spectrum.</li>
</ul>

<p>see also: MassSpecBase(), MassSpecProfile(), MassSpecCentroid()</p>
</div>


                            <div id="MassSpecfromFreq.__init__" class="classattr">
                                        <input id="MassSpecfromFreq.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MassSpecfromFreq</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">frequency_domain</span>,</span><span class="param">	<span class="n">magnitude</span>,</span><span class="param">	<span class="n">d_params</span>,</span><span class="param">	<span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="MassSpecfromFreq.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecfromFreq.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecfromFreq.__init__-1350"><a href="#MassSpecfromFreq.__init__-1350"><span class="linenos">1350</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="MassSpecfromFreq.__init__-1351"><a href="#MassSpecfromFreq.__init__-1351"><span class="linenos">1351</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1352"><a href="#MassSpecfromFreq.__init__-1352"><span class="linenos">1352</span></a>        <span class="n">frequency_domain</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1353"><a href="#MassSpecfromFreq.__init__-1353"><span class="linenos">1353</span></a>        <span class="n">magnitude</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1354"><a href="#MassSpecfromFreq.__init__-1354"><span class="linenos">1354</span></a>        <span class="n">d_params</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1355"><a href="#MassSpecfromFreq.__init__-1355"><span class="linenos">1355</span></a>        <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1356"><a href="#MassSpecfromFreq.__init__-1356"><span class="linenos">1356</span></a>        <span class="n">keep_profile</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.__init__-1357"><a href="#MassSpecfromFreq.__init__-1357"><span class="linenos">1357</span></a>    <span class="p">):</span>
</span><span id="MassSpecfromFreq.__init__-1358"><a href="#MassSpecfromFreq.__init__-1358"><span class="linenos">1358</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecfromFreq.__init__-1359"><a href="#MassSpecfromFreq.__init__-1359"><span class="linenos">1359</span></a>
</span><span id="MassSpecfromFreq.__init__-1360"><a href="#MassSpecfromFreq.__init__-1360"><span class="linenos">1360</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_frequency_domain</span> <span class="o">=</span> <span class="n">frequency_domain</span>
</span><span id="MassSpecfromFreq.__init__-1361"><a href="#MassSpecfromFreq.__init__-1361"><span class="linenos">1361</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">has_frequency</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecfromFreq.__init__-1362"><a href="#MassSpecfromFreq.__init__-1362"><span class="linenos">1362</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_mz_domain</span><span class="p">()</span>
</span><span id="MassSpecfromFreq.__init__-1363"><a href="#MassSpecfromFreq.__init__-1363"><span class="linenos">1363</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_sort_mz_domain</span><span class="p">()</span>
</span><span id="MassSpecfromFreq.__init__-1364"><a href="#MassSpecfromFreq.__init__-1364"><span class="linenos">1364</span></a>
</span><span id="MassSpecfromFreq.__init__-1365"><a href="#MassSpecfromFreq.__init__-1365"><span class="linenos">1365</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecfromFreq.__init__-1366"><a href="#MassSpecfromFreq.__init__-1366"><span class="linenos">1366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecfromFreq.__init__-1367"><a href="#MassSpecfromFreq.__init__-1367"><span class="linenos">1367</span></a>
</span><span id="MassSpecfromFreq.__init__-1368"><a href="#MassSpecfromFreq.__init__-1368"><span class="linenos">1368</span></a>        <span class="c1"># use this call to automatically process data as the object is created, Setting need to be changed before initiating the class to be in effect</span>
</span><span id="MassSpecfromFreq.__init__-1369"><a href="#MassSpecfromFreq.__init__-1369"><span class="linenos">1369</span></a>
</span><span id="MassSpecfromFreq.__init__-1370"><a href="#MassSpecfromFreq.__init__-1370"><span class="linenos">1370</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecfromFreq.__init__-1371"><a href="#MassSpecfromFreq.__init__-1371"><span class="linenos">1371</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">(</span><span class="n">keep_profile</span><span class="o">=</span><span class="n">keep_profile</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="MassSpecfromFreq.has_frequency" class="classattr">
                                <div class="attr variable">
            <span class="name">has_frequency</span>

        
    </div>
    <a class="headerlink" href="#MassSpecfromFreq.has_frequency"></a>
    
    

                            </div>
                            <div id="MassSpecfromFreq.magnetron_frequency" class="classattr">
                                <div class="attr variable">
            <span class="name">magnetron_frequency</span>

        
    </div>
    <a class="headerlink" href="#MassSpecfromFreq.magnetron_frequency"></a>
    
    

                            </div>
                            <div id="MassSpecfromFreq.magnetron_frequency_sigma" class="classattr">
                                <div class="attr variable">
            <span class="name">magnetron_frequency_sigma</span>

        
    </div>
    <a class="headerlink" href="#MassSpecfromFreq.magnetron_frequency_sigma"></a>
    
    

                            </div>
                            <div id="MassSpecfromFreq.transient_settings" class="classattr">
                                <div class="attr variable">
            <span class="name">transient_settings</span>

        
    </div>
    <a class="headerlink" href="#MassSpecfromFreq.transient_settings"></a>
    
            <div class="docstring"><p>Return the transient settings of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecfromFreq.calc_magnetron_freq" class="classattr">
                                        <input id="MassSpecfromFreq.calc_magnetron_freq-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">calc_magnetron_freq</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">max_magnetron_freq</span><span class="o">=</span><span class="mi">50</span>, </span><span class="param"><span class="n">magnetron_freq_bins</span><span class="o">=</span><span class="mi">300</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecfromFreq.calc_magnetron_freq-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecfromFreq.calc_magnetron_freq"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecfromFreq.calc_magnetron_freq-1398"><a href="#MassSpecfromFreq.calc_magnetron_freq-1398"><span class="linenos">1398</span></a>    <span class="k">def</span> <span class="nf">calc_magnetron_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_magnetron_freq</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">magnetron_freq_bins</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1399"><a href="#MassSpecfromFreq.calc_magnetron_freq-1399"><span class="linenos">1399</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the magnetron frequency of the mass spectrum.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1400"><a href="#MassSpecfromFreq.calc_magnetron_freq-1400"><span class="linenos">1400</span></a>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1401"><a href="#MassSpecfromFreq.calc_magnetron_freq-1401"><span class="linenos">1401</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1402"><a href="#MassSpecfromFreq.calc_magnetron_freq-1402"><span class="linenos">1402</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1403"><a href="#MassSpecfromFreq.calc_magnetron_freq-1403"><span class="linenos">1403</span></a><span class="sd">        max_magnetron_freq : float, optional</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1404"><a href="#MassSpecfromFreq.calc_magnetron_freq-1404"><span class="linenos">1404</span></a><span class="sd">            The maximum magnetron frequency. Defaults to 50.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1405"><a href="#MassSpecfromFreq.calc_magnetron_freq-1405"><span class="linenos">1405</span></a><span class="sd">        magnetron_freq_bins : int, optional</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1406"><a href="#MassSpecfromFreq.calc_magnetron_freq-1406"><span class="linenos">1406</span></a><span class="sd">            The number of bins to use for the histogram. Defaults to 300.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1407"><a href="#MassSpecfromFreq.calc_magnetron_freq-1407"><span class="linenos">1407</span></a>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1408"><a href="#MassSpecfromFreq.calc_magnetron_freq-1408"><span class="linenos">1408</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1409"><a href="#MassSpecfromFreq.calc_magnetron_freq-1409"><span class="linenos">1409</span></a><span class="sd">        -------</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1410"><a href="#MassSpecfromFreq.calc_magnetron_freq-1410"><span class="linenos">1410</span></a><span class="sd">        None</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1411"><a href="#MassSpecfromFreq.calc_magnetron_freq-1411"><span class="linenos">1411</span></a>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1412"><a href="#MassSpecfromFreq.calc_magnetron_freq-1412"><span class="linenos">1412</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1413"><a href="#MassSpecfromFreq.calc_magnetron_freq-1413"><span class="linenos">1413</span></a><span class="sd">        -----</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1414"><a href="#MassSpecfromFreq.calc_magnetron_freq-1414"><span class="linenos">1414</span></a><span class="sd">        Calculates the magnetron frequency by examining all the picked peaks and the distances between them in the frequency domain.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1415"><a href="#MassSpecfromFreq.calc_magnetron_freq-1415"><span class="linenos">1415</span></a><span class="sd">        A histogram of those values below the threshold &#39;max_magnetron_freq&#39; with the &#39;magnetron_freq_bins&#39; number of bins is calculated.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1416"><a href="#MassSpecfromFreq.calc_magnetron_freq-1416"><span class="linenos">1416</span></a><span class="sd">        A gaussian model is fit to this histogram - the center value of this (statistically probably) the magnetron frequency.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1417"><a href="#MassSpecfromFreq.calc_magnetron_freq-1417"><span class="linenos">1417</span></a><span class="sd">        This appears to work well or nOmega datasets, but may not work well for 1x datasets or those with very low magnetron peaks.</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1418"><a href="#MassSpecfromFreq.calc_magnetron_freq-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1419"><a href="#MassSpecfromFreq.calc_magnetron_freq-1419"><span class="linenos">1419</span></a>        <span class="n">ms_df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">freq_exp</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">])</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1420"><a href="#MassSpecfromFreq.calc_magnetron_freq-1420"><span class="linenos">1420</span></a>        <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;Freq&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1421"><a href="#MassSpecfromFreq.calc_magnetron_freq-1421"><span class="linenos">1421</span></a>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1422"><a href="#MassSpecfromFreq.calc_magnetron_freq-1422"><span class="linenos">1422</span></a>        <span class="n">freq_hist</span> <span class="o">=</span> <span class="n">histogram</span><span class="p">(</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1423"><a href="#MassSpecfromFreq.calc_magnetron_freq-1423"><span class="linenos">1423</span></a>            <span class="n">ms_df</span><span class="p">[</span><span class="n">ms_df</span><span class="p">[</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">max_magnetron_freq</span><span class="p">][</span><span class="s2">&quot;FreqDelta&quot;</span><span class="p">],</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1424"><a href="#MassSpecfromFreq.calc_magnetron_freq-1424"><span class="linenos">1424</span></a>            <span class="n">bins</span><span class="o">=</span><span class="n">magnetron_freq_bins</span><span class="p">,</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1425"><a href="#MassSpecfromFreq.calc_magnetron_freq-1425"><span class="linenos">1425</span></a>        <span class="p">)</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1426"><a href="#MassSpecfromFreq.calc_magnetron_freq-1426"><span class="linenos">1426</span></a>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1427"><a href="#MassSpecfromFreq.calc_magnetron_freq-1427"><span class="linenos">1427</span></a>        <span class="n">mod</span> <span class="o">=</span> <span class="n">GaussianModel</span><span class="p">()</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1428"><a href="#MassSpecfromFreq.calc_magnetron_freq-1428"><span class="linenos">1428</span></a>        <span class="n">pars</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">guess</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1429"><a href="#MassSpecfromFreq.calc_magnetron_freq-1429"><span class="linenos">1429</span></a>        <span class="n">out</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pars</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">freq_hist</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1430"><a href="#MassSpecfromFreq.calc_magnetron_freq-1430"><span class="linenos">1430</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;center&quot;</span><span class="p">]</span>
</span><span id="MassSpecfromFreq.calc_magnetron_freq-1431"><a href="#MassSpecfromFreq.calc_magnetron_freq-1431"><span class="linenos">1431</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">magnetron_frequency_sigma</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">best_values</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Calculates the magnetron frequency of the mass spectrum.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>max_magnetron_freq</strong> (float, optional):
The maximum magnetron frequency. Defaults to 50.</li>
<li><strong>magnetron_freq_bins</strong> (int, optional):
The number of bins to use for the histogram. Defaults to 300.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None</strong></li>
</ul>

<h6 id="notes">Notes</h6>

<p>Calculates the magnetron frequency by examining all the picked peaks and the distances between them in the frequency domain.
A histogram of those values below the threshold 'max_magnetron_freq' with the 'magnetron_freq_bins' number of bins is calculated.
A gaussian model is fit to this histogram - the center value of this (statistically probably) the magnetron frequency.
This appears to work well or nOmega datasets, but may not work well for 1x datasets or those with very low magnetron peaks.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#MassSpecBase">MassSpecBase</a></dt>
                                <dd id="MassSpecfromFreq.mspeaks" class="variable"><a href="#MassSpecBase.mspeaks">mspeaks</a></dd>
                <dd id="MassSpecfromFreq.is_calibrated" class="variable"><a href="#MassSpecBase.is_calibrated">is_calibrated</a></dd>
                <dd id="MassSpecfromFreq.is_centroid" class="variable"><a href="#MassSpecBase.is_centroid">is_centroid</a></dd>
                <dd id="MassSpecfromFreq.calibration_order" class="variable"><a href="#MassSpecBase.calibration_order">calibration_order</a></dd>
                <dd id="MassSpecfromFreq.calibration_points" class="variable"><a href="#MassSpecBase.calibration_points">calibration_points</a></dd>
                <dd id="MassSpecfromFreq.calibration_ref_mzs" class="variable"><a href="#MassSpecBase.calibration_ref_mzs">calibration_ref_mzs</a></dd>
                <dd id="MassSpecfromFreq.calibration_meas_mzs" class="variable"><a href="#MassSpecBase.calibration_meas_mzs">calibration_meas_mzs</a></dd>
                <dd id="MassSpecfromFreq.calibration_RMS" class="variable"><a href="#MassSpecBase.calibration_RMS">calibration_RMS</a></dd>
                <dd id="MassSpecfromFreq.calibration_segment" class="variable"><a href="#MassSpecBase.calibration_segment">calibration_segment</a></dd>
                <dd id="MassSpecfromFreq.calibration_raw_error_median" class="variable"><a href="#MassSpecBase.calibration_raw_error_median">calibration_raw_error_median</a></dd>
                <dd id="MassSpecfromFreq.calibration_raw_error_stdev" class="variable"><a href="#MassSpecBase.calibration_raw_error_stdev">calibration_raw_error_stdev</a></dd>
                <dd id="MassSpecfromFreq.set_indexes" class="function"><a href="#MassSpecBase.set_indexes">set_indexes</a></dd>
                <dd id="MassSpecfromFreq.reset_indexes" class="function"><a href="#MassSpecBase.reset_indexes">reset_indexes</a></dd>
                <dd id="MassSpecfromFreq.add_mspeak" class="function"><a href="#MassSpecBase.add_mspeak">add_mspeak</a></dd>
                <dd id="MassSpecfromFreq.reset_cal_therms" class="function"><a href="#MassSpecBase.reset_cal_therms">reset_cal_therms</a></dd>
                <dd id="MassSpecfromFreq.clear_molecular_formulas" class="function"><a href="#MassSpecBase.clear_molecular_formulas">clear_molecular_formulas</a></dd>
                <dd id="MassSpecfromFreq.process_mass_spec" class="function"><a href="#MassSpecBase.process_mass_spec">process_mass_spec</a></dd>
                <dd id="MassSpecfromFreq.cal_noise_threshold" class="function"><a href="#MassSpecBase.cal_noise_threshold">cal_noise_threshold</a></dd>
                <dd id="MassSpecfromFreq.parameters" class="variable"><a href="#MassSpecBase.parameters">parameters</a></dd>
                <dd id="MassSpecfromFreq.set_parameter_from_json" class="function"><a href="#MassSpecBase.set_parameter_from_json">set_parameter_from_json</a></dd>
                <dd id="MassSpecfromFreq.set_parameter_from_toml" class="function"><a href="#MassSpecBase.set_parameter_from_toml">set_parameter_from_toml</a></dd>
                <dd id="MassSpecfromFreq.mspeaks_settings" class="variable"><a href="#MassSpecBase.mspeaks_settings">mspeaks_settings</a></dd>
                <dd id="MassSpecfromFreq.settings" class="variable"><a href="#MassSpecBase.settings">settings</a></dd>
                <dd id="MassSpecfromFreq.molecular_search_settings" class="variable"><a href="#MassSpecBase.molecular_search_settings">molecular_search_settings</a></dd>
                <dd id="MassSpecfromFreq.mz_cal_profile" class="variable"><a href="#MassSpecBase.mz_cal_profile">mz_cal_profile</a></dd>
                <dd id="MassSpecfromFreq.mz_cal" class="variable"><a href="#MassSpecBase.mz_cal">mz_cal</a></dd>
                <dd id="MassSpecfromFreq.mz_exp" class="variable"><a href="#MassSpecBase.mz_exp">mz_exp</a></dd>
                <dd id="MassSpecfromFreq.freq_exp_profile" class="variable"><a href="#MassSpecBase.freq_exp_profile">freq_exp_profile</a></dd>
                <dd id="MassSpecfromFreq.freq_exp_pp" class="variable"><a href="#MassSpecBase.freq_exp_pp">freq_exp_pp</a></dd>
                <dd id="MassSpecfromFreq.mz_exp_profile" class="variable"><a href="#MassSpecBase.mz_exp_profile">mz_exp_profile</a></dd>
                <dd id="MassSpecfromFreq.mz_exp_pp" class="variable"><a href="#MassSpecBase.mz_exp_pp">mz_exp_pp</a></dd>
                <dd id="MassSpecfromFreq.abundance_profile" class="variable"><a href="#MassSpecBase.abundance_profile">abundance_profile</a></dd>
                <dd id="MassSpecfromFreq.abundance_profile_pp" class="variable"><a href="#MassSpecBase.abundance_profile_pp">abundance_profile_pp</a></dd>
                <dd id="MassSpecfromFreq.abundance" class="variable"><a href="#MassSpecBase.abundance">abundance</a></dd>
                <dd id="MassSpecfromFreq.freq_exp" class="function"><a href="#MassSpecBase.freq_exp">freq_exp</a></dd>
                <dd id="MassSpecfromFreq.resolving_power" class="variable"><a href="#MassSpecBase.resolving_power">resolving_power</a></dd>
                <dd id="MassSpecfromFreq.signal_to_noise" class="variable"><a href="#MassSpecBase.signal_to_noise">signal_to_noise</a></dd>
                <dd id="MassSpecfromFreq.nominal_mz" class="variable"><a href="#MassSpecBase.nominal_mz">nominal_mz</a></dd>
                <dd id="MassSpecfromFreq.get_mz_and_abundance_peaks_tuples" class="function"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples">get_mz_and_abundance_peaks_tuples</a></dd>
                <dd id="MassSpecfromFreq.kmd" class="variable"><a href="#MassSpecBase.kmd">kmd</a></dd>
                <dd id="MassSpecfromFreq.kendrick_mass" class="variable"><a href="#MassSpecBase.kendrick_mass">kendrick_mass</a></dd>
                <dd id="MassSpecfromFreq.max_mz_exp" class="variable"><a href="#MassSpecBase.max_mz_exp">max_mz_exp</a></dd>
                <dd id="MassSpecfromFreq.min_mz_exp" class="variable"><a href="#MassSpecBase.min_mz_exp">min_mz_exp</a></dd>
                <dd id="MassSpecfromFreq.max_abundance" class="variable"><a href="#MassSpecBase.max_abundance">max_abundance</a></dd>
                <dd id="MassSpecfromFreq.max_signal_to_noise" class="variable"><a href="#MassSpecBase.max_signal_to_noise">max_signal_to_noise</a></dd>
                <dd id="MassSpecfromFreq.most_abundant_mspeak" class="variable"><a href="#MassSpecBase.most_abundant_mspeak">most_abundant_mspeak</a></dd>
                <dd id="MassSpecfromFreq.min_abundance" class="variable"><a href="#MassSpecBase.min_abundance">min_abundance</a></dd>
                <dd id="MassSpecfromFreq.dynamic_range" class="variable"><a href="#MassSpecBase.dynamic_range">dynamic_range</a></dd>
                <dd id="MassSpecfromFreq.baseline_noise" class="variable"><a href="#MassSpecBase.baseline_noise">baseline_noise</a></dd>
                <dd id="MassSpecfromFreq.baseline_noise_std" class="variable"><a href="#MassSpecBase.baseline_noise_std">baseline_noise_std</a></dd>
                <dd id="MassSpecfromFreq.Aterm" class="variable"><a href="#MassSpecBase.Aterm">Aterm</a></dd>
                <dd id="MassSpecfromFreq.Bterm" class="variable"><a href="#MassSpecBase.Bterm">Bterm</a></dd>
                <dd id="MassSpecfromFreq.Cterm" class="variable"><a href="#MassSpecBase.Cterm">Cterm</a></dd>
                <dd id="MassSpecfromFreq.filename" class="variable"><a href="#MassSpecBase.filename">filename</a></dd>
                <dd id="MassSpecfromFreq.dir_location" class="variable"><a href="#MassSpecBase.dir_location">dir_location</a></dd>
                <dd id="MassSpecfromFreq.sort_by_mz" class="function"><a href="#MassSpecBase.sort_by_mz">sort_by_mz</a></dd>
                <dd id="MassSpecfromFreq.sort_by_abundance" class="function"><a href="#MassSpecBase.sort_by_abundance">sort_by_abundance</a></dd>
                <dd id="MassSpecfromFreq.tic" class="variable"><a href="#MassSpecBase.tic">tic</a></dd>
                <dd id="MassSpecfromFreq.check_mspeaks_warning" class="function"><a href="#MassSpecBase.check_mspeaks_warning">check_mspeaks_warning</a></dd>
                <dd id="MassSpecfromFreq.check_mspeaks" class="function"><a href="#MassSpecBase.check_mspeaks">check_mspeaks</a></dd>
                <dd id="MassSpecfromFreq.remove_assignment_by_index" class="function"><a href="#MassSpecBase.remove_assignment_by_index">remove_assignment_by_index</a></dd>
                <dd id="MassSpecfromFreq.filter_by_index" class="function"><a href="#MassSpecBase.filter_by_index">filter_by_index</a></dd>
                <dd id="MassSpecfromFreq.filter_by_mz" class="function"><a href="#MassSpecBase.filter_by_mz">filter_by_mz</a></dd>
                <dd id="MassSpecfromFreq.filter_by_s2n" class="function"><a href="#MassSpecBase.filter_by_s2n">filter_by_s2n</a></dd>
                <dd id="MassSpecfromFreq.filter_by_abundance" class="function"><a href="#MassSpecBase.filter_by_abundance">filter_by_abundance</a></dd>
                <dd id="MassSpecfromFreq.filter_by_max_resolving_power" class="function"><a href="#MassSpecBase.filter_by_max_resolving_power">filter_by_max_resolving_power</a></dd>
                <dd id="MassSpecfromFreq.filter_by_mean_resolving_power" class="function"><a href="#MassSpecBase.filter_by_mean_resolving_power">filter_by_mean_resolving_power</a></dd>
                <dd id="MassSpecfromFreq.filter_by_min_resolving_power" class="function"><a href="#MassSpecBase.filter_by_min_resolving_power">filter_by_min_resolving_power</a></dd>
                <dd id="MassSpecfromFreq.filter_by_noise_threshold" class="function"><a href="#MassSpecBase.filter_by_noise_threshold">filter_by_noise_threshold</a></dd>
                <dd id="MassSpecfromFreq.find_peaks" class="function"><a href="#MassSpecBase.find_peaks">find_peaks</a></dd>
                <dd id="MassSpecfromFreq.change_kendrick_base_all_mspeaks" class="function"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks">change_kendrick_base_all_mspeaks</a></dd>
                <dd id="MassSpecfromFreq.get_nominal_mz_first_last_indexes" class="function"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes">get_nominal_mz_first_last_indexes</a></dd>
                <dd id="MassSpecfromFreq.get_masses_count_by_nominal_mass" class="function"><a href="#MassSpecBase.get_masses_count_by_nominal_mass">get_masses_count_by_nominal_mass</a></dd>
                <dd id="MassSpecfromFreq.datapoints_count_by_nominal_mz" class="function"><a href="#MassSpecBase.datapoints_count_by_nominal_mz">datapoints_count_by_nominal_mz</a></dd>
                <dd id="MassSpecfromFreq.get_nominal_mass_indexes" class="function"><a href="#MassSpecBase.get_nominal_mass_indexes">get_nominal_mass_indexes</a></dd>
                <dd id="MassSpecfromFreq.plot_centroid" class="function"><a href="#MassSpecBase.plot_centroid">plot_centroid</a></dd>
                <dd id="MassSpecfromFreq.plot_profile_and_noise_threshold" class="function"><a href="#MassSpecBase.plot_profile_and_noise_threshold">plot_profile_and_noise_threshold</a></dd>
                <dd id="MassSpecfromFreq.plot_mz_domain_profile" class="function"><a href="#MassSpecBase.plot_mz_domain_profile">plot_mz_domain_profile</a></dd>
                <dd id="MassSpecfromFreq.to_excel" class="function"><a href="#MassSpecBase.to_excel">to_excel</a></dd>
                <dd id="MassSpecfromFreq.to_hdf" class="function"><a href="#MassSpecBase.to_hdf">to_hdf</a></dd>
                <dd id="MassSpecfromFreq.to_csv" class="function"><a href="#MassSpecBase.to_csv">to_csv</a></dd>
                <dd id="MassSpecfromFreq.to_pandas" class="function"><a href="#MassSpecBase.to_pandas">to_pandas</a></dd>
                <dd id="MassSpecfromFreq.to_dataframe" class="function"><a href="#MassSpecBase.to_dataframe">to_dataframe</a></dd>
                <dd id="MassSpecfromFreq.to_json" class="function"><a href="#MassSpecBase.to_json">to_json</a></dd>
                <dd id="MassSpecfromFreq.parameters_json" class="function"><a href="#MassSpecBase.parameters_json">parameters_json</a></dd>
                <dd id="MassSpecfromFreq.parameters_toml" class="function"><a href="#MassSpecBase.parameters_toml">parameters_toml</a></dd>

            </div>
            <div><dt><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></dt>
                                <dd id="MassSpecfromFreq.percentile_assigned" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.percentile_assigned">percentile_assigned</a></dd>
                <dd id="MassSpecfromFreq.resolving_power_calc" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.resolving_power_calc">resolving_power_calc</a></dd>
                <dd id="MassSpecfromFreq.number_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.number_average_molecular_weight">number_average_molecular_weight</a></dd>
                <dd id="MassSpecfromFreq.weight_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.weight_average_molecular_weight">weight_average_molecular_weight</a></dd>

            </div>
            <div><dt><a href="../calc/PeakPicking.html#PeakPicking">corems.mass_spectrum.calc.PeakPicking.PeakPicking</a></dt>
                                <dd id="MassSpecfromFreq.prepare_peak_picking_data" class="function"><a href="../calc/PeakPicking.html#PeakPicking.prepare_peak_picking_data">prepare_peak_picking_data</a></dd>
                <dd id="MassSpecfromFreq.cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cut_mz_domain_peak_picking">cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecfromFreq.legacy_cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.legacy_cut_mz_domain_peak_picking">legacy_cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecfromFreq.extrapolate_axis" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axis">extrapolate_axis</a></dd>
                <dd id="MassSpecfromFreq.extrapolate_axes_for_pp" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axes_for_pp">extrapolate_axes_for_pp</a></dd>
                <dd id="MassSpecfromFreq.do_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.do_peak_picking">do_peak_picking</a></dd>
                <dd id="MassSpecfromFreq.find_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_minima">find_minima</a></dd>
                <dd id="MassSpecfromFreq.linear_fit_calc" class="function"><a href="../calc/PeakPicking.html#PeakPicking.linear_fit_calc">linear_fit_calc</a></dd>
                <dd id="MassSpecfromFreq.calculate_resolving_power" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calculate_resolving_power">calculate_resolving_power</a></dd>
                <dd id="MassSpecfromFreq.cal_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cal_minima">cal_minima</a></dd>
                <dd id="MassSpecfromFreq.calc_centroid" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid">calc_centroid</a></dd>
                <dd id="MassSpecfromFreq.get_threshold" class="function"><a href="../calc/PeakPicking.html#PeakPicking.get_threshold">get_threshold</a></dd>
                <dd id="MassSpecfromFreq.algebraic_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.algebraic_quadratic">algebraic_quadratic</a></dd>
                <dd id="MassSpecfromFreq.find_apex_fit_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_apex_fit_quadratic">find_apex_fit_quadratic</a></dd>
                <dd id="MassSpecfromFreq.check_prominence" class="function"><a href="../calc/PeakPicking.html#PeakPicking.check_prominence">check_prominence</a></dd>
                <dd id="MassSpecfromFreq.use_the_max" class="function"><a href="../calc/PeakPicking.html#PeakPicking.use_the_max">use_the_max</a></dd>
                <dd id="MassSpecfromFreq.calc_centroid_legacy" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid_legacy">calc_centroid_legacy</a></dd>

            </div>
            <div><dt><a href="../calc/NoiseCalc.html#NoiseThresholdCalc">corems.mass_spectrum.calc.NoiseCalc.NoiseThresholdCalc</a></dt>
                                <dd id="MassSpecfromFreq.get_noise_threshold" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_threshold">get_noise_threshold</a></dd>
                <dd id="MassSpecfromFreq.cut_mz_domain_noise" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.cut_mz_domain_noise">cut_mz_domain_noise</a></dd>
                <dd id="MassSpecfromFreq.get_noise_average" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_average">get_noise_average</a></dd>
                <dd id="MassSpecfromFreq.get_abundance_minima_centroid" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_abundance_minima_centroid">get_abundance_minima_centroid</a></dd>
                <dd id="MassSpecfromFreq.run_log_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_log_noise_threshold_calc">run_log_noise_threshold_calc</a></dd>
                <dd id="MassSpecfromFreq.run_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_noise_threshold_calc">run_noise_threshold_calc</a></dd>

            </div>
            <div><dt><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></dt>
                                <dd id="MassSpecfromFreq.mz_odd_even_index_lists" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.mz_odd_even_index_lists">mz_odd_even_index_lists</a></dd>
                <dd id="MassSpecfromFreq.calc_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.calc_error">calc_error</a></dd>
                <dd id="MassSpecfromFreq.populate_kendrick_index_dict_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_error">populate_kendrick_index_dict_error</a></dd>
                <dd id="MassSpecfromFreq.populate_kendrick_index_dict_rounding" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_rounding">populate_kendrick_index_dict_rounding</a></dd>
                <dd id="MassSpecfromFreq.sort_abundance_kendrick_dict" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.sort_abundance_kendrick_dict">sort_abundance_kendrick_dict</a></dd>
                <dd id="MassSpecfromFreq.kendrick_groups_indexes" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.kendrick_groups_indexes">kendrick_groups_indexes</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MassSpecCentroid">
                            <input id="MassSpecCentroid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MassSpecCentroid</span><wbr>(<span class="base"><a href="#MassSpecBase">MassSpecBase</a></span>):

                <label class="view-source-button" for="MassSpecCentroid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecCentroid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecCentroid-1434"><a href="#MassSpecCentroid-1434"><span class="linenos">1434</span></a><span class="k">class</span> <span class="nc">MassSpecCentroid</span><span class="p">(</span><span class="n">MassSpecBase</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1435"><a href="#MassSpecCentroid-1435"><span class="linenos">1435</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on centroid format</span>
</span><span id="MassSpecCentroid-1436"><a href="#MassSpecCentroid-1436"><span class="linenos">1436</span></a>
</span><span id="MassSpecCentroid-1437"><a href="#MassSpecCentroid-1437"><span class="linenos">1437</span></a><span class="sd">    Notes</span>
</span><span id="MassSpecCentroid-1438"><a href="#MassSpecCentroid-1438"><span class="linenos">1438</span></a><span class="sd">    -----</span>
</span><span id="MassSpecCentroid-1439"><a href="#MassSpecCentroid-1439"><span class="linenos">1439</span></a><span class="sd">    - Stores the centroid data and instrument settings</span>
</span><span id="MassSpecCentroid-1440"><a href="#MassSpecCentroid-1440"><span class="linenos">1440</span></a><span class="sd">    - Simulate profile data based on Gaussian or Lorentzian peak shape</span>
</span><span id="MassSpecCentroid-1441"><a href="#MassSpecCentroid-1441"><span class="linenos">1441</span></a><span class="sd">    - Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</span>
</span><span id="MassSpecCentroid-1442"><a href="#MassSpecCentroid-1442"><span class="linenos">1442</span></a><span class="sd">    - _mspeaks is populated under the hood by calling process_mass_spec method</span>
</span><span id="MassSpecCentroid-1443"><a href="#MassSpecCentroid-1443"><span class="linenos">1443</span></a><span class="sd">    - iteration is null if _mspeaks is empty</span>
</span><span id="MassSpecCentroid-1444"><a href="#MassSpecCentroid-1444"><span class="linenos">1444</span></a>
</span><span id="MassSpecCentroid-1445"><a href="#MassSpecCentroid-1445"><span class="linenos">1445</span></a><span class="sd">    Parameters</span>
</span><span id="MassSpecCentroid-1446"><a href="#MassSpecCentroid-1446"><span class="linenos">1446</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecCentroid-1447"><a href="#MassSpecCentroid-1447"><span class="linenos">1447</span></a><span class="sd">    data_dict : dict {string: numpy array float64 )</span>
</span><span id="MassSpecCentroid-1448"><a href="#MassSpecCentroid-1448"><span class="linenos">1448</span></a><span class="sd">        contains keys [m/z, Abundance, Resolving Power, S/N]</span>
</span><span id="MassSpecCentroid-1449"><a href="#MassSpecCentroid-1449"><span class="linenos">1449</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="MassSpecCentroid-1450"><a href="#MassSpecCentroid-1450"><span class="linenos">1450</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="MassSpecCentroid-1451"><a href="#MassSpecCentroid-1451"><span class="linenos">1451</span></a><span class="sd">    auto_process : bool, optional</span>
</span><span id="MassSpecCentroid-1452"><a href="#MassSpecCentroid-1452"><span class="linenos">1452</span></a><span class="sd">        Whether to automatically process the mass spectrum. Defaults to True.</span>
</span><span id="MassSpecCentroid-1453"><a href="#MassSpecCentroid-1453"><span class="linenos">1453</span></a>
</span><span id="MassSpecCentroid-1454"><a href="#MassSpecCentroid-1454"><span class="linenos">1454</span></a><span class="sd">    Attributes</span>
</span><span id="MassSpecCentroid-1455"><a href="#MassSpecCentroid-1455"><span class="linenos">1455</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecCentroid-1456"><a href="#MassSpecCentroid-1456"><span class="linenos">1456</span></a><span class="sd">    label : str</span>
</span><span id="MassSpecCentroid-1457"><a href="#MassSpecCentroid-1457"><span class="linenos">1457</span></a><span class="sd">        store label (Bruker, Midas Transient, see Labels class)</span>
</span><span id="MassSpecCentroid-1458"><a href="#MassSpecCentroid-1458"><span class="linenos">1458</span></a><span class="sd">    _baseline_noise : float</span>
</span><span id="MassSpecCentroid-1459"><a href="#MassSpecCentroid-1459"><span class="linenos">1459</span></a><span class="sd">        store baseline noise</span>
</span><span id="MassSpecCentroid-1460"><a href="#MassSpecCentroid-1460"><span class="linenos">1460</span></a><span class="sd">    _baseline_noise_std : float</span>
</span><span id="MassSpecCentroid-1461"><a href="#MassSpecCentroid-1461"><span class="linenos">1461</span></a><span class="sd">        store baseline noise std</span>
</span><span id="MassSpecCentroid-1462"><a href="#MassSpecCentroid-1462"><span class="linenos">1462</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="MassSpecCentroid-1463"><a href="#MassSpecCentroid-1463"><span class="linenos">1463</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecCentroid-1464"><a href="#MassSpecCentroid-1464"><span class="linenos">1464</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="MassSpecCentroid-1465"><a href="#MassSpecCentroid-1465"><span class="linenos">1465</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecCentroid-1466"><a href="#MassSpecCentroid-1466"><span class="linenos">1466</span></a><span class="sd">    _mspeaks : list</span>
</span><span id="MassSpecCentroid-1467"><a href="#MassSpecCentroid-1467"><span class="linenos">1467</span></a><span class="sd">        A list of mass peaks.</span>
</span><span id="MassSpecCentroid-1468"><a href="#MassSpecCentroid-1468"><span class="linenos">1468</span></a>
</span><span id="MassSpecCentroid-1469"><a href="#MassSpecCentroid-1469"><span class="linenos">1469</span></a>
</span><span id="MassSpecCentroid-1470"><a href="#MassSpecCentroid-1470"><span class="linenos">1470</span></a><span class="sd">    Methods</span>
</span><span id="MassSpecCentroid-1471"><a href="#MassSpecCentroid-1471"><span class="linenos">1471</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecCentroid-1472"><a href="#MassSpecCentroid-1472"><span class="linenos">1472</span></a><span class="sd">    * process_mass_spec().</span>
</span><span id="MassSpecCentroid-1473"><a href="#MassSpecCentroid-1473"><span class="linenos">1473</span></a><span class="sd">        Process the mass spectrum. Overriden from MassSpecBase. Populates the _mspeaks list with MSpeaks class using the centroid data.</span>
</span><span id="MassSpecCentroid-1474"><a href="#MassSpecCentroid-1474"><span class="linenos">1474</span></a><span class="sd">    * __simulate_profile__data__().</span>
</span><span id="MassSpecCentroid-1475"><a href="#MassSpecCentroid-1475"><span class="linenos">1475</span></a><span class="sd">        Simulate profile data based on Gaussian or Lorentzian peak shape. Needs theoretical resolving power calculation and define peak shape, intended for plotting and inspection purposes only.</span>
</span><span id="MassSpecCentroid-1476"><a href="#MassSpecCentroid-1476"><span class="linenos">1476</span></a>
</span><span id="MassSpecCentroid-1477"><a href="#MassSpecCentroid-1477"><span class="linenos">1477</span></a><span class="sd">    see also: MassSpecBase(), MassSpecfromFreq(), MassSpecProfile()</span>
</span><span id="MassSpecCentroid-1478"><a href="#MassSpecCentroid-1478"><span class="linenos">1478</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1479"><a href="#MassSpecCentroid-1479"><span class="linenos">1479</span></a>
</span><span id="MassSpecCentroid-1480"><a href="#MassSpecCentroid-1480"><span class="linenos">1480</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1481"><a href="#MassSpecCentroid-1481"><span class="linenos">1481</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1482"><a href="#MassSpecCentroid-1482"><span class="linenos">1482</span></a>
</span><span id="MassSpecCentroid-1483"><a href="#MassSpecCentroid-1483"><span class="linenos">1483</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1484"><a href="#MassSpecCentroid-1484"><span class="linenos">1484</span></a>
</span><span id="MassSpecCentroid-1485"><a href="#MassSpecCentroid-1485"><span class="linenos">1485</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1486"><a href="#MassSpecCentroid-1486"><span class="linenos">1486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1487"><a href="#MassSpecCentroid-1487"><span class="linenos">1487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1488"><a href="#MassSpecCentroid-1488"><span class="linenos">1488</span></a>
</span><span id="MassSpecCentroid-1489"><a href="#MassSpecCentroid-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid-1490"><a href="#MassSpecCentroid-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="n">data_dict</span>
</span><span id="MassSpecCentroid-1491"><a href="#MassSpecCentroid-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">]</span>
</span><span id="MassSpecCentroid-1492"><a href="#MassSpecCentroid-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">]</span>
</span><span id="MassSpecCentroid-1493"><a href="#MassSpecCentroid-1493"><span class="linenos">1493</span></a>
</span><span id="MassSpecCentroid-1494"><a href="#MassSpecCentroid-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1495"><a href="#MassSpecCentroid-1495"><span class="linenos">1495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="MassSpecCentroid-1496"><a href="#MassSpecCentroid-1496"><span class="linenos">1496</span></a>
</span><span id="MassSpecCentroid-1497"><a href="#MassSpecCentroid-1497"><span class="linenos">1497</span></a>    <span class="k">def</span> <span class="nf">__simulate_profile__data__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exp_mz_centroid</span><span class="p">,</span> <span class="n">magnitude_centroid</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1498"><a href="#MassSpecCentroid-1498"><span class="linenos">1498</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate profile data based on Gaussian or Lorentzian peak shape</span>
</span><span id="MassSpecCentroid-1499"><a href="#MassSpecCentroid-1499"><span class="linenos">1499</span></a>
</span><span id="MassSpecCentroid-1500"><a href="#MassSpecCentroid-1500"><span class="linenos">1500</span></a><span class="sd">        Notes</span>
</span><span id="MassSpecCentroid-1501"><a href="#MassSpecCentroid-1501"><span class="linenos">1501</span></a><span class="sd">        -----</span>
</span><span id="MassSpecCentroid-1502"><a href="#MassSpecCentroid-1502"><span class="linenos">1502</span></a><span class="sd">        Needs theoretical resolving power calculation and define peak shape.</span>
</span><span id="MassSpecCentroid-1503"><a href="#MassSpecCentroid-1503"><span class="linenos">1503</span></a><span class="sd">        This is a quick fix to trick a line plot be able to plot as sticks for plotting and inspection purposes only.</span>
</span><span id="MassSpecCentroid-1504"><a href="#MassSpecCentroid-1504"><span class="linenos">1504</span></a>
</span><span id="MassSpecCentroid-1505"><a href="#MassSpecCentroid-1505"><span class="linenos">1505</span></a><span class="sd">        Parameters</span>
</span><span id="MassSpecCentroid-1506"><a href="#MassSpecCentroid-1506"><span class="linenos">1506</span></a><span class="sd">        ----------</span>
</span><span id="MassSpecCentroid-1507"><a href="#MassSpecCentroid-1507"><span class="linenos">1507</span></a><span class="sd">        exp_mz_centroid : list(float)</span>
</span><span id="MassSpecCentroid-1508"><a href="#MassSpecCentroid-1508"><span class="linenos">1508</span></a><span class="sd">            list of m/z values</span>
</span><span id="MassSpecCentroid-1509"><a href="#MassSpecCentroid-1509"><span class="linenos">1509</span></a><span class="sd">        magnitude_centroid : list(float)</span>
</span><span id="MassSpecCentroid-1510"><a href="#MassSpecCentroid-1510"><span class="linenos">1510</span></a><span class="sd">            list of abundance values</span>
</span><span id="MassSpecCentroid-1511"><a href="#MassSpecCentroid-1511"><span class="linenos">1511</span></a>
</span><span id="MassSpecCentroid-1512"><a href="#MassSpecCentroid-1512"><span class="linenos">1512</span></a>
</span><span id="MassSpecCentroid-1513"><a href="#MassSpecCentroid-1513"><span class="linenos">1513</span></a><span class="sd">        Returns</span>
</span><span id="MassSpecCentroid-1514"><a href="#MassSpecCentroid-1514"><span class="linenos">1514</span></a><span class="sd">        -------</span>
</span><span id="MassSpecCentroid-1515"><a href="#MassSpecCentroid-1515"><span class="linenos">1515</span></a><span class="sd">        x : list(float)</span>
</span><span id="MassSpecCentroid-1516"><a href="#MassSpecCentroid-1516"><span class="linenos">1516</span></a><span class="sd">            list of m/z values</span>
</span><span id="MassSpecCentroid-1517"><a href="#MassSpecCentroid-1517"><span class="linenos">1517</span></a><span class="sd">        y : list(float)</span>
</span><span id="MassSpecCentroid-1518"><a href="#MassSpecCentroid-1518"><span class="linenos">1518</span></a><span class="sd">            list of abundance values</span>
</span><span id="MassSpecCentroid-1519"><a href="#MassSpecCentroid-1519"><span class="linenos">1519</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1520"><a href="#MassSpecCentroid-1520"><span class="linenos">1520</span></a>
</span><span id="MassSpecCentroid-1521"><a href="#MassSpecCentroid-1521"><span class="linenos">1521</span></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="MassSpecCentroid-1522"><a href="#MassSpecCentroid-1522"><span class="linenos">1522</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">)):</span>
</span><span id="MassSpecCentroid-1523"><a href="#MassSpecCentroid-1523"><span class="linenos">1523</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1524"><a href="#MassSpecCentroid-1524"><span class="linenos">1524</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="MassSpecCentroid-1525"><a href="#MassSpecCentroid-1525"><span class="linenos">1525</span></a>            <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_mz_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1526"><a href="#MassSpecCentroid-1526"><span class="linenos">1526</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1527"><a href="#MassSpecCentroid-1527"><span class="linenos">1527</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magnitude_centroid</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="MassSpecCentroid-1528"><a href="#MassSpecCentroid-1528"><span class="linenos">1528</span></a>            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1529"><a href="#MassSpecCentroid-1529"><span class="linenos">1529</span></a>        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
</span><span id="MassSpecCentroid-1530"><a href="#MassSpecCentroid-1530"><span class="linenos">1530</span></a>
</span><span id="MassSpecCentroid-1531"><a href="#MassSpecCentroid-1531"><span class="linenos">1531</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroid-1532"><a href="#MassSpecCentroid-1532"><span class="linenos">1532</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1533"><a href="#MassSpecCentroid-1533"><span class="linenos">1533</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1534"><a href="#MassSpecCentroid-1534"><span class="linenos">1534</span></a>        <span class="n">mz_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MassSpecCentroid-1535"><a href="#MassSpecCentroid-1535"><span class="linenos">1535</span></a>        <span class="k">for</span> <span class="n">mz</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1536"><a href="#MassSpecCentroid-1536"><span class="linenos">1536</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span> <span class="o">-</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1537"><a href="#MassSpecCentroid-1537"><span class="linenos">1537</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1538"><a href="#MassSpecCentroid-1538"><span class="linenos">1538</span></a>            <span class="n">mz_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mz</span> <span class="o">+</span> <span class="mf">0.0000001</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1539"><a href="#MassSpecCentroid-1539"><span class="linenos">1539</span></a>        <span class="k">return</span> <span class="n">mz_list</span>
</span><span id="MassSpecCentroid-1540"><a href="#MassSpecCentroid-1540"><span class="linenos">1540</span></a>
</span><span id="MassSpecCentroid-1541"><a href="#MassSpecCentroid-1541"><span class="linenos">1541</span></a>    <span class="nd">@mz_exp_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecCentroid-1542"><a href="#MassSpecCentroid-1542"><span class="linenos">1542</span></a>    <span class="k">def</span> <span class="nf">mz_exp_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_mz_exp</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1543"><a href="#MassSpecCentroid-1543"><span class="linenos">1543</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">_mz_exp</span>
</span><span id="MassSpecCentroid-1544"><a href="#MassSpecCentroid-1544"><span class="linenos">1544</span></a>
</span><span id="MassSpecCentroid-1545"><a href="#MassSpecCentroid-1545"><span class="linenos">1545</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroid-1546"><a href="#MassSpecCentroid-1546"><span class="linenos">1546</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1547"><a href="#MassSpecCentroid-1547"><span class="linenos">1547</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance profile of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1548"><a href="#MassSpecCentroid-1548"><span class="linenos">1548</span></a>        <span class="n">ab_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="MassSpecCentroid-1549"><a href="#MassSpecCentroid-1549"><span class="linenos">1549</span></a>        <span class="k">for</span> <span class="n">ab</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1550"><a href="#MassSpecCentroid-1550"><span class="linenos">1550</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1551"><a href="#MassSpecCentroid-1551"><span class="linenos">1551</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1552"><a href="#MassSpecCentroid-1552"><span class="linenos">1552</span></a>            <span class="n">ab_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1553"><a href="#MassSpecCentroid-1553"><span class="linenos">1553</span></a>        <span class="k">return</span> <span class="n">ab_list</span>
</span><span id="MassSpecCentroid-1554"><a href="#MassSpecCentroid-1554"><span class="linenos">1554</span></a>
</span><span id="MassSpecCentroid-1555"><a href="#MassSpecCentroid-1555"><span class="linenos">1555</span></a>    <span class="nd">@abundance_profile</span><span class="o">.</span><span class="n">setter</span>
</span><span id="MassSpecCentroid-1556"><a href="#MassSpecCentroid-1556"><span class="linenos">1556</span></a>    <span class="k">def</span> <span class="nf">abundance_profile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">abundance</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1557"><a href="#MassSpecCentroid-1557"><span class="linenos">1557</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">abundance</span>
</span><span id="MassSpecCentroid-1558"><a href="#MassSpecCentroid-1558"><span class="linenos">1558</span></a>
</span><span id="MassSpecCentroid-1559"><a href="#MassSpecCentroid-1559"><span class="linenos">1559</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroid-1560"><a href="#MassSpecCentroid-1560"><span class="linenos">1560</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1561"><a href="#MassSpecCentroid-1561"><span class="linenos">1561</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1562"><a href="#MassSpecCentroid-1562"><span class="linenos">1562</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1563"><a href="#MassSpecCentroid-1563"><span class="linenos">1563</span></a>
</span><span id="MassSpecCentroid-1564"><a href="#MassSpecCentroid-1564"><span class="linenos">1564</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1565"><a href="#MassSpecCentroid-1565"><span class="linenos">1565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid-1566"><a href="#MassSpecCentroid-1566"><span class="linenos">1566</span></a>        <span class="kn">import</span> <span class="nn">tqdm</span>
</span><span id="MassSpecCentroid-1567"><a href="#MassSpecCentroid-1567"><span class="linenos">1567</span></a>
</span><span id="MassSpecCentroid-1568"><a href="#MassSpecCentroid-1568"><span class="linenos">1568</span></a>        <span class="c1"># overwrite process_mass_spec</span>
</span><span id="MassSpecCentroid-1569"><a href="#MassSpecCentroid-1569"><span class="linenos">1569</span></a>        <span class="c1"># mspeak objs are usually added inside the PeaKPicking class</span>
</span><span id="MassSpecCentroid-1570"><a href="#MassSpecCentroid-1570"><span class="linenos">1570</span></a>        <span class="c1"># for profile and freq based data</span>
</span><span id="MassSpecCentroid-1571"><a href="#MassSpecCentroid-1571"><span class="linenos">1571</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span><span id="MassSpecCentroid-1572"><a href="#MassSpecCentroid-1572"><span class="linenos">1572</span></a>        <span class="n">ion_charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polarity</span>
</span><span id="MassSpecCentroid-1573"><a href="#MassSpecCentroid-1573"><span class="linenos">1573</span></a>
</span><span id="MassSpecCentroid-1574"><a href="#MassSpecCentroid-1574"><span class="linenos">1574</span></a>        <span class="c1"># Check if resolving power is present</span>
</span><span id="MassSpecCentroid-1575"><a href="#MassSpecCentroid-1575"><span class="linenos">1575</span></a>        <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid-1576"><a href="#MassSpecCentroid-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1577"><a href="#MassSpecCentroid-1577"><span class="linenos">1577</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid-1578"><a href="#MassSpecCentroid-1578"><span class="linenos">1578</span></a>        <span class="k">if</span> <span class="n">rp_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecCentroid-1579"><a href="#MassSpecCentroid-1579"><span class="linenos">1579</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1580"><a href="#MassSpecCentroid-1580"><span class="linenos">1580</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid-1581"><a href="#MassSpecCentroid-1581"><span class="linenos">1581</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid-1582"><a href="#MassSpecCentroid-1582"><span class="linenos">1582</span></a>
</span><span id="MassSpecCentroid-1583"><a href="#MassSpecCentroid-1583"><span class="linenos">1583</span></a>        <span class="c1"># Check if s2n is present</span>
</span><span id="MassSpecCentroid-1584"><a href="#MassSpecCentroid-1584"><span class="linenos">1584</span></a>        <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid-1585"><a href="#MassSpecCentroid-1585"><span class="linenos">1585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">):</span>
</span><span id="MassSpecCentroid-1586"><a href="#MassSpecCentroid-1586"><span class="linenos">1586</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid-1587"><a href="#MassSpecCentroid-1587"><span class="linenos">1587</span></a>        <span class="k">if</span> <span class="n">s2n_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecCentroid-1588"><a href="#MassSpecCentroid-1588"><span class="linenos">1588</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1589"><a href="#MassSpecCentroid-1589"><span class="linenos">1589</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid-1590"><a href="#MassSpecCentroid-1590"><span class="linenos">1590</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid-1591"><a href="#MassSpecCentroid-1591"><span class="linenos">1591</span></a>
</span><span id="MassSpecCentroid-1592"><a href="#MassSpecCentroid-1592"><span class="linenos">1592</span></a>        <span class="c1"># Warning if no s2n data but noise thresholding is set to signal_noise</span>
</span><span id="MassSpecCentroid-1593"><a href="#MassSpecCentroid-1593"><span class="linenos">1593</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid-1594"><a href="#MassSpecCentroid-1594"><span class="linenos">1594</span></a>            <span class="ow">not</span> <span class="n">s2n_present</span>
</span><span id="MassSpecCentroid-1595"><a href="#MassSpecCentroid-1595"><span class="linenos">1595</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="MassSpecCentroid-1596"><a href="#MassSpecCentroid-1596"><span class="linenos">1596</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid-1597"><a href="#MassSpecCentroid-1597"><span class="linenos">1597</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Signal to Noise data is missing for noise thresholding&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1598"><a href="#MassSpecCentroid-1598"><span class="linenos">1598</span></a>
</span><span id="MassSpecCentroid-1599"><a href="#MassSpecCentroid-1599"><span class="linenos">1599</span></a>        <span class="c1"># Pull out abundance data</span>
</span><span id="MassSpecCentroid-1600"><a href="#MassSpecCentroid-1600"><span class="linenos">1600</span></a>        <span class="n">abun</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1601"><a href="#MassSpecCentroid-1601"><span class="linenos">1601</span></a>
</span><span id="MassSpecCentroid-1602"><a href="#MassSpecCentroid-1602"><span class="linenos">1602</span></a>        <span class="c1"># Get the threshold for filtering if using minima, relative, or absolute abundance thresholding</span>
</span><span id="MassSpecCentroid-1603"><a href="#MassSpecCentroid-1603"><span class="linenos">1603</span></a>        <span class="n">abundance_threshold</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_threshold</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1604"><a href="#MassSpecCentroid-1604"><span class="linenos">1604</span></a>
</span><span id="MassSpecCentroid-1605"><a href="#MassSpecCentroid-1605"><span class="linenos">1605</span></a>        <span class="c1"># Set rp_i and s2n_i to None which will be overwritten if present</span>
</span><span id="MassSpecCentroid-1606"><a href="#MassSpecCentroid-1606"><span class="linenos">1606</span></a>        <span class="n">rp_i</span><span class="p">,</span> <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid-1607"><a href="#MassSpecCentroid-1607"><span class="linenos">1607</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">)):</span>
</span><span id="MassSpecCentroid-1608"><a href="#MassSpecCentroid-1608"><span class="linenos">1608</span></a>            <span class="k">if</span> <span class="n">rp_present</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1609"><a href="#MassSpecCentroid-1609"><span class="linenos">1609</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="MassSpecCentroid-1610"><a href="#MassSpecCentroid-1610"><span class="linenos">1610</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid-1611"><a href="#MassSpecCentroid-1611"><span class="linenos">1611</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1612"><a href="#MassSpecCentroid-1612"><span class="linenos">1612</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="MassSpecCentroid-1613"><a href="#MassSpecCentroid-1613"><span class="linenos">1613</span></a>            <span class="k">if</span> <span class="n">s2n_present</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1614"><a href="#MassSpecCentroid-1614"><span class="linenos">1614</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="MassSpecCentroid-1615"><a href="#MassSpecCentroid-1615"><span class="linenos">1615</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid-1616"><a href="#MassSpecCentroid-1616"><span class="linenos">1616</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1617"><a href="#MassSpecCentroid-1617"><span class="linenos">1617</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="MassSpecCentroid-1618"><a href="#MassSpecCentroid-1618"><span class="linenos">1618</span></a>
</span><span id="MassSpecCentroid-1619"><a href="#MassSpecCentroid-1619"><span class="linenos">1619</span></a>            <span class="c1"># centroid peak does not have start and end peak index pos</span>
</span><span id="MassSpecCentroid-1620"><a href="#MassSpecCentroid-1620"><span class="linenos">1620</span></a>            <span class="n">massspec_indexes</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1621"><a href="#MassSpecCentroid-1621"><span class="linenos">1621</span></a>
</span><span id="MassSpecCentroid-1622"><a href="#MassSpecCentroid-1622"><span class="linenos">1622</span></a>            <span class="c1"># Add peaks based on the noise thresholding method</span>
</span><span id="MassSpecCentroid-1623"><a href="#MassSpecCentroid-1623"><span class="linenos">1623</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid-1624"><a href="#MassSpecCentroid-1624"><span class="linenos">1624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span>
</span><span id="MassSpecCentroid-1625"><a href="#MassSpecCentroid-1625"><span class="linenos">1625</span></a>                <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;minima&quot;</span><span class="p">,</span> <span class="s2">&quot;relative_abundance&quot;</span><span class="p">,</span> <span class="s2">&quot;absolute_abundance&quot;</span><span class="p">]</span>
</span><span id="MassSpecCentroid-1626"><a href="#MassSpecCentroid-1626"><span class="linenos">1626</span></a>                <span class="ow">and</span> <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">/</span> <span class="n">factor</span> <span class="o">&gt;=</span> <span class="n">abundance_threshold</span>
</span><span id="MassSpecCentroid-1627"><a href="#MassSpecCentroid-1627"><span class="linenos">1627</span></a>            <span class="p">):</span>
</span><span id="MassSpecCentroid-1628"><a href="#MassSpecCentroid-1628"><span class="linenos">1628</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecCentroid-1629"><a href="#MassSpecCentroid-1629"><span class="linenos">1629</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1630"><a href="#MassSpecCentroid-1630"><span class="linenos">1630</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1631"><a href="#MassSpecCentroid-1631"><span class="linenos">1631</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="MassSpecCentroid-1632"><a href="#MassSpecCentroid-1632"><span class="linenos">1632</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1633"><a href="#MassSpecCentroid-1633"><span class="linenos">1633</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1634"><a href="#MassSpecCentroid-1634"><span class="linenos">1634</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1635"><a href="#MassSpecCentroid-1635"><span class="linenos">1635</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1636"><a href="#MassSpecCentroid-1636"><span class="linenos">1636</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid-1637"><a href="#MassSpecCentroid-1637"><span class="linenos">1637</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid-1638"><a href="#MassSpecCentroid-1638"><span class="linenos">1638</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="MassSpecCentroid-1639"><a href="#MassSpecCentroid-1639"><span class="linenos">1639</span></a>                <span class="ow">and</span> <span class="n">s2n_i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_min_s2n</span>
</span><span id="MassSpecCentroid-1640"><a href="#MassSpecCentroid-1640"><span class="linenos">1640</span></a>            <span class="p">):</span>
</span><span id="MassSpecCentroid-1641"><a href="#MassSpecCentroid-1641"><span class="linenos">1641</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecCentroid-1642"><a href="#MassSpecCentroid-1642"><span class="linenos">1642</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1643"><a href="#MassSpecCentroid-1643"><span class="linenos">1643</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1644"><a href="#MassSpecCentroid-1644"><span class="linenos">1644</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="MassSpecCentroid-1645"><a href="#MassSpecCentroid-1645"><span class="linenos">1645</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1646"><a href="#MassSpecCentroid-1646"><span class="linenos">1646</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1647"><a href="#MassSpecCentroid-1647"><span class="linenos">1647</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1648"><a href="#MassSpecCentroid-1648"><span class="linenos">1648</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecCentroid-1649"><a href="#MassSpecCentroid-1649"><span class="linenos">1649</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid-1650"><a href="#MassSpecCentroid-1650"><span class="linenos">1650</span></a>
</span><span id="MassSpecCentroid-1651"><a href="#MassSpecCentroid-1651"><span class="linenos">1651</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="MassSpecCentroid-1652"><a href="#MassSpecCentroid-1652"><span class="linenos">1652</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="MassSpecCentroid-1653"><a href="#MassSpecCentroid-1653"><span class="linenos">1653</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="MassSpecCentroid-1654"><a href="#MassSpecCentroid-1654"><span class="linenos">1654</span></a>
</span><span id="MassSpecCentroid-1655"><a href="#MassSpecCentroid-1655"><span class="linenos">1655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1656"><a href="#MassSpecCentroid-1656"><span class="linenos">1656</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1657"><a href="#MassSpecCentroid-1657"><span class="linenos">1657</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;log noise Not tested for centroid data&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid-1658"><a href="#MassSpecCentroid-1658"><span class="linenos">1658</span></a>                <span class="c1"># self._baseline_noise, self._baseline_noise_std = self.run_log_noise_threshold_calc()</span>
</span><span id="MassSpecCentroid-1659"><a href="#MassSpecCentroid-1659"><span class="linenos">1659</span></a>
</span><span id="MassSpecCentroid-1660"><a href="#MassSpecCentroid-1660"><span class="linenos">1660</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid-1661"><a href="#MassSpecCentroid-1661"><span class="linenos">1661</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecCentroid-1662"><a href="#MassSpecCentroid-1662"><span class="linenos">1662</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecCentroid-1663"><a href="#MassSpecCentroid-1663"><span class="linenos">1663</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid-1664"><a href="#MassSpecCentroid-1664"><span class="linenos">1664</span></a>
</span><span id="MassSpecCentroid-1665"><a href="#MassSpecCentroid-1665"><span class="linenos">1665</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span></pre></div>


            <div class="docstring"><p>A mass spectrum class when the entry point is on centroid format</p>

<h6 id="notes">Notes</h6>

<ul>
<li>Stores the centroid data and instrument settings</li>
<li>Simulate profile data based on Gaussian or Lorentzian peak shape</li>
<li>Iteration over a list of MSPeaks classes stored at the _mspeaks attributes</li>
<li>_mspeaks is populated under the hood by calling process_mass_spec method</li>
<li>iteration is null if _mspeaks is empty</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>data_dict : dict {string</strong> (numpy array float64 )):
contains keys [m/z, Abundance, Resolving Power, S/N]</li>
<li><strong>d_params : dict{'str'</strong> (float, int or str}):
contains the instrument settings and processing settings</li>
<li><strong>auto_process</strong> (bool, optional):
Whether to automatically process the mass spectrum. Defaults to True.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>label</strong> (str):
store label (Bruker, Midas Transient, see Labels class)</li>
<li><strong>_baseline_noise</strong> (float):
store baseline noise</li>
<li><strong>_baseline_noise_std</strong> (float):
store baseline noise std</li>
<li><strong>_abundance</strong> (ndarray):
The abundance values of the mass spectrum.</li>
<li><strong>_mz_exp</strong> (ndarray):
The m/z values of the mass spectrum.</li>
<li><strong>_mspeaks</strong> (list):
A list of mass peaks.</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>process_mass_spec().
Process the mass spectrum. Overriden from MassSpecBase. Populates the _mspeaks list with MSpeaks class using the centroid data.</li>
<li>__simulate_profile__data__().
Simulate profile data based on Gaussian or Lorentzian peak shape. Needs theoretical resolving power calculation and define peak shape, intended for plotting and inspection purposes only.</li>
</ul>

<p>see also: MassSpecBase(), MassSpecfromFreq(), MassSpecProfile()</p>
</div>


                            <div id="MassSpecCentroid.__init__" class="classattr">
                                        <input id="MassSpecCentroid.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MassSpecCentroid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dict</span>, </span><span class="param"><span class="n">d_params</span>, </span><span class="param"><span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span></span>)</span>

                <label class="view-source-button" for="MassSpecCentroid.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecCentroid.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecCentroid.__init__-1480"><a href="#MassSpecCentroid.__init__-1480"><span class="linenos">1480</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="MassSpecCentroid.__init__-1481"><a href="#MassSpecCentroid.__init__-1481"><span class="linenos">1481</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroid.__init__-1482"><a href="#MassSpecCentroid.__init__-1482"><span class="linenos">1482</span></a>
</span><span id="MassSpecCentroid.__init__-1483"><a href="#MassSpecCentroid.__init__-1483"><span class="linenos">1483</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroid.__init__-1484"><a href="#MassSpecCentroid.__init__-1484"><span class="linenos">1484</span></a>
</span><span id="MassSpecCentroid.__init__-1485"><a href="#MassSpecCentroid.__init__-1485"><span class="linenos">1485</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="MassSpecCentroid.__init__-1486"><a href="#MassSpecCentroid.__init__-1486"><span class="linenos">1486</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid.__init__-1487"><a href="#MassSpecCentroid.__init__-1487"><span class="linenos">1487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="n">d_params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid.__init__-1488"><a href="#MassSpecCentroid.__init__-1488"><span class="linenos">1488</span></a>
</span><span id="MassSpecCentroid.__init__-1489"><a href="#MassSpecCentroid.__init__-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">is_centroid</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid.__init__-1490"><a href="#MassSpecCentroid.__init__-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span> <span class="o">=</span> <span class="n">data_dict</span>
</span><span id="MassSpecCentroid.__init__-1491"><a href="#MassSpecCentroid.__init__-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">]</span>
</span><span id="MassSpecCentroid.__init__-1492"><a href="#MassSpecCentroid.__init__-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">]</span>
</span><span id="MassSpecCentroid.__init__-1493"><a href="#MassSpecCentroid.__init__-1493"><span class="linenos">1493</span></a>
</span><span id="MassSpecCentroid.__init__-1494"><a href="#MassSpecCentroid.__init__-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">auto_process</span><span class="p">:</span>
</span><span id="MassSpecCentroid.__init__-1495"><a href="#MassSpecCentroid.__init__-1495"><span class="linenos">1495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span></pre></div>


    

                            </div>
                            <div id="MassSpecCentroid.is_centroid" class="classattr">
                                <div class="attr variable">
            <span class="name">is_centroid</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroid.is_centroid"></a>
    
    

                            </div>
                            <div id="MassSpecCentroid.data_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">data_dict</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroid.data_dict"></a>
    
    

                            </div>
                            <div id="MassSpecCentroid.mz_exp_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_exp_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroid.mz_exp_profile"></a>
    
            <div class="docstring"><p>Return the m/z profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroid.abundance_profile" class="classattr">
                                <div class="attr variable">
            <span class="name">abundance_profile</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroid.abundance_profile"></a>
    
            <div class="docstring"><p>Return the abundance profile of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroid.tic" class="classattr">
                                <div class="attr variable">
            <span class="name">tic</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroid.tic"></a>
    
            <div class="docstring"><p>Return the total ion current of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroid.process_mass_spec" class="classattr">
                                        <input id="MassSpecCentroid.process_mass_spec-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">process_mass_spec</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="MassSpecCentroid.process_mass_spec-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecCentroid.process_mass_spec"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecCentroid.process_mass_spec-1564"><a href="#MassSpecCentroid.process_mass_spec-1564"><span class="linenos">1564</span></a>    <span class="k">def</span> <span class="nf">process_mass_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1565"><a href="#MassSpecCentroid.process_mass_spec-1565"><span class="linenos">1565</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Process the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroid.process_mass_spec-1566"><a href="#MassSpecCentroid.process_mass_spec-1566"><span class="linenos">1566</span></a>        <span class="kn">import</span> <span class="nn">tqdm</span>
</span><span id="MassSpecCentroid.process_mass_spec-1567"><a href="#MassSpecCentroid.process_mass_spec-1567"><span class="linenos">1567</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1568"><a href="#MassSpecCentroid.process_mass_spec-1568"><span class="linenos">1568</span></a>        <span class="c1"># overwrite process_mass_spec</span>
</span><span id="MassSpecCentroid.process_mass_spec-1569"><a href="#MassSpecCentroid.process_mass_spec-1569"><span class="linenos">1569</span></a>        <span class="c1"># mspeak objs are usually added inside the PeaKPicking class</span>
</span><span id="MassSpecCentroid.process_mass_spec-1570"><a href="#MassSpecCentroid.process_mass_spec-1570"><span class="linenos">1570</span></a>        <span class="c1"># for profile and freq based data</span>
</span><span id="MassSpecCentroid.process_mass_spec-1571"><a href="#MassSpecCentroid.process_mass_spec-1571"><span class="linenos">1571</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span><span id="MassSpecCentroid.process_mass_spec-1572"><a href="#MassSpecCentroid.process_mass_spec-1572"><span class="linenos">1572</span></a>        <span class="n">ion_charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">polarity</span>
</span><span id="MassSpecCentroid.process_mass_spec-1573"><a href="#MassSpecCentroid.process_mass_spec-1573"><span class="linenos">1573</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1574"><a href="#MassSpecCentroid.process_mass_spec-1574"><span class="linenos">1574</span></a>        <span class="c1"># Check if resolving power is present</span>
</span><span id="MassSpecCentroid.process_mass_spec-1575"><a href="#MassSpecCentroid.process_mass_spec-1575"><span class="linenos">1575</span></a>        <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid.process_mass_spec-1576"><a href="#MassSpecCentroid.process_mass_spec-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1577"><a href="#MassSpecCentroid.process_mass_spec-1577"><span class="linenos">1577</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid.process_mass_spec-1578"><a href="#MassSpecCentroid.process_mass_spec-1578"><span class="linenos">1578</span></a>        <span class="k">if</span> <span class="n">rp_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1579"><a href="#MassSpecCentroid.process_mass_spec-1579"><span class="linenos">1579</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1580"><a href="#MassSpecCentroid.process_mass_spec-1580"><span class="linenos">1580</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1581"><a href="#MassSpecCentroid.process_mass_spec-1581"><span class="linenos">1581</span></a>            <span class="n">rp_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid.process_mass_spec-1582"><a href="#MassSpecCentroid.process_mass_spec-1582"><span class="linenos">1582</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1583"><a href="#MassSpecCentroid.process_mass_spec-1583"><span class="linenos">1583</span></a>        <span class="c1"># Check if s2n is present</span>
</span><span id="MassSpecCentroid.process_mass_spec-1584"><a href="#MassSpecCentroid.process_mass_spec-1584"><span class="linenos">1584</span></a>        <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="MassSpecCentroid.process_mass_spec-1585"><a href="#MassSpecCentroid.process_mass_spec-1585"><span class="linenos">1585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1586"><a href="#MassSpecCentroid.process_mass_spec-1586"><span class="linenos">1586</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid.process_mass_spec-1587"><a href="#MassSpecCentroid.process_mass_spec-1587"><span class="linenos">1587</span></a>        <span class="k">if</span> <span class="n">s2n_present</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1588"><a href="#MassSpecCentroid.process_mass_spec-1588"><span class="linenos">1588</span></a>            <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1589"><a href="#MassSpecCentroid.process_mass_spec-1589"><span class="linenos">1589</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1590"><a href="#MassSpecCentroid.process_mass_spec-1590"><span class="linenos">1590</span></a>            <span class="n">s2n_present</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="MassSpecCentroid.process_mass_spec-1591"><a href="#MassSpecCentroid.process_mass_spec-1591"><span class="linenos">1591</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1592"><a href="#MassSpecCentroid.process_mass_spec-1592"><span class="linenos">1592</span></a>        <span class="c1"># Warning if no s2n data but noise thresholding is set to signal_noise</span>
</span><span id="MassSpecCentroid.process_mass_spec-1593"><a href="#MassSpecCentroid.process_mass_spec-1593"><span class="linenos">1593</span></a>        <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1594"><a href="#MassSpecCentroid.process_mass_spec-1594"><span class="linenos">1594</span></a>            <span class="ow">not</span> <span class="n">s2n_present</span>
</span><span id="MassSpecCentroid.process_mass_spec-1595"><a href="#MassSpecCentroid.process_mass_spec-1595"><span class="linenos">1595</span></a>            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="MassSpecCentroid.process_mass_spec-1596"><a href="#MassSpecCentroid.process_mass_spec-1596"><span class="linenos">1596</span></a>        <span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1597"><a href="#MassSpecCentroid.process_mass_spec-1597"><span class="linenos">1597</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Signal to Noise data is missing for noise thresholding&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1598"><a href="#MassSpecCentroid.process_mass_spec-1598"><span class="linenos">1598</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1599"><a href="#MassSpecCentroid.process_mass_spec-1599"><span class="linenos">1599</span></a>        <span class="c1"># Pull out abundance data</span>
</span><span id="MassSpecCentroid.process_mass_spec-1600"><a href="#MassSpecCentroid.process_mass_spec-1600"><span class="linenos">1600</span></a>        <span class="n">abun</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1601"><a href="#MassSpecCentroid.process_mass_spec-1601"><span class="linenos">1601</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1602"><a href="#MassSpecCentroid.process_mass_spec-1602"><span class="linenos">1602</span></a>        <span class="c1"># Get the threshold for filtering if using minima, relative, or absolute abundance thresholding</span>
</span><span id="MassSpecCentroid.process_mass_spec-1603"><a href="#MassSpecCentroid.process_mass_spec-1603"><span class="linenos">1603</span></a>        <span class="n">abundance_threshold</span><span class="p">,</span> <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_threshold</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1604"><a href="#MassSpecCentroid.process_mass_spec-1604"><span class="linenos">1604</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1605"><a href="#MassSpecCentroid.process_mass_spec-1605"><span class="linenos">1605</span></a>        <span class="c1"># Set rp_i and s2n_i to None which will be overwritten if present</span>
</span><span id="MassSpecCentroid.process_mass_spec-1606"><a href="#MassSpecCentroid.process_mass_spec-1606"><span class="linenos">1606</span></a>        <span class="n">rp_i</span><span class="p">,</span> <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid.process_mass_spec-1607"><a href="#MassSpecCentroid.process_mass_spec-1607"><span class="linenos">1607</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">mz</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">)):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1608"><a href="#MassSpecCentroid.process_mass_spec-1608"><span class="linenos">1608</span></a>            <span class="k">if</span> <span class="n">rp_present</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1609"><a href="#MassSpecCentroid.process_mass_spec-1609"><span class="linenos">1609</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1610"><a href="#MassSpecCentroid.process_mass_spec-1610"><span class="linenos">1610</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid.process_mass_spec-1611"><a href="#MassSpecCentroid.process_mass_spec-1611"><span class="linenos">1611</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1612"><a href="#MassSpecCentroid.process_mass_spec-1612"><span class="linenos">1612</span></a>                    <span class="n">rp_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="MassSpecCentroid.process_mass_spec-1613"><a href="#MassSpecCentroid.process_mass_spec-1613"><span class="linenos">1613</span></a>            <span class="k">if</span> <span class="n">s2n_present</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1614"><a href="#MassSpecCentroid.process_mass_spec-1614"><span class="linenos">1614</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">]:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1615"><a href="#MassSpecCentroid.process_mass_spec-1615"><span class="linenos">1615</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</span><span id="MassSpecCentroid.process_mass_spec-1616"><a href="#MassSpecCentroid.process_mass_spec-1616"><span class="linenos">1616</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1617"><a href="#MassSpecCentroid.process_mass_spec-1617"><span class="linenos">1617</span></a>                    <span class="n">s2n_i</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">)[</span><span class="n">index</span><span class="p">])</span>
</span><span id="MassSpecCentroid.process_mass_spec-1618"><a href="#MassSpecCentroid.process_mass_spec-1618"><span class="linenos">1618</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1619"><a href="#MassSpecCentroid.process_mass_spec-1619"><span class="linenos">1619</span></a>            <span class="c1"># centroid peak does not have start and end peak index pos</span>
</span><span id="MassSpecCentroid.process_mass_spec-1620"><a href="#MassSpecCentroid.process_mass_spec-1620"><span class="linenos">1620</span></a>            <span class="n">massspec_indexes</span> <span class="o">=</span> <span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1621"><a href="#MassSpecCentroid.process_mass_spec-1621"><span class="linenos">1621</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1622"><a href="#MassSpecCentroid.process_mass_spec-1622"><span class="linenos">1622</span></a>            <span class="c1"># Add peaks based on the noise thresholding method</span>
</span><span id="MassSpecCentroid.process_mass_spec-1623"><a href="#MassSpecCentroid.process_mass_spec-1623"><span class="linenos">1623</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1624"><a href="#MassSpecCentroid.process_mass_spec-1624"><span class="linenos">1624</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span>
</span><span id="MassSpecCentroid.process_mass_spec-1625"><a href="#MassSpecCentroid.process_mass_spec-1625"><span class="linenos">1625</span></a>                <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;minima&quot;</span><span class="p">,</span> <span class="s2">&quot;relative_abundance&quot;</span><span class="p">,</span> <span class="s2">&quot;absolute_abundance&quot;</span><span class="p">]</span>
</span><span id="MassSpecCentroid.process_mass_spec-1626"><a href="#MassSpecCentroid.process_mass_spec-1626"><span class="linenos">1626</span></a>                <span class="ow">and</span> <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">/</span> <span class="n">factor</span> <span class="o">&gt;=</span> <span class="n">abundance_threshold</span>
</span><span id="MassSpecCentroid.process_mass_spec-1627"><a href="#MassSpecCentroid.process_mass_spec-1627"><span class="linenos">1627</span></a>            <span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1628"><a href="#MassSpecCentroid.process_mass_spec-1628"><span class="linenos">1628</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1629"><a href="#MassSpecCentroid.process_mass_spec-1629"><span class="linenos">1629</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1630"><a href="#MassSpecCentroid.process_mass_spec-1630"><span class="linenos">1630</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1631"><a href="#MassSpecCentroid.process_mass_spec-1631"><span class="linenos">1631</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="MassSpecCentroid.process_mass_spec-1632"><a href="#MassSpecCentroid.process_mass_spec-1632"><span class="linenos">1632</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1633"><a href="#MassSpecCentroid.process_mass_spec-1633"><span class="linenos">1633</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1634"><a href="#MassSpecCentroid.process_mass_spec-1634"><span class="linenos">1634</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1635"><a href="#MassSpecCentroid.process_mass_spec-1635"><span class="linenos">1635</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1636"><a href="#MassSpecCentroid.process_mass_spec-1636"><span class="linenos">1636</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1637"><a href="#MassSpecCentroid.process_mass_spec-1637"><span class="linenos">1637</span></a>            <span class="k">if</span> <span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1638"><a href="#MassSpecCentroid.process_mass_spec-1638"><span class="linenos">1638</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;signal_noise&quot;</span>
</span><span id="MassSpecCentroid.process_mass_spec-1639"><a href="#MassSpecCentroid.process_mass_spec-1639"><span class="linenos">1639</span></a>                <span class="ow">and</span> <span class="n">s2n_i</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">mass_spectrum</span><span class="o">.</span><span class="n">noise_threshold_min_s2n</span>
</span><span id="MassSpecCentroid.process_mass_spec-1640"><a href="#MassSpecCentroid.process_mass_spec-1640"><span class="linenos">1640</span></a>            <span class="p">):</span>
</span><span id="MassSpecCentroid.process_mass_spec-1641"><a href="#MassSpecCentroid.process_mass_spec-1641"><span class="linenos">1641</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">add_mspeak</span><span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1642"><a href="#MassSpecCentroid.process_mass_spec-1642"><span class="linenos">1642</span></a>                    <span class="n">ion_charge</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1643"><a href="#MassSpecCentroid.process_mass_spec-1643"><span class="linenos">1643</span></a>                    <span class="n">mz</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1644"><a href="#MassSpecCentroid.process_mass_spec-1644"><span class="linenos">1644</span></a>                    <span class="n">abun</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
</span><span id="MassSpecCentroid.process_mass_spec-1645"><a href="#MassSpecCentroid.process_mass_spec-1645"><span class="linenos">1645</span></a>                    <span class="n">rp_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1646"><a href="#MassSpecCentroid.process_mass_spec-1646"><span class="linenos">1646</span></a>                    <span class="n">s2n_i</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1647"><a href="#MassSpecCentroid.process_mass_spec-1647"><span class="linenos">1647</span></a>                    <span class="n">massspec_indexes</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1648"><a href="#MassSpecCentroid.process_mass_spec-1648"><span class="linenos">1648</span></a>                    <span class="n">ms_parent</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
</span><span id="MassSpecCentroid.process_mass_spec-1649"><a href="#MassSpecCentroid.process_mass_spec-1649"><span class="linenos">1649</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1650"><a href="#MassSpecCentroid.process_mass_spec-1650"><span class="linenos">1650</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1651"><a href="#MassSpecCentroid.process_mass_spec-1651"><span class="linenos">1651</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mspeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mspeaks</span>
</span><span id="MassSpecCentroid.process_mass_spec-1652"><a href="#MassSpecCentroid.process_mass_spec-1652"><span class="linenos">1652</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_abundance</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_abundance</span>
</span><span id="MassSpecCentroid.process_mass_spec-1653"><a href="#MassSpecCentroid.process_mass_spec-1653"><span class="linenos">1653</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_nominal_masses_start_final_indexes</span><span class="p">()</span>
</span><span id="MassSpecCentroid.process_mass_spec-1654"><a href="#MassSpecCentroid.process_mass_spec-1654"><span class="linenos">1654</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1655"><a href="#MassSpecCentroid.process_mass_spec-1655"><span class="linenos">1655</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1656"><a href="#MassSpecCentroid.process_mass_spec-1656"><span class="linenos">1656</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1657"><a href="#MassSpecCentroid.process_mass_spec-1657"><span class="linenos">1657</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;log noise Not tested for centroid data&quot;</span><span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1658"><a href="#MassSpecCentroid.process_mass_spec-1658"><span class="linenos">1658</span></a>                <span class="c1"># self._baseline_noise, self._baseline_noise_std = self.run_log_noise_threshold_calc()</span>
</span><span id="MassSpecCentroid.process_mass_spec-1659"><a href="#MassSpecCentroid.process_mass_spec-1659"><span class="linenos">1659</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1660"><a href="#MassSpecCentroid.process_mass_spec-1660"><span class="linenos">1660</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroid.process_mass_spec-1661"><a href="#MassSpecCentroid.process_mass_spec-1661"><span class="linenos">1661</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline_noise_std</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="MassSpecCentroid.process_mass_spec-1662"><a href="#MassSpecCentroid.process_mass_spec-1662"><span class="linenos">1662</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">run_noise_threshold_calc</span><span class="p">()</span>
</span><span id="MassSpecCentroid.process_mass_spec-1663"><a href="#MassSpecCentroid.process_mass_spec-1663"><span class="linenos">1663</span></a>                <span class="p">)</span>
</span><span id="MassSpecCentroid.process_mass_spec-1664"><a href="#MassSpecCentroid.process_mass_spec-1664"><span class="linenos">1664</span></a>
</span><span id="MassSpecCentroid.process_mass_spec-1665"><a href="#MassSpecCentroid.process_mass_spec-1665"><span class="linenos">1665</span></a>        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_dict</span>
</span></pre></div>


            <div class="docstring"><p>Process the mass spectrum.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#MassSpecBase">MassSpecBase</a></dt>
                                <dd id="MassSpecCentroid.mspeaks" class="variable"><a href="#MassSpecBase.mspeaks">mspeaks</a></dd>
                <dd id="MassSpecCentroid.is_calibrated" class="variable"><a href="#MassSpecBase.is_calibrated">is_calibrated</a></dd>
                <dd id="MassSpecCentroid.has_frequency" class="variable"><a href="#MassSpecBase.has_frequency">has_frequency</a></dd>
                <dd id="MassSpecCentroid.calibration_order" class="variable"><a href="#MassSpecBase.calibration_order">calibration_order</a></dd>
                <dd id="MassSpecCentroid.calibration_points" class="variable"><a href="#MassSpecBase.calibration_points">calibration_points</a></dd>
                <dd id="MassSpecCentroid.calibration_ref_mzs" class="variable"><a href="#MassSpecBase.calibration_ref_mzs">calibration_ref_mzs</a></dd>
                <dd id="MassSpecCentroid.calibration_meas_mzs" class="variable"><a href="#MassSpecBase.calibration_meas_mzs">calibration_meas_mzs</a></dd>
                <dd id="MassSpecCentroid.calibration_RMS" class="variable"><a href="#MassSpecBase.calibration_RMS">calibration_RMS</a></dd>
                <dd id="MassSpecCentroid.calibration_segment" class="variable"><a href="#MassSpecBase.calibration_segment">calibration_segment</a></dd>
                <dd id="MassSpecCentroid.calibration_raw_error_median" class="variable"><a href="#MassSpecBase.calibration_raw_error_median">calibration_raw_error_median</a></dd>
                <dd id="MassSpecCentroid.calibration_raw_error_stdev" class="variable"><a href="#MassSpecBase.calibration_raw_error_stdev">calibration_raw_error_stdev</a></dd>
                <dd id="MassSpecCentroid.set_indexes" class="function"><a href="#MassSpecBase.set_indexes">set_indexes</a></dd>
                <dd id="MassSpecCentroid.reset_indexes" class="function"><a href="#MassSpecBase.reset_indexes">reset_indexes</a></dd>
                <dd id="MassSpecCentroid.add_mspeak" class="function"><a href="#MassSpecBase.add_mspeak">add_mspeak</a></dd>
                <dd id="MassSpecCentroid.reset_cal_therms" class="function"><a href="#MassSpecBase.reset_cal_therms">reset_cal_therms</a></dd>
                <dd id="MassSpecCentroid.clear_molecular_formulas" class="function"><a href="#MassSpecBase.clear_molecular_formulas">clear_molecular_formulas</a></dd>
                <dd id="MassSpecCentroid.cal_noise_threshold" class="function"><a href="#MassSpecBase.cal_noise_threshold">cal_noise_threshold</a></dd>
                <dd id="MassSpecCentroid.parameters" class="variable"><a href="#MassSpecBase.parameters">parameters</a></dd>
                <dd id="MassSpecCentroid.set_parameter_from_json" class="function"><a href="#MassSpecBase.set_parameter_from_json">set_parameter_from_json</a></dd>
                <dd id="MassSpecCentroid.set_parameter_from_toml" class="function"><a href="#MassSpecBase.set_parameter_from_toml">set_parameter_from_toml</a></dd>
                <dd id="MassSpecCentroid.mspeaks_settings" class="variable"><a href="#MassSpecBase.mspeaks_settings">mspeaks_settings</a></dd>
                <dd id="MassSpecCentroid.settings" class="variable"><a href="#MassSpecBase.settings">settings</a></dd>
                <dd id="MassSpecCentroid.molecular_search_settings" class="variable"><a href="#MassSpecBase.molecular_search_settings">molecular_search_settings</a></dd>
                <dd id="MassSpecCentroid.mz_cal_profile" class="variable"><a href="#MassSpecBase.mz_cal_profile">mz_cal_profile</a></dd>
                <dd id="MassSpecCentroid.mz_cal" class="variable"><a href="#MassSpecBase.mz_cal">mz_cal</a></dd>
                <dd id="MassSpecCentroid.mz_exp" class="variable"><a href="#MassSpecBase.mz_exp">mz_exp</a></dd>
                <dd id="MassSpecCentroid.freq_exp_profile" class="variable"><a href="#MassSpecBase.freq_exp_profile">freq_exp_profile</a></dd>
                <dd id="MassSpecCentroid.freq_exp_pp" class="variable"><a href="#MassSpecBase.freq_exp_pp">freq_exp_pp</a></dd>
                <dd id="MassSpecCentroid.mz_exp_pp" class="variable"><a href="#MassSpecBase.mz_exp_pp">mz_exp_pp</a></dd>
                <dd id="MassSpecCentroid.abundance_profile_pp" class="variable"><a href="#MassSpecBase.abundance_profile_pp">abundance_profile_pp</a></dd>
                <dd id="MassSpecCentroid.abundance" class="variable"><a href="#MassSpecBase.abundance">abundance</a></dd>
                <dd id="MassSpecCentroid.freq_exp" class="function"><a href="#MassSpecBase.freq_exp">freq_exp</a></dd>
                <dd id="MassSpecCentroid.resolving_power" class="variable"><a href="#MassSpecBase.resolving_power">resolving_power</a></dd>
                <dd id="MassSpecCentroid.signal_to_noise" class="variable"><a href="#MassSpecBase.signal_to_noise">signal_to_noise</a></dd>
                <dd id="MassSpecCentroid.nominal_mz" class="variable"><a href="#MassSpecBase.nominal_mz">nominal_mz</a></dd>
                <dd id="MassSpecCentroid.get_mz_and_abundance_peaks_tuples" class="function"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples">get_mz_and_abundance_peaks_tuples</a></dd>
                <dd id="MassSpecCentroid.kmd" class="variable"><a href="#MassSpecBase.kmd">kmd</a></dd>
                <dd id="MassSpecCentroid.kendrick_mass" class="variable"><a href="#MassSpecBase.kendrick_mass">kendrick_mass</a></dd>
                <dd id="MassSpecCentroid.max_mz_exp" class="variable"><a href="#MassSpecBase.max_mz_exp">max_mz_exp</a></dd>
                <dd id="MassSpecCentroid.min_mz_exp" class="variable"><a href="#MassSpecBase.min_mz_exp">min_mz_exp</a></dd>
                <dd id="MassSpecCentroid.max_abundance" class="variable"><a href="#MassSpecBase.max_abundance">max_abundance</a></dd>
                <dd id="MassSpecCentroid.max_signal_to_noise" class="variable"><a href="#MassSpecBase.max_signal_to_noise">max_signal_to_noise</a></dd>
                <dd id="MassSpecCentroid.most_abundant_mspeak" class="variable"><a href="#MassSpecBase.most_abundant_mspeak">most_abundant_mspeak</a></dd>
                <dd id="MassSpecCentroid.min_abundance" class="variable"><a href="#MassSpecBase.min_abundance">min_abundance</a></dd>
                <dd id="MassSpecCentroid.dynamic_range" class="variable"><a href="#MassSpecBase.dynamic_range">dynamic_range</a></dd>
                <dd id="MassSpecCentroid.baseline_noise" class="variable"><a href="#MassSpecBase.baseline_noise">baseline_noise</a></dd>
                <dd id="MassSpecCentroid.baseline_noise_std" class="variable"><a href="#MassSpecBase.baseline_noise_std">baseline_noise_std</a></dd>
                <dd id="MassSpecCentroid.Aterm" class="variable"><a href="#MassSpecBase.Aterm">Aterm</a></dd>
                <dd id="MassSpecCentroid.Bterm" class="variable"><a href="#MassSpecBase.Bterm">Bterm</a></dd>
                <dd id="MassSpecCentroid.Cterm" class="variable"><a href="#MassSpecBase.Cterm">Cterm</a></dd>
                <dd id="MassSpecCentroid.filename" class="variable"><a href="#MassSpecBase.filename">filename</a></dd>
                <dd id="MassSpecCentroid.dir_location" class="variable"><a href="#MassSpecBase.dir_location">dir_location</a></dd>
                <dd id="MassSpecCentroid.sort_by_mz" class="function"><a href="#MassSpecBase.sort_by_mz">sort_by_mz</a></dd>
                <dd id="MassSpecCentroid.sort_by_abundance" class="function"><a href="#MassSpecBase.sort_by_abundance">sort_by_abundance</a></dd>
                <dd id="MassSpecCentroid.check_mspeaks_warning" class="function"><a href="#MassSpecBase.check_mspeaks_warning">check_mspeaks_warning</a></dd>
                <dd id="MassSpecCentroid.check_mspeaks" class="function"><a href="#MassSpecBase.check_mspeaks">check_mspeaks</a></dd>
                <dd id="MassSpecCentroid.remove_assignment_by_index" class="function"><a href="#MassSpecBase.remove_assignment_by_index">remove_assignment_by_index</a></dd>
                <dd id="MassSpecCentroid.filter_by_index" class="function"><a href="#MassSpecBase.filter_by_index">filter_by_index</a></dd>
                <dd id="MassSpecCentroid.filter_by_mz" class="function"><a href="#MassSpecBase.filter_by_mz">filter_by_mz</a></dd>
                <dd id="MassSpecCentroid.filter_by_s2n" class="function"><a href="#MassSpecBase.filter_by_s2n">filter_by_s2n</a></dd>
                <dd id="MassSpecCentroid.filter_by_abundance" class="function"><a href="#MassSpecBase.filter_by_abundance">filter_by_abundance</a></dd>
                <dd id="MassSpecCentroid.filter_by_max_resolving_power" class="function"><a href="#MassSpecBase.filter_by_max_resolving_power">filter_by_max_resolving_power</a></dd>
                <dd id="MassSpecCentroid.filter_by_mean_resolving_power" class="function"><a href="#MassSpecBase.filter_by_mean_resolving_power">filter_by_mean_resolving_power</a></dd>
                <dd id="MassSpecCentroid.filter_by_min_resolving_power" class="function"><a href="#MassSpecBase.filter_by_min_resolving_power">filter_by_min_resolving_power</a></dd>
                <dd id="MassSpecCentroid.filter_by_noise_threshold" class="function"><a href="#MassSpecBase.filter_by_noise_threshold">filter_by_noise_threshold</a></dd>
                <dd id="MassSpecCentroid.find_peaks" class="function"><a href="#MassSpecBase.find_peaks">find_peaks</a></dd>
                <dd id="MassSpecCentroid.change_kendrick_base_all_mspeaks" class="function"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks">change_kendrick_base_all_mspeaks</a></dd>
                <dd id="MassSpecCentroid.get_nominal_mz_first_last_indexes" class="function"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes">get_nominal_mz_first_last_indexes</a></dd>
                <dd id="MassSpecCentroid.get_masses_count_by_nominal_mass" class="function"><a href="#MassSpecBase.get_masses_count_by_nominal_mass">get_masses_count_by_nominal_mass</a></dd>
                <dd id="MassSpecCentroid.datapoints_count_by_nominal_mz" class="function"><a href="#MassSpecBase.datapoints_count_by_nominal_mz">datapoints_count_by_nominal_mz</a></dd>
                <dd id="MassSpecCentroid.get_nominal_mass_indexes" class="function"><a href="#MassSpecBase.get_nominal_mass_indexes">get_nominal_mass_indexes</a></dd>
                <dd id="MassSpecCentroid.plot_centroid" class="function"><a href="#MassSpecBase.plot_centroid">plot_centroid</a></dd>
                <dd id="MassSpecCentroid.plot_profile_and_noise_threshold" class="function"><a href="#MassSpecBase.plot_profile_and_noise_threshold">plot_profile_and_noise_threshold</a></dd>
                <dd id="MassSpecCentroid.plot_mz_domain_profile" class="function"><a href="#MassSpecBase.plot_mz_domain_profile">plot_mz_domain_profile</a></dd>
                <dd id="MassSpecCentroid.to_excel" class="function"><a href="#MassSpecBase.to_excel">to_excel</a></dd>
                <dd id="MassSpecCentroid.to_hdf" class="function"><a href="#MassSpecBase.to_hdf">to_hdf</a></dd>
                <dd id="MassSpecCentroid.to_csv" class="function"><a href="#MassSpecBase.to_csv">to_csv</a></dd>
                <dd id="MassSpecCentroid.to_pandas" class="function"><a href="#MassSpecBase.to_pandas">to_pandas</a></dd>
                <dd id="MassSpecCentroid.to_dataframe" class="function"><a href="#MassSpecBase.to_dataframe">to_dataframe</a></dd>
                <dd id="MassSpecCentroid.to_json" class="function"><a href="#MassSpecBase.to_json">to_json</a></dd>
                <dd id="MassSpecCentroid.parameters_json" class="function"><a href="#MassSpecBase.parameters_json">parameters_json</a></dd>
                <dd id="MassSpecCentroid.parameters_toml" class="function"><a href="#MassSpecBase.parameters_toml">parameters_toml</a></dd>

            </div>
            <div><dt><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></dt>
                                <dd id="MassSpecCentroid.percentile_assigned" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.percentile_assigned">percentile_assigned</a></dd>
                <dd id="MassSpecCentroid.resolving_power_calc" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.resolving_power_calc">resolving_power_calc</a></dd>
                <dd id="MassSpecCentroid.number_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.number_average_molecular_weight">number_average_molecular_weight</a></dd>
                <dd id="MassSpecCentroid.weight_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.weight_average_molecular_weight">weight_average_molecular_weight</a></dd>

            </div>
            <div><dt><a href="../calc/PeakPicking.html#PeakPicking">corems.mass_spectrum.calc.PeakPicking.PeakPicking</a></dt>
                                <dd id="MassSpecCentroid.prepare_peak_picking_data" class="function"><a href="../calc/PeakPicking.html#PeakPicking.prepare_peak_picking_data">prepare_peak_picking_data</a></dd>
                <dd id="MassSpecCentroid.cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cut_mz_domain_peak_picking">cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecCentroid.legacy_cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.legacy_cut_mz_domain_peak_picking">legacy_cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecCentroid.extrapolate_axis" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axis">extrapolate_axis</a></dd>
                <dd id="MassSpecCentroid.extrapolate_axes_for_pp" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axes_for_pp">extrapolate_axes_for_pp</a></dd>
                <dd id="MassSpecCentroid.do_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.do_peak_picking">do_peak_picking</a></dd>
                <dd id="MassSpecCentroid.find_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_minima">find_minima</a></dd>
                <dd id="MassSpecCentroid.linear_fit_calc" class="function"><a href="../calc/PeakPicking.html#PeakPicking.linear_fit_calc">linear_fit_calc</a></dd>
                <dd id="MassSpecCentroid.calculate_resolving_power" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calculate_resolving_power">calculate_resolving_power</a></dd>
                <dd id="MassSpecCentroid.cal_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cal_minima">cal_minima</a></dd>
                <dd id="MassSpecCentroid.calc_centroid" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid">calc_centroid</a></dd>
                <dd id="MassSpecCentroid.get_threshold" class="function"><a href="../calc/PeakPicking.html#PeakPicking.get_threshold">get_threshold</a></dd>
                <dd id="MassSpecCentroid.algebraic_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.algebraic_quadratic">algebraic_quadratic</a></dd>
                <dd id="MassSpecCentroid.find_apex_fit_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_apex_fit_quadratic">find_apex_fit_quadratic</a></dd>
                <dd id="MassSpecCentroid.check_prominence" class="function"><a href="../calc/PeakPicking.html#PeakPicking.check_prominence">check_prominence</a></dd>
                <dd id="MassSpecCentroid.use_the_max" class="function"><a href="../calc/PeakPicking.html#PeakPicking.use_the_max">use_the_max</a></dd>
                <dd id="MassSpecCentroid.calc_centroid_legacy" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid_legacy">calc_centroid_legacy</a></dd>

            </div>
            <div><dt><a href="../calc/NoiseCalc.html#NoiseThresholdCalc">corems.mass_spectrum.calc.NoiseCalc.NoiseThresholdCalc</a></dt>
                                <dd id="MassSpecCentroid.get_noise_threshold" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_threshold">get_noise_threshold</a></dd>
                <dd id="MassSpecCentroid.cut_mz_domain_noise" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.cut_mz_domain_noise">cut_mz_domain_noise</a></dd>
                <dd id="MassSpecCentroid.get_noise_average" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_average">get_noise_average</a></dd>
                <dd id="MassSpecCentroid.get_abundance_minima_centroid" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_abundance_minima_centroid">get_abundance_minima_centroid</a></dd>
                <dd id="MassSpecCentroid.run_log_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_log_noise_threshold_calc">run_log_noise_threshold_calc</a></dd>
                <dd id="MassSpecCentroid.run_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_noise_threshold_calc">run_noise_threshold_calc</a></dd>

            </div>
            <div><dt><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></dt>
                                <dd id="MassSpecCentroid.mz_odd_even_index_lists" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.mz_odd_even_index_lists">mz_odd_even_index_lists</a></dd>
                <dd id="MassSpecCentroid.calc_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.calc_error">calc_error</a></dd>
                <dd id="MassSpecCentroid.populate_kendrick_index_dict_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_error">populate_kendrick_index_dict_error</a></dd>
                <dd id="MassSpecCentroid.populate_kendrick_index_dict_rounding" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_rounding">populate_kendrick_index_dict_rounding</a></dd>
                <dd id="MassSpecCentroid.sort_abundance_kendrick_dict" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.sort_abundance_kendrick_dict">sort_abundance_kendrick_dict</a></dd>
                <dd id="MassSpecCentroid.kendrick_groups_indexes" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.kendrick_groups_indexes">kendrick_groups_indexes</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="MassSpecCentroidLowRes">
                            <input id="MassSpecCentroidLowRes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">MassSpecCentroidLowRes</span><wbr>(<span class="base"><a href="#MassSpecCentroid">MassSpecCentroid</a></span>):

                <label class="view-source-button" for="MassSpecCentroidLowRes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecCentroidLowRes-1668"><a href="#MassSpecCentroidLowRes-1668"><span class="linenos">1668</span></a><span class="k">class</span> <span class="nc">MassSpecCentroidLowRes</span><span class="p">(</span><span class="n">MassSpecCentroid</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1669"><a href="#MassSpecCentroidLowRes-1669"><span class="linenos">1669</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A mass spectrum class when the entry point is on low resolution centroid format</span>
</span><span id="MassSpecCentroidLowRes-1670"><a href="#MassSpecCentroidLowRes-1670"><span class="linenos">1670</span></a>
</span><span id="MassSpecCentroidLowRes-1671"><a href="#MassSpecCentroidLowRes-1671"><span class="linenos">1671</span></a><span class="sd">    Notes</span>
</span><span id="MassSpecCentroidLowRes-1672"><a href="#MassSpecCentroidLowRes-1672"><span class="linenos">1672</span></a><span class="sd">    -----</span>
</span><span id="MassSpecCentroidLowRes-1673"><a href="#MassSpecCentroidLowRes-1673"><span class="linenos">1673</span></a><span class="sd">    Does not store MSPeak Objs, will iterate over mz, abundance pairs instead</span>
</span><span id="MassSpecCentroidLowRes-1674"><a href="#MassSpecCentroidLowRes-1674"><span class="linenos">1674</span></a>
</span><span id="MassSpecCentroidLowRes-1675"><a href="#MassSpecCentroidLowRes-1675"><span class="linenos">1675</span></a><span class="sd">    Parameters</span>
</span><span id="MassSpecCentroidLowRes-1676"><a href="#MassSpecCentroidLowRes-1676"><span class="linenos">1676</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecCentroidLowRes-1677"><a href="#MassSpecCentroidLowRes-1677"><span class="linenos">1677</span></a><span class="sd">    data_dict : dict {string: numpy array float64 )</span>
</span><span id="MassSpecCentroidLowRes-1678"><a href="#MassSpecCentroidLowRes-1678"><span class="linenos">1678</span></a><span class="sd">        contains keys [m/z, Abundance, Resolving Power, S/N]</span>
</span><span id="MassSpecCentroidLowRes-1679"><a href="#MassSpecCentroidLowRes-1679"><span class="linenos">1679</span></a><span class="sd">    d_params : dict{&#39;str&#39;: float, int or str}</span>
</span><span id="MassSpecCentroidLowRes-1680"><a href="#MassSpecCentroidLowRes-1680"><span class="linenos">1680</span></a><span class="sd">        contains the instrument settings and processing settings</span>
</span><span id="MassSpecCentroidLowRes-1681"><a href="#MassSpecCentroidLowRes-1681"><span class="linenos">1681</span></a>
</span><span id="MassSpecCentroidLowRes-1682"><a href="#MassSpecCentroidLowRes-1682"><span class="linenos">1682</span></a><span class="sd">    Attributes</span>
</span><span id="MassSpecCentroidLowRes-1683"><a href="#MassSpecCentroidLowRes-1683"><span class="linenos">1683</span></a><span class="sd">    ----------</span>
</span><span id="MassSpecCentroidLowRes-1684"><a href="#MassSpecCentroidLowRes-1684"><span class="linenos">1684</span></a><span class="sd">    _processed_tic : float</span>
</span><span id="MassSpecCentroidLowRes-1685"><a href="#MassSpecCentroidLowRes-1685"><span class="linenos">1685</span></a><span class="sd">        store processed total ion current</span>
</span><span id="MassSpecCentroidLowRes-1686"><a href="#MassSpecCentroidLowRes-1686"><span class="linenos">1686</span></a><span class="sd">    _abundance : ndarray</span>
</span><span id="MassSpecCentroidLowRes-1687"><a href="#MassSpecCentroidLowRes-1687"><span class="linenos">1687</span></a><span class="sd">        The abundance values of the mass spectrum.</span>
</span><span id="MassSpecCentroidLowRes-1688"><a href="#MassSpecCentroidLowRes-1688"><span class="linenos">1688</span></a><span class="sd">    _mz_exp : ndarray</span>
</span><span id="MassSpecCentroidLowRes-1689"><a href="#MassSpecCentroidLowRes-1689"><span class="linenos">1689</span></a><span class="sd">        The m/z values of the mass spectrum.</span>
</span><span id="MassSpecCentroidLowRes-1690"><a href="#MassSpecCentroidLowRes-1690"><span class="linenos">1690</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1691"><a href="#MassSpecCentroidLowRes-1691"><span class="linenos">1691</span></a>
</span><span id="MassSpecCentroidLowRes-1692"><a href="#MassSpecCentroidLowRes-1692"><span class="linenos">1692</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1693"><a href="#MassSpecCentroidLowRes-1693"><span class="linenos">1693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroidLowRes-1694"><a href="#MassSpecCentroidLowRes-1694"><span class="linenos">1694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">))</span>
</span><span id="MassSpecCentroidLowRes-1695"><a href="#MassSpecCentroidLowRes-1695"><span class="linenos">1695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span>
</span><span id="MassSpecCentroidLowRes-1696"><a href="#MassSpecCentroidLowRes-1696"><span class="linenos">1696</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="MassSpecCentroidLowRes-1697"><a href="#MassSpecCentroidLowRes-1697"><span class="linenos">1697</span></a>
</span><span id="MassSpecCentroidLowRes-1698"><a href="#MassSpecCentroidLowRes-1698"><span class="linenos">1698</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1699"><a href="#MassSpecCentroidLowRes-1699"><span class="linenos">1699</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">)</span>
</span><span id="MassSpecCentroidLowRes-1700"><a href="#MassSpecCentroidLowRes-1700"><span class="linenos">1700</span></a>
</span><span id="MassSpecCentroidLowRes-1701"><a href="#MassSpecCentroidLowRes-1701"><span class="linenos">1701</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1702"><a href="#MassSpecCentroidLowRes-1702"><span class="linenos">1702</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mz_exp</span><span class="p">[</span><span class="n">position</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">[</span><span class="n">position</span><span class="p">])</span>
</span><span id="MassSpecCentroidLowRes-1703"><a href="#MassSpecCentroidLowRes-1703"><span class="linenos">1703</span></a>
</span><span id="MassSpecCentroidLowRes-1704"><a href="#MassSpecCentroidLowRes-1704"><span class="linenos">1704</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1705"><a href="#MassSpecCentroidLowRes-1705"><span class="linenos">1705</span></a>    <span class="k">def</span> <span class="nf">mz_exp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1706"><a href="#MassSpecCentroidLowRes-1706"><span class="linenos">1706</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1707"><a href="#MassSpecCentroidLowRes-1707"><span class="linenos">1707</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span>
</span><span id="MassSpecCentroidLowRes-1708"><a href="#MassSpecCentroidLowRes-1708"><span class="linenos">1708</span></a>
</span><span id="MassSpecCentroidLowRes-1709"><a href="#MassSpecCentroidLowRes-1709"><span class="linenos">1709</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1710"><a href="#MassSpecCentroidLowRes-1710"><span class="linenos">1710</span></a>    <span class="k">def</span> <span class="nf">abundance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1711"><a href="#MassSpecCentroidLowRes-1711"><span class="linenos">1711</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the abundance values of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1712"><a href="#MassSpecCentroidLowRes-1712"><span class="linenos">1712</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span>
</span><span id="MassSpecCentroidLowRes-1713"><a href="#MassSpecCentroidLowRes-1713"><span class="linenos">1713</span></a>
</span><span id="MassSpecCentroidLowRes-1714"><a href="#MassSpecCentroidLowRes-1714"><span class="linenos">1714</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1715"><a href="#MassSpecCentroidLowRes-1715"><span class="linenos">1715</span></a>    <span class="k">def</span> <span class="nf">processed_tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1716"><a href="#MassSpecCentroidLowRes-1716"><span class="linenos">1716</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the processed total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1717"><a href="#MassSpecCentroidLowRes-1717"><span class="linenos">1717</span></a>        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span><span class="p">)</span>
</span><span id="MassSpecCentroidLowRes-1718"><a href="#MassSpecCentroidLowRes-1718"><span class="linenos">1718</span></a>
</span><span id="MassSpecCentroidLowRes-1719"><a href="#MassSpecCentroidLowRes-1719"><span class="linenos">1719</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1720"><a href="#MassSpecCentroidLowRes-1720"><span class="linenos">1720</span></a>    <span class="k">def</span> <span class="nf">tic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1721"><a href="#MassSpecCentroidLowRes-1721"><span class="linenos">1721</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the total ion current of the mass spectrum.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1722"><a href="#MassSpecCentroidLowRes-1722"><span class="linenos">1722</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span><span class="p">:</span>
</span><span id="MassSpecCentroidLowRes-1723"><a href="#MassSpecCentroidLowRes-1723"><span class="linenos">1723</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span>
</span><span id="MassSpecCentroidLowRes-1724"><a href="#MassSpecCentroidLowRes-1724"><span class="linenos">1724</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="MassSpecCentroidLowRes-1725"><a href="#MassSpecCentroidLowRes-1725"><span class="linenos">1725</span></a>            <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abundance</span><span class="p">)</span>
</span><span id="MassSpecCentroidLowRes-1726"><a href="#MassSpecCentroidLowRes-1726"><span class="linenos">1726</span></a>
</span><span id="MassSpecCentroidLowRes-1727"><a href="#MassSpecCentroidLowRes-1727"><span class="linenos">1727</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1728"><a href="#MassSpecCentroidLowRes-1728"><span class="linenos">1728</span></a>    <span class="k">def</span> <span class="nf">mz_abun_tuples</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1729"><a href="#MassSpecCentroidLowRes-1729"><span class="linenos">1729</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z and abundance values of the mass spectrum as a list of tuples.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1730"><a href="#MassSpecCentroidLowRes-1730"><span class="linenos">1730</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">))))</span>
</span><span id="MassSpecCentroidLowRes-1731"><a href="#MassSpecCentroidLowRes-1731"><span class="linenos">1731</span></a>
</span><span id="MassSpecCentroidLowRes-1732"><a href="#MassSpecCentroidLowRes-1732"><span class="linenos">1732</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]</span>
</span><span id="MassSpecCentroidLowRes-1733"><a href="#MassSpecCentroidLowRes-1733"><span class="linenos">1733</span></a>
</span><span id="MassSpecCentroidLowRes-1734"><a href="#MassSpecCentroidLowRes-1734"><span class="linenos">1734</span></a>    <span class="nd">@property</span>
</span><span id="MassSpecCentroidLowRes-1735"><a href="#MassSpecCentroidLowRes-1735"><span class="linenos">1735</span></a>    <span class="k">def</span> <span class="nf">mz_abun_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes-1736"><a href="#MassSpecCentroidLowRes-1736"><span class="linenos">1736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the m/z and abundance values of the mass spectrum as a dictionary.&quot;&quot;&quot;</span>
</span><span id="MassSpecCentroidLowRes-1737"><a href="#MassSpecCentroidLowRes-1737"><span class="linenos">1737</span></a>        <span class="n">r</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="MassSpecCentroidLowRes-1738"><a href="#MassSpecCentroidLowRes-1738"><span class="linenos">1738</span></a>
</span><span id="MassSpecCentroidLowRes-1739"><a href="#MassSpecCentroidLowRes-1739"><span class="linenos">1739</span></a>        <span class="k">return</span> <span class="p">{</span><span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span> <span class="n">r</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>A mass spectrum class when the entry point is on low resolution centroid format</p>

<h6 id="notes">Notes</h6>

<p>Does not store MSPeak Objs, will iterate over mz, abundance pairs instead</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>data_dict : dict {string</strong> (numpy array float64 )):
contains keys [m/z, Abundance, Resolving Power, S/N]</li>
<li><strong>d_params : dict{'str'</strong> (float, int or str}):
contains the instrument settings and processing settings</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>_processed_tic</strong> (float):
store processed total ion current</li>
<li><strong>_abundance</strong> (ndarray):
The abundance values of the mass spectrum.</li>
<li><strong>_mz_exp</strong> (ndarray):
The m/z values of the mass spectrum.</li>
</ul>
</div>


                            <div id="MassSpecCentroidLowRes.__init__" class="classattr">
                                        <input id="MassSpecCentroidLowRes.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">MassSpecCentroidLowRes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dict</span>, </span><span class="param"><span class="n">d_params</span></span>)</span>

                <label class="view-source-button" for="MassSpecCentroidLowRes.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="MassSpecCentroidLowRes.__init__-1692"><a href="#MassSpecCentroidLowRes.__init__-1692"><span class="linenos">1692</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">):</span>
</span><span id="MassSpecCentroidLowRes.__init__-1693"><a href="#MassSpecCentroidLowRes.__init__-1693"><span class="linenos">1693</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameters_objects</span><span class="p">(</span><span class="n">d_params</span><span class="p">)</span>
</span><span id="MassSpecCentroidLowRes.__init__-1694"><a href="#MassSpecCentroidLowRes.__init__-1694"><span class="linenos">1694</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_mz_exp</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">))</span>
</span><span id="MassSpecCentroidLowRes.__init__-1695"><a href="#MassSpecCentroidLowRes.__init__-1695"><span class="linenos">1695</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_abundance</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">))</span>
</span><span id="MassSpecCentroidLowRes.__init__-1696"><a href="#MassSpecCentroidLowRes.__init__-1696"><span class="linenos">1696</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_processed_tic</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


    

                            </div>
                            <div id="MassSpecCentroidLowRes.mz_exp" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_exp</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.mz_exp"></a>
    
            <div class="docstring"><p>Return the m/z values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroidLowRes.abundance" class="classattr">
                                <div class="attr variable">
            <span class="name">abundance</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.abundance"></a>
    
            <div class="docstring"><p>Return the abundance values of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroidLowRes.processed_tic" class="classattr">
                                <div class="attr variable">
            <span class="name">processed_tic</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.processed_tic"></a>
    
            <div class="docstring"><p>Return the processed total ion current of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroidLowRes.tic" class="classattr">
                                <div class="attr variable">
            <span class="name">tic</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.tic"></a>
    
            <div class="docstring"><p>Return the total ion current of the mass spectrum.</p>
</div>


                            </div>
                            <div id="MassSpecCentroidLowRes.mz_abun_tuples" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_abun_tuples</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.mz_abun_tuples"></a>
    
            <div class="docstring"><p>Return the m/z and abundance values of the mass spectrum as a list of tuples.</p>
</div>


                            </div>
                            <div id="MassSpecCentroidLowRes.mz_abun_dict" class="classattr">
                                <div class="attr variable">
            <span class="name">mz_abun_dict</span>

        
    </div>
    <a class="headerlink" href="#MassSpecCentroidLowRes.mz_abun_dict"></a>
    
            <div class="docstring"><p>Return the m/z and abundance values of the mass spectrum as a dictionary.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#MassSpecCentroid">MassSpecCentroid</a></dt>
                                <dd id="MassSpecCentroidLowRes.is_centroid" class="variable"><a href="#MassSpecCentroid.is_centroid">is_centroid</a></dd>
                <dd id="MassSpecCentroidLowRes.data_dict" class="variable"><a href="#MassSpecCentroid.data_dict">data_dict</a></dd>
                <dd id="MassSpecCentroidLowRes.mz_exp_profile" class="variable"><a href="#MassSpecCentroid.mz_exp_profile">mz_exp_profile</a></dd>
                <dd id="MassSpecCentroidLowRes.abundance_profile" class="variable"><a href="#MassSpecCentroid.abundance_profile">abundance_profile</a></dd>
                <dd id="MassSpecCentroidLowRes.process_mass_spec" class="function"><a href="#MassSpecCentroid.process_mass_spec">process_mass_spec</a></dd>

            </div>
            <div><dt><a href="#MassSpecBase">MassSpecBase</a></dt>
                                <dd id="MassSpecCentroidLowRes.mspeaks" class="variable"><a href="#MassSpecBase.mspeaks">mspeaks</a></dd>
                <dd id="MassSpecCentroidLowRes.is_calibrated" class="variable"><a href="#MassSpecBase.is_calibrated">is_calibrated</a></dd>
                <dd id="MassSpecCentroidLowRes.has_frequency" class="variable"><a href="#MassSpecBase.has_frequency">has_frequency</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_order" class="variable"><a href="#MassSpecBase.calibration_order">calibration_order</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_points" class="variable"><a href="#MassSpecBase.calibration_points">calibration_points</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_ref_mzs" class="variable"><a href="#MassSpecBase.calibration_ref_mzs">calibration_ref_mzs</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_meas_mzs" class="variable"><a href="#MassSpecBase.calibration_meas_mzs">calibration_meas_mzs</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_RMS" class="variable"><a href="#MassSpecBase.calibration_RMS">calibration_RMS</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_segment" class="variable"><a href="#MassSpecBase.calibration_segment">calibration_segment</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_raw_error_median" class="variable"><a href="#MassSpecBase.calibration_raw_error_median">calibration_raw_error_median</a></dd>
                <dd id="MassSpecCentroidLowRes.calibration_raw_error_stdev" class="variable"><a href="#MassSpecBase.calibration_raw_error_stdev">calibration_raw_error_stdev</a></dd>
                <dd id="MassSpecCentroidLowRes.set_indexes" class="function"><a href="#MassSpecBase.set_indexes">set_indexes</a></dd>
                <dd id="MassSpecCentroidLowRes.reset_indexes" class="function"><a href="#MassSpecBase.reset_indexes">reset_indexes</a></dd>
                <dd id="MassSpecCentroidLowRes.add_mspeak" class="function"><a href="#MassSpecBase.add_mspeak">add_mspeak</a></dd>
                <dd id="MassSpecCentroidLowRes.reset_cal_therms" class="function"><a href="#MassSpecBase.reset_cal_therms">reset_cal_therms</a></dd>
                <dd id="MassSpecCentroidLowRes.clear_molecular_formulas" class="function"><a href="#MassSpecBase.clear_molecular_formulas">clear_molecular_formulas</a></dd>
                <dd id="MassSpecCentroidLowRes.cal_noise_threshold" class="function"><a href="#MassSpecBase.cal_noise_threshold">cal_noise_threshold</a></dd>
                <dd id="MassSpecCentroidLowRes.parameters" class="variable"><a href="#MassSpecBase.parameters">parameters</a></dd>
                <dd id="MassSpecCentroidLowRes.set_parameter_from_json" class="function"><a href="#MassSpecBase.set_parameter_from_json">set_parameter_from_json</a></dd>
                <dd id="MassSpecCentroidLowRes.set_parameter_from_toml" class="function"><a href="#MassSpecBase.set_parameter_from_toml">set_parameter_from_toml</a></dd>
                <dd id="MassSpecCentroidLowRes.mspeaks_settings" class="variable"><a href="#MassSpecBase.mspeaks_settings">mspeaks_settings</a></dd>
                <dd id="MassSpecCentroidLowRes.settings" class="variable"><a href="#MassSpecBase.settings">settings</a></dd>
                <dd id="MassSpecCentroidLowRes.molecular_search_settings" class="variable"><a href="#MassSpecBase.molecular_search_settings">molecular_search_settings</a></dd>
                <dd id="MassSpecCentroidLowRes.mz_cal_profile" class="variable"><a href="#MassSpecBase.mz_cal_profile">mz_cal_profile</a></dd>
                <dd id="MassSpecCentroidLowRes.mz_cal" class="variable"><a href="#MassSpecBase.mz_cal">mz_cal</a></dd>
                <dd id="MassSpecCentroidLowRes.freq_exp_profile" class="variable"><a href="#MassSpecBase.freq_exp_profile">freq_exp_profile</a></dd>
                <dd id="MassSpecCentroidLowRes.freq_exp_pp" class="variable"><a href="#MassSpecBase.freq_exp_pp">freq_exp_pp</a></dd>
                <dd id="MassSpecCentroidLowRes.mz_exp_pp" class="variable"><a href="#MassSpecBase.mz_exp_pp">mz_exp_pp</a></dd>
                <dd id="MassSpecCentroidLowRes.abundance_profile_pp" class="variable"><a href="#MassSpecBase.abundance_profile_pp">abundance_profile_pp</a></dd>
                <dd id="MassSpecCentroidLowRes.freq_exp" class="function"><a href="#MassSpecBase.freq_exp">freq_exp</a></dd>
                <dd id="MassSpecCentroidLowRes.resolving_power" class="variable"><a href="#MassSpecBase.resolving_power">resolving_power</a></dd>
                <dd id="MassSpecCentroidLowRes.signal_to_noise" class="variable"><a href="#MassSpecBase.signal_to_noise">signal_to_noise</a></dd>
                <dd id="MassSpecCentroidLowRes.nominal_mz" class="variable"><a href="#MassSpecBase.nominal_mz">nominal_mz</a></dd>
                <dd id="MassSpecCentroidLowRes.get_mz_and_abundance_peaks_tuples" class="function"><a href="#MassSpecBase.get_mz_and_abundance_peaks_tuples">get_mz_and_abundance_peaks_tuples</a></dd>
                <dd id="MassSpecCentroidLowRes.kmd" class="variable"><a href="#MassSpecBase.kmd">kmd</a></dd>
                <dd id="MassSpecCentroidLowRes.kendrick_mass" class="variable"><a href="#MassSpecBase.kendrick_mass">kendrick_mass</a></dd>
                <dd id="MassSpecCentroidLowRes.max_mz_exp" class="variable"><a href="#MassSpecBase.max_mz_exp">max_mz_exp</a></dd>
                <dd id="MassSpecCentroidLowRes.min_mz_exp" class="variable"><a href="#MassSpecBase.min_mz_exp">min_mz_exp</a></dd>
                <dd id="MassSpecCentroidLowRes.max_abundance" class="variable"><a href="#MassSpecBase.max_abundance">max_abundance</a></dd>
                <dd id="MassSpecCentroidLowRes.max_signal_to_noise" class="variable"><a href="#MassSpecBase.max_signal_to_noise">max_signal_to_noise</a></dd>
                <dd id="MassSpecCentroidLowRes.most_abundant_mspeak" class="variable"><a href="#MassSpecBase.most_abundant_mspeak">most_abundant_mspeak</a></dd>
                <dd id="MassSpecCentroidLowRes.min_abundance" class="variable"><a href="#MassSpecBase.min_abundance">min_abundance</a></dd>
                <dd id="MassSpecCentroidLowRes.dynamic_range" class="variable"><a href="#MassSpecBase.dynamic_range">dynamic_range</a></dd>
                <dd id="MassSpecCentroidLowRes.baseline_noise" class="variable"><a href="#MassSpecBase.baseline_noise">baseline_noise</a></dd>
                <dd id="MassSpecCentroidLowRes.baseline_noise_std" class="variable"><a href="#MassSpecBase.baseline_noise_std">baseline_noise_std</a></dd>
                <dd id="MassSpecCentroidLowRes.Aterm" class="variable"><a href="#MassSpecBase.Aterm">Aterm</a></dd>
                <dd id="MassSpecCentroidLowRes.Bterm" class="variable"><a href="#MassSpecBase.Bterm">Bterm</a></dd>
                <dd id="MassSpecCentroidLowRes.Cterm" class="variable"><a href="#MassSpecBase.Cterm">Cterm</a></dd>
                <dd id="MassSpecCentroidLowRes.filename" class="variable"><a href="#MassSpecBase.filename">filename</a></dd>
                <dd id="MassSpecCentroidLowRes.dir_location" class="variable"><a href="#MassSpecBase.dir_location">dir_location</a></dd>
                <dd id="MassSpecCentroidLowRes.sort_by_mz" class="function"><a href="#MassSpecBase.sort_by_mz">sort_by_mz</a></dd>
                <dd id="MassSpecCentroidLowRes.sort_by_abundance" class="function"><a href="#MassSpecBase.sort_by_abundance">sort_by_abundance</a></dd>
                <dd id="MassSpecCentroidLowRes.check_mspeaks_warning" class="function"><a href="#MassSpecBase.check_mspeaks_warning">check_mspeaks_warning</a></dd>
                <dd id="MassSpecCentroidLowRes.check_mspeaks" class="function"><a href="#MassSpecBase.check_mspeaks">check_mspeaks</a></dd>
                <dd id="MassSpecCentroidLowRes.remove_assignment_by_index" class="function"><a href="#MassSpecBase.remove_assignment_by_index">remove_assignment_by_index</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_index" class="function"><a href="#MassSpecBase.filter_by_index">filter_by_index</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_mz" class="function"><a href="#MassSpecBase.filter_by_mz">filter_by_mz</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_s2n" class="function"><a href="#MassSpecBase.filter_by_s2n">filter_by_s2n</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_abundance" class="function"><a href="#MassSpecBase.filter_by_abundance">filter_by_abundance</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_max_resolving_power" class="function"><a href="#MassSpecBase.filter_by_max_resolving_power">filter_by_max_resolving_power</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_mean_resolving_power" class="function"><a href="#MassSpecBase.filter_by_mean_resolving_power">filter_by_mean_resolving_power</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_min_resolving_power" class="function"><a href="#MassSpecBase.filter_by_min_resolving_power">filter_by_min_resolving_power</a></dd>
                <dd id="MassSpecCentroidLowRes.filter_by_noise_threshold" class="function"><a href="#MassSpecBase.filter_by_noise_threshold">filter_by_noise_threshold</a></dd>
                <dd id="MassSpecCentroidLowRes.find_peaks" class="function"><a href="#MassSpecBase.find_peaks">find_peaks</a></dd>
                <dd id="MassSpecCentroidLowRes.change_kendrick_base_all_mspeaks" class="function"><a href="#MassSpecBase.change_kendrick_base_all_mspeaks">change_kendrick_base_all_mspeaks</a></dd>
                <dd id="MassSpecCentroidLowRes.get_nominal_mz_first_last_indexes" class="function"><a href="#MassSpecBase.get_nominal_mz_first_last_indexes">get_nominal_mz_first_last_indexes</a></dd>
                <dd id="MassSpecCentroidLowRes.get_masses_count_by_nominal_mass" class="function"><a href="#MassSpecBase.get_masses_count_by_nominal_mass">get_masses_count_by_nominal_mass</a></dd>
                <dd id="MassSpecCentroidLowRes.datapoints_count_by_nominal_mz" class="function"><a href="#MassSpecBase.datapoints_count_by_nominal_mz">datapoints_count_by_nominal_mz</a></dd>
                <dd id="MassSpecCentroidLowRes.get_nominal_mass_indexes" class="function"><a href="#MassSpecBase.get_nominal_mass_indexes">get_nominal_mass_indexes</a></dd>
                <dd id="MassSpecCentroidLowRes.plot_centroid" class="function"><a href="#MassSpecBase.plot_centroid">plot_centroid</a></dd>
                <dd id="MassSpecCentroidLowRes.plot_profile_and_noise_threshold" class="function"><a href="#MassSpecBase.plot_profile_and_noise_threshold">plot_profile_and_noise_threshold</a></dd>
                <dd id="MassSpecCentroidLowRes.plot_mz_domain_profile" class="function"><a href="#MassSpecBase.plot_mz_domain_profile">plot_mz_domain_profile</a></dd>
                <dd id="MassSpecCentroidLowRes.to_excel" class="function"><a href="#MassSpecBase.to_excel">to_excel</a></dd>
                <dd id="MassSpecCentroidLowRes.to_hdf" class="function"><a href="#MassSpecBase.to_hdf">to_hdf</a></dd>
                <dd id="MassSpecCentroidLowRes.to_csv" class="function"><a href="#MassSpecBase.to_csv">to_csv</a></dd>
                <dd id="MassSpecCentroidLowRes.to_pandas" class="function"><a href="#MassSpecBase.to_pandas">to_pandas</a></dd>
                <dd id="MassSpecCentroidLowRes.to_dataframe" class="function"><a href="#MassSpecBase.to_dataframe">to_dataframe</a></dd>
                <dd id="MassSpecCentroidLowRes.to_json" class="function"><a href="#MassSpecBase.to_json">to_json</a></dd>
                <dd id="MassSpecCentroidLowRes.parameters_json" class="function"><a href="#MassSpecBase.parameters_json">parameters_json</a></dd>
                <dd id="MassSpecCentroidLowRes.parameters_toml" class="function"><a href="#MassSpecBase.parameters_toml">parameters_toml</a></dd>

            </div>
            <div><dt><a href="../calc/MassSpectrumCalc.html#MassSpecCalc">corems.mass_spectrum.calc.MassSpectrumCalc.MassSpecCalc</a></dt>
                                <dd id="MassSpecCentroidLowRes.percentile_assigned" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.percentile_assigned">percentile_assigned</a></dd>
                <dd id="MassSpecCentroidLowRes.resolving_power_calc" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.resolving_power_calc">resolving_power_calc</a></dd>
                <dd id="MassSpecCentroidLowRes.number_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.number_average_molecular_weight">number_average_molecular_weight</a></dd>
                <dd id="MassSpecCentroidLowRes.weight_average_molecular_weight" class="function"><a href="../calc/MassSpectrumCalc.html#MassSpecCalc.weight_average_molecular_weight">weight_average_molecular_weight</a></dd>

            </div>
            <div><dt><a href="../calc/PeakPicking.html#PeakPicking">corems.mass_spectrum.calc.PeakPicking.PeakPicking</a></dt>
                                <dd id="MassSpecCentroidLowRes.prepare_peak_picking_data" class="function"><a href="../calc/PeakPicking.html#PeakPicking.prepare_peak_picking_data">prepare_peak_picking_data</a></dd>
                <dd id="MassSpecCentroidLowRes.cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cut_mz_domain_peak_picking">cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecCentroidLowRes.legacy_cut_mz_domain_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.legacy_cut_mz_domain_peak_picking">legacy_cut_mz_domain_peak_picking</a></dd>
                <dd id="MassSpecCentroidLowRes.extrapolate_axis" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axis">extrapolate_axis</a></dd>
                <dd id="MassSpecCentroidLowRes.extrapolate_axes_for_pp" class="function"><a href="../calc/PeakPicking.html#PeakPicking.extrapolate_axes_for_pp">extrapolate_axes_for_pp</a></dd>
                <dd id="MassSpecCentroidLowRes.do_peak_picking" class="function"><a href="../calc/PeakPicking.html#PeakPicking.do_peak_picking">do_peak_picking</a></dd>
                <dd id="MassSpecCentroidLowRes.find_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_minima">find_minima</a></dd>
                <dd id="MassSpecCentroidLowRes.linear_fit_calc" class="function"><a href="../calc/PeakPicking.html#PeakPicking.linear_fit_calc">linear_fit_calc</a></dd>
                <dd id="MassSpecCentroidLowRes.calculate_resolving_power" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calculate_resolving_power">calculate_resolving_power</a></dd>
                <dd id="MassSpecCentroidLowRes.cal_minima" class="function"><a href="../calc/PeakPicking.html#PeakPicking.cal_minima">cal_minima</a></dd>
                <dd id="MassSpecCentroidLowRes.calc_centroid" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid">calc_centroid</a></dd>
                <dd id="MassSpecCentroidLowRes.get_threshold" class="function"><a href="../calc/PeakPicking.html#PeakPicking.get_threshold">get_threshold</a></dd>
                <dd id="MassSpecCentroidLowRes.algebraic_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.algebraic_quadratic">algebraic_quadratic</a></dd>
                <dd id="MassSpecCentroidLowRes.find_apex_fit_quadratic" class="function"><a href="../calc/PeakPicking.html#PeakPicking.find_apex_fit_quadratic">find_apex_fit_quadratic</a></dd>
                <dd id="MassSpecCentroidLowRes.check_prominence" class="function"><a href="../calc/PeakPicking.html#PeakPicking.check_prominence">check_prominence</a></dd>
                <dd id="MassSpecCentroidLowRes.use_the_max" class="function"><a href="../calc/PeakPicking.html#PeakPicking.use_the_max">use_the_max</a></dd>
                <dd id="MassSpecCentroidLowRes.calc_centroid_legacy" class="function"><a href="../calc/PeakPicking.html#PeakPicking.calc_centroid_legacy">calc_centroid_legacy</a></dd>

            </div>
            <div><dt><a href="../calc/NoiseCalc.html#NoiseThresholdCalc">corems.mass_spectrum.calc.NoiseCalc.NoiseThresholdCalc</a></dt>
                                <dd id="MassSpecCentroidLowRes.get_noise_threshold" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_threshold">get_noise_threshold</a></dd>
                <dd id="MassSpecCentroidLowRes.cut_mz_domain_noise" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.cut_mz_domain_noise">cut_mz_domain_noise</a></dd>
                <dd id="MassSpecCentroidLowRes.get_noise_average" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_noise_average">get_noise_average</a></dd>
                <dd id="MassSpecCentroidLowRes.get_abundance_minima_centroid" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.get_abundance_minima_centroid">get_abundance_minima_centroid</a></dd>
                <dd id="MassSpecCentroidLowRes.run_log_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_log_noise_threshold_calc">run_log_noise_threshold_calc</a></dd>
                <dd id="MassSpecCentroidLowRes.run_noise_threshold_calc" class="function"><a href="../calc/NoiseCalc.html#NoiseThresholdCalc.run_noise_threshold_calc">run_noise_threshold_calc</a></dd>

            </div>
            <div><dt><a href="../calc/KendrickGroup.html#KendrickGrouping">corems.mass_spectrum.calc.KendrickGroup.KendrickGrouping</a></dt>
                                <dd id="MassSpecCentroidLowRes.mz_odd_even_index_lists" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.mz_odd_even_index_lists">mz_odd_even_index_lists</a></dd>
                <dd id="MassSpecCentroidLowRes.calc_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.calc_error">calc_error</a></dd>
                <dd id="MassSpecCentroidLowRes.populate_kendrick_index_dict_error" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_error">populate_kendrick_index_dict_error</a></dd>
                <dd id="MassSpecCentroidLowRes.populate_kendrick_index_dict_rounding" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.populate_kendrick_index_dict_rounding">populate_kendrick_index_dict_rounding</a></dd>
                <dd id="MassSpecCentroidLowRes.sort_abundance_kendrick_dict" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.sort_abundance_kendrick_dict">sort_abundance_kendrick_dict</a></dd>
                <dd id="MassSpecCentroidLowRes.kendrick_groups_indexes" class="function"><a href="../calc/KendrickGroup.html#KendrickGrouping.kendrick_groups_indexes">kendrick_groups_indexes</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>