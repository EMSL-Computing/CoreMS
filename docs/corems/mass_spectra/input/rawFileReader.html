<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>corems.mass_spectra.input.rawFileReader API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../input.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;corems.mass_spectra.input</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#spec">spec</a>
            </li>
            <li>
                    <a class="class" href="#ThermoBaseClass">ThermoBaseClass</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ThermoBaseClass.__init__">ThermoBaseClass</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.iRawDataPlus">iRawDataPlus</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.res">res</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.file_path">file_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.iFileHeader">iFileHeader</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.parameters">parameters</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.chromatogram_settings">chromatogram_settings</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.scans">scans</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.start_scan">start_scan</a>
                        </li>
                        <li>
                                <a class="variable" href="#ThermoBaseClass.end_scan">end_scan</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.set_msordertype">set_msordertype</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_creation_time">get_creation_time</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.remove_temp_file">remove_temp_file</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.close_file">close_file</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_polarity_mode">get_polarity_mode</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_filter_for_scan_num">get_filter_for_scan_num</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.check_full_scan">check_full_scan</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_all_filters">get_all_filters</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_scan_header">get_scan_header</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_rt_time_from_trace">get_rt_time_from_trace</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_eics">get_eics</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_tic">get_tic</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_average_mass_spectrum">get_average_mass_spectrum</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.set_metadata">set_metadata</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_instrument_methods">get_instrument_methods</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_tune_method">get_tune_method</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_status_log">get_status_log</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_error_logs">get_error_logs</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_sample_information">get_sample_information</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_instrument_data">get_instrument_data</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_centroid_msms_data">get_centroid_msms_data</a>
                        </li>
                        <li>
                                <a class="function" href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist">get_average_mass_spectrum_by_scanlist</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ImportMassSpectraThermoMSFileReader">ImportMassSpectraThermoMSFileReader</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.__init__">ImportMassSpectraThermoMSFileReader</a>
                        </li>
                        <li>
                                <a class="variable" href="#ImportMassSpectraThermoMSFileReader.file_location">file_location</a>
                        </li>
                        <li>
                                <a class="variable" href="#ImportMassSpectraThermoMSFileReader.analyzer">analyzer</a>
                        </li>
                        <li>
                                <a class="variable" href="#ImportMassSpectraThermoMSFileReader.instrument_label">instrument_label</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_scan_df">get_scan_df</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_ms_raw">get_ms_raw</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.run">run</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan">get_mass_spectrum_from_scan</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj">get_mass_spectra_obj</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj">get_lcms_obj</a>
                        </li>
                        <li>
                                <a class="function" href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times">get_icr_transient_times</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../../corems.html">corems</a><wbr>.<a href="./../../mass_spectra.html">mass_spectra</a><wbr>.<a href="./../input.html">input</a><wbr>.rawFileReader    </h1>

                
                        <input id="mod-rawFileReader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-rawFileReader-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Yuri E. Corilo&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;Jun 09, 2021&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">axes</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.factory.processingSetting</span> <span class="kn">import</span> <span class="n">LiquidChromatographSetting</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span> <span class="nn">sys</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span> <span class="nn">site</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">import</span> <span class="nn">datetime</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">import</span> <span class="nn">importlib.util</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">import</span> <span class="nn">clr</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span> <span class="nn">s3path</span> <span class="kn">import</span> <span class="n">S3Path</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.constant</span> <span class="kn">import</span> <span class="n">Labels</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.factory.lc_class</span> <span class="kn">import</span> <span class="n">MassSpectraBase</span><span class="p">,</span> <span class="n">LCMSBase</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.factory.chromat_data</span> <span class="kn">import</span> <span class="n">EIC_Data</span><span class="p">,</span> <span class="n">TIC_Data</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectrum.factory.MassSpectrumClasses</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>    <span class="n">MassSpecProfile</span><span class="p">,</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>    <span class="n">MassSpecCentroid</span><span class="p">,</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="p">)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.factory.parameters</span> <span class="kn">import</span> <span class="n">LCMSParameters</span><span class="p">,</span> <span class="n">default_parameters</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.input.parserbase</span> <span class="kn">import</span> <span class="n">SpectraParserInterface</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="c1"># Add the path of the Thermo .NET libraries to the system path</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="n">spec</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_spec</span><span class="p">(</span><span class="s2">&quot;corems&quot;</span><span class="p">)</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">origin</span><span class="p">))</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/ext_lib/dotnet/&quot;</span><span class="p">)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;ThermoFisher.CommonCore.RawFileReader&quot;</span><span class="p">)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;ThermoFisher.CommonCore.Data&quot;</span><span class="p">)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="n">clr</span><span class="o">.</span><span class="n">AddReference</span><span class="p">(</span><span class="s2">&quot;ThermoFisher.CommonCore.MassPrecisionEstimator&quot;</span><span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.RawFileReader</span> <span class="kn">import</span> <span class="n">RawFileReaderAdapter</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data</span> <span class="kn">import</span> <span class="n">ToleranceUnits</span><span class="p">,</span> <span class="n">Extensions</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.Business</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>    <span class="n">ChromatogramTraceSettings</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>    <span class="n">TraceType</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>    <span class="n">MassOptions</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="p">)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.Business</span> <span class="kn">import</span> <span class="n">ChromatogramSignal</span><span class="p">,</span> <span class="n">Range</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.Business</span> <span class="kn">import</span> <span class="n">Device</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.Interfaces</span> <span class="kn">import</span> <span class="n">IChromatogramSettings</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.Business</span> <span class="kn">import</span> <span class="n">MassOptions</span><span class="p">,</span> <span class="n">FileHeaderReaderFactory</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="kn">from</span> <span class="nn">ThermoFisher.CommonCore.Data.FilterEnums</span> <span class="kn">import</span> <span class="n">MSOrderType</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="kn">from</span> <span class="nn">System.Collections.Generic</span> <span class="kn">import</span> <span class="n">List</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="k">class</span> <span class="nc">ThermoBaseClass</span><span class="p">:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for parsing Thermo Raw files and extracting information from them.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">    Parameters:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">    -----------</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    file_location : str or pathlib.Path or s3path.S3Path</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">        Thermo Raw file path or S3 path.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    Attributes:</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    -----------</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    file_path : str or pathlib.Path or s3path.S3Path</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        The file path of the Thermo Raw file.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">    parameters : LCMSParameters</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">        The LCMS parameters for the Thermo Raw file.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">    chromatogram_settings : LiquidChromatographSetting</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">        The chromatogram settings for the Thermo Raw file.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    scans : list or tuple</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">        The selected scans for the Thermo Raw file.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">    start_scan : int</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">        The starting scan number for the Thermo Raw file.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">    end_scan : int</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">        The ending scan number for the Thermo Raw file.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">    Methods:</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">    --------</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    * set_msordertype(scanFilter, mstype: str = &#39;ms1&#39;) -&gt; scanFilter</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">        Convert the user-passed MS Type string to a Thermo MSOrderType object.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">    * get_creation_time() -&gt; datetime.datetime</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">        Extract the creation date stamp from the .RAW file and return it as a formatted datetime object.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">    * remove_temp_file()</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">        Remove the temporary file if the path is from S3Path.</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    * get_polarity_mode(scan_number: int) -&gt; int</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">        Get the polarity mode for the given scan number.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">    * get_filter_for_scan_num(scan_number: int) -&gt; List[str]</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">        Get the filter for the given scan number.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">    * check_full_scan(scan_number: int) -&gt; bool</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">        Check if the given scan number is a full scan.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">    * get_all_filters() -&gt; Tuple[Dict[int, str], List[str]]</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">        Get all scan filters for the Thermo Raw file.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">    * get_scan_header(scan: int) -&gt; Dict[str, Any]</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">        Get the full dictionary of scan header metadata for the given scan number.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    * get_rt_time_from_trace(trace) -&gt; Tuple[List[float], List[float], List[int]]</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">        Get the retention time, intensity, and scan number from the given trace.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="sd">    * get_eics(target_mzs: List[float], tic_data: Dict[str, Any], ms_type: str = &#39;MS !d&#39;,</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">             peak_detection: bool = True, smooth: bool = True, plot: bool = False,</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">             ax: Optional[matplotlib.axes.Axes] = None, legend: bool = False) -&gt; Tuple[Dict[float, EIC_Data], matplotlib.axes.Axes]</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">        Get the extracted ion chromatograms (EICs) for the target m/z values.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">):</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;file_location: srt pathlib.Path or s3path.S3Path</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">        Thermo Raw file path</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>        <span class="c1"># Thread.__init__(self)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="n">S3Path</span><span class="p">):</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>            <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;tmp/&quot;</span><span class="p">)</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>            <span class="n">temp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="n">file_location</span><span class="o">.</span><span class="n">name</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>                <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_location</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">())</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span> <span class="o">=</span> <span class="n">RawFileReaderAdapter</span><span class="o">.</span><span class="n">FileFactory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsOpen</span><span class="p">:</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>                <span class="s2">&quot;Unable to access the RAW file using the RawFileReader class!&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>        <span class="c1"># Check for any errors in the RAW file</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsError</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>                <span class="s2">&quot;Error opening (</span><span class="si">{}</span><span class="s2">) - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">FileError</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>            <span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SelectInstrument</span><span class="p">(</span><span class="n">Device</span><span class="o">.</span><span class="n">MS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iFileHeader</span> <span class="o">=</span> <span class="n">FileHeaderReaderFactory</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="c1"># removing tmp file</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="k">def</span> <span class="nf">_init_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">        Initialize the LCMSParameters object.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">LCMSParameters</span><span class="p">()</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>    <span class="nd">@property</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LCMSParameters</span><span class="p">:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        Get or set the LCMSParameters object.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="nd">@parameters</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_LCMSParameters</span><span class="p">:</span> <span class="n">LCMSParameters</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">instance_LCMSParameters</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>    <span class="nd">@property</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>    <span class="k">def</span> <span class="nf">chromatogram_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LiquidChromatographSetting</span><span class="p">:</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">        Get or set the LiquidChromatographSetting object.</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">lc_ms</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>    <span class="nd">@chromatogram_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>    <span class="k">def</span> <span class="nf">chromatogram_settings</span><span class="p">(</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">instance_LiquidChromatographSetting</span><span class="p">:</span> <span class="n">LiquidChromatographSetting</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>    <span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">lc_ms</span> <span class="o">=</span> <span class="n">instance_LiquidChromatographSetting</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>    <span class="nd">@property</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>    <span class="k">def</span> <span class="nf">scans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;scans : list or tuple</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">        If list uses Thermo AverageScansInScanRange for selected scans, ortherwise uses Thermo AverageScans for a scan range</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">scans</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>    <span class="nd">@property</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="k">def</span> <span class="nf">start_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        Get the starting scan number for the Thermo Raw file.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">FirstSpectrum</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>    <span class="nd">@property</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>    <span class="k">def</span> <span class="nf">end_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="sd">        Get the ending scan number for the Thermo Raw file.</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">LastSpectrum</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>    <span class="k">def</span> <span class="nf">set_msordertype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">mstype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span><span class="p">):</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        Function to convert user passed string MS Type to Thermo MSOrderType object</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        Limited to MS1 through MS10.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        Parameters:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        -----------</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        scanFilter : Thermo.ScanFilter</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">            The scan filter object.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        mstype : str, optional</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">            The MS Type string, by default &#39;ms1&#39;</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>        <span class="n">mstype</span> <span class="o">=</span> <span class="n">mstype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="c1"># Check that a valid mstype is passed</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>            <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MS Type not valid, must be between MS1 and MS10&quot;</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>        <span class="n">msordertypedict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>            <span class="s2">&quot;MS1&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span><span class="p">,</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>            <span class="s2">&quot;MS2&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms2</span><span class="p">,</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="s2">&quot;MS3&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms3</span><span class="p">,</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="s2">&quot;MS4&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms4</span><span class="p">,</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>            <span class="s2">&quot;MS5&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms5</span><span class="p">,</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="s2">&quot;MS6&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms6</span><span class="p">,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="s2">&quot;MS7&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms7</span><span class="p">,</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="s2">&quot;MS8&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms8</span><span class="p">,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>            <span class="s2">&quot;MS9&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms9</span><span class="p">,</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="s2">&quot;MS10&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms10</span><span class="p">,</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>        <span class="p">}</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="n">scanFilter</span><span class="o">.</span><span class="n">MSOrder</span> <span class="o">=</span> <span class="n">msordertypedict</span><span class="p">[</span><span class="n">mstype</span><span class="p">]</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="k">return</span> <span class="n">scanFilter</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="k">def</span> <span class="nf">get_creation_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">        Extract the creation date stamp from the .RAW file</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">        Return formatted creation date stamp.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">CreationDate</span><span class="o">.</span><span class="n">get_Ticks</span><span class="p">()</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="n">microseconds</span><span class="o">=</span><span class="n">credate</span> <span class="o">/</span> <span class="mi">10</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="k">return</span> <span class="n">credate</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>    <span class="k">def</span> <span class="nf">remove_temp_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;if the path is from S3Path data cannot be serialized to io.ByteStream and</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">        a temporary copy is stored at the temp dir</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">        use this function only at the end of your execution scrip</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">        some LCMS class methods depend on this file</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>    <span class="k">def</span> <span class="nf">close_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        Close the Thermo Raw file.</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">Dispose</span><span class="p">()</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>    <span class="k">def</span> <span class="nf">get_polarity_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a><span class="sd">        Get the polarity mode for the given scan number.</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">        Parameters:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">        -----------</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a><span class="sd">        scan_number : int</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">            The scan number.</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">        Raises:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        -------</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">        Exception</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">            If the polarity mode is unknown.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="n">polarity_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filter_for_scan_num</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>        <span class="k">if</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>            <span class="c1"># return &#39;POSITIVE_ION_MODE&#39;</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="k">elif</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Polarity Mode Unknown, please set it manually&quot;</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>    <span class="k">def</span> <span class="nf">get_filter_for_scan_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">        Returns the closest matching run time that corresponds to scan_number for the current</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">        controller. This function is only supported for MS device controllers.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        Parameters:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        -----------</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        scan_number : int</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">            The scan number.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="k">def</span> <span class="nf">check_full_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>        <span class="c1"># scan_filter.ScanMode 0 = FULL</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="n">scan_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="k">return</span> <span class="n">scan_filter</span><span class="o">.</span><span class="n">ScanMode</span> <span class="o">==</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>    <span class="k">def</span> <span class="nf">get_all_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">        Get all scan filters.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        This function is only supported for MS device controllers.</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="n">scanrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="n">scanfiltersdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>        <span class="n">scanfilterslist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="n">scanrange</span><span class="p">:</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>            <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>            <span class="n">scanfiltersdic</span><span class="p">[</span><span class="n">scan_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_label</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>            <span class="n">scanfilterslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="n">scanfilterset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scanfilterslist</span><span class="p">))</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>        <span class="k">return</span> <span class="n">scanfiltersdic</span><span class="p">,</span> <span class="n">scanfilterset</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>    <span class="k">def</span> <span class="nf">get_scan_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">        Get full dictionary of scan header meta data, i.e. AGC status, ion injection time, etc.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">        Parameters:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        -----------</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">        scan : int</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">            The scan number.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTrailerExtraInformation</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="n">header_dic</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>    <span class="k">def</span> <span class="nf">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;trace: ThermoFisher.CommonCore.Data.Business.ChromatogramSignal&quot;&quot;&quot;</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Times</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Intensities</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Scans</span><span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>    <span class="k">def</span> <span class="nf">get_eics</span><span class="p">(</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="n">target_mzs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="n">tic_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">EIC_Data</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS&#39;, MS2&#39;)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">        start_scan: int default -1 will select the lowest available</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">        end_scan: int default -1 will select the highest available</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">        returns:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">            chroma: dict{target_mz: EIC_Data(</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">                                        Scans: [int]</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">                                            original thermo scan numbers</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">                                        Time: [floats]</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">                                            list of retention times</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">                                        TIC: [floats]</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">                                            total ion chromatogram</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">                                        Apexes: [int]</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">                                            original thermo apex scan number after peak picking</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">                                        )</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>        <span class="c1"># If peak_detection or smooth is True, raise exception</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>        <span class="k">if</span> <span class="n">peak_detection</span> <span class="ow">or</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Peak detection and smoothing are no longer implemented in this function&quot;</span><span class="p">)</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">eic_tolerance_ppm</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>        <span class="n">all_chroma_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="k">for</span> <span class="n">target_mz</span> <span class="ow">in</span> <span class="n">target_mzs</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">MassRange</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">MassRanges</span> <span class="o">=</span> <span class="p">[</span><span class="n">Range</span><span class="p">(</span><span class="n">target_mz</span><span class="p">,</span> <span class="n">target_mz</span><span class="p">)]</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>            <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>            <span class="n">all_chroma_settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chroma_settings</span><span class="p">)</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="c1"># chroma_settings2 = IChromatogramSettings(settings)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>            <span class="n">all_chroma_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">options</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="p">)</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">chroma</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Bbox</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>                <span class="c1"># ax = plt.gca()</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>                <span class="c1"># ax.clear()</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>            <span class="c1"># plt.show()</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">trace</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces</span><span class="p">):</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                <span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">scans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>                <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>                    <span class="n">eic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>                <span class="n">chroma</span><span class="p">[</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span><span class="n">scans</span><span class="o">=</span><span class="n">scans</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="o">=</span><span class="n">eic</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>                <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>            <span class="c1"># max_eic = self.get_max_eic(chroma)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>            <span class="n">max_signal</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>            <span class="k">for</span> <span class="n">eic_data</span> <span class="ow">in</span> <span class="n">chroma</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>                <span class="n">eic</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">eic</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>                <span class="n">time</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">time</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">):</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>                    <span class="n">warn</span><span class="p">(</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>                        <span class="s2">&quot;The software assumes same lenth of TIC and EIC, this does not seems to be the case and the results mass spectrum selected by the scan number might not be correct&quot;</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>                    <span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>                <span class="k">if</span> <span class="n">eic</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>                    <span class="n">centroid_eics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eic_centroid_detector</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">max_signal</span><span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>                    <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">centroid_eics</span><span class="p">]</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>                    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>                        <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>                            <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>                            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>                                <span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>                                <span class="n">eic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>                                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>                            <span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ms_type</span> <span class="o">+</span> <span class="s2">&quot; EIC&quot;</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.76</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>                <span class="c1"># ax.set_prop_cycle(color=plt.cm.gist_rainbow(np.linspace(0, 1, len(traces))))</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">}</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>                <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>                    <span class="k">if</span> <span class="n">legend</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_bbox_to_anchor</span><span class="p">()</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>                            <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">evt</span><span class="o">.</span><span class="n">button</span><span class="p">],</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>                        <span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>                        <span class="n">tr</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>                        <span class="n">legend</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">tr</span><span class="p">))</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>                        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;scroll_event&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>            <span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>                <span class="n">rt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>                <span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>            <span class="k">return</span> <span class="n">traces</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>            <span class="c1"># plot_chroma(rt, tic)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>            <span class="c1"># plt.show()</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>    <span class="k">def</span> <span class="nf">get_tic</span><span class="p">(</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="n">trace_type</span><span class="o">=</span><span class="s2">&quot;TIC&quot;</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TIC_Data</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS !d&#39;, &#39;MS2&#39;, None)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">            if you use None you get all scans.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">        peak_detection: bool</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">        smooth: bool</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">        plot: bool</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">        ax: matplotlib axis object</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="sd">        trace_type: str (&#39;TIC&#39;,&#39;BPC&#39;)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">        returns:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">            chroma: dict</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">            {</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="sd">            Scan: [int]</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">                original thermo scan numberMS</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">            Time: [floats]</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">                list of retention times</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">            TIC: [floats]</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">                total ion chromatogram</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">            Apexes: [int]</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">                original thermo apex scan number after peak picking</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">            }</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;TIC&quot;</span><span class="p">:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">TIC</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="k">elif</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">BasePeak</span><span class="p">)</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">trace_type</span><span class="si">}</span><span class="s2"> undefined&quot;</span><span class="p">)</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>        <span class="k">if</span> <span class="n">ms_type</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>            <span class="p">[</span><span class="n">chroma_settings</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>        <span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">TIC_Data</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[],</span> <span class="n">scans</span><span class="o">=</span><span class="p">[],</span> <span class="n">tic</span><span class="o">=</span><span class="p">[],</span> <span class="n">bpc</span><span class="o">=</span><span class="p">[],</span> <span class="n">apexes</span><span class="o">=</span><span class="p">[])</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>        <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>                <span class="c1"># print(trace[0].Scans[i])</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>            <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>                <span class="n">centroid_peak_indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid_detector</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>                <span class="p">]</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="n">centroid_peak_indexes</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>            <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>                    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>                    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>                    <span class="c1"># fig, ax = plt.subplots(figsize=(6, 3))</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trace_type</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>                <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                    <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>                        <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>                            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>                        <span class="p">)</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>                <span class="c1"># plt.show()</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>            <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>            <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum</span><span class="p">(</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>        <span class="n">spectrum_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span><span class="p">,</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="n">ms_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MS1&quot;</span><span class="p">,</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span> <span class="o">|</span> <span class="n">MassSpecCentroid</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">        Averages mass spectra over a scan range using Thermo&#39;s AverageScansInScanRange method</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">        or a scan list using Thermo&#39;s AverageScans method</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="sd">        spectrum_mode: str</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">            centroid or profile mass spectrum</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        auto_process: bool</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="sd">        ms_type: str</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">            String of form &#39;ms1&#39; or &#39;ms2&#39; or &#39;MS3&#39; etc. Valid up to MS10.</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">            Internal function converts to Thermo MSOrderType class.</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="k">def</span> <span class="nf">get_profile_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>            <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="p">}</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>            <span class="k">return</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>        <span class="k">def</span> <span class="nf">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>            <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>            <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>            <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>            <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="p">}</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>            <span class="n">firstScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>        <span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        <span class="c1"># force it to only look for the MSType</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_msordertype</span><span class="p">(</span><span class="n">scanFilter</span><span class="p">,</span> <span class="n">ms_type</span><span class="p">)</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScansInScanRange</span><span class="p">(</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">options</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>            <span class="p">)</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>                    <span class="p">)</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                        <span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>            <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">:</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>                    <span class="p">)</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>                        <span class="p">)</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scans must be a list intergers or a tuple if integers&quot;</span><span class="p">)</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>    <span class="k">def</span> <span class="nf">set_metadata</span><span class="p">(</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>        <span class="n">firstScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>        <span class="n">lastScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>        <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>    <span class="p">):</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">        Collect metadata to be ingested in the mass spectrum object</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">        scans_list: list[int] or false</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">        lastScanNumber: int</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">        firstScanNumber: int</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="n">default_parameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>        <span class="k">if</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scans_list</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">scans_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">)</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;analyzer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Model</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;acquisition_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_creation_time</span><span class="p">()</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;instrument_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="k">return</span> <span class="n">d_params</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="k">def</span> <span class="nf">get_instrument_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse_strings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">        This function will extract the instrument methods embedded in the raw file</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">        First it will check if there are any instrument methods, if not returning None</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        Then it will get the total number of instrument methods.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">        For each method, it will extract the plaintext string of the method and attempt to parse it into a dictionary</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">        If this fails, it will return just the string object.</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">        This has been tested on data from an Orbitrap ID-X with embedded MS and LC methods, but other instrument types may fail.</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">        Parameters:</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">        -----------</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">        parse_strings: bool</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            If True, will attempt to parse the instrument methods into a dictionary. If False, will return the raw string.</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">        Returns:</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        --------</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">        List[Dict[str, Any]] or List</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">            A list of dictionaries containing the instrument methods, or a list of strings if parsing fails.</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">HasInstrumentMethod</span><span class="p">:</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>                <span class="s2">&quot;Raw Data file does not have any instrument methods attached&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>            <span class="p">)</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>            <span class="k">def</span> <span class="nf">parse_instrument_method</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>                <span class="n">method</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>                <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>  <span class="c1"># Skip empty lines</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>                        <span class="k">continue</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                        <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Settings&quot;</span><span class="p">)</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Summary&quot;</span><span class="p">)</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Scan Event&quot;</span><span class="p">)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>                    <span class="p">):</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>                        <span class="n">current_section</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>                        <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>                        <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>                    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">):</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>                        <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>                            <span class="n">indent_level</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>                            <span class="k">if</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                                <span class="k">if</span> <span class="n">sub_section</span><span class="p">:</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>                                    <span class="p">)</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>                            <span class="k">elif</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>                                <span class="n">scan_type</span><span class="p">,</span> <span class="n">key_value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>                                    <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>                                    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>                                    <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>                                <span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>                                    <span class="n">sub_section</span><span class="p">,</span> <span class="p">{}</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>                                <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">scan_type</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>                                <span class="k">if</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>                                    <span class="p">)</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span><span class="n">scan_type</span><span class="p">][</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>                            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>                                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>                                    <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>                                <span class="p">)</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>                                <span class="n">sub_section</span> <span class="o">=</span> <span class="n">key_value</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>                        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>                <span class="k">return</span> <span class="n">method</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>            <span class="n">count_instrument_methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">InstrumentMethodsCount</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>            <span class="c1"># TODO make this code better...</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>            <span class="n">instrument_methods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count_instrument_methods</span><span class="p">):</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>                <span class="n">instrument_method_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentMethod</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>                <span class="k">if</span> <span class="n">parse_strings</span><span class="p">:</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">parse_instrument_method</span><span class="p">(</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>                            <span class="n">instrument_method_string</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>                        <span class="p">)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>                    <span class="k">except</span><span class="p">:</span>  <span class="c1"># if it fails for any reason</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>                    <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>                <span class="n">instrument_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument_method_dict</span><span class="p">)</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>            <span class="k">return</span> <span class="n">instrument_methods</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>    <span class="k">def</span> <span class="nf">get_tune_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">        This code will extract the tune method from the raw file</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">        Returns:</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">        --------</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="sd">            A dictionary containing the tune method information</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">        Raises:</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        -------</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="sd">        ValueError</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">            If no tune methods are found in the raw file</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneDataCount</span><span class="p">()</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No tune methods found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>        <span class="k">elif</span> <span class="n">tunemethodcount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>                <span class="s2">&quot;Multiple tune methods found in the raw data file, returning the 1st&quot;</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>            <span class="p">)</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneData</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>            <span class="p">):</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>                <span class="c1"># This is a section header</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>    <span class="k">def</span> <span class="nf">get_status_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retention_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">        This code will extract the status logs from the raw file</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">        Parameters:</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">        -----------</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">        retention_time: float</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">            The retention time in minutes to extract the status log data from.</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">            Will use the closest retention time found. Default 0.</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">        Returns:</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">        --------</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">            A dictionary containing the status log information</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        Raises:</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">        -------</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">        ValueError</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">            If no status logs are found in the raw file</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogEntriesCount</span><span class="p">()</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No status logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogForRetentionTime</span><span class="p">(</span><span class="n">retention_time</span><span class="p">)</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>            <span class="p">):</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>                <span class="c1"># This is a section header</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>    <span class="k">def</span> <span class="nf">get_error_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">        This code will extract the error logs from the raw file</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">        Returns:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">        --------</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">        Dict[float, str]</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">            A dictionary containing the error log information with the retention time as the key</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">        Raises:</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">        -------</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">        ValueError</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">            If no error logs are found in the raw file</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>        <span class="n">error_log_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">ErrorLogCount</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="k">if</span> <span class="n">error_log_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No error logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="n">error_logs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">error_log_count</span><span class="p">):</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>            <span class="n">error_log_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetErrorLogItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">RetentionTime</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">Message</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="c1"># Use the index `i` as the unique ID key</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>            <span class="n">error_logs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">:</span> <span class="n">rt</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">}</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="k">return</span> <span class="n">error_logs</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>    <span class="k">def</span> <span class="nf">get_sample_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        This code will extract the sample information from the raw file</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">        Returns:</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        --------</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">            A dictionary containing the sample information</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">            Note that UserText field may not be handled properly and may need further processing</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>        <span class="n">sminfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SampleInformation</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>        <span class="n">smdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Comment</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleId</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleName</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Vial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Vial</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InjectionVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InjectionVolume</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Barcode</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;BarcodeStatus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">BarcodeStatus</span><span class="p">)</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationLevel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationLevel</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;DilutionFactor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">DilutionFactor</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InstrumentMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InstrumentMethodFile</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RawFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RawFileName</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationFile</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;IstdAmount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">IstdAmount</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RowNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RowNumber</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Path</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;ProcessingMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">ProcessingMethodFile</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">SampleType</span><span class="p">)</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleWeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleWeight</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;UserText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>            <span class="s2">&quot;UserText&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">UserText</span><span class="p">]</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>        <span class="p">}</span>  <span class="c1"># [0] #This may not work - needs debugging with</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="k">return</span> <span class="n">smdict</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>    <span class="k">def</span> <span class="nf">get_instrument_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">        This code will extract the instrument data from the raw file</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        Returns:</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        --------</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">            A dictionary containing the instrument data</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="n">instrument_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="n">id_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Name</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Model</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SerialNumber</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SoftwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SoftwareVersion</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;HardwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">HardwareVersion</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;ChannelLabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>            <span class="s2">&quot;ChannelLabels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">ChannelLabels</span><span class="p">]</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="p">}</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Flags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Flags</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelY</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelX</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="k">return</span> <span class="n">id_dict</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>    <span class="k">def</span> <span class="nf">get_centroid_msms_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">):</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a><span class="sd">        .. deprecated:: 2.0</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">            This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>            <span class="s2">&quot;The `get_centroid_msms_data()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>        <span class="p">)</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="p">[</span><span class="n">scan</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">)</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>        <span class="n">centroidStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>        <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>        <span class="c1"># charge = scans_labels[5]</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>        <span class="p">}</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">=</span> <span class="s2">&quot;relative_abundance&quot;</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_min_relative_abundance</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum_by_scanlist</span><span class="p">(</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>        <span class="n">scans_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span><span class="p">:</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        Averages selected scans mass spectra using Thermo&#39;s AverageScans method</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        scans_list: list[int]</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">        auto_process: bool</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">        Returns:</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">            MassSpecProfile</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">         .. deprecated:: 2.0</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="sd">        This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>            <span class="s2">&quot;The `get_average_mass_spectrum_by_scanlist()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>        <span class="p">)</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="n">scans_list</span><span class="p">)</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>            <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>        <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="n">len_data</span> <span class="o">=</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="o">.</span><span class="n">Length</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>        <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>        <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a>        <span class="p">}</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="k">class</span> <span class="nc">ImportMassSpectraThermoMSFileReader</span><span class="p">(</span><span class="n">ThermoBaseClass</span><span class="p">,</span> <span class="n">SpectraParserInterface</span><span class="p">):</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for parsing Thermo RAW mass spectrometry data files and instatiating MassSpectraBase or LCMSBase objects</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">    Parameters</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">    ----------</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">    file_location : str or Path</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        The path to the RAW file to be parsed.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">    analyzer : str, optional</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        The type of mass analyzer used in the instrument. Default is &quot;Unknown&quot;.</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">    instrument_label : str, optional</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">        The name of the instrument used to acquire the data. Default is &quot;Unknown&quot;.</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">    sample_name : str, optional</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">        The name of the sample being analyzed. If not provided, the stem of the file_location path will be used.</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">    Attributes</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="sd">    ----------</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a><span class="sd">    file_location : Path</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">        The path to the RAW file being parsed.</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">    analyzer : str</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">        The type of mass analyzer used in the instrument.</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">    instrument_label : str</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">        The name of the instrument used to acquire the data.</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">    sample_name : str</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">        The name of the sample being analyzed.</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="sd">    Methods</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="sd">    -------</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">    * run(spectra=True).</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a><span class="sd">        Parses the RAW file and returns a dictionary of mass spectra dataframes and a scan metadata dataframe.</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">    * get_mass_spectrum_from_scan(scan_number, polarity, auto_process=True)</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">        Parses the RAW file and returns a MassSpecBase object from a single scan.</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">    * get_mass_spectra_obj().</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a><span class="sd">        Parses the RAW file and instantiates a MassSpectraBase object.</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">    * get_lcms_obj().</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">        Parses the RAW file and instantiates an LCMSBase object.</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">    * get_icr_transient_times().</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">        Return a list for transient time targets for all scans, or selected scans range</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">    Inherits from ThermoBaseClass and SpectraParserInterface</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>        <span class="n">file_location</span><span class="p">,</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>        <span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>        <span class="n">instrument_label</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>        <span class="n">sample_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>    <span class="p">):</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>            <span class="c1"># if obj is a string it defaults to create a Path obj, pass the S3Path if needed</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>            <span class="n">file_location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_location</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_location</span><span class="p">))</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">analyzer</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span> <span class="o">=</span> <span class="n">instrument_label</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>        <span class="k">if</span> <span class="n">sample_name</span><span class="p">:</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">sample_name</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">file_location</span><span class="o">.</span><span class="n">stem</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="k">pass</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>        <span class="c1"># This automatically brings in all the data</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="c1"># Get scan df info; starting with bulk ms1 and ms2 scans</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>        <span class="n">ms1_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span><span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="n">ms1_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>        <span class="p">}</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="n">ms1_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms1_scan_dict</span><span class="p">)</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>        <span class="n">ms1_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>        <span class="n">ms2_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>            <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS2&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>        <span class="p">)</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="n">ms2_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="p">}</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="n">ms2_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms2_scan_dict</span><span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>        <span class="n">ms2_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms2&quot;</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ms1_tic_df</span><span class="p">,</span> <span class="n">ms2_tic_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>        <span class="p">)</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>        <span class="c1"># get scan text</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>        <span class="n">scan_filter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_filters</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="p">)</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;scan_text&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">scan_filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>            <span class="sa">r</span><span class="s2">&quot;\[(\d+\.\d+)-\d+\.\d+\]&quot;</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        <span class="p">)</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_upper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>            <span class="sa">r</span><span class="s2">&quot;\[\d+\.\d+-(\d+\.\d+)\]&quot;</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>        <span class="p">)</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>            <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">),</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>        <span class="p">)</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+\.\d+)@&quot;</span><span class="p">)</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="c1"># Assign each scan as centroid or profile</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsCentroidScanFromScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centroid&quot;</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="p">):</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms1&quot;</span><span class="p">:</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms2&quot;</span><span class="p">:</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectra must be &#39;none&#39;, &#39;all&#39;, &#39;ms1&#39;, or &#39;ms2&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>        <span class="c1"># Result container</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>        <span class="c1"># Row count container</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>        <span class="c1"># Column name container</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>        <span class="c1"># set at float32</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>        <span class="c1"># First pass: get nrows</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>        <span class="n">N</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="p">)</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>            <span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="c1"># Second pass: parse</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>            <span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>            <span class="c1"># Get index of abun that are &gt; 0</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mz</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>            <span class="c1"># Number of rows</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>            <span class="c1"># No measurements</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>                <span class="k">continue</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>            <span class="c1"># Dimension check</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">):</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;m/z and intensity array dimension mismatch&quot;</span><span class="p">)</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>                <span class="k">continue</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>            <span class="c1"># Scan/frame info</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>            <span class="n">id_dict</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>            <span class="c1"># Columns</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>            <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>            <span class="c1"># Subarray init</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>            <span class="c1"># Populate scan/frame info</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>            <span class="c1"># Populate m/z</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">mz</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>            <span class="c1"># Populate intensity</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">abun</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>            <span class="c1"># Initialize output container</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>            <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">],</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>                <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>            <span class="c1"># Insert subarray</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="p">:</span> <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">arr</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>            <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="n">n</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>        <span class="c1"># Construct ms1 and ms2 mz dataframes</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>        <span class="c1"># rename keys in res to add &#39;ms&#39; prefix</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;ms</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        Extracts mass spectra data from a raw file.</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="sd">        Parameters</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        ----------</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">            Which mass spectra data to include in the output. Default is all.  Other options: none, ms1, ms2.</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">        scan_df : pandas.DataFrame, optional</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">            Scan dataframe.  If not provided, the scan dataframe is created from the mzML file.</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        Returns</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">        -------</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">        tuple</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">            A tuple containing two elements:</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">            - A dictionary containing mass spectra data, separated by MS level.</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">            - A pandas DataFrame containing scan information, including scan number, scan time, TIC, MS level,</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">                scan text, scan window lower and upper bounds, polarity, and precursor m/z (if applicable).</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>        <span class="c1"># Prepare scan_df</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>        <span class="k">if</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>            <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>        <span class="c1"># Prepare mass spectra data</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">)</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">,</span> <span class="n">spectrum_mode</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>    <span class="p">):</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpecBase object from a single scan number from the binary file, currently only supports profile mode.</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="sd">        Parameters</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a><span class="sd">        ----------</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a><span class="sd">        scan_number : int</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a><span class="sd">            The scan number to extract the mass spectrum from.</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a><span class="sd">        polarity : int</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="sd">            The polarity of the scan.  1 for positive mode, -1 for negative mode.</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a><span class="sd">        spectrum_mode : str</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a><span class="sd">            The type of mass spectrum to extract.  Must be &#39;profile&#39; or &#39;centroid&#39;.</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="sd">        auto_process : bool, optional</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a><span class="sd">            If True, perform peak picking and noise threshold calculation after creating the mass spectrum object. Default is True.</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="sd">        Returns</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="sd">        -------</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">        MassSpecProfile | MassSpecCentroid</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a><span class="sd">            The MassSpecProfile or MassSpecCentroid object containing the parsed mass spectrum.</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>        <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>                <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>            <span class="p">)</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>            <span class="p">}</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>            <span class="p">)</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>            <span class="p">)</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>        <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>            <span class="n">centroid_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>            <span class="k">if</span> <span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>                <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>                <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>                <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>                <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>                <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>                <span class="p">}</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># For CID MS2, the centroid data are stored in the profile data location, they do not have any associated rp or baseline data, but they should be treated as centroid data</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>                <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>                    <span class="n">scan_number</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>                <span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>                <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>                    <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>                <span class="p">)</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>                <span class="p">}</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">,</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>            <span class="p">)</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>            <span class="p">)</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>        <span class="k">return</span> <span class="n">mass_spectrum_obj</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpectraBase object from the binary data file file.</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">        Returns</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a><span class="sd">        -------</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">        MassSpectraBase</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">            The MassSpectra object containing the parsed mass spectra.  The object is instatiated with the mzML file, analyzer, instrument, sample name, and scan dataframe.</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>        <span class="n">mass_spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="p">)</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>        <span class="n">mass_spectra_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="k">return</span> <span class="n">mass_spectra_obj</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiates a LCMSBase object from the mzML file.</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">        Parameters</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="sd">        ----------</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">            Which mass spectra data to include in the output. Default is &quot;all&quot;.  Other options: &quot;none&quot;, &quot;ms1&quot;, &quot;ms2&quot;.</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a><span class="sd">        Returns</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a><span class="sd">        -------</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a><span class="sd">        LCMSBase</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a><span class="sd">            LCMS object containing mass spectra data. The object is instatiated with the file location, analyzer, instrument, sample name, scan info, mz dataframe (as specifified), polarity, as well as the attributes holding the scans, retention times, and tics.</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>  <span class="c1"># first run it to just get scan info</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>        <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>            <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="p">)</span>  <span class="c1"># second run to parse data</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>        <span class="p">)</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>                <span class="n">key_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">intensity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>                    <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>                <span class="p">)</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>                <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_ms_unprocessed</span><span class="p">[</span><span class="n">key_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>        <span class="c1"># Check if polarity is mixed</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mixed polarities detected in scan data&quot;</span><span class="p">)</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>    <span class="k">def</span> <span class="nf">get_icr_transient_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list for transient time targets for all scans, or selected scans range</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">        Notes</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="sd">        --------</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">        Resolving Power and Transient time targets based on 7T FT-ICR MS system</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>        <span class="n">res_trans_time</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>            <span class="s2">&quot;50&quot;</span><span class="p">:</span> <span class="mf">0.384</span><span class="p">,</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>            <span class="s2">&quot;100000&quot;</span><span class="p">:</span> <span class="mf">0.768</span><span class="p">,</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>            <span class="s2">&quot;200000&quot;</span><span class="p">:</span> <span class="mf">1.536</span><span class="p">,</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>            <span class="s2">&quot;400000&quot;</span><span class="p">:</span> <span class="mf">3.072</span><span class="p">,</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>            <span class="s2">&quot;750000&quot;</span><span class="p">:</span> <span class="mf">6.144</span><span class="p">,</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>            <span class="s2">&quot;1000000&quot;</span><span class="p">:</span> <span class="mf">12.288</span><span class="p">,</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>        <span class="p">}</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>        <span class="n">firstScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>        <span class="n">lastScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>        <span class="n">transient_time_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">):</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>            <span class="n">scan_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_header</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>            <span class="n">rp_target</span> <span class="o">=</span> <span class="n">scan_header</span><span class="p">[</span><span class="s2">&quot;FT Resolution:&quot;</span><span class="p">]</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>            <span class="n">transient_time</span> <span class="o">=</span> <span class="n">res_trans_time</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rp_target</span><span class="p">)</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>            <span class="n">transient_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transient_time</span><span class="p">)</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>            <span class="c1"># print(transient_time, rp_target)</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>        <span class="k">return</span> <span class="n">transient_time_list</span>
</span></pre></div>


            </section>
                <section id="spec">
                    <div class="attr variable">
            <span class="name">spec</span>        =
<input id="spec-view-value" class="view-value-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
            <label class="view-value-button pdoc-button" for="spec-view-value"></label><span class="default_value">ModuleSpec(name=&#39;corems&#39;, loader=&lt;_frozen_importlib_external.SourceFileLoader object&gt;, origin=&#39;/Users/heal742/LOCAL/corems_dev/corems/corems/__init__.py&#39;, submodule_search_locations=[&#39;/Users/heal742/LOCAL/corems_dev/corems/corems&#39;])</span>

        
    </div>
    <a class="headerlink" href="#spec"></a>
    
    

                </section>
                <section id="ThermoBaseClass">
                            <input id="ThermoBaseClass-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ThermoBaseClass</span>:

                <label class="view-source-button" for="ThermoBaseClass-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass-60"><a href="#ThermoBaseClass-60"><span class="linenos">  60</span></a><span class="k">class</span> <span class="nc">ThermoBaseClass</span><span class="p">:</span>
</span><span id="ThermoBaseClass-61"><a href="#ThermoBaseClass-61"><span class="linenos">  61</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for parsing Thermo Raw files and extracting information from them.</span>
</span><span id="ThermoBaseClass-62"><a href="#ThermoBaseClass-62"><span class="linenos">  62</span></a>
</span><span id="ThermoBaseClass-63"><a href="#ThermoBaseClass-63"><span class="linenos">  63</span></a><span class="sd">    Parameters:</span>
</span><span id="ThermoBaseClass-64"><a href="#ThermoBaseClass-64"><span class="linenos">  64</span></a><span class="sd">    -----------</span>
</span><span id="ThermoBaseClass-65"><a href="#ThermoBaseClass-65"><span class="linenos">  65</span></a><span class="sd">    file_location : str or pathlib.Path or s3path.S3Path</span>
</span><span id="ThermoBaseClass-66"><a href="#ThermoBaseClass-66"><span class="linenos">  66</span></a><span class="sd">        Thermo Raw file path or S3 path.</span>
</span><span id="ThermoBaseClass-67"><a href="#ThermoBaseClass-67"><span class="linenos">  67</span></a>
</span><span id="ThermoBaseClass-68"><a href="#ThermoBaseClass-68"><span class="linenos">  68</span></a><span class="sd">    Attributes:</span>
</span><span id="ThermoBaseClass-69"><a href="#ThermoBaseClass-69"><span class="linenos">  69</span></a><span class="sd">    -----------</span>
</span><span id="ThermoBaseClass-70"><a href="#ThermoBaseClass-70"><span class="linenos">  70</span></a><span class="sd">    file_path : str or pathlib.Path or s3path.S3Path</span>
</span><span id="ThermoBaseClass-71"><a href="#ThermoBaseClass-71"><span class="linenos">  71</span></a><span class="sd">        The file path of the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-72"><a href="#ThermoBaseClass-72"><span class="linenos">  72</span></a><span class="sd">    parameters : LCMSParameters</span>
</span><span id="ThermoBaseClass-73"><a href="#ThermoBaseClass-73"><span class="linenos">  73</span></a><span class="sd">        The LCMS parameters for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-74"><a href="#ThermoBaseClass-74"><span class="linenos">  74</span></a><span class="sd">    chromatogram_settings : LiquidChromatographSetting</span>
</span><span id="ThermoBaseClass-75"><a href="#ThermoBaseClass-75"><span class="linenos">  75</span></a><span class="sd">        The chromatogram settings for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-76"><a href="#ThermoBaseClass-76"><span class="linenos">  76</span></a><span class="sd">    scans : list or tuple</span>
</span><span id="ThermoBaseClass-77"><a href="#ThermoBaseClass-77"><span class="linenos">  77</span></a><span class="sd">        The selected scans for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-78"><a href="#ThermoBaseClass-78"><span class="linenos">  78</span></a><span class="sd">    start_scan : int</span>
</span><span id="ThermoBaseClass-79"><a href="#ThermoBaseClass-79"><span class="linenos">  79</span></a><span class="sd">        The starting scan number for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-80"><a href="#ThermoBaseClass-80"><span class="linenos">  80</span></a><span class="sd">    end_scan : int</span>
</span><span id="ThermoBaseClass-81"><a href="#ThermoBaseClass-81"><span class="linenos">  81</span></a><span class="sd">        The ending scan number for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-82"><a href="#ThermoBaseClass-82"><span class="linenos">  82</span></a>
</span><span id="ThermoBaseClass-83"><a href="#ThermoBaseClass-83"><span class="linenos">  83</span></a><span class="sd">    Methods:</span>
</span><span id="ThermoBaseClass-84"><a href="#ThermoBaseClass-84"><span class="linenos">  84</span></a><span class="sd">    --------</span>
</span><span id="ThermoBaseClass-85"><a href="#ThermoBaseClass-85"><span class="linenos">  85</span></a><span class="sd">    * set_msordertype(scanFilter, mstype: str = &#39;ms1&#39;) -&gt; scanFilter</span>
</span><span id="ThermoBaseClass-86"><a href="#ThermoBaseClass-86"><span class="linenos">  86</span></a><span class="sd">        Convert the user-passed MS Type string to a Thermo MSOrderType object.</span>
</span><span id="ThermoBaseClass-87"><a href="#ThermoBaseClass-87"><span class="linenos">  87</span></a><span class="sd">    * get_creation_time() -&gt; datetime.datetime</span>
</span><span id="ThermoBaseClass-88"><a href="#ThermoBaseClass-88"><span class="linenos">  88</span></a><span class="sd">        Extract the creation date stamp from the .RAW file and return it as a formatted datetime object.</span>
</span><span id="ThermoBaseClass-89"><a href="#ThermoBaseClass-89"><span class="linenos">  89</span></a><span class="sd">    * remove_temp_file()</span>
</span><span id="ThermoBaseClass-90"><a href="#ThermoBaseClass-90"><span class="linenos">  90</span></a><span class="sd">        Remove the temporary file if the path is from S3Path.</span>
</span><span id="ThermoBaseClass-91"><a href="#ThermoBaseClass-91"><span class="linenos">  91</span></a><span class="sd">    * get_polarity_mode(scan_number: int) -&gt; int</span>
</span><span id="ThermoBaseClass-92"><a href="#ThermoBaseClass-92"><span class="linenos">  92</span></a><span class="sd">        Get the polarity mode for the given scan number.</span>
</span><span id="ThermoBaseClass-93"><a href="#ThermoBaseClass-93"><span class="linenos">  93</span></a><span class="sd">    * get_filter_for_scan_num(scan_number: int) -&gt; List[str]</span>
</span><span id="ThermoBaseClass-94"><a href="#ThermoBaseClass-94"><span class="linenos">  94</span></a><span class="sd">        Get the filter for the given scan number.</span>
</span><span id="ThermoBaseClass-95"><a href="#ThermoBaseClass-95"><span class="linenos">  95</span></a><span class="sd">    * check_full_scan(scan_number: int) -&gt; bool</span>
</span><span id="ThermoBaseClass-96"><a href="#ThermoBaseClass-96"><span class="linenos">  96</span></a><span class="sd">        Check if the given scan number is a full scan.</span>
</span><span id="ThermoBaseClass-97"><a href="#ThermoBaseClass-97"><span class="linenos">  97</span></a><span class="sd">    * get_all_filters() -&gt; Tuple[Dict[int, str], List[str]]</span>
</span><span id="ThermoBaseClass-98"><a href="#ThermoBaseClass-98"><span class="linenos">  98</span></a><span class="sd">        Get all scan filters for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-99"><a href="#ThermoBaseClass-99"><span class="linenos">  99</span></a><span class="sd">    * get_scan_header(scan: int) -&gt; Dict[str, Any]</span>
</span><span id="ThermoBaseClass-100"><a href="#ThermoBaseClass-100"><span class="linenos"> 100</span></a><span class="sd">        Get the full dictionary of scan header metadata for the given scan number.</span>
</span><span id="ThermoBaseClass-101"><a href="#ThermoBaseClass-101"><span class="linenos"> 101</span></a><span class="sd">    * get_rt_time_from_trace(trace) -&gt; Tuple[List[float], List[float], List[int]]</span>
</span><span id="ThermoBaseClass-102"><a href="#ThermoBaseClass-102"><span class="linenos"> 102</span></a><span class="sd">        Get the retention time, intensity, and scan number from the given trace.</span>
</span><span id="ThermoBaseClass-103"><a href="#ThermoBaseClass-103"><span class="linenos"> 103</span></a><span class="sd">    * get_eics(target_mzs: List[float], tic_data: Dict[str, Any], ms_type: str = &#39;MS !d&#39;,</span>
</span><span id="ThermoBaseClass-104"><a href="#ThermoBaseClass-104"><span class="linenos"> 104</span></a><span class="sd">             peak_detection: bool = True, smooth: bool = True, plot: bool = False,</span>
</span><span id="ThermoBaseClass-105"><a href="#ThermoBaseClass-105"><span class="linenos"> 105</span></a><span class="sd">             ax: Optional[matplotlib.axes.Axes] = None, legend: bool = False) -&gt; Tuple[Dict[float, EIC_Data], matplotlib.axes.Axes]</span>
</span><span id="ThermoBaseClass-106"><a href="#ThermoBaseClass-106"><span class="linenos"> 106</span></a><span class="sd">        Get the extracted ion chromatograms (EICs) for the target m/z values.</span>
</span><span id="ThermoBaseClass-107"><a href="#ThermoBaseClass-107"><span class="linenos"> 107</span></a>
</span><span id="ThermoBaseClass-108"><a href="#ThermoBaseClass-108"><span class="linenos"> 108</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-109"><a href="#ThermoBaseClass-109"><span class="linenos"> 109</span></a>
</span><span id="ThermoBaseClass-110"><a href="#ThermoBaseClass-110"><span class="linenos"> 110</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">):</span>
</span><span id="ThermoBaseClass-111"><a href="#ThermoBaseClass-111"><span class="linenos"> 111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;file_location: srt pathlib.Path or s3path.S3Path</span>
</span><span id="ThermoBaseClass-112"><a href="#ThermoBaseClass-112"><span class="linenos"> 112</span></a><span class="sd">        Thermo Raw file path</span>
</span><span id="ThermoBaseClass-113"><a href="#ThermoBaseClass-113"><span class="linenos"> 113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-114"><a href="#ThermoBaseClass-114"><span class="linenos"> 114</span></a>        <span class="c1"># Thread.__init__(self)</span>
</span><span id="ThermoBaseClass-115"><a href="#ThermoBaseClass-115"><span class="linenos"> 115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ThermoBaseClass-116"><a href="#ThermoBaseClass-116"><span class="linenos"> 116</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ThermoBaseClass-117"><a href="#ThermoBaseClass-117"><span class="linenos"> 117</span></a>
</span><span id="ThermoBaseClass-118"><a href="#ThermoBaseClass-118"><span class="linenos"> 118</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="n">S3Path</span><span class="p">):</span>
</span><span id="ThermoBaseClass-119"><a href="#ThermoBaseClass-119"><span class="linenos"> 119</span></a>            <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;tmp/&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-120"><a href="#ThermoBaseClass-120"><span class="linenos"> 120</span></a>            <span class="n">temp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ThermoBaseClass-121"><a href="#ThermoBaseClass-121"><span class="linenos"> 121</span></a>
</span><span id="ThermoBaseClass-122"><a href="#ThermoBaseClass-122"><span class="linenos"> 122</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="n">file_location</span><span class="o">.</span><span class="n">name</span>
</span><span id="ThermoBaseClass-123"><a href="#ThermoBaseClass-123"><span class="linenos"> 123</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
</span><span id="ThermoBaseClass-124"><a href="#ThermoBaseClass-124"><span class="linenos"> 124</span></a>                <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_location</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">())</span>
</span><span id="ThermoBaseClass-125"><a href="#ThermoBaseClass-125"><span class="linenos"> 125</span></a>
</span><span id="ThermoBaseClass-126"><a href="#ThermoBaseClass-126"><span class="linenos"> 126</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-127"><a href="#ThermoBaseClass-127"><span class="linenos"> 127</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ThermoBaseClass-128"><a href="#ThermoBaseClass-128"><span class="linenos"> 128</span></a>
</span><span id="ThermoBaseClass-129"><a href="#ThermoBaseClass-129"><span class="linenos"> 129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span> <span class="o">=</span> <span class="n">RawFileReaderAdapter</span><span class="o">.</span><span class="n">FileFactory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="ThermoBaseClass-130"><a href="#ThermoBaseClass-130"><span class="linenos"> 130</span></a>
</span><span id="ThermoBaseClass-131"><a href="#ThermoBaseClass-131"><span class="linenos"> 131</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsOpen</span><span class="p">:</span>
</span><span id="ThermoBaseClass-132"><a href="#ThermoBaseClass-132"><span class="linenos"> 132</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="ThermoBaseClass-133"><a href="#ThermoBaseClass-133"><span class="linenos"> 133</span></a>                <span class="s2">&quot;Unable to access the RAW file using the RawFileReader class!&quot;</span>
</span><span id="ThermoBaseClass-134"><a href="#ThermoBaseClass-134"><span class="linenos"> 134</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass-135"><a href="#ThermoBaseClass-135"><span class="linenos"> 135</span></a>
</span><span id="ThermoBaseClass-136"><a href="#ThermoBaseClass-136"><span class="linenos"> 136</span></a>        <span class="c1"># Check for any errors in the RAW file</span>
</span><span id="ThermoBaseClass-137"><a href="#ThermoBaseClass-137"><span class="linenos"> 137</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsError</span><span class="p">:</span>
</span><span id="ThermoBaseClass-138"><a href="#ThermoBaseClass-138"><span class="linenos"> 138</span></a>            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
</span><span id="ThermoBaseClass-139"><a href="#ThermoBaseClass-139"><span class="linenos"> 139</span></a>                <span class="s2">&quot;Error opening (</span><span class="si">{}</span><span class="s2">) - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">FileError</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
</span><span id="ThermoBaseClass-140"><a href="#ThermoBaseClass-140"><span class="linenos"> 140</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass-141"><a href="#ThermoBaseClass-141"><span class="linenos"> 141</span></a>
</span><span id="ThermoBaseClass-142"><a href="#ThermoBaseClass-142"><span class="linenos"> 142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SelectInstrument</span><span class="p">(</span><span class="n">Device</span><span class="o">.</span><span class="n">MS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-143"><a href="#ThermoBaseClass-143"><span class="linenos"> 143</span></a>
</span><span id="ThermoBaseClass-144"><a href="#ThermoBaseClass-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ThermoBaseClass-145"><a href="#ThermoBaseClass-145"><span class="linenos"> 145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iFileHeader</span> <span class="o">=</span> <span class="n">FileHeaderReaderFactory</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="ThermoBaseClass-146"><a href="#ThermoBaseClass-146"><span class="linenos"> 146</span></a>
</span><span id="ThermoBaseClass-147"><a href="#ThermoBaseClass-147"><span class="linenos"> 147</span></a>        <span class="c1"># removing tmp file</span>
</span><span id="ThermoBaseClass-148"><a href="#ThermoBaseClass-148"><span class="linenos"> 148</span></a>
</span><span id="ThermoBaseClass-149"><a href="#ThermoBaseClass-149"><span class="linenos"> 149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span><span id="ThermoBaseClass-150"><a href="#ThermoBaseClass-150"><span class="linenos"> 150</span></a>
</span><span id="ThermoBaseClass-151"><a href="#ThermoBaseClass-151"><span class="linenos"> 151</span></a>    <span class="k">def</span> <span class="nf">_init_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass-152"><a href="#ThermoBaseClass-152"><span class="linenos"> 152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-153"><a href="#ThermoBaseClass-153"><span class="linenos"> 153</span></a><span class="sd">        Initialize the LCMSParameters object.</span>
</span><span id="ThermoBaseClass-154"><a href="#ThermoBaseClass-154"><span class="linenos"> 154</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-155"><a href="#ThermoBaseClass-155"><span class="linenos"> 155</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">LCMSParameters</span><span class="p">()</span>
</span><span id="ThermoBaseClass-156"><a href="#ThermoBaseClass-156"><span class="linenos"> 156</span></a>
</span><span id="ThermoBaseClass-157"><a href="#ThermoBaseClass-157"><span class="linenos"> 157</span></a>    <span class="nd">@property</span>
</span><span id="ThermoBaseClass-158"><a href="#ThermoBaseClass-158"><span class="linenos"> 158</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LCMSParameters</span><span class="p">:</span>
</span><span id="ThermoBaseClass-159"><a href="#ThermoBaseClass-159"><span class="linenos"> 159</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-160"><a href="#ThermoBaseClass-160"><span class="linenos"> 160</span></a><span class="sd">        Get or set the LCMSParameters object.</span>
</span><span id="ThermoBaseClass-161"><a href="#ThermoBaseClass-161"><span class="linenos"> 161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-162"><a href="#ThermoBaseClass-162"><span class="linenos"> 162</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>
</span><span id="ThermoBaseClass-163"><a href="#ThermoBaseClass-163"><span class="linenos"> 163</span></a>
</span><span id="ThermoBaseClass-164"><a href="#ThermoBaseClass-164"><span class="linenos"> 164</span></a>    <span class="nd">@parameters</span><span class="o">.</span><span class="n">setter</span>
</span><span id="ThermoBaseClass-165"><a href="#ThermoBaseClass-165"><span class="linenos"> 165</span></a>    <span class="k">def</span> <span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_LCMSParameters</span><span class="p">:</span> <span class="n">LCMSParameters</span><span class="p">):</span>
</span><span id="ThermoBaseClass-166"><a href="#ThermoBaseClass-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">instance_LCMSParameters</span>
</span><span id="ThermoBaseClass-167"><a href="#ThermoBaseClass-167"><span class="linenos"> 167</span></a>
</span><span id="ThermoBaseClass-168"><a href="#ThermoBaseClass-168"><span class="linenos"> 168</span></a>    <span class="nd">@property</span>
</span><span id="ThermoBaseClass-169"><a href="#ThermoBaseClass-169"><span class="linenos"> 169</span></a>    <span class="k">def</span> <span class="nf">chromatogram_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LiquidChromatographSetting</span><span class="p">:</span>
</span><span id="ThermoBaseClass-170"><a href="#ThermoBaseClass-170"><span class="linenos"> 170</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-171"><a href="#ThermoBaseClass-171"><span class="linenos"> 171</span></a><span class="sd">        Get or set the LiquidChromatographSetting object.</span>
</span><span id="ThermoBaseClass-172"><a href="#ThermoBaseClass-172"><span class="linenos"> 172</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-173"><a href="#ThermoBaseClass-173"><span class="linenos"> 173</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">lc_ms</span>
</span><span id="ThermoBaseClass-174"><a href="#ThermoBaseClass-174"><span class="linenos"> 174</span></a>
</span><span id="ThermoBaseClass-175"><a href="#ThermoBaseClass-175"><span class="linenos"> 175</span></a>    <span class="nd">@chromatogram_settings</span><span class="o">.</span><span class="n">setter</span>
</span><span id="ThermoBaseClass-176"><a href="#ThermoBaseClass-176"><span class="linenos"> 176</span></a>    <span class="k">def</span> <span class="nf">chromatogram_settings</span><span class="p">(</span>
</span><span id="ThermoBaseClass-177"><a href="#ThermoBaseClass-177"><span class="linenos"> 177</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">instance_LiquidChromatographSetting</span><span class="p">:</span> <span class="n">LiquidChromatographSetting</span>
</span><span id="ThermoBaseClass-178"><a href="#ThermoBaseClass-178"><span class="linenos"> 178</span></a>    <span class="p">):</span>
</span><span id="ThermoBaseClass-179"><a href="#ThermoBaseClass-179"><span class="linenos"> 179</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">lc_ms</span> <span class="o">=</span> <span class="n">instance_LiquidChromatographSetting</span>
</span><span id="ThermoBaseClass-180"><a href="#ThermoBaseClass-180"><span class="linenos"> 180</span></a>
</span><span id="ThermoBaseClass-181"><a href="#ThermoBaseClass-181"><span class="linenos"> 181</span></a>    <span class="nd">@property</span>
</span><span id="ThermoBaseClass-182"><a href="#ThermoBaseClass-182"><span class="linenos"> 182</span></a>    <span class="k">def</span> <span class="nf">scans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">:</span>
</span><span id="ThermoBaseClass-183"><a href="#ThermoBaseClass-183"><span class="linenos"> 183</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;scans : list or tuple</span>
</span><span id="ThermoBaseClass-184"><a href="#ThermoBaseClass-184"><span class="linenos"> 184</span></a><span class="sd">        If list uses Thermo AverageScansInScanRange for selected scans, ortherwise uses Thermo AverageScans for a scan range</span>
</span><span id="ThermoBaseClass-185"><a href="#ThermoBaseClass-185"><span class="linenos"> 185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-186"><a href="#ThermoBaseClass-186"><span class="linenos"> 186</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">scans</span>
</span><span id="ThermoBaseClass-187"><a href="#ThermoBaseClass-187"><span class="linenos"> 187</span></a>
</span><span id="ThermoBaseClass-188"><a href="#ThermoBaseClass-188"><span class="linenos"> 188</span></a>    <span class="nd">@property</span>
</span><span id="ThermoBaseClass-189"><a href="#ThermoBaseClass-189"><span class="linenos"> 189</span></a>    <span class="k">def</span> <span class="nf">start_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ThermoBaseClass-190"><a href="#ThermoBaseClass-190"><span class="linenos"> 190</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-191"><a href="#ThermoBaseClass-191"><span class="linenos"> 191</span></a><span class="sd">        Get the starting scan number for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-192"><a href="#ThermoBaseClass-192"><span class="linenos"> 192</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-193"><a href="#ThermoBaseClass-193"><span class="linenos"> 193</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="ThermoBaseClass-194"><a href="#ThermoBaseClass-194"><span class="linenos"> 194</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">FirstSpectrum</span>
</span><span id="ThermoBaseClass-195"><a href="#ThermoBaseClass-195"><span class="linenos"> 195</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-196"><a href="#ThermoBaseClass-196"><span class="linenos"> 196</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ThermoBaseClass-197"><a href="#ThermoBaseClass-197"><span class="linenos"> 197</span></a>
</span><span id="ThermoBaseClass-198"><a href="#ThermoBaseClass-198"><span class="linenos"> 198</span></a>    <span class="nd">@property</span>
</span><span id="ThermoBaseClass-199"><a href="#ThermoBaseClass-199"><span class="linenos"> 199</span></a>    <span class="k">def</span> <span class="nf">end_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ThermoBaseClass-200"><a href="#ThermoBaseClass-200"><span class="linenos"> 200</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-201"><a href="#ThermoBaseClass-201"><span class="linenos"> 201</span></a><span class="sd">        Get the ending scan number for the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-202"><a href="#ThermoBaseClass-202"><span class="linenos"> 202</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-203"><a href="#ThermoBaseClass-203"><span class="linenos"> 203</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
</span><span id="ThermoBaseClass-204"><a href="#ThermoBaseClass-204"><span class="linenos"> 204</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">LastSpectrum</span>
</span><span id="ThermoBaseClass-205"><a href="#ThermoBaseClass-205"><span class="linenos"> 205</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-206"><a href="#ThermoBaseClass-206"><span class="linenos"> 206</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass-207"><a href="#ThermoBaseClass-207"><span class="linenos"> 207</span></a>
</span><span id="ThermoBaseClass-208"><a href="#ThermoBaseClass-208"><span class="linenos"> 208</span></a>    <span class="k">def</span> <span class="nf">set_msordertype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">mstype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span><span class="p">):</span>
</span><span id="ThermoBaseClass-209"><a href="#ThermoBaseClass-209"><span class="linenos"> 209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-210"><a href="#ThermoBaseClass-210"><span class="linenos"> 210</span></a><span class="sd">        Function to convert user passed string MS Type to Thermo MSOrderType object</span>
</span><span id="ThermoBaseClass-211"><a href="#ThermoBaseClass-211"><span class="linenos"> 211</span></a><span class="sd">        Limited to MS1 through MS10.</span>
</span><span id="ThermoBaseClass-212"><a href="#ThermoBaseClass-212"><span class="linenos"> 212</span></a>
</span><span id="ThermoBaseClass-213"><a href="#ThermoBaseClass-213"><span class="linenos"> 213</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-214"><a href="#ThermoBaseClass-214"><span class="linenos"> 214</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-215"><a href="#ThermoBaseClass-215"><span class="linenos"> 215</span></a><span class="sd">        scanFilter : Thermo.ScanFilter</span>
</span><span id="ThermoBaseClass-216"><a href="#ThermoBaseClass-216"><span class="linenos"> 216</span></a><span class="sd">            The scan filter object.</span>
</span><span id="ThermoBaseClass-217"><a href="#ThermoBaseClass-217"><span class="linenos"> 217</span></a><span class="sd">        mstype : str, optional</span>
</span><span id="ThermoBaseClass-218"><a href="#ThermoBaseClass-218"><span class="linenos"> 218</span></a><span class="sd">            The MS Type string, by default &#39;ms1&#39;</span>
</span><span id="ThermoBaseClass-219"><a href="#ThermoBaseClass-219"><span class="linenos"> 219</span></a>
</span><span id="ThermoBaseClass-220"><a href="#ThermoBaseClass-220"><span class="linenos"> 220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-221"><a href="#ThermoBaseClass-221"><span class="linenos"> 221</span></a>        <span class="n">mstype</span> <span class="o">=</span> <span class="n">mstype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="ThermoBaseClass-222"><a href="#ThermoBaseClass-222"><span class="linenos"> 222</span></a>        <span class="c1"># Check that a valid mstype is passed</span>
</span><span id="ThermoBaseClass-223"><a href="#ThermoBaseClass-223"><span class="linenos"> 223</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="ThermoBaseClass-224"><a href="#ThermoBaseClass-224"><span class="linenos"> 224</span></a>            <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MS Type not valid, must be between MS1 and MS10&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-225"><a href="#ThermoBaseClass-225"><span class="linenos"> 225</span></a>
</span><span id="ThermoBaseClass-226"><a href="#ThermoBaseClass-226"><span class="linenos"> 226</span></a>        <span class="n">msordertypedict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-227"><a href="#ThermoBaseClass-227"><span class="linenos"> 227</span></a>            <span class="s2">&quot;MS1&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span><span class="p">,</span>
</span><span id="ThermoBaseClass-228"><a href="#ThermoBaseClass-228"><span class="linenos"> 228</span></a>            <span class="s2">&quot;MS2&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms2</span><span class="p">,</span>
</span><span id="ThermoBaseClass-229"><a href="#ThermoBaseClass-229"><span class="linenos"> 229</span></a>            <span class="s2">&quot;MS3&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms3</span><span class="p">,</span>
</span><span id="ThermoBaseClass-230"><a href="#ThermoBaseClass-230"><span class="linenos"> 230</span></a>            <span class="s2">&quot;MS4&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms4</span><span class="p">,</span>
</span><span id="ThermoBaseClass-231"><a href="#ThermoBaseClass-231"><span class="linenos"> 231</span></a>            <span class="s2">&quot;MS5&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms5</span><span class="p">,</span>
</span><span id="ThermoBaseClass-232"><a href="#ThermoBaseClass-232"><span class="linenos"> 232</span></a>            <span class="s2">&quot;MS6&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms6</span><span class="p">,</span>
</span><span id="ThermoBaseClass-233"><a href="#ThermoBaseClass-233"><span class="linenos"> 233</span></a>            <span class="s2">&quot;MS7&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms7</span><span class="p">,</span>
</span><span id="ThermoBaseClass-234"><a href="#ThermoBaseClass-234"><span class="linenos"> 234</span></a>            <span class="s2">&quot;MS8&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms8</span><span class="p">,</span>
</span><span id="ThermoBaseClass-235"><a href="#ThermoBaseClass-235"><span class="linenos"> 235</span></a>            <span class="s2">&quot;MS9&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms9</span><span class="p">,</span>
</span><span id="ThermoBaseClass-236"><a href="#ThermoBaseClass-236"><span class="linenos"> 236</span></a>            <span class="s2">&quot;MS10&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms10</span><span class="p">,</span>
</span><span id="ThermoBaseClass-237"><a href="#ThermoBaseClass-237"><span class="linenos"> 237</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass-238"><a href="#ThermoBaseClass-238"><span class="linenos"> 238</span></a>        <span class="n">scanFilter</span><span class="o">.</span><span class="n">MSOrder</span> <span class="o">=</span> <span class="n">msordertypedict</span><span class="p">[</span><span class="n">mstype</span><span class="p">]</span>
</span><span id="ThermoBaseClass-239"><a href="#ThermoBaseClass-239"><span class="linenos"> 239</span></a>        <span class="k">return</span> <span class="n">scanFilter</span>
</span><span id="ThermoBaseClass-240"><a href="#ThermoBaseClass-240"><span class="linenos"> 240</span></a>
</span><span id="ThermoBaseClass-241"><a href="#ThermoBaseClass-241"><span class="linenos"> 241</span></a>    <span class="k">def</span> <span class="nf">get_creation_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
</span><span id="ThermoBaseClass-242"><a href="#ThermoBaseClass-242"><span class="linenos"> 242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-243"><a href="#ThermoBaseClass-243"><span class="linenos"> 243</span></a><span class="sd">        Extract the creation date stamp from the .RAW file</span>
</span><span id="ThermoBaseClass-244"><a href="#ThermoBaseClass-244"><span class="linenos"> 244</span></a><span class="sd">        Return formatted creation date stamp.</span>
</span><span id="ThermoBaseClass-245"><a href="#ThermoBaseClass-245"><span class="linenos"> 245</span></a>
</span><span id="ThermoBaseClass-246"><a href="#ThermoBaseClass-246"><span class="linenos"> 246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-247"><a href="#ThermoBaseClass-247"><span class="linenos"> 247</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">CreationDate</span><span class="o">.</span><span class="n">get_Ticks</span><span class="p">()</span>
</span><span id="ThermoBaseClass-248"><a href="#ThermoBaseClass-248"><span class="linenos"> 248</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
</span><span id="ThermoBaseClass-249"><a href="#ThermoBaseClass-249"><span class="linenos"> 249</span></a>            <span class="n">microseconds</span><span class="o">=</span><span class="n">credate</span> <span class="o">/</span> <span class="mi">10</span>
</span><span id="ThermoBaseClass-250"><a href="#ThermoBaseClass-250"><span class="linenos"> 250</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-251"><a href="#ThermoBaseClass-251"><span class="linenos"> 251</span></a>        <span class="k">return</span> <span class="n">credate</span>
</span><span id="ThermoBaseClass-252"><a href="#ThermoBaseClass-252"><span class="linenos"> 252</span></a>
</span><span id="ThermoBaseClass-253"><a href="#ThermoBaseClass-253"><span class="linenos"> 253</span></a>    <span class="k">def</span> <span class="nf">remove_temp_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ThermoBaseClass-254"><a href="#ThermoBaseClass-254"><span class="linenos"> 254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;if the path is from S3Path data cannot be serialized to io.ByteStream and</span>
</span><span id="ThermoBaseClass-255"><a href="#ThermoBaseClass-255"><span class="linenos"> 255</span></a><span class="sd">        a temporary copy is stored at the temp dir</span>
</span><span id="ThermoBaseClass-256"><a href="#ThermoBaseClass-256"><span class="linenos"> 256</span></a><span class="sd">        use this function only at the end of your execution scrip</span>
</span><span id="ThermoBaseClass-257"><a href="#ThermoBaseClass-257"><span class="linenos"> 257</span></a><span class="sd">        some LCMS class methods depend on this file</span>
</span><span id="ThermoBaseClass-258"><a href="#ThermoBaseClass-258"><span class="linenos"> 258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-259"><a href="#ThermoBaseClass-259"><span class="linenos"> 259</span></a>
</span><span id="ThermoBaseClass-260"><a href="#ThermoBaseClass-260"><span class="linenos"> 260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="ThermoBaseClass-261"><a href="#ThermoBaseClass-261"><span class="linenos"> 261</span></a>
</span><span id="ThermoBaseClass-262"><a href="#ThermoBaseClass-262"><span class="linenos"> 262</span></a>    <span class="k">def</span> <span class="nf">close_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ThermoBaseClass-263"><a href="#ThermoBaseClass-263"><span class="linenos"> 263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-264"><a href="#ThermoBaseClass-264"><span class="linenos"> 264</span></a><span class="sd">        Close the Thermo Raw file.</span>
</span><span id="ThermoBaseClass-265"><a href="#ThermoBaseClass-265"><span class="linenos"> 265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-266"><a href="#ThermoBaseClass-266"><span class="linenos"> 266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">Dispose</span><span class="p">()</span>
</span><span id="ThermoBaseClass-267"><a href="#ThermoBaseClass-267"><span class="linenos"> 267</span></a>
</span><span id="ThermoBaseClass-268"><a href="#ThermoBaseClass-268"><span class="linenos"> 268</span></a>    <span class="k">def</span> <span class="nf">get_polarity_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ThermoBaseClass-269"><a href="#ThermoBaseClass-269"><span class="linenos"> 269</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-270"><a href="#ThermoBaseClass-270"><span class="linenos"> 270</span></a><span class="sd">        Get the polarity mode for the given scan number.</span>
</span><span id="ThermoBaseClass-271"><a href="#ThermoBaseClass-271"><span class="linenos"> 271</span></a>
</span><span id="ThermoBaseClass-272"><a href="#ThermoBaseClass-272"><span class="linenos"> 272</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-273"><a href="#ThermoBaseClass-273"><span class="linenos"> 273</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-274"><a href="#ThermoBaseClass-274"><span class="linenos"> 274</span></a><span class="sd">        scan_number : int</span>
</span><span id="ThermoBaseClass-275"><a href="#ThermoBaseClass-275"><span class="linenos"> 275</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass-276"><a href="#ThermoBaseClass-276"><span class="linenos"> 276</span></a>
</span><span id="ThermoBaseClass-277"><a href="#ThermoBaseClass-277"><span class="linenos"> 277</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass-278"><a href="#ThermoBaseClass-278"><span class="linenos"> 278</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass-279"><a href="#ThermoBaseClass-279"><span class="linenos"> 279</span></a><span class="sd">        Exception</span>
</span><span id="ThermoBaseClass-280"><a href="#ThermoBaseClass-280"><span class="linenos"> 280</span></a><span class="sd">            If the polarity mode is unknown.</span>
</span><span id="ThermoBaseClass-281"><a href="#ThermoBaseClass-281"><span class="linenos"> 281</span></a>
</span><span id="ThermoBaseClass-282"><a href="#ThermoBaseClass-282"><span class="linenos"> 282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-283"><a href="#ThermoBaseClass-283"><span class="linenos"> 283</span></a>        <span class="n">polarity_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filter_for_scan_num</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass-284"><a href="#ThermoBaseClass-284"><span class="linenos"> 284</span></a>
</span><span id="ThermoBaseClass-285"><a href="#ThermoBaseClass-285"><span class="linenos"> 285</span></a>        <span class="k">if</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-286"><a href="#ThermoBaseClass-286"><span class="linenos"> 286</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="ThermoBaseClass-287"><a href="#ThermoBaseClass-287"><span class="linenos"> 287</span></a>            <span class="c1"># return &#39;POSITIVE_ION_MODE&#39;</span>
</span><span id="ThermoBaseClass-288"><a href="#ThermoBaseClass-288"><span class="linenos"> 288</span></a>
</span><span id="ThermoBaseClass-289"><a href="#ThermoBaseClass-289"><span class="linenos"> 289</span></a>        <span class="k">elif</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-290"><a href="#ThermoBaseClass-290"><span class="linenos"> 290</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="ThermoBaseClass-291"><a href="#ThermoBaseClass-291"><span class="linenos"> 291</span></a>
</span><span id="ThermoBaseClass-292"><a href="#ThermoBaseClass-292"><span class="linenos"> 292</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-293"><a href="#ThermoBaseClass-293"><span class="linenos"> 293</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Polarity Mode Unknown, please set it manually&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-294"><a href="#ThermoBaseClass-294"><span class="linenos"> 294</span></a>
</span><span id="ThermoBaseClass-295"><a href="#ThermoBaseClass-295"><span class="linenos"> 295</span></a>    <span class="k">def</span> <span class="nf">get_filter_for_scan_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ThermoBaseClass-296"><a href="#ThermoBaseClass-296"><span class="linenos"> 296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-297"><a href="#ThermoBaseClass-297"><span class="linenos"> 297</span></a><span class="sd">        Returns the closest matching run time that corresponds to scan_number for the current</span>
</span><span id="ThermoBaseClass-298"><a href="#ThermoBaseClass-298"><span class="linenos"> 298</span></a><span class="sd">        controller. This function is only supported for MS device controllers.</span>
</span><span id="ThermoBaseClass-299"><a href="#ThermoBaseClass-299"><span class="linenos"> 299</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="ThermoBaseClass-300"><a href="#ThermoBaseClass-300"><span class="linenos"> 300</span></a>
</span><span id="ThermoBaseClass-301"><a href="#ThermoBaseClass-301"><span class="linenos"> 301</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-302"><a href="#ThermoBaseClass-302"><span class="linenos"> 302</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-303"><a href="#ThermoBaseClass-303"><span class="linenos"> 303</span></a><span class="sd">        scan_number : int</span>
</span><span id="ThermoBaseClass-304"><a href="#ThermoBaseClass-304"><span class="linenos"> 304</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass-305"><a href="#ThermoBaseClass-305"><span class="linenos"> 305</span></a>
</span><span id="ThermoBaseClass-306"><a href="#ThermoBaseClass-306"><span class="linenos"> 306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-307"><a href="#ThermoBaseClass-307"><span class="linenos"> 307</span></a>        <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass-308"><a href="#ThermoBaseClass-308"><span class="linenos"> 308</span></a>
</span><span id="ThermoBaseClass-309"><a href="#ThermoBaseClass-309"><span class="linenos"> 309</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="ThermoBaseClass-310"><a href="#ThermoBaseClass-310"><span class="linenos"> 310</span></a>
</span><span id="ThermoBaseClass-311"><a href="#ThermoBaseClass-311"><span class="linenos"> 311</span></a>    <span class="k">def</span> <span class="nf">check_full_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ThermoBaseClass-312"><a href="#ThermoBaseClass-312"><span class="linenos"> 312</span></a>        <span class="c1"># scan_filter.ScanMode 0 = FULL</span>
</span><span id="ThermoBaseClass-313"><a href="#ThermoBaseClass-313"><span class="linenos"> 313</span></a>        <span class="n">scan_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass-314"><a href="#ThermoBaseClass-314"><span class="linenos"> 314</span></a>
</span><span id="ThermoBaseClass-315"><a href="#ThermoBaseClass-315"><span class="linenos"> 315</span></a>        <span class="k">return</span> <span class="n">scan_filter</span><span class="o">.</span><span class="n">ScanMode</span> <span class="o">==</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span>
</span><span id="ThermoBaseClass-316"><a href="#ThermoBaseClass-316"><span class="linenos"> 316</span></a>
</span><span id="ThermoBaseClass-317"><a href="#ThermoBaseClass-317"><span class="linenos"> 317</span></a>    <span class="k">def</span> <span class="nf">get_all_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ThermoBaseClass-318"><a href="#ThermoBaseClass-318"><span class="linenos"> 318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-319"><a href="#ThermoBaseClass-319"><span class="linenos"> 319</span></a><span class="sd">        Get all scan filters.</span>
</span><span id="ThermoBaseClass-320"><a href="#ThermoBaseClass-320"><span class="linenos"> 320</span></a><span class="sd">        This function is only supported for MS device controllers.</span>
</span><span id="ThermoBaseClass-321"><a href="#ThermoBaseClass-321"><span class="linenos"> 321</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="ThermoBaseClass-322"><a href="#ThermoBaseClass-322"><span class="linenos"> 322</span></a>
</span><span id="ThermoBaseClass-323"><a href="#ThermoBaseClass-323"><span class="linenos"> 323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-324"><a href="#ThermoBaseClass-324"><span class="linenos"> 324</span></a>
</span><span id="ThermoBaseClass-325"><a href="#ThermoBaseClass-325"><span class="linenos"> 325</span></a>        <span class="n">scanrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-326"><a href="#ThermoBaseClass-326"><span class="linenos"> 326</span></a>        <span class="n">scanfiltersdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-327"><a href="#ThermoBaseClass-327"><span class="linenos"> 327</span></a>        <span class="n">scanfilterslist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-328"><a href="#ThermoBaseClass-328"><span class="linenos"> 328</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="n">scanrange</span><span class="p">:</span>
</span><span id="ThermoBaseClass-329"><a href="#ThermoBaseClass-329"><span class="linenos"> 329</span></a>            <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass-330"><a href="#ThermoBaseClass-330"><span class="linenos"> 330</span></a>            <span class="n">scanfiltersdic</span><span class="p">[</span><span class="n">scan_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_label</span>
</span><span id="ThermoBaseClass-331"><a href="#ThermoBaseClass-331"><span class="linenos"> 331</span></a>            <span class="n">scanfilterslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span>
</span><span id="ThermoBaseClass-332"><a href="#ThermoBaseClass-332"><span class="linenos"> 332</span></a>        <span class="n">scanfilterset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scanfilterslist</span><span class="p">))</span>
</span><span id="ThermoBaseClass-333"><a href="#ThermoBaseClass-333"><span class="linenos"> 333</span></a>        <span class="k">return</span> <span class="n">scanfiltersdic</span><span class="p">,</span> <span class="n">scanfilterset</span>
</span><span id="ThermoBaseClass-334"><a href="#ThermoBaseClass-334"><span class="linenos"> 334</span></a>
</span><span id="ThermoBaseClass-335"><a href="#ThermoBaseClass-335"><span class="linenos"> 335</span></a>    <span class="k">def</span> <span class="nf">get_scan_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="ThermoBaseClass-336"><a href="#ThermoBaseClass-336"><span class="linenos"> 336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-337"><a href="#ThermoBaseClass-337"><span class="linenos"> 337</span></a><span class="sd">        Get full dictionary of scan header meta data, i.e. AGC status, ion injection time, etc.</span>
</span><span id="ThermoBaseClass-338"><a href="#ThermoBaseClass-338"><span class="linenos"> 338</span></a>
</span><span id="ThermoBaseClass-339"><a href="#ThermoBaseClass-339"><span class="linenos"> 339</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-340"><a href="#ThermoBaseClass-340"><span class="linenos"> 340</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-341"><a href="#ThermoBaseClass-341"><span class="linenos"> 341</span></a><span class="sd">        scan : int</span>
</span><span id="ThermoBaseClass-342"><a href="#ThermoBaseClass-342"><span class="linenos"> 342</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass-343"><a href="#ThermoBaseClass-343"><span class="linenos"> 343</span></a>
</span><span id="ThermoBaseClass-344"><a href="#ThermoBaseClass-344"><span class="linenos"> 344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-345"><a href="#ThermoBaseClass-345"><span class="linenos"> 345</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTrailerExtraInformation</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass-346"><a href="#ThermoBaseClass-346"><span class="linenos"> 346</span></a>
</span><span id="ThermoBaseClass-347"><a href="#ThermoBaseClass-347"><span class="linenos"> 347</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-348"><a href="#ThermoBaseClass-348"><span class="linenos"> 348</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass-349"><a href="#ThermoBaseClass-349"><span class="linenos"> 349</span></a>            <span class="n">header_dic</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="ThermoBaseClass-350"><a href="#ThermoBaseClass-350"><span class="linenos"> 350</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="ThermoBaseClass-351"><a href="#ThermoBaseClass-351"><span class="linenos"> 351</span></a>
</span><span id="ThermoBaseClass-352"><a href="#ThermoBaseClass-352"><span class="linenos"> 352</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ThermoBaseClass-353"><a href="#ThermoBaseClass-353"><span class="linenos"> 353</span></a>    <span class="k">def</span> <span class="nf">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="ThermoBaseClass-354"><a href="#ThermoBaseClass-354"><span class="linenos"> 354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;trace: ThermoFisher.CommonCore.Data.Business.ChromatogramSignal&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-355"><a href="#ThermoBaseClass-355"><span class="linenos"> 355</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Times</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Intensities</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Scans</span><span class="p">)</span>
</span><span id="ThermoBaseClass-356"><a href="#ThermoBaseClass-356"><span class="linenos"> 356</span></a>
</span><span id="ThermoBaseClass-357"><a href="#ThermoBaseClass-357"><span class="linenos"> 357</span></a>    <span class="k">def</span> <span class="nf">get_eics</span><span class="p">(</span>
</span><span id="ThermoBaseClass-358"><a href="#ThermoBaseClass-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass-359"><a href="#ThermoBaseClass-359"><span class="linenos"> 359</span></a>        <span class="n">target_mzs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="ThermoBaseClass-360"><a href="#ThermoBaseClass-360"><span class="linenos"> 360</span></a>        <span class="n">tic_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ThermoBaseClass-361"><a href="#ThermoBaseClass-361"><span class="linenos"> 361</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-362"><a href="#ThermoBaseClass-362"><span class="linenos"> 362</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-363"><a href="#ThermoBaseClass-363"><span class="linenos"> 363</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-364"><a href="#ThermoBaseClass-364"><span class="linenos"> 364</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-365"><a href="#ThermoBaseClass-365"><span class="linenos"> 365</span></a>        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="ThermoBaseClass-366"><a href="#ThermoBaseClass-366"><span class="linenos"> 366</span></a>        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-367"><a href="#ThermoBaseClass-367"><span class="linenos"> 367</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">EIC_Data</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="ThermoBaseClass-368"><a href="#ThermoBaseClass-368"><span class="linenos"> 368</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS&#39;, MS2&#39;)</span>
</span><span id="ThermoBaseClass-369"><a href="#ThermoBaseClass-369"><span class="linenos"> 369</span></a><span class="sd">        start_scan: int default -1 will select the lowest available</span>
</span><span id="ThermoBaseClass-370"><a href="#ThermoBaseClass-370"><span class="linenos"> 370</span></a><span class="sd">        end_scan: int default -1 will select the highest available</span>
</span><span id="ThermoBaseClass-371"><a href="#ThermoBaseClass-371"><span class="linenos"> 371</span></a>
</span><span id="ThermoBaseClass-372"><a href="#ThermoBaseClass-372"><span class="linenos"> 372</span></a><span class="sd">        returns:</span>
</span><span id="ThermoBaseClass-373"><a href="#ThermoBaseClass-373"><span class="linenos"> 373</span></a>
</span><span id="ThermoBaseClass-374"><a href="#ThermoBaseClass-374"><span class="linenos"> 374</span></a><span class="sd">            chroma: dict{target_mz: EIC_Data(</span>
</span><span id="ThermoBaseClass-375"><a href="#ThermoBaseClass-375"><span class="linenos"> 375</span></a><span class="sd">                                        Scans: [int]</span>
</span><span id="ThermoBaseClass-376"><a href="#ThermoBaseClass-376"><span class="linenos"> 376</span></a><span class="sd">                                            original thermo scan numbers</span>
</span><span id="ThermoBaseClass-377"><a href="#ThermoBaseClass-377"><span class="linenos"> 377</span></a><span class="sd">                                        Time: [floats]</span>
</span><span id="ThermoBaseClass-378"><a href="#ThermoBaseClass-378"><span class="linenos"> 378</span></a><span class="sd">                                            list of retention times</span>
</span><span id="ThermoBaseClass-379"><a href="#ThermoBaseClass-379"><span class="linenos"> 379</span></a><span class="sd">                                        TIC: [floats]</span>
</span><span id="ThermoBaseClass-380"><a href="#ThermoBaseClass-380"><span class="linenos"> 380</span></a><span class="sd">                                            total ion chromatogram</span>
</span><span id="ThermoBaseClass-381"><a href="#ThermoBaseClass-381"><span class="linenos"> 381</span></a><span class="sd">                                        Apexes: [int]</span>
</span><span id="ThermoBaseClass-382"><a href="#ThermoBaseClass-382"><span class="linenos"> 382</span></a><span class="sd">                                            original thermo apex scan number after peak picking</span>
</span><span id="ThermoBaseClass-383"><a href="#ThermoBaseClass-383"><span class="linenos"> 383</span></a><span class="sd">                                        )</span>
</span><span id="ThermoBaseClass-384"><a href="#ThermoBaseClass-384"><span class="linenos"> 384</span></a>
</span><span id="ThermoBaseClass-385"><a href="#ThermoBaseClass-385"><span class="linenos"> 385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-386"><a href="#ThermoBaseClass-386"><span class="linenos"> 386</span></a>        <span class="c1"># If peak_detection or smooth is True, raise exception</span>
</span><span id="ThermoBaseClass-387"><a href="#ThermoBaseClass-387"><span class="linenos"> 387</span></a>        <span class="k">if</span> <span class="n">peak_detection</span> <span class="ow">or</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass-388"><a href="#ThermoBaseClass-388"><span class="linenos"> 388</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Peak detection and smoothing are no longer implemented in this function&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-389"><a href="#ThermoBaseClass-389"><span class="linenos"> 389</span></a>
</span><span id="ThermoBaseClass-390"><a href="#ThermoBaseClass-390"><span class="linenos"> 390</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass-391"><a href="#ThermoBaseClass-391"><span class="linenos"> 391</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass-392"><a href="#ThermoBaseClass-392"><span class="linenos"> 392</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">eic_tolerance_ppm</span>
</span><span id="ThermoBaseClass-393"><a href="#ThermoBaseClass-393"><span class="linenos"> 393</span></a>
</span><span id="ThermoBaseClass-394"><a href="#ThermoBaseClass-394"><span class="linenos"> 394</span></a>        <span class="n">all_chroma_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-395"><a href="#ThermoBaseClass-395"><span class="linenos"> 395</span></a>
</span><span id="ThermoBaseClass-396"><a href="#ThermoBaseClass-396"><span class="linenos"> 396</span></a>        <span class="k">for</span> <span class="n">target_mz</span> <span class="ow">in</span> <span class="n">target_mzs</span><span class="p">:</span>
</span><span id="ThermoBaseClass-397"><a href="#ThermoBaseClass-397"><span class="linenos"> 397</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">MassRange</span><span class="p">)</span>
</span><span id="ThermoBaseClass-398"><a href="#ThermoBaseClass-398"><span class="linenos"> 398</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="ThermoBaseClass-399"><a href="#ThermoBaseClass-399"><span class="linenos"> 399</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">MassRanges</span> <span class="o">=</span> <span class="p">[</span><span class="n">Range</span><span class="p">(</span><span class="n">target_mz</span><span class="p">,</span> <span class="n">target_mz</span><span class="p">)]</span>
</span><span id="ThermoBaseClass-400"><a href="#ThermoBaseClass-400"><span class="linenos"> 400</span></a>
</span><span id="ThermoBaseClass-401"><a href="#ThermoBaseClass-401"><span class="linenos"> 401</span></a>            <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass-402"><a href="#ThermoBaseClass-402"><span class="linenos"> 402</span></a>
</span><span id="ThermoBaseClass-403"><a href="#ThermoBaseClass-403"><span class="linenos"> 403</span></a>            <span class="n">all_chroma_settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chroma_settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass-404"><a href="#ThermoBaseClass-404"><span class="linenos"> 404</span></a>
</span><span id="ThermoBaseClass-405"><a href="#ThermoBaseClass-405"><span class="linenos"> 405</span></a>        <span class="c1"># chroma_settings2 = IChromatogramSettings(settings)</span>
</span><span id="ThermoBaseClass-406"><a href="#ThermoBaseClass-406"><span class="linenos"> 406</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="ThermoBaseClass-407"><a href="#ThermoBaseClass-407"><span class="linenos"> 407</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="ThermoBaseClass-408"><a href="#ThermoBaseClass-408"><span class="linenos"> 408</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="ThermoBaseClass-409"><a href="#ThermoBaseClass-409"><span class="linenos"> 409</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="ThermoBaseClass-410"><a href="#ThermoBaseClass-410"><span class="linenos"> 410</span></a>
</span><span id="ThermoBaseClass-411"><a href="#ThermoBaseClass-411"><span class="linenos"> 411</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="ThermoBaseClass-412"><a href="#ThermoBaseClass-412"><span class="linenos"> 412</span></a>            <span class="n">all_chroma_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">options</span>
</span><span id="ThermoBaseClass-413"><a href="#ThermoBaseClass-413"><span class="linenos"> 413</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-414"><a href="#ThermoBaseClass-414"><span class="linenos"> 414</span></a>
</span><span id="ThermoBaseClass-415"><a href="#ThermoBaseClass-415"><span class="linenos"> 415</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ThermoBaseClass-416"><a href="#ThermoBaseClass-416"><span class="linenos"> 416</span></a>
</span><span id="ThermoBaseClass-417"><a href="#ThermoBaseClass-417"><span class="linenos"> 417</span></a>        <span class="n">chroma</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-418"><a href="#ThermoBaseClass-418"><span class="linenos"> 418</span></a>
</span><span id="ThermoBaseClass-419"><a href="#ThermoBaseClass-419"><span class="linenos"> 419</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass-420"><a href="#ThermoBaseClass-420"><span class="linenos"> 420</span></a>            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Bbox</span>
</span><span id="ThermoBaseClass-421"><a href="#ThermoBaseClass-421"><span class="linenos"> 421</span></a>            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="ThermoBaseClass-422"><a href="#ThermoBaseClass-422"><span class="linenos"> 422</span></a>
</span><span id="ThermoBaseClass-423"><a href="#ThermoBaseClass-423"><span class="linenos"> 423</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="ThermoBaseClass-424"><a href="#ThermoBaseClass-424"><span class="linenos"> 424</span></a>                <span class="c1"># ax = plt.gca()</span>
</span><span id="ThermoBaseClass-425"><a href="#ThermoBaseClass-425"><span class="linenos"> 425</span></a>                <span class="c1"># ax.clear()</span>
</span><span id="ThermoBaseClass-426"><a href="#ThermoBaseClass-426"><span class="linenos"> 426</span></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="ThermoBaseClass-427"><a href="#ThermoBaseClass-427"><span class="linenos"> 427</span></a>
</span><span id="ThermoBaseClass-428"><a href="#ThermoBaseClass-428"><span class="linenos"> 428</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-429"><a href="#ThermoBaseClass-429"><span class="linenos"> 429</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="ThermoBaseClass-430"><a href="#ThermoBaseClass-430"><span class="linenos"> 430</span></a>
</span><span id="ThermoBaseClass-431"><a href="#ThermoBaseClass-431"><span class="linenos"> 431</span></a>            <span class="c1"># plt.show()</span>
</span><span id="ThermoBaseClass-432"><a href="#ThermoBaseClass-432"><span class="linenos"> 432</span></a>
</span><span id="ThermoBaseClass-433"><a href="#ThermoBaseClass-433"><span class="linenos"> 433</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">trace</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces</span><span class="p">):</span>
</span><span id="ThermoBaseClass-434"><a href="#ThermoBaseClass-434"><span class="linenos"> 434</span></a>            <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-435"><a href="#ThermoBaseClass-435"><span class="linenos"> 435</span></a>                <span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">scans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</span><span id="ThermoBaseClass-436"><a href="#ThermoBaseClass-436"><span class="linenos"> 436</span></a>                <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass-437"><a href="#ThermoBaseClass-437"><span class="linenos"> 437</span></a>                    <span class="n">eic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-438"><a href="#ThermoBaseClass-438"><span class="linenos"> 438</span></a>
</span><span id="ThermoBaseClass-439"><a href="#ThermoBaseClass-439"><span class="linenos"> 439</span></a>                <span class="n">chroma</span><span class="p">[</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span><span class="n">scans</span><span class="o">=</span><span class="n">scans</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="o">=</span><span class="n">eic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-440"><a href="#ThermoBaseClass-440"><span class="linenos"> 440</span></a>                <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass-441"><a href="#ThermoBaseClass-441"><span class="linenos"> 441</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="ThermoBaseClass-442"><a href="#ThermoBaseClass-442"><span class="linenos"> 442</span></a>
</span><span id="ThermoBaseClass-443"><a href="#ThermoBaseClass-443"><span class="linenos"> 443</span></a>        <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass-444"><a href="#ThermoBaseClass-444"><span class="linenos"> 444</span></a>            <span class="c1"># max_eic = self.get_max_eic(chroma)</span>
</span><span id="ThermoBaseClass-445"><a href="#ThermoBaseClass-445"><span class="linenos"> 445</span></a>            <span class="n">max_signal</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-446"><a href="#ThermoBaseClass-446"><span class="linenos"> 446</span></a>
</span><span id="ThermoBaseClass-447"><a href="#ThermoBaseClass-447"><span class="linenos"> 447</span></a>            <span class="k">for</span> <span class="n">eic_data</span> <span class="ow">in</span> <span class="n">chroma</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="ThermoBaseClass-448"><a href="#ThermoBaseClass-448"><span class="linenos"> 448</span></a>                <span class="n">eic</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">eic</span>
</span><span id="ThermoBaseClass-449"><a href="#ThermoBaseClass-449"><span class="linenos"> 449</span></a>                <span class="n">time</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">time</span>
</span><span id="ThermoBaseClass-450"><a href="#ThermoBaseClass-450"><span class="linenos"> 450</span></a>
</span><span id="ThermoBaseClass-451"><a href="#ThermoBaseClass-451"><span class="linenos"> 451</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">):</span>
</span><span id="ThermoBaseClass-452"><a href="#ThermoBaseClass-452"><span class="linenos"> 452</span></a>                    <span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass-453"><a href="#ThermoBaseClass-453"><span class="linenos"> 453</span></a>                        <span class="s2">&quot;The software assumes same lenth of TIC and EIC, this does not seems to be the case and the results mass spectrum selected by the scan number might not be correct&quot;</span>
</span><span id="ThermoBaseClass-454"><a href="#ThermoBaseClass-454"><span class="linenos"> 454</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass-455"><a href="#ThermoBaseClass-455"><span class="linenos"> 455</span></a>
</span><span id="ThermoBaseClass-456"><a href="#ThermoBaseClass-456"><span class="linenos"> 456</span></a>                <span class="k">if</span> <span class="n">eic</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-457"><a href="#ThermoBaseClass-457"><span class="linenos"> 457</span></a>                    <span class="n">centroid_eics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eic_centroid_detector</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">max_signal</span><span class="p">)</span>
</span><span id="ThermoBaseClass-458"><a href="#ThermoBaseClass-458"><span class="linenos"> 458</span></a>                    <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">centroid_eics</span><span class="p">]</span>
</span><span id="ThermoBaseClass-459"><a href="#ThermoBaseClass-459"><span class="linenos"> 459</span></a>
</span><span id="ThermoBaseClass-460"><a href="#ThermoBaseClass-460"><span class="linenos"> 460</span></a>                    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass-461"><a href="#ThermoBaseClass-461"><span class="linenos"> 461</span></a>                        <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="ThermoBaseClass-462"><a href="#ThermoBaseClass-462"><span class="linenos"> 462</span></a>                            <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass-463"><a href="#ThermoBaseClass-463"><span class="linenos"> 463</span></a>                            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="ThermoBaseClass-464"><a href="#ThermoBaseClass-464"><span class="linenos"> 464</span></a>                                <span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass-465"><a href="#ThermoBaseClass-465"><span class="linenos"> 465</span></a>                                <span class="n">eic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass-466"><a href="#ThermoBaseClass-466"><span class="linenos"> 466</span></a>                                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-467"><a href="#ThermoBaseClass-467"><span class="linenos"> 467</span></a>                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-468"><a href="#ThermoBaseClass-468"><span class="linenos"> 468</span></a>                            <span class="p">)</span>
</span><span id="ThermoBaseClass-469"><a href="#ThermoBaseClass-469"><span class="linenos"> 469</span></a>
</span><span id="ThermoBaseClass-470"><a href="#ThermoBaseClass-470"><span class="linenos"> 470</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass-471"><a href="#ThermoBaseClass-471"><span class="linenos"> 471</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-472"><a href="#ThermoBaseClass-472"><span class="linenos"> 472</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-473"><a href="#ThermoBaseClass-473"><span class="linenos"> 473</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ms_type</span> <span class="o">+</span> <span class="s2">&quot; EIC&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-474"><a href="#ThermoBaseClass-474"><span class="linenos"> 474</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="ThermoBaseClass-475"><a href="#ThermoBaseClass-475"><span class="linenos"> 475</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass-476"><a href="#ThermoBaseClass-476"><span class="linenos"> 476</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass-477"><a href="#ThermoBaseClass-477"><span class="linenos"> 477</span></a>
</span><span id="ThermoBaseClass-478"><a href="#ThermoBaseClass-478"><span class="linenos"> 478</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="ThermoBaseClass-479"><a href="#ThermoBaseClass-479"><span class="linenos"> 479</span></a>                <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="ThermoBaseClass-480"><a href="#ThermoBaseClass-480"><span class="linenos"> 480</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.76</span><span class="p">)</span>
</span><span id="ThermoBaseClass-481"><a href="#ThermoBaseClass-481"><span class="linenos"> 481</span></a>                <span class="c1"># ax.set_prop_cycle(color=plt.cm.gist_rainbow(np.linspace(0, 1, len(traces))))</span>
</span><span id="ThermoBaseClass-482"><a href="#ThermoBaseClass-482"><span class="linenos"> 482</span></a>
</span><span id="ThermoBaseClass-483"><a href="#ThermoBaseClass-483"><span class="linenos"> 483</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">}</span>
</span><span id="ThermoBaseClass-484"><a href="#ThermoBaseClass-484"><span class="linenos"> 484</span></a>
</span><span id="ThermoBaseClass-485"><a href="#ThermoBaseClass-485"><span class="linenos"> 485</span></a>                <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="ThermoBaseClass-486"><a href="#ThermoBaseClass-486"><span class="linenos"> 486</span></a>                    <span class="k">if</span> <span class="n">legend</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="ThermoBaseClass-487"><a href="#ThermoBaseClass-487"><span class="linenos"> 487</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_bbox_to_anchor</span><span class="p">()</span>
</span><span id="ThermoBaseClass-488"><a href="#ThermoBaseClass-488"><span class="linenos"> 488</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span>
</span><span id="ThermoBaseClass-489"><a href="#ThermoBaseClass-489"><span class="linenos"> 489</span></a>                            <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">evt</span><span class="o">.</span><span class="n">button</span><span class="p">],</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="ThermoBaseClass-490"><a href="#ThermoBaseClass-490"><span class="linenos"> 490</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass-491"><a href="#ThermoBaseClass-491"><span class="linenos"> 491</span></a>                        <span class="n">tr</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
</span><span id="ThermoBaseClass-492"><a href="#ThermoBaseClass-492"><span class="linenos"> 492</span></a>                        <span class="n">legend</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">tr</span><span class="p">))</span>
</span><span id="ThermoBaseClass-493"><a href="#ThermoBaseClass-493"><span class="linenos"> 493</span></a>                        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="ThermoBaseClass-494"><a href="#ThermoBaseClass-494"><span class="linenos"> 494</span></a>
</span><span id="ThermoBaseClass-495"><a href="#ThermoBaseClass-495"><span class="linenos"> 495</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;scroll_event&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
</span><span id="ThermoBaseClass-496"><a href="#ThermoBaseClass-496"><span class="linenos"> 496</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="ThermoBaseClass-497"><a href="#ThermoBaseClass-497"><span class="linenos"> 497</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-498"><a href="#ThermoBaseClass-498"><span class="linenos"> 498</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-499"><a href="#ThermoBaseClass-499"><span class="linenos"> 499</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-500"><a href="#ThermoBaseClass-500"><span class="linenos"> 500</span></a>            <span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-501"><a href="#ThermoBaseClass-501"><span class="linenos"> 501</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-502"><a href="#ThermoBaseClass-502"><span class="linenos"> 502</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass-503"><a href="#ThermoBaseClass-503"><span class="linenos"> 503</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="ThermoBaseClass-504"><a href="#ThermoBaseClass-504"><span class="linenos"> 504</span></a>
</span><span id="ThermoBaseClass-505"><a href="#ThermoBaseClass-505"><span class="linenos"> 505</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="ThermoBaseClass-506"><a href="#ThermoBaseClass-506"><span class="linenos"> 506</span></a>                <span class="n">rt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-507"><a href="#ThermoBaseClass-507"><span class="linenos"> 507</span></a>                <span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-508"><a href="#ThermoBaseClass-508"><span class="linenos"> 508</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-509"><a href="#ThermoBaseClass-509"><span class="linenos"> 509</span></a>
</span><span id="ThermoBaseClass-510"><a href="#ThermoBaseClass-510"><span class="linenos"> 510</span></a>            <span class="k">return</span> <span class="n">traces</span>
</span><span id="ThermoBaseClass-511"><a href="#ThermoBaseClass-511"><span class="linenos"> 511</span></a>            <span class="c1"># plot_chroma(rt, tic)</span>
</span><span id="ThermoBaseClass-512"><a href="#ThermoBaseClass-512"><span class="linenos"> 512</span></a>            <span class="c1"># plt.show()</span>
</span><span id="ThermoBaseClass-513"><a href="#ThermoBaseClass-513"><span class="linenos"> 513</span></a>
</span><span id="ThermoBaseClass-514"><a href="#ThermoBaseClass-514"><span class="linenos"> 514</span></a>    <span class="k">def</span> <span class="nf">get_tic</span><span class="p">(</span>
</span><span id="ThermoBaseClass-515"><a href="#ThermoBaseClass-515"><span class="linenos"> 515</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass-516"><a href="#ThermoBaseClass-516"><span class="linenos"> 516</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-517"><a href="#ThermoBaseClass-517"><span class="linenos"> 517</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="ThermoBaseClass-518"><a href="#ThermoBaseClass-518"><span class="linenos"> 518</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="ThermoBaseClass-519"><a href="#ThermoBaseClass-519"><span class="linenos"> 519</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-520"><a href="#ThermoBaseClass-520"><span class="linenos"> 520</span></a>        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ThermoBaseClass-521"><a href="#ThermoBaseClass-521"><span class="linenos"> 521</span></a>        <span class="n">trace_type</span><span class="o">=</span><span class="s2">&quot;TIC&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-522"><a href="#ThermoBaseClass-522"><span class="linenos"> 522</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TIC_Data</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="ThermoBaseClass-523"><a href="#ThermoBaseClass-523"><span class="linenos"> 523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS !d&#39;, &#39;MS2&#39;, None)</span>
</span><span id="ThermoBaseClass-524"><a href="#ThermoBaseClass-524"><span class="linenos"> 524</span></a><span class="sd">            if you use None you get all scans.</span>
</span><span id="ThermoBaseClass-525"><a href="#ThermoBaseClass-525"><span class="linenos"> 525</span></a><span class="sd">        peak_detection: bool</span>
</span><span id="ThermoBaseClass-526"><a href="#ThermoBaseClass-526"><span class="linenos"> 526</span></a><span class="sd">        smooth: bool</span>
</span><span id="ThermoBaseClass-527"><a href="#ThermoBaseClass-527"><span class="linenos"> 527</span></a><span class="sd">        plot: bool</span>
</span><span id="ThermoBaseClass-528"><a href="#ThermoBaseClass-528"><span class="linenos"> 528</span></a><span class="sd">        ax: matplotlib axis object</span>
</span><span id="ThermoBaseClass-529"><a href="#ThermoBaseClass-529"><span class="linenos"> 529</span></a><span class="sd">        trace_type: str (&#39;TIC&#39;,&#39;BPC&#39;)</span>
</span><span id="ThermoBaseClass-530"><a href="#ThermoBaseClass-530"><span class="linenos"> 530</span></a>
</span><span id="ThermoBaseClass-531"><a href="#ThermoBaseClass-531"><span class="linenos"> 531</span></a><span class="sd">        returns:</span>
</span><span id="ThermoBaseClass-532"><a href="#ThermoBaseClass-532"><span class="linenos"> 532</span></a><span class="sd">            chroma: dict</span>
</span><span id="ThermoBaseClass-533"><a href="#ThermoBaseClass-533"><span class="linenos"> 533</span></a><span class="sd">            {</span>
</span><span id="ThermoBaseClass-534"><a href="#ThermoBaseClass-534"><span class="linenos"> 534</span></a><span class="sd">            Scan: [int]</span>
</span><span id="ThermoBaseClass-535"><a href="#ThermoBaseClass-535"><span class="linenos"> 535</span></a><span class="sd">                original thermo scan numberMS</span>
</span><span id="ThermoBaseClass-536"><a href="#ThermoBaseClass-536"><span class="linenos"> 536</span></a><span class="sd">            Time: [floats]</span>
</span><span id="ThermoBaseClass-537"><a href="#ThermoBaseClass-537"><span class="linenos"> 537</span></a><span class="sd">                list of retention times</span>
</span><span id="ThermoBaseClass-538"><a href="#ThermoBaseClass-538"><span class="linenos"> 538</span></a><span class="sd">            TIC: [floats]</span>
</span><span id="ThermoBaseClass-539"><a href="#ThermoBaseClass-539"><span class="linenos"> 539</span></a><span class="sd">                total ion chromatogram</span>
</span><span id="ThermoBaseClass-540"><a href="#ThermoBaseClass-540"><span class="linenos"> 540</span></a><span class="sd">            Apexes: [int]</span>
</span><span id="ThermoBaseClass-541"><a href="#ThermoBaseClass-541"><span class="linenos"> 541</span></a><span class="sd">                original thermo apex scan number after peak picking</span>
</span><span id="ThermoBaseClass-542"><a href="#ThermoBaseClass-542"><span class="linenos"> 542</span></a><span class="sd">            }</span>
</span><span id="ThermoBaseClass-543"><a href="#ThermoBaseClass-543"><span class="linenos"> 543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-544"><a href="#ThermoBaseClass-544"><span class="linenos"> 544</span></a>        <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;TIC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-545"><a href="#ThermoBaseClass-545"><span class="linenos"> 545</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">TIC</span><span class="p">)</span>
</span><span id="ThermoBaseClass-546"><a href="#ThermoBaseClass-546"><span class="linenos"> 546</span></a>        <span class="k">elif</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-547"><a href="#ThermoBaseClass-547"><span class="linenos"> 547</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">BasePeak</span><span class="p">)</span>
</span><span id="ThermoBaseClass-548"><a href="#ThermoBaseClass-548"><span class="linenos"> 548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-549"><a href="#ThermoBaseClass-549"><span class="linenos"> 549</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">trace_type</span><span class="si">}</span><span class="s2"> undefined&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-550"><a href="#ThermoBaseClass-550"><span class="linenos"> 550</span></a>        <span class="k">if</span> <span class="n">ms_type</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-551"><a href="#ThermoBaseClass-551"><span class="linenos"> 551</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-552"><a href="#ThermoBaseClass-552"><span class="linenos"> 552</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-553"><a href="#ThermoBaseClass-553"><span class="linenos"> 553</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="ThermoBaseClass-554"><a href="#ThermoBaseClass-554"><span class="linenos"> 554</span></a>
</span><span id="ThermoBaseClass-555"><a href="#ThermoBaseClass-555"><span class="linenos"> 555</span></a>        <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass-556"><a href="#ThermoBaseClass-556"><span class="linenos"> 556</span></a>
</span><span id="ThermoBaseClass-557"><a href="#ThermoBaseClass-557"><span class="linenos"> 557</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="ThermoBaseClass-558"><a href="#ThermoBaseClass-558"><span class="linenos"> 558</span></a>            <span class="p">[</span><span class="n">chroma_settings</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ThermoBaseClass-559"><a href="#ThermoBaseClass-559"><span class="linenos"> 559</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-560"><a href="#ThermoBaseClass-560"><span class="linenos"> 560</span></a>
</span><span id="ThermoBaseClass-561"><a href="#ThermoBaseClass-561"><span class="linenos"> 561</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ThermoBaseClass-562"><a href="#ThermoBaseClass-562"><span class="linenos"> 562</span></a>
</span><span id="ThermoBaseClass-563"><a href="#ThermoBaseClass-563"><span class="linenos"> 563</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">TIC_Data</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[],</span> <span class="n">scans</span><span class="o">=</span><span class="p">[],</span> <span class="n">tic</span><span class="o">=</span><span class="p">[],</span> <span class="n">bpc</span><span class="o">=</span><span class="p">[],</span> <span class="n">apexes</span><span class="o">=</span><span class="p">[])</span>
</span><span id="ThermoBaseClass-564"><a href="#ThermoBaseClass-564"><span class="linenos"> 564</span></a>
</span><span id="ThermoBaseClass-565"><a href="#ThermoBaseClass-565"><span class="linenos"> 565</span></a>        <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-566"><a href="#ThermoBaseClass-566"><span class="linenos"> 566</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass-567"><a href="#ThermoBaseClass-567"><span class="linenos"> 567</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="ThermoBaseClass-568"><a href="#ThermoBaseClass-568"><span class="linenos"> 568</span></a>
</span><span id="ThermoBaseClass-569"><a href="#ThermoBaseClass-569"><span class="linenos"> 569</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="ThermoBaseClass-570"><a href="#ThermoBaseClass-570"><span class="linenos"> 570</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-571"><a href="#ThermoBaseClass-571"><span class="linenos"> 571</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-572"><a href="#ThermoBaseClass-572"><span class="linenos"> 572</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass-573"><a href="#ThermoBaseClass-573"><span class="linenos"> 573</span></a>
</span><span id="ThermoBaseClass-574"><a href="#ThermoBaseClass-574"><span class="linenos"> 574</span></a>                <span class="c1"># print(trace[0].Scans[i])</span>
</span><span id="ThermoBaseClass-575"><a href="#ThermoBaseClass-575"><span class="linenos"> 575</span></a>            <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass-576"><a href="#ThermoBaseClass-576"><span class="linenos"> 576</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-577"><a href="#ThermoBaseClass-577"><span class="linenos"> 577</span></a>
</span><span id="ThermoBaseClass-578"><a href="#ThermoBaseClass-578"><span class="linenos"> 578</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-579"><a href="#ThermoBaseClass-579"><span class="linenos"> 579</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-580"><a href="#ThermoBaseClass-580"><span class="linenos"> 580</span></a>
</span><span id="ThermoBaseClass-581"><a href="#ThermoBaseClass-581"><span class="linenos"> 581</span></a>            <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass-582"><a href="#ThermoBaseClass-582"><span class="linenos"> 582</span></a>                <span class="n">centroid_peak_indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ThermoBaseClass-583"><a href="#ThermoBaseClass-583"><span class="linenos"> 583</span></a>                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid_detector</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass-584"><a href="#ThermoBaseClass-584"><span class="linenos"> 584</span></a>                <span class="p">]</span>
</span><span id="ThermoBaseClass-585"><a href="#ThermoBaseClass-585"><span class="linenos"> 585</span></a>
</span><span id="ThermoBaseClass-586"><a href="#ThermoBaseClass-586"><span class="linenos"> 586</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="n">centroid_peak_indexes</span>
</span><span id="ThermoBaseClass-587"><a href="#ThermoBaseClass-587"><span class="linenos"> 587</span></a>
</span><span id="ThermoBaseClass-588"><a href="#ThermoBaseClass-588"><span class="linenos"> 588</span></a>            <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass-589"><a href="#ThermoBaseClass-589"><span class="linenos"> 589</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="ThermoBaseClass-590"><a href="#ThermoBaseClass-590"><span class="linenos"> 590</span></a>                    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="ThermoBaseClass-591"><a href="#ThermoBaseClass-591"><span class="linenos"> 591</span></a>
</span><span id="ThermoBaseClass-592"><a href="#ThermoBaseClass-592"><span class="linenos"> 592</span></a>                    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="ThermoBaseClass-593"><a href="#ThermoBaseClass-593"><span class="linenos"> 593</span></a>                    <span class="c1"># fig, ax = plt.subplots(figsize=(6, 3))</span>
</span><span id="ThermoBaseClass-594"><a href="#ThermoBaseClass-594"><span class="linenos"> 594</span></a>
</span><span id="ThermoBaseClass-595"><a href="#ThermoBaseClass-595"><span class="linenos"> 595</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trace_type</span><span class="p">)</span>
</span><span id="ThermoBaseClass-596"><a href="#ThermoBaseClass-596"><span class="linenos"> 596</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-597"><a href="#ThermoBaseClass-597"><span class="linenos"> 597</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-598"><a href="#ThermoBaseClass-598"><span class="linenos"> 598</span></a>                <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass-599"><a href="#ThermoBaseClass-599"><span class="linenos"> 599</span></a>                    <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="ThermoBaseClass-600"><a href="#ThermoBaseClass-600"><span class="linenos"> 600</span></a>                        <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass-601"><a href="#ThermoBaseClass-601"><span class="linenos"> 601</span></a>                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="ThermoBaseClass-602"><a href="#ThermoBaseClass-602"><span class="linenos"> 602</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass-603"><a href="#ThermoBaseClass-603"><span class="linenos"> 603</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass-604"><a href="#ThermoBaseClass-604"><span class="linenos"> 604</span></a>                            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-605"><a href="#ThermoBaseClass-605"><span class="linenos"> 605</span></a>                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-606"><a href="#ThermoBaseClass-606"><span class="linenos"> 606</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass-607"><a href="#ThermoBaseClass-607"><span class="linenos"> 607</span></a>
</span><span id="ThermoBaseClass-608"><a href="#ThermoBaseClass-608"><span class="linenos"> 608</span></a>                <span class="c1"># plt.show()</span>
</span><span id="ThermoBaseClass-609"><a href="#ThermoBaseClass-609"><span class="linenos"> 609</span></a>                <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-610"><a href="#ThermoBaseClass-610"><span class="linenos"> 610</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="ThermoBaseClass-611"><a href="#ThermoBaseClass-611"><span class="linenos"> 611</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-612"><a href="#ThermoBaseClass-612"><span class="linenos"> 612</span></a>                <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="ThermoBaseClass-613"><a href="#ThermoBaseClass-613"><span class="linenos"> 613</span></a>            <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-614"><a href="#ThermoBaseClass-614"><span class="linenos"> 614</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="ThermoBaseClass-615"><a href="#ThermoBaseClass-615"><span class="linenos"> 615</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-616"><a href="#ThermoBaseClass-616"><span class="linenos"> 616</span></a>            <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-617"><a href="#ThermoBaseClass-617"><span class="linenos"> 617</span></a>
</span><span id="ThermoBaseClass-618"><a href="#ThermoBaseClass-618"><span class="linenos"> 618</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-619"><a href="#ThermoBaseClass-619"><span class="linenos"> 619</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-620"><a href="#ThermoBaseClass-620"><span class="linenos"> 620</span></a>
</span><span id="ThermoBaseClass-621"><a href="#ThermoBaseClass-621"><span class="linenos"> 621</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum</span><span class="p">(</span>
</span><span id="ThermoBaseClass-622"><a href="#ThermoBaseClass-622"><span class="linenos"> 622</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass-623"><a href="#ThermoBaseClass-623"><span class="linenos"> 623</span></a>        <span class="n">spectrum_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-624"><a href="#ThermoBaseClass-624"><span class="linenos"> 624</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ThermoBaseClass-625"><a href="#ThermoBaseClass-625"><span class="linenos"> 625</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-626"><a href="#ThermoBaseClass-626"><span class="linenos"> 626</span></a>        <span class="n">ms_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MS1&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-627"><a href="#ThermoBaseClass-627"><span class="linenos"> 627</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span> <span class="o">|</span> <span class="n">MassSpecCentroid</span><span class="p">:</span>
</span><span id="ThermoBaseClass-628"><a href="#ThermoBaseClass-628"><span class="linenos"> 628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-629"><a href="#ThermoBaseClass-629"><span class="linenos"> 629</span></a><span class="sd">        Averages mass spectra over a scan range using Thermo&#39;s AverageScansInScanRange method</span>
</span><span id="ThermoBaseClass-630"><a href="#ThermoBaseClass-630"><span class="linenos"> 630</span></a><span class="sd">        or a scan list using Thermo&#39;s AverageScans method</span>
</span><span id="ThermoBaseClass-631"><a href="#ThermoBaseClass-631"><span class="linenos"> 631</span></a><span class="sd">        spectrum_mode: str</span>
</span><span id="ThermoBaseClass-632"><a href="#ThermoBaseClass-632"><span class="linenos"> 632</span></a><span class="sd">            centroid or profile mass spectrum</span>
</span><span id="ThermoBaseClass-633"><a href="#ThermoBaseClass-633"><span class="linenos"> 633</span></a><span class="sd">        auto_process: bool</span>
</span><span id="ThermoBaseClass-634"><a href="#ThermoBaseClass-634"><span class="linenos"> 634</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="ThermoBaseClass-635"><a href="#ThermoBaseClass-635"><span class="linenos"> 635</span></a><span class="sd">        ms_type: str</span>
</span><span id="ThermoBaseClass-636"><a href="#ThermoBaseClass-636"><span class="linenos"> 636</span></a><span class="sd">            String of form &#39;ms1&#39; or &#39;ms2&#39; or &#39;MS3&#39; etc. Valid up to MS10.</span>
</span><span id="ThermoBaseClass-637"><a href="#ThermoBaseClass-637"><span class="linenos"> 637</span></a><span class="sd">            Internal function converts to Thermo MSOrderType class.</span>
</span><span id="ThermoBaseClass-638"><a href="#ThermoBaseClass-638"><span class="linenos"> 638</span></a>
</span><span id="ThermoBaseClass-639"><a href="#ThermoBaseClass-639"><span class="linenos"> 639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-640"><a href="#ThermoBaseClass-640"><span class="linenos"> 640</span></a>
</span><span id="ThermoBaseClass-641"><a href="#ThermoBaseClass-641"><span class="linenos"> 641</span></a>        <span class="k">def</span> <span class="nf">get_profile_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="ThermoBaseClass-642"><a href="#ThermoBaseClass-642"><span class="linenos"> 642</span></a>            <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ThermoBaseClass-643"><a href="#ThermoBaseClass-643"><span class="linenos"> 643</span></a>            <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass-644"><a href="#ThermoBaseClass-644"><span class="linenos"> 644</span></a>
</span><span id="ThermoBaseClass-645"><a href="#ThermoBaseClass-645"><span class="linenos"> 645</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-646"><a href="#ThermoBaseClass-646"><span class="linenos"> 646</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass-647"><a href="#ThermoBaseClass-647"><span class="linenos"> 647</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass-648"><a href="#ThermoBaseClass-648"><span class="linenos"> 648</span></a>            <span class="p">}</span>
</span><span id="ThermoBaseClass-649"><a href="#ThermoBaseClass-649"><span class="linenos"> 649</span></a>
</span><span id="ThermoBaseClass-650"><a href="#ThermoBaseClass-650"><span class="linenos"> 650</span></a>            <span class="k">return</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="ThermoBaseClass-651"><a href="#ThermoBaseClass-651"><span class="linenos"> 651</span></a>
</span><span id="ThermoBaseClass-652"><a href="#ThermoBaseClass-652"><span class="linenos"> 652</span></a>        <span class="k">def</span> <span class="nf">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="ThermoBaseClass-653"><a href="#ThermoBaseClass-653"><span class="linenos"> 653</span></a>            <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ThermoBaseClass-654"><a href="#ThermoBaseClass-654"><span class="linenos"> 654</span></a>
</span><span id="ThermoBaseClass-655"><a href="#ThermoBaseClass-655"><span class="linenos"> 655</span></a>            <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ThermoBaseClass-656"><a href="#ThermoBaseClass-656"><span class="linenos"> 656</span></a>
</span><span id="ThermoBaseClass-657"><a href="#ThermoBaseClass-657"><span class="linenos"> 657</span></a>            <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ThermoBaseClass-658"><a href="#ThermoBaseClass-658"><span class="linenos"> 658</span></a>
</span><span id="ThermoBaseClass-659"><a href="#ThermoBaseClass-659"><span class="linenos"> 659</span></a>            <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass-660"><a href="#ThermoBaseClass-660"><span class="linenos"> 660</span></a>
</span><span id="ThermoBaseClass-661"><a href="#ThermoBaseClass-661"><span class="linenos"> 661</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ThermoBaseClass-662"><a href="#ThermoBaseClass-662"><span class="linenos"> 662</span></a>
</span><span id="ThermoBaseClass-663"><a href="#ThermoBaseClass-663"><span class="linenos"> 663</span></a>            <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ThermoBaseClass-664"><a href="#ThermoBaseClass-664"><span class="linenos"> 664</span></a>            <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ThermoBaseClass-665"><a href="#ThermoBaseClass-665"><span class="linenos"> 665</span></a>
</span><span id="ThermoBaseClass-666"><a href="#ThermoBaseClass-666"><span class="linenos"> 666</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass-667"><a href="#ThermoBaseClass-667"><span class="linenos"> 667</span></a>
</span><span id="ThermoBaseClass-668"><a href="#ThermoBaseClass-668"><span class="linenos"> 668</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass-669"><a href="#ThermoBaseClass-669"><span class="linenos"> 669</span></a>
</span><span id="ThermoBaseClass-670"><a href="#ThermoBaseClass-670"><span class="linenos"> 670</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-671"><a href="#ThermoBaseClass-671"><span class="linenos"> 671</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ThermoBaseClass-672"><a href="#ThermoBaseClass-672"><span class="linenos"> 672</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="ThermoBaseClass-673"><a href="#ThermoBaseClass-673"><span class="linenos"> 673</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ThermoBaseClass-674"><a href="#ThermoBaseClass-674"><span class="linenos"> 674</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ThermoBaseClass-675"><a href="#ThermoBaseClass-675"><span class="linenos"> 675</span></a>            <span class="p">}</span>
</span><span id="ThermoBaseClass-676"><a href="#ThermoBaseClass-676"><span class="linenos"> 676</span></a>
</span><span id="ThermoBaseClass-677"><a href="#ThermoBaseClass-677"><span class="linenos"> 677</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass-678"><a href="#ThermoBaseClass-678"><span class="linenos"> 678</span></a>
</span><span id="ThermoBaseClass-679"><a href="#ThermoBaseClass-679"><span class="linenos"> 679</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-680"><a href="#ThermoBaseClass-680"><span class="linenos"> 680</span></a>
</span><span id="ThermoBaseClass-681"><a href="#ThermoBaseClass-681"><span class="linenos"> 681</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ThermoBaseClass-682"><a href="#ThermoBaseClass-682"><span class="linenos"> 682</span></a>            <span class="n">firstScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ThermoBaseClass-683"><a href="#ThermoBaseClass-683"><span class="linenos"> 683</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-684"><a href="#ThermoBaseClass-684"><span class="linenos"> 684</span></a>
</span><span id="ThermoBaseClass-685"><a href="#ThermoBaseClass-685"><span class="linenos"> 685</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="ThermoBaseClass-686"><a href="#ThermoBaseClass-686"><span class="linenos"> 686</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass-687"><a href="#ThermoBaseClass-687"><span class="linenos"> 687</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass-688"><a href="#ThermoBaseClass-688"><span class="linenos"> 688</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="ThermoBaseClass-689"><a href="#ThermoBaseClass-689"><span class="linenos"> 689</span></a>
</span><span id="ThermoBaseClass-690"><a href="#ThermoBaseClass-690"><span class="linenos"> 690</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="ThermoBaseClass-691"><a href="#ThermoBaseClass-691"><span class="linenos"> 691</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="ThermoBaseClass-692"><a href="#ThermoBaseClass-692"><span class="linenos"> 692</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass-693"><a href="#ThermoBaseClass-693"><span class="linenos"> 693</span></a>
</span><span id="ThermoBaseClass-694"><a href="#ThermoBaseClass-694"><span class="linenos"> 694</span></a>        <span class="c1"># force it to only look for the MSType</span>
</span><span id="ThermoBaseClass-695"><a href="#ThermoBaseClass-695"><span class="linenos"> 695</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_msordertype</span><span class="p">(</span><span class="n">scanFilter</span><span class="p">,</span> <span class="n">ms_type</span><span class="p">)</span>
</span><span id="ThermoBaseClass-696"><a href="#ThermoBaseClass-696"><span class="linenos"> 696</span></a>
</span><span id="ThermoBaseClass-697"><a href="#ThermoBaseClass-697"><span class="linenos"> 697</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="ThermoBaseClass-698"><a href="#ThermoBaseClass-698"><span class="linenos"> 698</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScansInScanRange</span><span class="p">(</span>
</span><span id="ThermoBaseClass-699"><a href="#ThermoBaseClass-699"><span class="linenos"> 699</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">options</span>
</span><span id="ThermoBaseClass-700"><a href="#ThermoBaseClass-700"><span class="linenos"> 700</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass-701"><a href="#ThermoBaseClass-701"><span class="linenos"> 701</span></a>
</span><span id="ThermoBaseClass-702"><a href="#ThermoBaseClass-702"><span class="linenos"> 702</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="ThermoBaseClass-703"><a href="#ThermoBaseClass-703"><span class="linenos"> 703</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-704"><a href="#ThermoBaseClass-704"><span class="linenos"> 704</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="ThermoBaseClass-705"><a href="#ThermoBaseClass-705"><span class="linenos"> 705</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="ThermoBaseClass-706"><a href="#ThermoBaseClass-706"><span class="linenos"> 706</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass-707"><a href="#ThermoBaseClass-707"><span class="linenos"> 707</span></a>
</span><span id="ThermoBaseClass-708"><a href="#ThermoBaseClass-708"><span class="linenos"> 708</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-709"><a href="#ThermoBaseClass-709"><span class="linenos"> 709</span></a>
</span><span id="ThermoBaseClass-710"><a href="#ThermoBaseClass-710"><span class="linenos"> 710</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-711"><a href="#ThermoBaseClass-711"><span class="linenos"> 711</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="ThermoBaseClass-712"><a href="#ThermoBaseClass-712"><span class="linenos"> 712</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="ThermoBaseClass-713"><a href="#ThermoBaseClass-713"><span class="linenos"> 713</span></a>
</span><span id="ThermoBaseClass-714"><a href="#ThermoBaseClass-714"><span class="linenos"> 714</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-715"><a href="#ThermoBaseClass-715"><span class="linenos"> 715</span></a>
</span><span id="ThermoBaseClass-716"><a href="#ThermoBaseClass-716"><span class="linenos"> 716</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-717"><a href="#ThermoBaseClass-717"><span class="linenos"> 717</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass-718"><a href="#ThermoBaseClass-718"><span class="linenos"> 718</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="ThermoBaseClass-719"><a href="#ThermoBaseClass-719"><span class="linenos"> 719</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass-720"><a href="#ThermoBaseClass-720"><span class="linenos"> 720</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-721"><a href="#ThermoBaseClass-721"><span class="linenos"> 721</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-722"><a href="#ThermoBaseClass-722"><span class="linenos"> 722</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-723"><a href="#ThermoBaseClass-723"><span class="linenos"> 723</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-724"><a href="#ThermoBaseClass-724"><span class="linenos"> 724</span></a>
</span><span id="ThermoBaseClass-725"><a href="#ThermoBaseClass-725"><span class="linenos"> 725</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="ThermoBaseClass-726"><a href="#ThermoBaseClass-726"><span class="linenos"> 726</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span>
</span><span id="ThermoBaseClass-727"><a href="#ThermoBaseClass-727"><span class="linenos"> 727</span></a>
</span><span id="ThermoBaseClass-728"><a href="#ThermoBaseClass-728"><span class="linenos"> 728</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="ThermoBaseClass-729"><a href="#ThermoBaseClass-729"><span class="linenos"> 729</span></a>            <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">:</span>
</span><span id="ThermoBaseClass-730"><a href="#ThermoBaseClass-730"><span class="linenos"> 730</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass-731"><a href="#ThermoBaseClass-731"><span class="linenos"> 731</span></a>
</span><span id="ThermoBaseClass-732"><a href="#ThermoBaseClass-732"><span class="linenos"> 732</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="ThermoBaseClass-733"><a href="#ThermoBaseClass-733"><span class="linenos"> 733</span></a>
</span><span id="ThermoBaseClass-734"><a href="#ThermoBaseClass-734"><span class="linenos"> 734</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="ThermoBaseClass-735"><a href="#ThermoBaseClass-735"><span class="linenos"> 735</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-736"><a href="#ThermoBaseClass-736"><span class="linenos"> 736</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="ThermoBaseClass-737"><a href="#ThermoBaseClass-737"><span class="linenos"> 737</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="ThermoBaseClass-738"><a href="#ThermoBaseClass-738"><span class="linenos"> 738</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass-739"><a href="#ThermoBaseClass-739"><span class="linenos"> 739</span></a>
</span><span id="ThermoBaseClass-740"><a href="#ThermoBaseClass-740"><span class="linenos"> 740</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-741"><a href="#ThermoBaseClass-741"><span class="linenos"> 741</span></a>
</span><span id="ThermoBaseClass-742"><a href="#ThermoBaseClass-742"><span class="linenos"> 742</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass-743"><a href="#ThermoBaseClass-743"><span class="linenos"> 743</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="ThermoBaseClass-744"><a href="#ThermoBaseClass-744"><span class="linenos"> 744</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="ThermoBaseClass-745"><a href="#ThermoBaseClass-745"><span class="linenos"> 745</span></a>
</span><span id="ThermoBaseClass-746"><a href="#ThermoBaseClass-746"><span class="linenos"> 746</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-747"><a href="#ThermoBaseClass-747"><span class="linenos"> 747</span></a>
</span><span id="ThermoBaseClass-748"><a href="#ThermoBaseClass-748"><span class="linenos"> 748</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-749"><a href="#ThermoBaseClass-749"><span class="linenos"> 749</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass-750"><a href="#ThermoBaseClass-750"><span class="linenos"> 750</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="ThermoBaseClass-751"><a href="#ThermoBaseClass-751"><span class="linenos"> 751</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass-752"><a href="#ThermoBaseClass-752"><span class="linenos"> 752</span></a>
</span><span id="ThermoBaseClass-753"><a href="#ThermoBaseClass-753"><span class="linenos"> 753</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-754"><a href="#ThermoBaseClass-754"><span class="linenos"> 754</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-755"><a href="#ThermoBaseClass-755"><span class="linenos"> 755</span></a>
</span><span id="ThermoBaseClass-756"><a href="#ThermoBaseClass-756"><span class="linenos"> 756</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-757"><a href="#ThermoBaseClass-757"><span class="linenos"> 757</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-758"><a href="#ThermoBaseClass-758"><span class="linenos"> 758</span></a>
</span><span id="ThermoBaseClass-759"><a href="#ThermoBaseClass-759"><span class="linenos"> 759</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-760"><a href="#ThermoBaseClass-760"><span class="linenos"> 760</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scans must be a list intergers or a tuple if integers&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-761"><a href="#ThermoBaseClass-761"><span class="linenos"> 761</span></a>
</span><span id="ThermoBaseClass-762"><a href="#ThermoBaseClass-762"><span class="linenos"> 762</span></a>    <span class="k">def</span> <span class="nf">set_metadata</span><span class="p">(</span>
</span><span id="ThermoBaseClass-763"><a href="#ThermoBaseClass-763"><span class="linenos"> 763</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass-764"><a href="#ThermoBaseClass-764"><span class="linenos"> 764</span></a>        <span class="n">firstScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-765"><a href="#ThermoBaseClass-765"><span class="linenos"> 765</span></a>        <span class="n">lastScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-766"><a href="#ThermoBaseClass-766"><span class="linenos"> 766</span></a>        <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass-767"><a href="#ThermoBaseClass-767"><span class="linenos"> 767</span></a>        <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="ThermoBaseClass-768"><a href="#ThermoBaseClass-768"><span class="linenos"> 768</span></a>    <span class="p">):</span>
</span><span id="ThermoBaseClass-769"><a href="#ThermoBaseClass-769"><span class="linenos"> 769</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-770"><a href="#ThermoBaseClass-770"><span class="linenos"> 770</span></a><span class="sd">        Collect metadata to be ingested in the mass spectrum object</span>
</span><span id="ThermoBaseClass-771"><a href="#ThermoBaseClass-771"><span class="linenos"> 771</span></a>
</span><span id="ThermoBaseClass-772"><a href="#ThermoBaseClass-772"><span class="linenos"> 772</span></a><span class="sd">        scans_list: list[int] or false</span>
</span><span id="ThermoBaseClass-773"><a href="#ThermoBaseClass-773"><span class="linenos"> 773</span></a><span class="sd">        lastScanNumber: int</span>
</span><span id="ThermoBaseClass-774"><a href="#ThermoBaseClass-774"><span class="linenos"> 774</span></a><span class="sd">        firstScanNumber: int</span>
</span><span id="ThermoBaseClass-775"><a href="#ThermoBaseClass-775"><span class="linenos"> 775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-776"><a href="#ThermoBaseClass-776"><span class="linenos"> 776</span></a>
</span><span id="ThermoBaseClass-777"><a href="#ThermoBaseClass-777"><span class="linenos"> 777</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="n">default_parameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ThermoBaseClass-778"><a href="#ThermoBaseClass-778"><span class="linenos"> 778</span></a>
</span><span id="ThermoBaseClass-779"><a href="#ThermoBaseClass-779"><span class="linenos"> 779</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="ThermoBaseClass-780"><a href="#ThermoBaseClass-780"><span class="linenos"> 780</span></a>
</span><span id="ThermoBaseClass-781"><a href="#ThermoBaseClass-781"><span class="linenos"> 781</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="ThermoBaseClass-782"><a href="#ThermoBaseClass-782"><span class="linenos"> 782</span></a>
</span><span id="ThermoBaseClass-783"><a href="#ThermoBaseClass-783"><span class="linenos"> 783</span></a>        <span class="k">if</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="ThermoBaseClass-784"><a href="#ThermoBaseClass-784"><span class="linenos"> 784</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scans_list</span>
</span><span id="ThermoBaseClass-785"><a href="#ThermoBaseClass-785"><span class="linenos"> 785</span></a>
</span><span id="ThermoBaseClass-786"><a href="#ThermoBaseClass-786"><span class="linenos"> 786</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">scans_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ThermoBaseClass-787"><a href="#ThermoBaseClass-787"><span class="linenos"> 787</span></a>
</span><span id="ThermoBaseClass-788"><a href="#ThermoBaseClass-788"><span class="linenos"> 788</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-789"><a href="#ThermoBaseClass-789"><span class="linenos"> 789</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">)</span>
</span><span id="ThermoBaseClass-790"><a href="#ThermoBaseClass-790"><span class="linenos"> 790</span></a>
</span><span id="ThermoBaseClass-791"><a href="#ThermoBaseClass-791"><span class="linenos"> 791</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">)</span>
</span><span id="ThermoBaseClass-792"><a href="#ThermoBaseClass-792"><span class="linenos"> 792</span></a>
</span><span id="ThermoBaseClass-793"><a href="#ThermoBaseClass-793"><span class="linenos"> 793</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;analyzer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Model</span>
</span><span id="ThermoBaseClass-794"><a href="#ThermoBaseClass-794"><span class="linenos"> 794</span></a>
</span><span id="ThermoBaseClass-795"><a href="#ThermoBaseClass-795"><span class="linenos"> 795</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;acquisition_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_creation_time</span><span class="p">()</span>
</span><span id="ThermoBaseClass-796"><a href="#ThermoBaseClass-796"><span class="linenos"> 796</span></a>
</span><span id="ThermoBaseClass-797"><a href="#ThermoBaseClass-797"><span class="linenos"> 797</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;instrument_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>
</span><span id="ThermoBaseClass-798"><a href="#ThermoBaseClass-798"><span class="linenos"> 798</span></a>
</span><span id="ThermoBaseClass-799"><a href="#ThermoBaseClass-799"><span class="linenos"> 799</span></a>        <span class="k">return</span> <span class="n">d_params</span>
</span><span id="ThermoBaseClass-800"><a href="#ThermoBaseClass-800"><span class="linenos"> 800</span></a>
</span><span id="ThermoBaseClass-801"><a href="#ThermoBaseClass-801"><span class="linenos"> 801</span></a>    <span class="k">def</span> <span class="nf">get_instrument_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse_strings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="ThermoBaseClass-802"><a href="#ThermoBaseClass-802"><span class="linenos"> 802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-803"><a href="#ThermoBaseClass-803"><span class="linenos"> 803</span></a><span class="sd">        This function will extract the instrument methods embedded in the raw file</span>
</span><span id="ThermoBaseClass-804"><a href="#ThermoBaseClass-804"><span class="linenos"> 804</span></a>
</span><span id="ThermoBaseClass-805"><a href="#ThermoBaseClass-805"><span class="linenos"> 805</span></a><span class="sd">        First it will check if there are any instrument methods, if not returning None</span>
</span><span id="ThermoBaseClass-806"><a href="#ThermoBaseClass-806"><span class="linenos"> 806</span></a><span class="sd">        Then it will get the total number of instrument methods.</span>
</span><span id="ThermoBaseClass-807"><a href="#ThermoBaseClass-807"><span class="linenos"> 807</span></a><span class="sd">        For each method, it will extract the plaintext string of the method and attempt to parse it into a dictionary</span>
</span><span id="ThermoBaseClass-808"><a href="#ThermoBaseClass-808"><span class="linenos"> 808</span></a><span class="sd">        If this fails, it will return just the string object.</span>
</span><span id="ThermoBaseClass-809"><a href="#ThermoBaseClass-809"><span class="linenos"> 809</span></a>
</span><span id="ThermoBaseClass-810"><a href="#ThermoBaseClass-810"><span class="linenos"> 810</span></a><span class="sd">        This has been tested on data from an Orbitrap ID-X with embedded MS and LC methods, but other instrument types may fail.</span>
</span><span id="ThermoBaseClass-811"><a href="#ThermoBaseClass-811"><span class="linenos"> 811</span></a>
</span><span id="ThermoBaseClass-812"><a href="#ThermoBaseClass-812"><span class="linenos"> 812</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-813"><a href="#ThermoBaseClass-813"><span class="linenos"> 813</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-814"><a href="#ThermoBaseClass-814"><span class="linenos"> 814</span></a><span class="sd">        parse_strings: bool</span>
</span><span id="ThermoBaseClass-815"><a href="#ThermoBaseClass-815"><span class="linenos"> 815</span></a><span class="sd">            If True, will attempt to parse the instrument methods into a dictionary. If False, will return the raw string.</span>
</span><span id="ThermoBaseClass-816"><a href="#ThermoBaseClass-816"><span class="linenos"> 816</span></a>
</span><span id="ThermoBaseClass-817"><a href="#ThermoBaseClass-817"><span class="linenos"> 817</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-818"><a href="#ThermoBaseClass-818"><span class="linenos"> 818</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-819"><a href="#ThermoBaseClass-819"><span class="linenos"> 819</span></a><span class="sd">        List[Dict[str, Any]] or List</span>
</span><span id="ThermoBaseClass-820"><a href="#ThermoBaseClass-820"><span class="linenos"> 820</span></a><span class="sd">            A list of dictionaries containing the instrument methods, or a list of strings if parsing fails.</span>
</span><span id="ThermoBaseClass-821"><a href="#ThermoBaseClass-821"><span class="linenos"> 821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-822"><a href="#ThermoBaseClass-822"><span class="linenos"> 822</span></a>
</span><span id="ThermoBaseClass-823"><a href="#ThermoBaseClass-823"><span class="linenos"> 823</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">HasInstrumentMethod</span><span class="p">:</span>
</span><span id="ThermoBaseClass-824"><a href="#ThermoBaseClass-824"><span class="linenos"> 824</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass-825"><a href="#ThermoBaseClass-825"><span class="linenos"> 825</span></a>                <span class="s2">&quot;Raw Data file does not have any instrument methods attached&quot;</span>
</span><span id="ThermoBaseClass-826"><a href="#ThermoBaseClass-826"><span class="linenos"> 826</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass-827"><a href="#ThermoBaseClass-827"><span class="linenos"> 827</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-828"><a href="#ThermoBaseClass-828"><span class="linenos"> 828</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-829"><a href="#ThermoBaseClass-829"><span class="linenos"> 829</span></a>
</span><span id="ThermoBaseClass-830"><a href="#ThermoBaseClass-830"><span class="linenos"> 830</span></a>            <span class="k">def</span> <span class="nf">parse_instrument_method</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="ThermoBaseClass-831"><a href="#ThermoBaseClass-831"><span class="linenos"> 831</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-832"><a href="#ThermoBaseClass-832"><span class="linenos"> 832</span></a>                <span class="n">method</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-833"><a href="#ThermoBaseClass-833"><span class="linenos"> 833</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-834"><a href="#ThermoBaseClass-834"><span class="linenos"> 834</span></a>                <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-835"><a href="#ThermoBaseClass-835"><span class="linenos"> 835</span></a>
</span><span id="ThermoBaseClass-836"><a href="#ThermoBaseClass-836"><span class="linenos"> 836</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="ThermoBaseClass-837"><a href="#ThermoBaseClass-837"><span class="linenos"> 837</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>  <span class="c1"># Skip empty lines</span>
</span><span id="ThermoBaseClass-838"><a href="#ThermoBaseClass-838"><span class="linenos"> 838</span></a>                        <span class="k">continue</span>
</span><span id="ThermoBaseClass-839"><a href="#ThermoBaseClass-839"><span class="linenos"> 839</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-840"><a href="#ThermoBaseClass-840"><span class="linenos"> 840</span></a>                        <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-841"><a href="#ThermoBaseClass-841"><span class="linenos"> 841</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Settings&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-842"><a href="#ThermoBaseClass-842"><span class="linenos"> 842</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Summary&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-843"><a href="#ThermoBaseClass-843"><span class="linenos"> 843</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-844"><a href="#ThermoBaseClass-844"><span class="linenos"> 844</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Scan Event&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-845"><a href="#ThermoBaseClass-845"><span class="linenos"> 845</span></a>                    <span class="p">):</span>
</span><span id="ThermoBaseClass-846"><a href="#ThermoBaseClass-846"><span class="linenos"> 846</span></a>                        <span class="n">current_section</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-847"><a href="#ThermoBaseClass-847"><span class="linenos"> 847</span></a>                        <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-848"><a href="#ThermoBaseClass-848"><span class="linenos"> 848</span></a>                        <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-849"><a href="#ThermoBaseClass-849"><span class="linenos"> 849</span></a>                    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">):</span>
</span><span id="ThermoBaseClass-850"><a href="#ThermoBaseClass-850"><span class="linenos"> 850</span></a>                        <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="ThermoBaseClass-851"><a href="#ThermoBaseClass-851"><span class="linenos"> 851</span></a>                            <span class="n">indent_level</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-852"><a href="#ThermoBaseClass-852"><span class="linenos"> 852</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-853"><a href="#ThermoBaseClass-853"><span class="linenos"> 853</span></a>
</span><span id="ThermoBaseClass-854"><a href="#ThermoBaseClass-854"><span class="linenos"> 854</span></a>                            <span class="k">if</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ThermoBaseClass-855"><a href="#ThermoBaseClass-855"><span class="linenos"> 855</span></a>                                <span class="k">if</span> <span class="n">sub_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass-856"><a href="#ThermoBaseClass-856"><span class="linenos"> 856</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-857"><a href="#ThermoBaseClass-857"><span class="linenos"> 857</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-858"><a href="#ThermoBaseClass-858"><span class="linenos"> 858</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass-859"><a href="#ThermoBaseClass-859"><span class="linenos"> 859</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass-860"><a href="#ThermoBaseClass-860"><span class="linenos"> 860</span></a>                                    <span class="p">)</span>
</span><span id="ThermoBaseClass-861"><a href="#ThermoBaseClass-861"><span class="linenos"> 861</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span>
</span><span id="ThermoBaseClass-862"><a href="#ThermoBaseClass-862"><span class="linenos"> 862</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-863"><a href="#ThermoBaseClass-863"><span class="linenos"> 863</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-864"><a href="#ThermoBaseClass-864"><span class="linenos"> 864</span></a>                            <span class="k">elif</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="ThermoBaseClass-865"><a href="#ThermoBaseClass-865"><span class="linenos"> 865</span></a>                                <span class="n">scan_type</span><span class="p">,</span> <span class="n">key_value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-866"><a href="#ThermoBaseClass-866"><span class="linenos"> 866</span></a>                                    <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-867"><a href="#ThermoBaseClass-867"><span class="linenos"> 867</span></a>                                    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass-868"><a href="#ThermoBaseClass-868"><span class="linenos"> 868</span></a>                                    <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass-869"><a href="#ThermoBaseClass-869"><span class="linenos"> 869</span></a>                                <span class="p">)</span>
</span><span id="ThermoBaseClass-870"><a href="#ThermoBaseClass-870"><span class="linenos"> 870</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
</span><span id="ThermoBaseClass-871"><a href="#ThermoBaseClass-871"><span class="linenos"> 871</span></a>                                    <span class="n">sub_section</span><span class="p">,</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-872"><a href="#ThermoBaseClass-872"><span class="linenos"> 872</span></a>                                <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">scan_type</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="ThermoBaseClass-873"><a href="#ThermoBaseClass-873"><span class="linenos"> 873</span></a>
</span><span id="ThermoBaseClass-874"><a href="#ThermoBaseClass-874"><span class="linenos"> 874</span></a>                                <span class="k">if</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="ThermoBaseClass-875"><a href="#ThermoBaseClass-875"><span class="linenos"> 875</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-876"><a href="#ThermoBaseClass-876"><span class="linenos"> 876</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-877"><a href="#ThermoBaseClass-877"><span class="linenos"> 877</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass-878"><a href="#ThermoBaseClass-878"><span class="linenos"> 878</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass-879"><a href="#ThermoBaseClass-879"><span class="linenos"> 879</span></a>                                    <span class="p">)</span>
</span><span id="ThermoBaseClass-880"><a href="#ThermoBaseClass-880"><span class="linenos"> 880</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span><span class="n">scan_type</span><span class="p">][</span>
</span><span id="ThermoBaseClass-881"><a href="#ThermoBaseClass-881"><span class="linenos"> 881</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-882"><a href="#ThermoBaseClass-882"><span class="linenos"> 882</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-883"><a href="#ThermoBaseClass-883"><span class="linenos"> 883</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-884"><a href="#ThermoBaseClass-884"><span class="linenos"> 884</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-885"><a href="#ThermoBaseClass-885"><span class="linenos"> 885</span></a>                            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="ThermoBaseClass-886"><a href="#ThermoBaseClass-886"><span class="linenos"> 886</span></a>                                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-887"><a href="#ThermoBaseClass-887"><span class="linenos"> 887</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-888"><a href="#ThermoBaseClass-888"><span class="linenos"> 888</span></a>                                    <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-889"><a href="#ThermoBaseClass-889"><span class="linenos"> 889</span></a>                                <span class="p">)</span>
</span><span id="ThermoBaseClass-890"><a href="#ThermoBaseClass-890"><span class="linenos"> 890</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-891"><a href="#ThermoBaseClass-891"><span class="linenos"> 891</span></a>                                <span class="n">sub_section</span> <span class="o">=</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass-892"><a href="#ThermoBaseClass-892"><span class="linenos"> 892</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-893"><a href="#ThermoBaseClass-893"><span class="linenos"> 893</span></a>                        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="ThermoBaseClass-894"><a href="#ThermoBaseClass-894"><span class="linenos"> 894</span></a>                            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass-895"><a href="#ThermoBaseClass-895"><span class="linenos"> 895</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-896"><a href="#ThermoBaseClass-896"><span class="linenos"> 896</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-897"><a href="#ThermoBaseClass-897"><span class="linenos"> 897</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-898"><a href="#ThermoBaseClass-898"><span class="linenos"> 898</span></a>
</span><span id="ThermoBaseClass-899"><a href="#ThermoBaseClass-899"><span class="linenos"> 899</span></a>                <span class="k">return</span> <span class="n">method</span>
</span><span id="ThermoBaseClass-900"><a href="#ThermoBaseClass-900"><span class="linenos"> 900</span></a>
</span><span id="ThermoBaseClass-901"><a href="#ThermoBaseClass-901"><span class="linenos"> 901</span></a>            <span class="n">count_instrument_methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">InstrumentMethodsCount</span>
</span><span id="ThermoBaseClass-902"><a href="#ThermoBaseClass-902"><span class="linenos"> 902</span></a>            <span class="c1"># TODO make this code better...</span>
</span><span id="ThermoBaseClass-903"><a href="#ThermoBaseClass-903"><span class="linenos"> 903</span></a>            <span class="n">instrument_methods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass-904"><a href="#ThermoBaseClass-904"><span class="linenos"> 904</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count_instrument_methods</span><span class="p">):</span>
</span><span id="ThermoBaseClass-905"><a href="#ThermoBaseClass-905"><span class="linenos"> 905</span></a>                <span class="n">instrument_method_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentMethod</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ThermoBaseClass-906"><a href="#ThermoBaseClass-906"><span class="linenos"> 906</span></a>                <span class="k">if</span> <span class="n">parse_strings</span><span class="p">:</span>
</span><span id="ThermoBaseClass-907"><a href="#ThermoBaseClass-907"><span class="linenos"> 907</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="ThermoBaseClass-908"><a href="#ThermoBaseClass-908"><span class="linenos"> 908</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">parse_instrument_method</span><span class="p">(</span>
</span><span id="ThermoBaseClass-909"><a href="#ThermoBaseClass-909"><span class="linenos"> 909</span></a>                            <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass-910"><a href="#ThermoBaseClass-910"><span class="linenos"> 910</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass-911"><a href="#ThermoBaseClass-911"><span class="linenos"> 911</span></a>                    <span class="k">except</span><span class="p">:</span>  <span class="c1"># if it fails for any reason</span>
</span><span id="ThermoBaseClass-912"><a href="#ThermoBaseClass-912"><span class="linenos"> 912</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass-913"><a href="#ThermoBaseClass-913"><span class="linenos"> 913</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-914"><a href="#ThermoBaseClass-914"><span class="linenos"> 914</span></a>                    <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass-915"><a href="#ThermoBaseClass-915"><span class="linenos"> 915</span></a>                <span class="n">instrument_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument_method_dict</span><span class="p">)</span>
</span><span id="ThermoBaseClass-916"><a href="#ThermoBaseClass-916"><span class="linenos"> 916</span></a>            <span class="k">return</span> <span class="n">instrument_methods</span>
</span><span id="ThermoBaseClass-917"><a href="#ThermoBaseClass-917"><span class="linenos"> 917</span></a>
</span><span id="ThermoBaseClass-918"><a href="#ThermoBaseClass-918"><span class="linenos"> 918</span></a>    <span class="k">def</span> <span class="nf">get_tune_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass-919"><a href="#ThermoBaseClass-919"><span class="linenos"> 919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-920"><a href="#ThermoBaseClass-920"><span class="linenos"> 920</span></a><span class="sd">        This code will extract the tune method from the raw file</span>
</span><span id="ThermoBaseClass-921"><a href="#ThermoBaseClass-921"><span class="linenos"> 921</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="ThermoBaseClass-922"><a href="#ThermoBaseClass-922"><span class="linenos"> 922</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="ThermoBaseClass-923"><a href="#ThermoBaseClass-923"><span class="linenos"> 923</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="ThermoBaseClass-924"><a href="#ThermoBaseClass-924"><span class="linenos"> 924</span></a>
</span><span id="ThermoBaseClass-925"><a href="#ThermoBaseClass-925"><span class="linenos"> 925</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-926"><a href="#ThermoBaseClass-926"><span class="linenos"> 926</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-927"><a href="#ThermoBaseClass-927"><span class="linenos"> 927</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass-928"><a href="#ThermoBaseClass-928"><span class="linenos"> 928</span></a><span class="sd">            A dictionary containing the tune method information</span>
</span><span id="ThermoBaseClass-929"><a href="#ThermoBaseClass-929"><span class="linenos"> 929</span></a>
</span><span id="ThermoBaseClass-930"><a href="#ThermoBaseClass-930"><span class="linenos"> 930</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass-931"><a href="#ThermoBaseClass-931"><span class="linenos"> 931</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass-932"><a href="#ThermoBaseClass-932"><span class="linenos"> 932</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass-933"><a href="#ThermoBaseClass-933"><span class="linenos"> 933</span></a><span class="sd">            If no tune methods are found in the raw file</span>
</span><span id="ThermoBaseClass-934"><a href="#ThermoBaseClass-934"><span class="linenos"> 934</span></a>
</span><span id="ThermoBaseClass-935"><a href="#ThermoBaseClass-935"><span class="linenos"> 935</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-936"><a href="#ThermoBaseClass-936"><span class="linenos"> 936</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneDataCount</span><span class="p">()</span>
</span><span id="ThermoBaseClass-937"><a href="#ThermoBaseClass-937"><span class="linenos"> 937</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-938"><a href="#ThermoBaseClass-938"><span class="linenos"> 938</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No tune methods found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-939"><a href="#ThermoBaseClass-939"><span class="linenos"> 939</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-940"><a href="#ThermoBaseClass-940"><span class="linenos"> 940</span></a>        <span class="k">elif</span> <span class="n">tunemethodcount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ThermoBaseClass-941"><a href="#ThermoBaseClass-941"><span class="linenos"> 941</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass-942"><a href="#ThermoBaseClass-942"><span class="linenos"> 942</span></a>                <span class="s2">&quot;Multiple tune methods found in the raw data file, returning the 1st&quot;</span>
</span><span id="ThermoBaseClass-943"><a href="#ThermoBaseClass-943"><span class="linenos"> 943</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass-944"><a href="#ThermoBaseClass-944"><span class="linenos"> 944</span></a>
</span><span id="ThermoBaseClass-945"><a href="#ThermoBaseClass-945"><span class="linenos"> 945</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneData</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ThermoBaseClass-946"><a href="#ThermoBaseClass-946"><span class="linenos"> 946</span></a>
</span><span id="ThermoBaseClass-947"><a href="#ThermoBaseClass-947"><span class="linenos"> 947</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-948"><a href="#ThermoBaseClass-948"><span class="linenos"> 948</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-949"><a href="#ThermoBaseClass-949"><span class="linenos"> 949</span></a>
</span><span id="ThermoBaseClass-950"><a href="#ThermoBaseClass-950"><span class="linenos"> 950</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass-951"><a href="#ThermoBaseClass-951"><span class="linenos"> 951</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass-952"><a href="#ThermoBaseClass-952"><span class="linenos"> 952</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass-953"><a href="#ThermoBaseClass-953"><span class="linenos"> 953</span></a>
</span><span id="ThermoBaseClass-954"><a href="#ThermoBaseClass-954"><span class="linenos"> 954</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="ThermoBaseClass-955"><a href="#ThermoBaseClass-955"><span class="linenos"> 955</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-956"><a href="#ThermoBaseClass-956"><span class="linenos"> 956</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-957"><a href="#ThermoBaseClass-957"><span class="linenos"> 957</span></a>            <span class="p">):</span>
</span><span id="ThermoBaseClass-958"><a href="#ThermoBaseClass-958"><span class="linenos"> 958</span></a>                <span class="c1"># This is a section header</span>
</span><span id="ThermoBaseClass-959"><a href="#ThermoBaseClass-959"><span class="linenos"> 959</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-960"><a href="#ThermoBaseClass-960"><span class="linenos"> 960</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-961"><a href="#ThermoBaseClass-961"><span class="linenos"> 961</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="ThermoBaseClass-962"><a href="#ThermoBaseClass-962"><span class="linenos"> 962</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-963"><a href="#ThermoBaseClass-963"><span class="linenos"> 963</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="ThermoBaseClass-964"><a href="#ThermoBaseClass-964"><span class="linenos"> 964</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-965"><a href="#ThermoBaseClass-965"><span class="linenos"> 965</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass-966"><a href="#ThermoBaseClass-966"><span class="linenos"> 966</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass-967"><a href="#ThermoBaseClass-967"><span class="linenos"> 967</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-968"><a href="#ThermoBaseClass-968"><span class="linenos"> 968</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass-969"><a href="#ThermoBaseClass-969"><span class="linenos"> 969</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="ThermoBaseClass-970"><a href="#ThermoBaseClass-970"><span class="linenos"> 970</span></a>
</span><span id="ThermoBaseClass-971"><a href="#ThermoBaseClass-971"><span class="linenos"> 971</span></a>    <span class="k">def</span> <span class="nf">get_status_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retention_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="ThermoBaseClass-972"><a href="#ThermoBaseClass-972"><span class="linenos"> 972</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-973"><a href="#ThermoBaseClass-973"><span class="linenos"> 973</span></a><span class="sd">        This code will extract the status logs from the raw file</span>
</span><span id="ThermoBaseClass-974"><a href="#ThermoBaseClass-974"><span class="linenos"> 974</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="ThermoBaseClass-975"><a href="#ThermoBaseClass-975"><span class="linenos"> 975</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="ThermoBaseClass-976"><a href="#ThermoBaseClass-976"><span class="linenos"> 976</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="ThermoBaseClass-977"><a href="#ThermoBaseClass-977"><span class="linenos"> 977</span></a>
</span><span id="ThermoBaseClass-978"><a href="#ThermoBaseClass-978"><span class="linenos"> 978</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass-979"><a href="#ThermoBaseClass-979"><span class="linenos"> 979</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass-980"><a href="#ThermoBaseClass-980"><span class="linenos"> 980</span></a><span class="sd">        retention_time: float</span>
</span><span id="ThermoBaseClass-981"><a href="#ThermoBaseClass-981"><span class="linenos"> 981</span></a><span class="sd">            The retention time in minutes to extract the status log data from.</span>
</span><span id="ThermoBaseClass-982"><a href="#ThermoBaseClass-982"><span class="linenos"> 982</span></a><span class="sd">            Will use the closest retention time found. Default 0.</span>
</span><span id="ThermoBaseClass-983"><a href="#ThermoBaseClass-983"><span class="linenos"> 983</span></a>
</span><span id="ThermoBaseClass-984"><a href="#ThermoBaseClass-984"><span class="linenos"> 984</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-985"><a href="#ThermoBaseClass-985"><span class="linenos"> 985</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-986"><a href="#ThermoBaseClass-986"><span class="linenos"> 986</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass-987"><a href="#ThermoBaseClass-987"><span class="linenos"> 987</span></a><span class="sd">            A dictionary containing the status log information</span>
</span><span id="ThermoBaseClass-988"><a href="#ThermoBaseClass-988"><span class="linenos"> 988</span></a>
</span><span id="ThermoBaseClass-989"><a href="#ThermoBaseClass-989"><span class="linenos"> 989</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass-990"><a href="#ThermoBaseClass-990"><span class="linenos"> 990</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass-991"><a href="#ThermoBaseClass-991"><span class="linenos"> 991</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass-992"><a href="#ThermoBaseClass-992"><span class="linenos"> 992</span></a><span class="sd">            If no status logs are found in the raw file</span>
</span><span id="ThermoBaseClass-993"><a href="#ThermoBaseClass-993"><span class="linenos"> 993</span></a>
</span><span id="ThermoBaseClass-994"><a href="#ThermoBaseClass-994"><span class="linenos"> 994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-995"><a href="#ThermoBaseClass-995"><span class="linenos"> 995</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogEntriesCount</span><span class="p">()</span>
</span><span id="ThermoBaseClass-996"><a href="#ThermoBaseClass-996"><span class="linenos"> 996</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-997"><a href="#ThermoBaseClass-997"><span class="linenos"> 997</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No status logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-998"><a href="#ThermoBaseClass-998"><span class="linenos"> 998</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-999"><a href="#ThermoBaseClass-999"><span class="linenos"> 999</span></a>
</span><span id="ThermoBaseClass-1000"><a href="#ThermoBaseClass-1000"><span class="linenos">1000</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogForRetentionTime</span><span class="p">(</span><span class="n">retention_time</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1001"><a href="#ThermoBaseClass-1001"><span class="linenos">1001</span></a>
</span><span id="ThermoBaseClass-1002"><a href="#ThermoBaseClass-1002"><span class="linenos">1002</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-1003"><a href="#ThermoBaseClass-1003"><span class="linenos">1003</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-1004"><a href="#ThermoBaseClass-1004"><span class="linenos">1004</span></a>
</span><span id="ThermoBaseClass-1005"><a href="#ThermoBaseClass-1005"><span class="linenos">1005</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1006"><a href="#ThermoBaseClass-1006"><span class="linenos">1006</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass-1007"><a href="#ThermoBaseClass-1007"><span class="linenos">1007</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass-1008"><a href="#ThermoBaseClass-1008"><span class="linenos">1008</span></a>
</span><span id="ThermoBaseClass-1009"><a href="#ThermoBaseClass-1009"><span class="linenos">1009</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="ThermoBaseClass-1010"><a href="#ThermoBaseClass-1010"><span class="linenos">1010</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-1011"><a href="#ThermoBaseClass-1011"><span class="linenos">1011</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1012"><a href="#ThermoBaseClass-1012"><span class="linenos">1012</span></a>            <span class="p">):</span>
</span><span id="ThermoBaseClass-1013"><a href="#ThermoBaseClass-1013"><span class="linenos">1013</span></a>                <span class="c1"># This is a section header</span>
</span><span id="ThermoBaseClass-1014"><a href="#ThermoBaseClass-1014"><span class="linenos">1014</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass-1015"><a href="#ThermoBaseClass-1015"><span class="linenos">1015</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass-1016"><a href="#ThermoBaseClass-1016"><span class="linenos">1016</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="ThermoBaseClass-1017"><a href="#ThermoBaseClass-1017"><span class="linenos">1017</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-1018"><a href="#ThermoBaseClass-1018"><span class="linenos">1018</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="ThermoBaseClass-1019"><a href="#ThermoBaseClass-1019"><span class="linenos">1019</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1020"><a href="#ThermoBaseClass-1020"><span class="linenos">1020</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1021"><a href="#ThermoBaseClass-1021"><span class="linenos">1021</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass-1022"><a href="#ThermoBaseClass-1022"><span class="linenos">1022</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1023"><a href="#ThermoBaseClass-1023"><span class="linenos">1023</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass-1024"><a href="#ThermoBaseClass-1024"><span class="linenos">1024</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span><span id="ThermoBaseClass-1025"><a href="#ThermoBaseClass-1025"><span class="linenos">1025</span></a>
</span><span id="ThermoBaseClass-1026"><a href="#ThermoBaseClass-1026"><span class="linenos">1026</span></a>    <span class="k">def</span> <span class="nf">get_error_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1027"><a href="#ThermoBaseClass-1027"><span class="linenos">1027</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1028"><a href="#ThermoBaseClass-1028"><span class="linenos">1028</span></a><span class="sd">        This code will extract the error logs from the raw file</span>
</span><span id="ThermoBaseClass-1029"><a href="#ThermoBaseClass-1029"><span class="linenos">1029</span></a>
</span><span id="ThermoBaseClass-1030"><a href="#ThermoBaseClass-1030"><span class="linenos">1030</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-1031"><a href="#ThermoBaseClass-1031"><span class="linenos">1031</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-1032"><a href="#ThermoBaseClass-1032"><span class="linenos">1032</span></a><span class="sd">        Dict[float, str]</span>
</span><span id="ThermoBaseClass-1033"><a href="#ThermoBaseClass-1033"><span class="linenos">1033</span></a><span class="sd">            A dictionary containing the error log information with the retention time as the key</span>
</span><span id="ThermoBaseClass-1034"><a href="#ThermoBaseClass-1034"><span class="linenos">1034</span></a>
</span><span id="ThermoBaseClass-1035"><a href="#ThermoBaseClass-1035"><span class="linenos">1035</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass-1036"><a href="#ThermoBaseClass-1036"><span class="linenos">1036</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass-1037"><a href="#ThermoBaseClass-1037"><span class="linenos">1037</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass-1038"><a href="#ThermoBaseClass-1038"><span class="linenos">1038</span></a><span class="sd">            If no error logs are found in the raw file</span>
</span><span id="ThermoBaseClass-1039"><a href="#ThermoBaseClass-1039"><span class="linenos">1039</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1040"><a href="#ThermoBaseClass-1040"><span class="linenos">1040</span></a>
</span><span id="ThermoBaseClass-1041"><a href="#ThermoBaseClass-1041"><span class="linenos">1041</span></a>        <span class="n">error_log_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">ErrorLogCount</span>
</span><span id="ThermoBaseClass-1042"><a href="#ThermoBaseClass-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="n">error_log_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1043"><a href="#ThermoBaseClass-1043"><span class="linenos">1043</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No error logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1044"><a href="#ThermoBaseClass-1044"><span class="linenos">1044</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass-1045"><a href="#ThermoBaseClass-1045"><span class="linenos">1045</span></a>
</span><span id="ThermoBaseClass-1046"><a href="#ThermoBaseClass-1046"><span class="linenos">1046</span></a>        <span class="n">error_logs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-1047"><a href="#ThermoBaseClass-1047"><span class="linenos">1047</span></a>
</span><span id="ThermoBaseClass-1048"><a href="#ThermoBaseClass-1048"><span class="linenos">1048</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">error_log_count</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1049"><a href="#ThermoBaseClass-1049"><span class="linenos">1049</span></a>            <span class="n">error_log_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetErrorLogItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1050"><a href="#ThermoBaseClass-1050"><span class="linenos">1050</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">RetentionTime</span>
</span><span id="ThermoBaseClass-1051"><a href="#ThermoBaseClass-1051"><span class="linenos">1051</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">Message</span>
</span><span id="ThermoBaseClass-1052"><a href="#ThermoBaseClass-1052"><span class="linenos">1052</span></a>            <span class="c1"># Use the index `i` as the unique ID key</span>
</span><span id="ThermoBaseClass-1053"><a href="#ThermoBaseClass-1053"><span class="linenos">1053</span></a>            <span class="n">error_logs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">:</span> <span class="n">rt</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">}</span>
</span><span id="ThermoBaseClass-1054"><a href="#ThermoBaseClass-1054"><span class="linenos">1054</span></a>        <span class="k">return</span> <span class="n">error_logs</span>
</span><span id="ThermoBaseClass-1055"><a href="#ThermoBaseClass-1055"><span class="linenos">1055</span></a>
</span><span id="ThermoBaseClass-1056"><a href="#ThermoBaseClass-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">get_sample_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1057"><a href="#ThermoBaseClass-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1058"><a href="#ThermoBaseClass-1058"><span class="linenos">1058</span></a><span class="sd">        This code will extract the sample information from the raw file</span>
</span><span id="ThermoBaseClass-1059"><a href="#ThermoBaseClass-1059"><span class="linenos">1059</span></a>
</span><span id="ThermoBaseClass-1060"><a href="#ThermoBaseClass-1060"><span class="linenos">1060</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-1061"><a href="#ThermoBaseClass-1061"><span class="linenos">1061</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-1062"><a href="#ThermoBaseClass-1062"><span class="linenos">1062</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass-1063"><a href="#ThermoBaseClass-1063"><span class="linenos">1063</span></a><span class="sd">            A dictionary containing the sample information</span>
</span><span id="ThermoBaseClass-1064"><a href="#ThermoBaseClass-1064"><span class="linenos">1064</span></a><span class="sd">            Note that UserText field may not be handled properly and may need further processing</span>
</span><span id="ThermoBaseClass-1065"><a href="#ThermoBaseClass-1065"><span class="linenos">1065</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1066"><a href="#ThermoBaseClass-1066"><span class="linenos">1066</span></a>        <span class="n">sminfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SampleInformation</span>
</span><span id="ThermoBaseClass-1067"><a href="#ThermoBaseClass-1067"><span class="linenos">1067</span></a>        <span class="n">smdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-1068"><a href="#ThermoBaseClass-1068"><span class="linenos">1068</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Comment</span>
</span><span id="ThermoBaseClass-1069"><a href="#ThermoBaseClass-1069"><span class="linenos">1069</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleId</span>
</span><span id="ThermoBaseClass-1070"><a href="#ThermoBaseClass-1070"><span class="linenos">1070</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleName</span>
</span><span id="ThermoBaseClass-1071"><a href="#ThermoBaseClass-1071"><span class="linenos">1071</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Vial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Vial</span>
</span><span id="ThermoBaseClass-1072"><a href="#ThermoBaseClass-1072"><span class="linenos">1072</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InjectionVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InjectionVolume</span>
</span><span id="ThermoBaseClass-1073"><a href="#ThermoBaseClass-1073"><span class="linenos">1073</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Barcode</span>
</span><span id="ThermoBaseClass-1074"><a href="#ThermoBaseClass-1074"><span class="linenos">1074</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;BarcodeStatus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">BarcodeStatus</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1075"><a href="#ThermoBaseClass-1075"><span class="linenos">1075</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationLevel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationLevel</span>
</span><span id="ThermoBaseClass-1076"><a href="#ThermoBaseClass-1076"><span class="linenos">1076</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;DilutionFactor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">DilutionFactor</span>
</span><span id="ThermoBaseClass-1077"><a href="#ThermoBaseClass-1077"><span class="linenos">1077</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InstrumentMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InstrumentMethodFile</span>
</span><span id="ThermoBaseClass-1078"><a href="#ThermoBaseClass-1078"><span class="linenos">1078</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RawFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RawFileName</span>
</span><span id="ThermoBaseClass-1079"><a href="#ThermoBaseClass-1079"><span class="linenos">1079</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationFile</span>
</span><span id="ThermoBaseClass-1080"><a href="#ThermoBaseClass-1080"><span class="linenos">1080</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;IstdAmount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">IstdAmount</span>
</span><span id="ThermoBaseClass-1081"><a href="#ThermoBaseClass-1081"><span class="linenos">1081</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RowNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RowNumber</span>
</span><span id="ThermoBaseClass-1082"><a href="#ThermoBaseClass-1082"><span class="linenos">1082</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Path</span>
</span><span id="ThermoBaseClass-1083"><a href="#ThermoBaseClass-1083"><span class="linenos">1083</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;ProcessingMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">ProcessingMethodFile</span>
</span><span id="ThermoBaseClass-1084"><a href="#ThermoBaseClass-1084"><span class="linenos">1084</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">SampleType</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1085"><a href="#ThermoBaseClass-1085"><span class="linenos">1085</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleWeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleWeight</span>
</span><span id="ThermoBaseClass-1086"><a href="#ThermoBaseClass-1086"><span class="linenos">1086</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;UserText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-1087"><a href="#ThermoBaseClass-1087"><span class="linenos">1087</span></a>            <span class="s2">&quot;UserText&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">UserText</span><span class="p">]</span>
</span><span id="ThermoBaseClass-1088"><a href="#ThermoBaseClass-1088"><span class="linenos">1088</span></a>        <span class="p">}</span>  <span class="c1"># [0] #This may not work - needs debugging with</span>
</span><span id="ThermoBaseClass-1089"><a href="#ThermoBaseClass-1089"><span class="linenos">1089</span></a>        <span class="k">return</span> <span class="n">smdict</span>
</span><span id="ThermoBaseClass-1090"><a href="#ThermoBaseClass-1090"><span class="linenos">1090</span></a>
</span><span id="ThermoBaseClass-1091"><a href="#ThermoBaseClass-1091"><span class="linenos">1091</span></a>    <span class="k">def</span> <span class="nf">get_instrument_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1092"><a href="#ThermoBaseClass-1092"><span class="linenos">1092</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1093"><a href="#ThermoBaseClass-1093"><span class="linenos">1093</span></a><span class="sd">        This code will extract the instrument data from the raw file</span>
</span><span id="ThermoBaseClass-1094"><a href="#ThermoBaseClass-1094"><span class="linenos">1094</span></a>
</span><span id="ThermoBaseClass-1095"><a href="#ThermoBaseClass-1095"><span class="linenos">1095</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-1096"><a href="#ThermoBaseClass-1096"><span class="linenos">1096</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass-1097"><a href="#ThermoBaseClass-1097"><span class="linenos">1097</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass-1098"><a href="#ThermoBaseClass-1098"><span class="linenos">1098</span></a><span class="sd">            A dictionary containing the instrument data</span>
</span><span id="ThermoBaseClass-1099"><a href="#ThermoBaseClass-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1100"><a href="#ThermoBaseClass-1100"><span class="linenos">1100</span></a>        <span class="n">instrument_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span>
</span><span id="ThermoBaseClass-1101"><a href="#ThermoBaseClass-1101"><span class="linenos">1101</span></a>        <span class="n">id_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass-1102"><a href="#ThermoBaseClass-1102"><span class="linenos">1102</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Name</span>
</span><span id="ThermoBaseClass-1103"><a href="#ThermoBaseClass-1103"><span class="linenos">1103</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Model</span>
</span><span id="ThermoBaseClass-1104"><a href="#ThermoBaseClass-1104"><span class="linenos">1104</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SerialNumber</span>
</span><span id="ThermoBaseClass-1105"><a href="#ThermoBaseClass-1105"><span class="linenos">1105</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SoftwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SoftwareVersion</span>
</span><span id="ThermoBaseClass-1106"><a href="#ThermoBaseClass-1106"><span class="linenos">1106</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;HardwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">HardwareVersion</span>
</span><span id="ThermoBaseClass-1107"><a href="#ThermoBaseClass-1107"><span class="linenos">1107</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;ChannelLabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-1108"><a href="#ThermoBaseClass-1108"><span class="linenos">1108</span></a>            <span class="s2">&quot;ChannelLabels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">ChannelLabels</span><span class="p">]</span>
</span><span id="ThermoBaseClass-1109"><a href="#ThermoBaseClass-1109"><span class="linenos">1109</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass-1110"><a href="#ThermoBaseClass-1110"><span class="linenos">1110</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Flags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Flags</span>
</span><span id="ThermoBaseClass-1111"><a href="#ThermoBaseClass-1111"><span class="linenos">1111</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelY</span>
</span><span id="ThermoBaseClass-1112"><a href="#ThermoBaseClass-1112"><span class="linenos">1112</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelX</span>
</span><span id="ThermoBaseClass-1113"><a href="#ThermoBaseClass-1113"><span class="linenos">1113</span></a>        <span class="k">return</span> <span class="n">id_dict</span>
</span><span id="ThermoBaseClass-1114"><a href="#ThermoBaseClass-1114"><span class="linenos">1114</span></a>
</span><span id="ThermoBaseClass-1115"><a href="#ThermoBaseClass-1115"><span class="linenos">1115</span></a>    <span class="k">def</span> <span class="nf">get_centroid_msms_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">):</span>
</span><span id="ThermoBaseClass-1116"><a href="#ThermoBaseClass-1116"><span class="linenos">1116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1117"><a href="#ThermoBaseClass-1117"><span class="linenos">1117</span></a><span class="sd">        .. deprecated:: 2.0</span>
</span><span id="ThermoBaseClass-1118"><a href="#ThermoBaseClass-1118"><span class="linenos">1118</span></a><span class="sd">            This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="ThermoBaseClass-1119"><a href="#ThermoBaseClass-1119"><span class="linenos">1119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1120"><a href="#ThermoBaseClass-1120"><span class="linenos">1120</span></a>
</span><span id="ThermoBaseClass-1121"><a href="#ThermoBaseClass-1121"><span class="linenos">1121</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass-1122"><a href="#ThermoBaseClass-1122"><span class="linenos">1122</span></a>            <span class="s2">&quot;The `get_centroid_msms_data()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="ThermoBaseClass-1123"><a href="#ThermoBaseClass-1123"><span class="linenos">1123</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1124"><a href="#ThermoBaseClass-1124"><span class="linenos">1124</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1125"><a href="#ThermoBaseClass-1125"><span class="linenos">1125</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-1126"><a href="#ThermoBaseClass-1126"><span class="linenos">1126</span></a>
</span><span id="ThermoBaseClass-1127"><a href="#ThermoBaseClass-1127"><span class="linenos">1127</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="p">[</span><span class="n">scan</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1128"><a href="#ThermoBaseClass-1128"><span class="linenos">1128</span></a>
</span><span id="ThermoBaseClass-1129"><a href="#ThermoBaseClass-1129"><span class="linenos">1129</span></a>        <span class="n">centroidStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1130"><a href="#ThermoBaseClass-1130"><span class="linenos">1130</span></a>
</span><span id="ThermoBaseClass-1131"><a href="#ThermoBaseClass-1131"><span class="linenos">1131</span></a>        <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1132"><a href="#ThermoBaseClass-1132"><span class="linenos">1132</span></a>
</span><span id="ThermoBaseClass-1133"><a href="#ThermoBaseClass-1133"><span class="linenos">1133</span></a>        <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1134"><a href="#ThermoBaseClass-1134"><span class="linenos">1134</span></a>
</span><span id="ThermoBaseClass-1135"><a href="#ThermoBaseClass-1135"><span class="linenos">1135</span></a>        <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1136"><a href="#ThermoBaseClass-1136"><span class="linenos">1136</span></a>
</span><span id="ThermoBaseClass-1137"><a href="#ThermoBaseClass-1137"><span class="linenos">1137</span></a>        <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1138"><a href="#ThermoBaseClass-1138"><span class="linenos">1138</span></a>
</span><span id="ThermoBaseClass-1139"><a href="#ThermoBaseClass-1139"><span class="linenos">1139</span></a>        <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1140"><a href="#ThermoBaseClass-1140"><span class="linenos">1140</span></a>
</span><span id="ThermoBaseClass-1141"><a href="#ThermoBaseClass-1141"><span class="linenos">1141</span></a>        <span class="c1"># charge = scans_labels[5]</span>
</span><span id="ThermoBaseClass-1142"><a href="#ThermoBaseClass-1142"><span class="linenos">1142</span></a>        <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ThermoBaseClass-1143"><a href="#ThermoBaseClass-1143"><span class="linenos">1143</span></a>        <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ThermoBaseClass-1144"><a href="#ThermoBaseClass-1144"><span class="linenos">1144</span></a>
</span><span id="ThermoBaseClass-1145"><a href="#ThermoBaseClass-1145"><span class="linenos">1145</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1146"><a href="#ThermoBaseClass-1146"><span class="linenos">1146</span></a>
</span><span id="ThermoBaseClass-1147"><a href="#ThermoBaseClass-1147"><span class="linenos">1147</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1148"><a href="#ThermoBaseClass-1148"><span class="linenos">1148</span></a>
</span><span id="ThermoBaseClass-1149"><a href="#ThermoBaseClass-1149"><span class="linenos">1149</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-1150"><a href="#ThermoBaseClass-1150"><span class="linenos">1150</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1151"><a href="#ThermoBaseClass-1151"><span class="linenos">1151</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1152"><a href="#ThermoBaseClass-1152"><span class="linenos">1152</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1153"><a href="#ThermoBaseClass-1153"><span class="linenos">1153</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ThermoBaseClass-1154"><a href="#ThermoBaseClass-1154"><span class="linenos">1154</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass-1155"><a href="#ThermoBaseClass-1155"><span class="linenos">1155</span></a>
</span><span id="ThermoBaseClass-1156"><a href="#ThermoBaseClass-1156"><span class="linenos">1156</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1157"><a href="#ThermoBaseClass-1157"><span class="linenos">1157</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">=</span> <span class="s2">&quot;relative_abundance&quot;</span>
</span><span id="ThermoBaseClass-1158"><a href="#ThermoBaseClass-1158"><span class="linenos">1158</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_min_relative_abundance</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ThermoBaseClass-1159"><a href="#ThermoBaseClass-1159"><span class="linenos">1159</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="ThermoBaseClass-1160"><a href="#ThermoBaseClass-1160"><span class="linenos">1160</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass-1161"><a href="#ThermoBaseClass-1161"><span class="linenos">1161</span></a>
</span><span id="ThermoBaseClass-1162"><a href="#ThermoBaseClass-1162"><span class="linenos">1162</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum_by_scanlist</span><span class="p">(</span>
</span><span id="ThermoBaseClass-1163"><a href="#ThermoBaseClass-1163"><span class="linenos">1163</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1164"><a href="#ThermoBaseClass-1164"><span class="linenos">1164</span></a>        <span class="n">scans_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="ThermoBaseClass-1165"><a href="#ThermoBaseClass-1165"><span class="linenos">1165</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1166"><a href="#ThermoBaseClass-1166"><span class="linenos">1166</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1167"><a href="#ThermoBaseClass-1167"><span class="linenos">1167</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1168"><a href="#ThermoBaseClass-1168"><span class="linenos">1168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1169"><a href="#ThermoBaseClass-1169"><span class="linenos">1169</span></a><span class="sd">        Averages selected scans mass spectra using Thermo&#39;s AverageScans method</span>
</span><span id="ThermoBaseClass-1170"><a href="#ThermoBaseClass-1170"><span class="linenos">1170</span></a><span class="sd">        scans_list: list[int]</span>
</span><span id="ThermoBaseClass-1171"><a href="#ThermoBaseClass-1171"><span class="linenos">1171</span></a><span class="sd">        auto_process: bool</span>
</span><span id="ThermoBaseClass-1172"><a href="#ThermoBaseClass-1172"><span class="linenos">1172</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="ThermoBaseClass-1173"><a href="#ThermoBaseClass-1173"><span class="linenos">1173</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass-1174"><a href="#ThermoBaseClass-1174"><span class="linenos">1174</span></a><span class="sd">            MassSpecProfile</span>
</span><span id="ThermoBaseClass-1175"><a href="#ThermoBaseClass-1175"><span class="linenos">1175</span></a>
</span><span id="ThermoBaseClass-1176"><a href="#ThermoBaseClass-1176"><span class="linenos">1176</span></a><span class="sd">         .. deprecated:: 2.0</span>
</span><span id="ThermoBaseClass-1177"><a href="#ThermoBaseClass-1177"><span class="linenos">1177</span></a><span class="sd">        This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="ThermoBaseClass-1178"><a href="#ThermoBaseClass-1178"><span class="linenos">1178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass-1179"><a href="#ThermoBaseClass-1179"><span class="linenos">1179</span></a>
</span><span id="ThermoBaseClass-1180"><a href="#ThermoBaseClass-1180"><span class="linenos">1180</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass-1181"><a href="#ThermoBaseClass-1181"><span class="linenos">1181</span></a>            <span class="s2">&quot;The `get_average_mass_spectrum_by_scanlist()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="ThermoBaseClass-1182"><a href="#ThermoBaseClass-1182"><span class="linenos">1182</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1183"><a href="#ThermoBaseClass-1183"><span class="linenos">1183</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1184"><a href="#ThermoBaseClass-1184"><span class="linenos">1184</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass-1185"><a href="#ThermoBaseClass-1185"><span class="linenos">1185</span></a>
</span><span id="ThermoBaseClass-1186"><a href="#ThermoBaseClass-1186"><span class="linenos">1186</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="n">scans_list</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1187"><a href="#ThermoBaseClass-1187"><span class="linenos">1187</span></a>
</span><span id="ThermoBaseClass-1188"><a href="#ThermoBaseClass-1188"><span class="linenos">1188</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="ThermoBaseClass-1189"><a href="#ThermoBaseClass-1189"><span class="linenos">1189</span></a>
</span><span id="ThermoBaseClass-1190"><a href="#ThermoBaseClass-1190"><span class="linenos">1190</span></a>        <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="ThermoBaseClass-1191"><a href="#ThermoBaseClass-1191"><span class="linenos">1191</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="ThermoBaseClass-1192"><a href="#ThermoBaseClass-1192"><span class="linenos">1192</span></a>            <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1193"><a href="#ThermoBaseClass-1193"><span class="linenos">1193</span></a>
</span><span id="ThermoBaseClass-1194"><a href="#ThermoBaseClass-1194"><span class="linenos">1194</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="ThermoBaseClass-1195"><a href="#ThermoBaseClass-1195"><span class="linenos">1195</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass-1196"><a href="#ThermoBaseClass-1196"><span class="linenos">1196</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass-1197"><a href="#ThermoBaseClass-1197"><span class="linenos">1197</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="ThermoBaseClass-1198"><a href="#ThermoBaseClass-1198"><span class="linenos">1198</span></a>
</span><span id="ThermoBaseClass-1199"><a href="#ThermoBaseClass-1199"><span class="linenos">1199</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="ThermoBaseClass-1200"><a href="#ThermoBaseClass-1200"><span class="linenos">1200</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="ThermoBaseClass-1201"><a href="#ThermoBaseClass-1201"><span class="linenos">1201</span></a>
</span><span id="ThermoBaseClass-1202"><a href="#ThermoBaseClass-1202"><span class="linenos">1202</span></a>        <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1203"><a href="#ThermoBaseClass-1203"><span class="linenos">1203</span></a>
</span><span id="ThermoBaseClass-1204"><a href="#ThermoBaseClass-1204"><span class="linenos">1204</span></a>        <span class="n">len_data</span> <span class="o">=</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="o">.</span><span class="n">Length</span>
</span><span id="ThermoBaseClass-1205"><a href="#ThermoBaseClass-1205"><span class="linenos">1205</span></a>
</span><span id="ThermoBaseClass-1206"><a href="#ThermoBaseClass-1206"><span class="linenos">1206</span></a>        <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1207"><a href="#ThermoBaseClass-1207"><span class="linenos">1207</span></a>        <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1208"><a href="#ThermoBaseClass-1208"><span class="linenos">1208</span></a>
</span><span id="ThermoBaseClass-1209"><a href="#ThermoBaseClass-1209"><span class="linenos">1209</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass-1210"><a href="#ThermoBaseClass-1210"><span class="linenos">1210</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1211"><a href="#ThermoBaseClass-1211"><span class="linenos">1211</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass-1212"><a href="#ThermoBaseClass-1212"><span class="linenos">1212</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass-1213"><a href="#ThermoBaseClass-1213"><span class="linenos">1213</span></a>
</span><span id="ThermoBaseClass-1214"><a href="#ThermoBaseClass-1214"><span class="linenos">1214</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="ThermoBaseClass-1215"><a href="#ThermoBaseClass-1215"><span class="linenos">1215</span></a>
</span><span id="ThermoBaseClass-1216"><a href="#ThermoBaseClass-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span></pre></div>


            <div class="docstring"><p>Class for parsing Thermo Raw files and extracting information from them.</p>

<h2 id="parameters">Parameters:</h2>

<p>file_location : str or pathlib.Path or s3path.S3Path
    Thermo Raw file path or S3 path.</p>

<h2 id="attributes">Attributes:</h2>

<p>file_path : str or pathlib.Path or s3path.S3Path
    The file path of the Thermo Raw file.
parameters : LCMSParameters
    The LCMS parameters for the Thermo Raw file.
chromatogram_settings : LiquidChromatographSetting
    The chromatogram settings for the Thermo Raw file.
scans : list or tuple
    The selected scans for the Thermo Raw file.
start_scan : int
    The starting scan number for the Thermo Raw file.
end_scan : int
    The ending scan number for the Thermo Raw file.</p>

<h2 id="methods">Methods:</h2>

<ul>
<li>set_msordertype(scanFilter, mstype: str = 'ms1') -> scanFilter
Convert the user-passed MS Type string to a Thermo MSOrderType object.</li>
<li>get_creation_time() -> datetime.datetime
Extract the creation date stamp from the .RAW file and return it as a formatted datetime object.</li>
<li>remove_temp_file()
Remove the temporary file if the path is from S3Path.</li>
<li>get_polarity_mode(scan_number: int) -> int
Get the polarity mode for the given scan number.</li>
<li>get_filter_for_scan_num(scan_number: int) -> List[str]
Get the filter for the given scan number.</li>
<li>check_full_scan(scan_number: int) -> bool
Check if the given scan number is a full scan.</li>
<li>get_all_filters() -> Tuple[Dict[int, str], List[str]]
Get all scan filters for the Thermo Raw file.</li>
<li>get_scan_header(scan: int) -> Dict[str, Any]
Get the full dictionary of scan header metadata for the given scan number.</li>
<li>get_rt_time_from_trace(trace) -> Tuple[List[float], List[float], List[int]]
Get the retention time, intensity, and scan number from the given trace.</li>
<li>get_eics(target_mzs: List[float], tic_data: Dict[str, Any], ms_type: str = 'MS !d',
     peak_detection: bool = True, smooth: bool = True, plot: bool = False,
     ax: Optional[matplotlib.axes.Axes] = None, legend: bool = False) -> Tuple[Dict[float, EIC_Data], matplotlib.axes.Axes]
Get the extracted ion chromatograms (EICs) for the target m/z values.</li>
</ul>
</div>


                            <div id="ThermoBaseClass.__init__" class="classattr">
                                        <input id="ThermoBaseClass.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ThermoBaseClass</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file_location</span></span>)</span>

                <label class="view-source-button" for="ThermoBaseClass.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.__init__-110"><a href="#ThermoBaseClass.__init__-110"><span class="linenos">110</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">):</span>
</span><span id="ThermoBaseClass.__init__-111"><a href="#ThermoBaseClass.__init__-111"><span class="linenos">111</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;file_location: srt pathlib.Path or s3path.S3Path</span>
</span><span id="ThermoBaseClass.__init__-112"><a href="#ThermoBaseClass.__init__-112"><span class="linenos">112</span></a><span class="sd">        Thermo Raw file path</span>
</span><span id="ThermoBaseClass.__init__-113"><a href="#ThermoBaseClass.__init__-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.__init__-114"><a href="#ThermoBaseClass.__init__-114"><span class="linenos">114</span></a>        <span class="c1"># Thread.__init__(self)</span>
</span><span id="ThermoBaseClass.__init__-115"><a href="#ThermoBaseClass.__init__-115"><span class="linenos">115</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ThermoBaseClass.__init__-116"><a href="#ThermoBaseClass.__init__-116"><span class="linenos">116</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-117"><a href="#ThermoBaseClass.__init__-117"><span class="linenos">117</span></a>
</span><span id="ThermoBaseClass.__init__-118"><a href="#ThermoBaseClass.__init__-118"><span class="linenos">118</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="n">S3Path</span><span class="p">):</span>
</span><span id="ThermoBaseClass.__init__-119"><a href="#ThermoBaseClass.__init__-119"><span class="linenos">119</span></a>            <span class="n">temp_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;tmp/&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-120"><a href="#ThermoBaseClass.__init__-120"><span class="linenos">120</span></a>            <span class="n">temp_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-121"><a href="#ThermoBaseClass.__init__-121"><span class="linenos">121</span></a>
</span><span id="ThermoBaseClass.__init__-122"><a href="#ThermoBaseClass.__init__-122"><span class="linenos">122</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">temp_dir</span> <span class="o">/</span> <span class="n">file_location</span><span class="o">.</span><span class="n">name</span>
</span><span id="ThermoBaseClass.__init__-123"><a href="#ThermoBaseClass.__init__-123"><span class="linenos">123</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
</span><span id="ThermoBaseClass.__init__-124"><a href="#ThermoBaseClass.__init__-124"><span class="linenos">124</span></a>                <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_location</span><span class="o">.</span><span class="n">read_bytes</span><span class="p">())</span>
</span><span id="ThermoBaseClass.__init__-125"><a href="#ThermoBaseClass.__init__-125"><span class="linenos">125</span></a>
</span><span id="ThermoBaseClass.__init__-126"><a href="#ThermoBaseClass.__init__-126"><span class="linenos">126</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.__init__-127"><a href="#ThermoBaseClass.__init__-127"><span class="linenos">127</span></a>            <span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ThermoBaseClass.__init__-128"><a href="#ThermoBaseClass.__init__-128"><span class="linenos">128</span></a>
</span><span id="ThermoBaseClass.__init__-129"><a href="#ThermoBaseClass.__init__-129"><span class="linenos">129</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span> <span class="o">=</span> <span class="n">RawFileReaderAdapter</span><span class="o">.</span><span class="n">FileFactory</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="ThermoBaseClass.__init__-130"><a href="#ThermoBaseClass.__init__-130"><span class="linenos">130</span></a>
</span><span id="ThermoBaseClass.__init__-131"><a href="#ThermoBaseClass.__init__-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsOpen</span><span class="p">:</span>
</span><span id="ThermoBaseClass.__init__-132"><a href="#ThermoBaseClass.__init__-132"><span class="linenos">132</span></a>            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
</span><span id="ThermoBaseClass.__init__-133"><a href="#ThermoBaseClass.__init__-133"><span class="linenos">133</span></a>                <span class="s2">&quot;Unable to access the RAW file using the RawFileReader class!&quot;</span>
</span><span id="ThermoBaseClass.__init__-134"><a href="#ThermoBaseClass.__init__-134"><span class="linenos">134</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-135"><a href="#ThermoBaseClass.__init__-135"><span class="linenos">135</span></a>
</span><span id="ThermoBaseClass.__init__-136"><a href="#ThermoBaseClass.__init__-136"><span class="linenos">136</span></a>        <span class="c1"># Check for any errors in the RAW file</span>
</span><span id="ThermoBaseClass.__init__-137"><a href="#ThermoBaseClass.__init__-137"><span class="linenos">137</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsError</span><span class="p">:</span>
</span><span id="ThermoBaseClass.__init__-138"><a href="#ThermoBaseClass.__init__-138"><span class="linenos">138</span></a>            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span>
</span><span id="ThermoBaseClass.__init__-139"><a href="#ThermoBaseClass.__init__-139"><span class="linenos">139</span></a>                <span class="s2">&quot;Error opening (</span><span class="si">{}</span><span class="s2">) - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">FileError</span><span class="p">,</span> <span class="n">file_path</span><span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-140"><a href="#ThermoBaseClass.__init__-140"><span class="linenos">140</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-141"><a href="#ThermoBaseClass.__init__-141"><span class="linenos">141</span></a>
</span><span id="ThermoBaseClass.__init__-142"><a href="#ThermoBaseClass.__init__-142"><span class="linenos">142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SelectInstrument</span><span class="p">(</span><span class="n">Device</span><span class="o">.</span><span class="n">MS</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.__init__-143"><a href="#ThermoBaseClass.__init__-143"><span class="linenos">143</span></a>
</span><span id="ThermoBaseClass.__init__-144"><a href="#ThermoBaseClass.__init__-144"><span class="linenos">144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ThermoBaseClass.__init__-145"><a href="#ThermoBaseClass.__init__-145"><span class="linenos">145</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iFileHeader</span> <span class="o">=</span> <span class="n">FileHeaderReaderFactory</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
</span><span id="ThermoBaseClass.__init__-146"><a href="#ThermoBaseClass.__init__-146"><span class="linenos">146</span></a>
</span><span id="ThermoBaseClass.__init__-147"><a href="#ThermoBaseClass.__init__-147"><span class="linenos">147</span></a>        <span class="c1"># removing tmp file</span>
</span><span id="ThermoBaseClass.__init__-148"><a href="#ThermoBaseClass.__init__-148"><span class="linenos">148</span></a>
</span><span id="ThermoBaseClass.__init__-149"><a href="#ThermoBaseClass.__init__-149"><span class="linenos">149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_init_settings</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>file_location: srt pathlib.Path or s3path.S3Path
Thermo Raw file path</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.iRawDataPlus" class="classattr">
                                <div class="attr variable">
            <span class="name">iRawDataPlus</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.iRawDataPlus"></a>
    
    

                            </div>
                            <div id="ThermoBaseClass.res" class="classattr">
                                <div class="attr variable">
            <span class="name">res</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.res"></a>
    
    

                            </div>
                            <div id="ThermoBaseClass.file_path" class="classattr">
                                <div class="attr variable">
            <span class="name">file_path</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.file_path"></a>
    
    

                            </div>
                            <div id="ThermoBaseClass.iFileHeader" class="classattr">
                                <div class="attr variable">
            <span class="name">iFileHeader</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.iFileHeader"></a>
    
    

                            </div>
                            <div id="ThermoBaseClass.parameters" class="classattr">
                                <div class="attr variable">
            <span class="name">parameters</span><span class="annotation">: <a href="../../encapsulation/factory/parameters.html#LCMSParameters">corems.encapsulation.factory.parameters.LCMSParameters</a></span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.parameters"></a>
    
            <div class="docstring"><p>Get or set the LCMSParameters object.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.chromatogram_settings" class="classattr">
                                <div class="attr variable">
            <span class="name">chromatogram_settings</span><span class="annotation">: <a href="../../encapsulation/factory/processingSetting.html#LiquidChromatographSetting">corems.encapsulation.factory.processingSetting.LiquidChromatographSetting</a></span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.chromatogram_settings"></a>
    
            <div class="docstring"><p>Get or set the LiquidChromatographSetting object.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.scans" class="classattr">
                                <div class="attr variable">
            <span class="name">scans</span><span class="annotation">: list | tuple</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.scans"></a>
    
            <div class="docstring"><p>scans : list or tuple
If list uses Thermo AverageScansInScanRange for selected scans, ortherwise uses Thermo AverageScans for a scan range</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.start_scan" class="classattr">
                                <div class="attr variable">
            <span class="name">start_scan</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.start_scan"></a>
    
            <div class="docstring"><p>Get the starting scan number for the Thermo Raw file.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.end_scan" class="classattr">
                                <div class="attr variable">
            <span class="name">end_scan</span><span class="annotation">: int</span>

        
    </div>
    <a class="headerlink" href="#ThermoBaseClass.end_scan"></a>
    
            <div class="docstring"><p>Get the ending scan number for the Thermo Raw file.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.set_msordertype" class="classattr">
                                        <input id="ThermoBaseClass.set_msordertype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_msordertype</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scanFilter</span>, </span><span class="param"><span class="n">mstype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ms1&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.set_msordertype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.set_msordertype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.set_msordertype-208"><a href="#ThermoBaseClass.set_msordertype-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">set_msordertype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">mstype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span><span class="p">):</span>
</span><span id="ThermoBaseClass.set_msordertype-209"><a href="#ThermoBaseClass.set_msordertype-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.set_msordertype-210"><a href="#ThermoBaseClass.set_msordertype-210"><span class="linenos">210</span></a><span class="sd">        Function to convert user passed string MS Type to Thermo MSOrderType object</span>
</span><span id="ThermoBaseClass.set_msordertype-211"><a href="#ThermoBaseClass.set_msordertype-211"><span class="linenos">211</span></a><span class="sd">        Limited to MS1 through MS10.</span>
</span><span id="ThermoBaseClass.set_msordertype-212"><a href="#ThermoBaseClass.set_msordertype-212"><span class="linenos">212</span></a>
</span><span id="ThermoBaseClass.set_msordertype-213"><a href="#ThermoBaseClass.set_msordertype-213"><span class="linenos">213</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.set_msordertype-214"><a href="#ThermoBaseClass.set_msordertype-214"><span class="linenos">214</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.set_msordertype-215"><a href="#ThermoBaseClass.set_msordertype-215"><span class="linenos">215</span></a><span class="sd">        scanFilter : Thermo.ScanFilter</span>
</span><span id="ThermoBaseClass.set_msordertype-216"><a href="#ThermoBaseClass.set_msordertype-216"><span class="linenos">216</span></a><span class="sd">            The scan filter object.</span>
</span><span id="ThermoBaseClass.set_msordertype-217"><a href="#ThermoBaseClass.set_msordertype-217"><span class="linenos">217</span></a><span class="sd">        mstype : str, optional</span>
</span><span id="ThermoBaseClass.set_msordertype-218"><a href="#ThermoBaseClass.set_msordertype-218"><span class="linenos">218</span></a><span class="sd">            The MS Type string, by default &#39;ms1&#39;</span>
</span><span id="ThermoBaseClass.set_msordertype-219"><a href="#ThermoBaseClass.set_msordertype-219"><span class="linenos">219</span></a>
</span><span id="ThermoBaseClass.set_msordertype-220"><a href="#ThermoBaseClass.set_msordertype-220"><span class="linenos">220</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.set_msordertype-221"><a href="#ThermoBaseClass.set_msordertype-221"><span class="linenos">221</span></a>        <span class="n">mstype</span> <span class="o">=</span> <span class="n">mstype</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span id="ThermoBaseClass.set_msordertype-222"><a href="#ThermoBaseClass.set_msordertype-222"><span class="linenos">222</span></a>        <span class="c1"># Check that a valid mstype is passed</span>
</span><span id="ThermoBaseClass.set_msordertype-223"><a href="#ThermoBaseClass.set_msordertype-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;MS&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="ThermoBaseClass.set_msordertype-224"><a href="#ThermoBaseClass.set_msordertype-224"><span class="linenos">224</span></a>            <span class="n">warn</span><span class="p">(</span><span class="s2">&quot;MS Type not valid, must be between MS1 and MS10&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.set_msordertype-225"><a href="#ThermoBaseClass.set_msordertype-225"><span class="linenos">225</span></a>
</span><span id="ThermoBaseClass.set_msordertype-226"><a href="#ThermoBaseClass.set_msordertype-226"><span class="linenos">226</span></a>        <span class="n">msordertypedict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.set_msordertype-227"><a href="#ThermoBaseClass.set_msordertype-227"><span class="linenos">227</span></a>            <span class="s2">&quot;MS1&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-228"><a href="#ThermoBaseClass.set_msordertype-228"><span class="linenos">228</span></a>            <span class="s2">&quot;MS2&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms2</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-229"><a href="#ThermoBaseClass.set_msordertype-229"><span class="linenos">229</span></a>            <span class="s2">&quot;MS3&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms3</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-230"><a href="#ThermoBaseClass.set_msordertype-230"><span class="linenos">230</span></a>            <span class="s2">&quot;MS4&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms4</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-231"><a href="#ThermoBaseClass.set_msordertype-231"><span class="linenos">231</span></a>            <span class="s2">&quot;MS5&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms5</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-232"><a href="#ThermoBaseClass.set_msordertype-232"><span class="linenos">232</span></a>            <span class="s2">&quot;MS6&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms6</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-233"><a href="#ThermoBaseClass.set_msordertype-233"><span class="linenos">233</span></a>            <span class="s2">&quot;MS7&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms7</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-234"><a href="#ThermoBaseClass.set_msordertype-234"><span class="linenos">234</span></a>            <span class="s2">&quot;MS8&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms8</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-235"><a href="#ThermoBaseClass.set_msordertype-235"><span class="linenos">235</span></a>            <span class="s2">&quot;MS9&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms9</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-236"><a href="#ThermoBaseClass.set_msordertype-236"><span class="linenos">236</span></a>            <span class="s2">&quot;MS10&quot;</span><span class="p">:</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms10</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_msordertype-237"><a href="#ThermoBaseClass.set_msordertype-237"><span class="linenos">237</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass.set_msordertype-238"><a href="#ThermoBaseClass.set_msordertype-238"><span class="linenos">238</span></a>        <span class="n">scanFilter</span><span class="o">.</span><span class="n">MSOrder</span> <span class="o">=</span> <span class="n">msordertypedict</span><span class="p">[</span><span class="n">mstype</span><span class="p">]</span>
</span><span id="ThermoBaseClass.set_msordertype-239"><a href="#ThermoBaseClass.set_msordertype-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="n">scanFilter</span>
</span></pre></div>


            <div class="docstring"><p>Function to convert user passed string MS Type to Thermo MSOrderType object
Limited to MS1 through MS10.</p>

<h2 id="parameters">Parameters:</h2>

<p>scanFilter : Thermo.ScanFilter
    The scan filter object.
mstype : str, optional
    The MS Type string, by default 'ms1'</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_creation_time" class="classattr">
                                        <input id="ThermoBaseClass.get_creation_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_creation_time</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_creation_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_creation_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_creation_time-241"><a href="#ThermoBaseClass.get_creation_time-241"><span class="linenos">241</span></a>    <span class="k">def</span> <span class="nf">get_creation_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_creation_time-242"><a href="#ThermoBaseClass.get_creation_time-242"><span class="linenos">242</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_creation_time-243"><a href="#ThermoBaseClass.get_creation_time-243"><span class="linenos">243</span></a><span class="sd">        Extract the creation date stamp from the .RAW file</span>
</span><span id="ThermoBaseClass.get_creation_time-244"><a href="#ThermoBaseClass.get_creation_time-244"><span class="linenos">244</span></a><span class="sd">        Return formatted creation date stamp.</span>
</span><span id="ThermoBaseClass.get_creation_time-245"><a href="#ThermoBaseClass.get_creation_time-245"><span class="linenos">245</span></a>
</span><span id="ThermoBaseClass.get_creation_time-246"><a href="#ThermoBaseClass.get_creation_time-246"><span class="linenos">246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_creation_time-247"><a href="#ThermoBaseClass.get_creation_time-247"><span class="linenos">247</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">CreationDate</span><span class="o">.</span><span class="n">get_Ticks</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_creation_time-248"><a href="#ThermoBaseClass.get_creation_time-248"><span class="linenos">248</span></a>        <span class="n">credate</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_creation_time-249"><a href="#ThermoBaseClass.get_creation_time-249"><span class="linenos">249</span></a>            <span class="n">microseconds</span><span class="o">=</span><span class="n">credate</span> <span class="o">/</span> <span class="mi">10</span>
</span><span id="ThermoBaseClass.get_creation_time-250"><a href="#ThermoBaseClass.get_creation_time-250"><span class="linenos">250</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_creation_time-251"><a href="#ThermoBaseClass.get_creation_time-251"><span class="linenos">251</span></a>        <span class="k">return</span> <span class="n">credate</span>
</span></pre></div>


            <div class="docstring"><p>Extract the creation date stamp from the .RAW file
Return formatted creation date stamp.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.remove_temp_file" class="classattr">
                                        <input id="ThermoBaseClass.remove_temp_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_temp_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.remove_temp_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.remove_temp_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.remove_temp_file-253"><a href="#ThermoBaseClass.remove_temp_file-253"><span class="linenos">253</span></a>    <span class="k">def</span> <span class="nf">remove_temp_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ThermoBaseClass.remove_temp_file-254"><a href="#ThermoBaseClass.remove_temp_file-254"><span class="linenos">254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;if the path is from S3Path data cannot be serialized to io.ByteStream and</span>
</span><span id="ThermoBaseClass.remove_temp_file-255"><a href="#ThermoBaseClass.remove_temp_file-255"><span class="linenos">255</span></a><span class="sd">        a temporary copy is stored at the temp dir</span>
</span><span id="ThermoBaseClass.remove_temp_file-256"><a href="#ThermoBaseClass.remove_temp_file-256"><span class="linenos">256</span></a><span class="sd">        use this function only at the end of your execution scrip</span>
</span><span id="ThermoBaseClass.remove_temp_file-257"><a href="#ThermoBaseClass.remove_temp_file-257"><span class="linenos">257</span></a><span class="sd">        some LCMS class methods depend on this file</span>
</span><span id="ThermoBaseClass.remove_temp_file-258"><a href="#ThermoBaseClass.remove_temp_file-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.remove_temp_file-259"><a href="#ThermoBaseClass.remove_temp_file-259"><span class="linenos">259</span></a>
</span><span id="ThermoBaseClass.remove_temp_file-260"><a href="#ThermoBaseClass.remove_temp_file-260"><span class="linenos">260</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>if the path is from S3Path data cannot be serialized to io.ByteStream and
a temporary copy is stored at the temp dir
use this function only at the end of your execution scrip
some LCMS class methods depend on this file</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.close_file" class="classattr">
                                        <input id="ThermoBaseClass.close_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close_file</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.close_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.close_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.close_file-262"><a href="#ThermoBaseClass.close_file-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">close_file</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ThermoBaseClass.close_file-263"><a href="#ThermoBaseClass.close_file-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.close_file-264"><a href="#ThermoBaseClass.close_file-264"><span class="linenos">264</span></a><span class="sd">        Close the Thermo Raw file.</span>
</span><span id="ThermoBaseClass.close_file-265"><a href="#ThermoBaseClass.close_file-265"><span class="linenos">265</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.close_file-266"><a href="#ThermoBaseClass.close_file-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">Dispose</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Close the Thermo Raw file.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_polarity_mode" class="classattr">
                                        <input id="ThermoBaseClass.get_polarity_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_polarity_mode</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">int</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_polarity_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_polarity_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_polarity_mode-268"><a href="#ThermoBaseClass.get_polarity_mode-268"><span class="linenos">268</span></a>    <span class="k">def</span> <span class="nf">get_polarity_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-269"><a href="#ThermoBaseClass.get_polarity_mode-269"><span class="linenos">269</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_polarity_mode-270"><a href="#ThermoBaseClass.get_polarity_mode-270"><span class="linenos">270</span></a><span class="sd">        Get the polarity mode for the given scan number.</span>
</span><span id="ThermoBaseClass.get_polarity_mode-271"><a href="#ThermoBaseClass.get_polarity_mode-271"><span class="linenos">271</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-272"><a href="#ThermoBaseClass.get_polarity_mode-272"><span class="linenos">272</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-273"><a href="#ThermoBaseClass.get_polarity_mode-273"><span class="linenos">273</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.get_polarity_mode-274"><a href="#ThermoBaseClass.get_polarity_mode-274"><span class="linenos">274</span></a><span class="sd">        scan_number : int</span>
</span><span id="ThermoBaseClass.get_polarity_mode-275"><a href="#ThermoBaseClass.get_polarity_mode-275"><span class="linenos">275</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass.get_polarity_mode-276"><a href="#ThermoBaseClass.get_polarity_mode-276"><span class="linenos">276</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-277"><a href="#ThermoBaseClass.get_polarity_mode-277"><span class="linenos">277</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-278"><a href="#ThermoBaseClass.get_polarity_mode-278"><span class="linenos">278</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass.get_polarity_mode-279"><a href="#ThermoBaseClass.get_polarity_mode-279"><span class="linenos">279</span></a><span class="sd">        Exception</span>
</span><span id="ThermoBaseClass.get_polarity_mode-280"><a href="#ThermoBaseClass.get_polarity_mode-280"><span class="linenos">280</span></a><span class="sd">            If the polarity mode is unknown.</span>
</span><span id="ThermoBaseClass.get_polarity_mode-281"><a href="#ThermoBaseClass.get_polarity_mode-281"><span class="linenos">281</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-282"><a href="#ThermoBaseClass.get_polarity_mode-282"><span class="linenos">282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_polarity_mode-283"><a href="#ThermoBaseClass.get_polarity_mode-283"><span class="linenos">283</span></a>        <span class="n">polarity_symbol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_filter_for_scan_num</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_polarity_mode-284"><a href="#ThermoBaseClass.get_polarity_mode-284"><span class="linenos">284</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-285"><a href="#ThermoBaseClass.get_polarity_mode-285"><span class="linenos">285</span></a>        <span class="k">if</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-286"><a href="#ThermoBaseClass.get_polarity_mode-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="mi">1</span>
</span><span id="ThermoBaseClass.get_polarity_mode-287"><a href="#ThermoBaseClass.get_polarity_mode-287"><span class="linenos">287</span></a>            <span class="c1"># return &#39;POSITIVE_ION_MODE&#39;</span>
</span><span id="ThermoBaseClass.get_polarity_mode-288"><a href="#ThermoBaseClass.get_polarity_mode-288"><span class="linenos">288</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-289"><a href="#ThermoBaseClass.get_polarity_mode-289"><span class="linenos">289</span></a>        <span class="k">elif</span> <span class="n">polarity_symbol</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-290"><a href="#ThermoBaseClass.get_polarity_mode-290"><span class="linenos">290</span></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="ThermoBaseClass.get_polarity_mode-291"><a href="#ThermoBaseClass.get_polarity_mode-291"><span class="linenos">291</span></a>
</span><span id="ThermoBaseClass.get_polarity_mode-292"><a href="#ThermoBaseClass.get_polarity_mode-292"><span class="linenos">292</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_polarity_mode-293"><a href="#ThermoBaseClass.get_polarity_mode-293"><span class="linenos">293</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Polarity Mode Unknown, please set it manually&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the polarity mode for the given scan number.</p>

<h2 id="parameters">Parameters:</h2>

<p>scan_number : int
    The scan number.</p>

<h2 id="raises">Raises:</h2>

<p>Exception
    If the polarity mode is unknown.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_filter_for_scan_num" class="classattr">
                                        <input id="ThermoBaseClass.get_filter_for_scan_num-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_filter_for_scan_num</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">String</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_filter_for_scan_num-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_filter_for_scan_num"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_filter_for_scan_num-295"><a href="#ThermoBaseClass.get_filter_for_scan_num-295"><span class="linenos">295</span></a>    <span class="k">def</span> <span class="nf">get_filter_for_scan_num</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-296"><a href="#ThermoBaseClass.get_filter_for_scan_num-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-297"><a href="#ThermoBaseClass.get_filter_for_scan_num-297"><span class="linenos">297</span></a><span class="sd">        Returns the closest matching run time that corresponds to scan_number for the current</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-298"><a href="#ThermoBaseClass.get_filter_for_scan_num-298"><span class="linenos">298</span></a><span class="sd">        controller. This function is only supported for MS device controllers.</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-299"><a href="#ThermoBaseClass.get_filter_for_scan_num-299"><span class="linenos">299</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-300"><a href="#ThermoBaseClass.get_filter_for_scan_num-300"><span class="linenos">300</span></a>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-301"><a href="#ThermoBaseClass.get_filter_for_scan_num-301"><span class="linenos">301</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-302"><a href="#ThermoBaseClass.get_filter_for_scan_num-302"><span class="linenos">302</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-303"><a href="#ThermoBaseClass.get_filter_for_scan_num-303"><span class="linenos">303</span></a><span class="sd">        scan_number : int</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-304"><a href="#ThermoBaseClass.get_filter_for_scan_num-304"><span class="linenos">304</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-305"><a href="#ThermoBaseClass.get_filter_for_scan_num-305"><span class="linenos">305</span></a>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-306"><a href="#ThermoBaseClass.get_filter_for_scan_num-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-307"><a href="#ThermoBaseClass.get_filter_for_scan_num-307"><span class="linenos">307</span></a>        <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-308"><a href="#ThermoBaseClass.get_filter_for_scan_num-308"><span class="linenos">308</span></a>
</span><span id="ThermoBaseClass.get_filter_for_scan_num-309"><a href="#ThermoBaseClass.get_filter_for_scan_num-309"><span class="linenos">309</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Returns the closest matching run time that corresponds to scan_number for the current
controller. This function is only supported for MS device controllers.
e.g.  ['FTMS', '-', 'p', 'NSI', 'Full', 'ms', '[200.00-1000.00]']</p>

<h2 id="parameters">Parameters:</h2>

<p>scan_number : int
    The scan number.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.check_full_scan" class="classattr">
                                        <input id="ThermoBaseClass.check_full_scan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">check_full_scan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.check_full_scan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.check_full_scan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.check_full_scan-311"><a href="#ThermoBaseClass.check_full_scan-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">check_full_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="ThermoBaseClass.check_full_scan-312"><a href="#ThermoBaseClass.check_full_scan-312"><span class="linenos">312</span></a>        <span class="c1"># scan_filter.ScanMode 0 = FULL</span>
</span><span id="ThermoBaseClass.check_full_scan-313"><a href="#ThermoBaseClass.check_full_scan-313"><span class="linenos">313</span></a>        <span class="n">scan_filter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass.check_full_scan-314"><a href="#ThermoBaseClass.check_full_scan-314"><span class="linenos">314</span></a>
</span><span id="ThermoBaseClass.check_full_scan-315"><a href="#ThermoBaseClass.check_full_scan-315"><span class="linenos">315</span></a>        <span class="k">return</span> <span class="n">scan_filter</span><span class="o">.</span><span class="n">ScanMode</span> <span class="o">==</span> <span class="n">MSOrderType</span><span class="o">.</span><span class="n">Ms</span>
</span></pre></div>


    

                            </div>
                            <div id="ThermoBaseClass.get_all_filters" class="classattr">
                                        <input id="ThermoBaseClass.get_all_filters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_all_filters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">String</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_all_filters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_all_filters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_all_filters-317"><a href="#ThermoBaseClass.get_all_filters-317"><span class="linenos">317</span></a>    <span class="k">def</span> <span class="nf">get_all_filters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
</span><span id="ThermoBaseClass.get_all_filters-318"><a href="#ThermoBaseClass.get_all_filters-318"><span class="linenos">318</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_all_filters-319"><a href="#ThermoBaseClass.get_all_filters-319"><span class="linenos">319</span></a><span class="sd">        Get all scan filters.</span>
</span><span id="ThermoBaseClass.get_all_filters-320"><a href="#ThermoBaseClass.get_all_filters-320"><span class="linenos">320</span></a><span class="sd">        This function is only supported for MS device controllers.</span>
</span><span id="ThermoBaseClass.get_all_filters-321"><a href="#ThermoBaseClass.get_all_filters-321"><span class="linenos">321</span></a><span class="sd">        e.g.  [&#39;FTMS&#39;, &#39;-&#39;, &#39;p&#39;, &#39;NSI&#39;, &#39;Full&#39;, &#39;ms&#39;, &#39;[200.00-1000.00]&#39;]</span>
</span><span id="ThermoBaseClass.get_all_filters-322"><a href="#ThermoBaseClass.get_all_filters-322"><span class="linenos">322</span></a>
</span><span id="ThermoBaseClass.get_all_filters-323"><a href="#ThermoBaseClass.get_all_filters-323"><span class="linenos">323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_all_filters-324"><a href="#ThermoBaseClass.get_all_filters-324"><span class="linenos">324</span></a>
</span><span id="ThermoBaseClass.get_all_filters-325"><a href="#ThermoBaseClass.get_all_filters-325"><span class="linenos">325</span></a>        <span class="n">scanrange</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_all_filters-326"><a href="#ThermoBaseClass.get_all_filters-326"><span class="linenos">326</span></a>        <span class="n">scanfiltersdic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_all_filters-327"><a href="#ThermoBaseClass.get_all_filters-327"><span class="linenos">327</span></a>        <span class="n">scanfilterslist</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_all_filters-328"><a href="#ThermoBaseClass.get_all_filters-328"><span class="linenos">328</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="n">scanrange</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_all_filters-329"><a href="#ThermoBaseClass.get_all_filters-329"><span class="linenos">329</span></a>            <span class="n">scan_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanEventStringForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_all_filters-330"><a href="#ThermoBaseClass.get_all_filters-330"><span class="linenos">330</span></a>            <span class="n">scanfiltersdic</span><span class="p">[</span><span class="n">scan_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_label</span>
</span><span id="ThermoBaseClass.get_all_filters-331"><a href="#ThermoBaseClass.get_all_filters-331"><span class="linenos">331</span></a>            <span class="n">scanfilterslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scan_label</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_all_filters-332"><a href="#ThermoBaseClass.get_all_filters-332"><span class="linenos">332</span></a>        <span class="n">scanfilterset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scanfilterslist</span><span class="p">))</span>
</span><span id="ThermoBaseClass.get_all_filters-333"><a href="#ThermoBaseClass.get_all_filters-333"><span class="linenos">333</span></a>        <span class="k">return</span> <span class="n">scanfiltersdic</span><span class="p">,</span> <span class="n">scanfilterset</span>
</span></pre></div>


            <div class="docstring"><p>Get all scan filters.
This function is only supported for MS device controllers.
e.g.  ['FTMS', '-', 'p', 'NSI', 'Full', 'ms', '[200.00-1000.00]']</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_scan_header" class="classattr">
                                        <input id="ThermoBaseClass.get_scan_header-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_scan_header</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_scan_header-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_scan_header"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_scan_header-335"><a href="#ThermoBaseClass.get_scan_header-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="nf">get_scan_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</span><span id="ThermoBaseClass.get_scan_header-336"><a href="#ThermoBaseClass.get_scan_header-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_scan_header-337"><a href="#ThermoBaseClass.get_scan_header-337"><span class="linenos">337</span></a><span class="sd">        Get full dictionary of scan header meta data, i.e. AGC status, ion injection time, etc.</span>
</span><span id="ThermoBaseClass.get_scan_header-338"><a href="#ThermoBaseClass.get_scan_header-338"><span class="linenos">338</span></a>
</span><span id="ThermoBaseClass.get_scan_header-339"><a href="#ThermoBaseClass.get_scan_header-339"><span class="linenos">339</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.get_scan_header-340"><a href="#ThermoBaseClass.get_scan_header-340"><span class="linenos">340</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.get_scan_header-341"><a href="#ThermoBaseClass.get_scan_header-341"><span class="linenos">341</span></a><span class="sd">        scan : int</span>
</span><span id="ThermoBaseClass.get_scan_header-342"><a href="#ThermoBaseClass.get_scan_header-342"><span class="linenos">342</span></a><span class="sd">            The scan number.</span>
</span><span id="ThermoBaseClass.get_scan_header-343"><a href="#ThermoBaseClass.get_scan_header-343"><span class="linenos">343</span></a>
</span><span id="ThermoBaseClass.get_scan_header-344"><a href="#ThermoBaseClass.get_scan_header-344"><span class="linenos">344</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_scan_header-345"><a href="#ThermoBaseClass.get_scan_header-345"><span class="linenos">345</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTrailerExtraInformation</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_scan_header-346"><a href="#ThermoBaseClass.get_scan_header-346"><span class="linenos">346</span></a>
</span><span id="ThermoBaseClass.get_scan_header-347"><a href="#ThermoBaseClass.get_scan_header-347"><span class="linenos">347</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_scan_header-348"><a href="#ThermoBaseClass.get_scan_header-348"><span class="linenos">348</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_scan_header-349"><a href="#ThermoBaseClass.get_scan_header-349"><span class="linenos">349</span></a>            <span class="n">header_dic</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="ThermoBaseClass.get_scan_header-350"><a href="#ThermoBaseClass.get_scan_header-350"><span class="linenos">350</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span></pre></div>


            <div class="docstring"><p>Get full dictionary of scan header meta data, i.e. AGC status, ion injection time, etc.</p>

<h2 id="parameters">Parameters:</h2>

<p>scan : int
    The scan number.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_rt_time_from_trace" class="classattr">
                                        <input id="ThermoBaseClass.get_rt_time_from_trace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_rt_time_from_trace</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">trace</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Double</span><span class="p">],</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Double</span><span class="p">],</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Int32</span><span class="p">]]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_rt_time_from_trace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_rt_time_from_trace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_rt_time_from_trace-352"><a href="#ThermoBaseClass.get_rt_time_from_trace-352"><span class="linenos">352</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ThermoBaseClass.get_rt_time_from_trace-353"><a href="#ThermoBaseClass.get_rt_time_from_trace-353"><span class="linenos">353</span></a>    <span class="k">def</span> <span class="nf">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
</span><span id="ThermoBaseClass.get_rt_time_from_trace-354"><a href="#ThermoBaseClass.get_rt_time_from_trace-354"><span class="linenos">354</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;trace: ThermoFisher.CommonCore.Data.Business.ChromatogramSignal&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_rt_time_from_trace-355"><a href="#ThermoBaseClass.get_rt_time_from_trace-355"><span class="linenos">355</span></a>        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Times</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Intensities</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">Scans</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>trace: ThermoFisher.CommonCore.Data.Business.ChromatogramSignal</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_eics" class="classattr">
                                        <input id="ThermoBaseClass.get_eics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_eics</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">target_mzs</span><span class="p">:</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Double</span><span class="p">]</span>,</span><span class="param">	<span class="n">tic_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>,</span><span class="param">	<span class="n">ms_type</span><span class="o">=</span><span class="s1">&#39;MS !d&#39;</span>,</span><span class="param">	<span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">smooth</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">legend</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n"><a href="../factory/chromat_data.html#EIC_Data">corems.mass_spectra.factory.chromat_data.EIC_Data</a></span><span class="p">],</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_eics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_eics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_eics-357"><a href="#ThermoBaseClass.get_eics-357"><span class="linenos">357</span></a>    <span class="k">def</span> <span class="nf">get_eics</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_eics-358"><a href="#ThermoBaseClass.get_eics-358"><span class="linenos">358</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-359"><a href="#ThermoBaseClass.get_eics-359"><span class="linenos">359</span></a>        <span class="n">target_mzs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_eics-360"><a href="#ThermoBaseClass.get_eics-360"><span class="linenos">360</span></a>        <span class="n">tic_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_eics-361"><a href="#ThermoBaseClass.get_eics-361"><span class="linenos">361</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-362"><a href="#ThermoBaseClass.get_eics-362"><span class="linenos">362</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-363"><a href="#ThermoBaseClass.get_eics-363"><span class="linenos">363</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-364"><a href="#ThermoBaseClass.get_eics-364"><span class="linenos">364</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-365"><a href="#ThermoBaseClass.get_eics-365"><span class="linenos">365</span></a>        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-366"><a href="#ThermoBaseClass.get_eics-366"><span class="linenos">366</span></a>        <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-367"><a href="#ThermoBaseClass.get_eics-367"><span class="linenos">367</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">EIC_Data</span><span class="p">],</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="ThermoBaseClass.get_eics-368"><a href="#ThermoBaseClass.get_eics-368"><span class="linenos">368</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS&#39;, MS2&#39;)</span>
</span><span id="ThermoBaseClass.get_eics-369"><a href="#ThermoBaseClass.get_eics-369"><span class="linenos">369</span></a><span class="sd">        start_scan: int default -1 will select the lowest available</span>
</span><span id="ThermoBaseClass.get_eics-370"><a href="#ThermoBaseClass.get_eics-370"><span class="linenos">370</span></a><span class="sd">        end_scan: int default -1 will select the highest available</span>
</span><span id="ThermoBaseClass.get_eics-371"><a href="#ThermoBaseClass.get_eics-371"><span class="linenos">371</span></a>
</span><span id="ThermoBaseClass.get_eics-372"><a href="#ThermoBaseClass.get_eics-372"><span class="linenos">372</span></a><span class="sd">        returns:</span>
</span><span id="ThermoBaseClass.get_eics-373"><a href="#ThermoBaseClass.get_eics-373"><span class="linenos">373</span></a>
</span><span id="ThermoBaseClass.get_eics-374"><a href="#ThermoBaseClass.get_eics-374"><span class="linenos">374</span></a><span class="sd">            chroma: dict{target_mz: EIC_Data(</span>
</span><span id="ThermoBaseClass.get_eics-375"><a href="#ThermoBaseClass.get_eics-375"><span class="linenos">375</span></a><span class="sd">                                        Scans: [int]</span>
</span><span id="ThermoBaseClass.get_eics-376"><a href="#ThermoBaseClass.get_eics-376"><span class="linenos">376</span></a><span class="sd">                                            original thermo scan numbers</span>
</span><span id="ThermoBaseClass.get_eics-377"><a href="#ThermoBaseClass.get_eics-377"><span class="linenos">377</span></a><span class="sd">                                        Time: [floats]</span>
</span><span id="ThermoBaseClass.get_eics-378"><a href="#ThermoBaseClass.get_eics-378"><span class="linenos">378</span></a><span class="sd">                                            list of retention times</span>
</span><span id="ThermoBaseClass.get_eics-379"><a href="#ThermoBaseClass.get_eics-379"><span class="linenos">379</span></a><span class="sd">                                        TIC: [floats]</span>
</span><span id="ThermoBaseClass.get_eics-380"><a href="#ThermoBaseClass.get_eics-380"><span class="linenos">380</span></a><span class="sd">                                            total ion chromatogram</span>
</span><span id="ThermoBaseClass.get_eics-381"><a href="#ThermoBaseClass.get_eics-381"><span class="linenos">381</span></a><span class="sd">                                        Apexes: [int]</span>
</span><span id="ThermoBaseClass.get_eics-382"><a href="#ThermoBaseClass.get_eics-382"><span class="linenos">382</span></a><span class="sd">                                            original thermo apex scan number after peak picking</span>
</span><span id="ThermoBaseClass.get_eics-383"><a href="#ThermoBaseClass.get_eics-383"><span class="linenos">383</span></a><span class="sd">                                        )</span>
</span><span id="ThermoBaseClass.get_eics-384"><a href="#ThermoBaseClass.get_eics-384"><span class="linenos">384</span></a>
</span><span id="ThermoBaseClass.get_eics-385"><a href="#ThermoBaseClass.get_eics-385"><span class="linenos">385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_eics-386"><a href="#ThermoBaseClass.get_eics-386"><span class="linenos">386</span></a>        <span class="c1"># If peak_detection or smooth is True, raise exception</span>
</span><span id="ThermoBaseClass.get_eics-387"><a href="#ThermoBaseClass.get_eics-387"><span class="linenos">387</span></a>        <span class="k">if</span> <span class="n">peak_detection</span> <span class="ow">or</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-388"><a href="#ThermoBaseClass.get_eics-388"><span class="linenos">388</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Peak detection and smoothing are no longer implemented in this function&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-389"><a href="#ThermoBaseClass.get_eics-389"><span class="linenos">389</span></a>
</span><span id="ThermoBaseClass.get_eics-390"><a href="#ThermoBaseClass.get_eics-390"><span class="linenos">390</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-391"><a href="#ThermoBaseClass.get_eics-391"><span class="linenos">391</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass.get_eics-392"><a href="#ThermoBaseClass.get_eics-392"><span class="linenos">392</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">eic_tolerance_ppm</span>
</span><span id="ThermoBaseClass.get_eics-393"><a href="#ThermoBaseClass.get_eics-393"><span class="linenos">393</span></a>
</span><span id="ThermoBaseClass.get_eics-394"><a href="#ThermoBaseClass.get_eics-394"><span class="linenos">394</span></a>        <span class="n">all_chroma_settings</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_eics-395"><a href="#ThermoBaseClass.get_eics-395"><span class="linenos">395</span></a>
</span><span id="ThermoBaseClass.get_eics-396"><a href="#ThermoBaseClass.get_eics-396"><span class="linenos">396</span></a>        <span class="k">for</span> <span class="n">target_mz</span> <span class="ow">in</span> <span class="n">target_mzs</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-397"><a href="#ThermoBaseClass.get_eics-397"><span class="linenos">397</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">MassRange</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-398"><a href="#ThermoBaseClass.get_eics-398"><span class="linenos">398</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="ThermoBaseClass.get_eics-399"><a href="#ThermoBaseClass.get_eics-399"><span class="linenos">399</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">MassRanges</span> <span class="o">=</span> <span class="p">[</span><span class="n">Range</span><span class="p">(</span><span class="n">target_mz</span><span class="p">,</span> <span class="n">target_mz</span><span class="p">)]</span>
</span><span id="ThermoBaseClass.get_eics-400"><a href="#ThermoBaseClass.get_eics-400"><span class="linenos">400</span></a>
</span><span id="ThermoBaseClass.get_eics-401"><a href="#ThermoBaseClass.get_eics-401"><span class="linenos">401</span></a>            <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-402"><a href="#ThermoBaseClass.get_eics-402"><span class="linenos">402</span></a>
</span><span id="ThermoBaseClass.get_eics-403"><a href="#ThermoBaseClass.get_eics-403"><span class="linenos">403</span></a>            <span class="n">all_chroma_settings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chroma_settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-404"><a href="#ThermoBaseClass.get_eics-404"><span class="linenos">404</span></a>
</span><span id="ThermoBaseClass.get_eics-405"><a href="#ThermoBaseClass.get_eics-405"><span class="linenos">405</span></a>        <span class="c1"># chroma_settings2 = IChromatogramSettings(settings)</span>
</span><span id="ThermoBaseClass.get_eics-406"><a href="#ThermoBaseClass.get_eics-406"><span class="linenos">406</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="ThermoBaseClass.get_eics-407"><a href="#ThermoBaseClass.get_eics-407"><span class="linenos">407</span></a>        <span class="c1"># print(chroma_settings.FragmentMass)</span>
</span><span id="ThermoBaseClass.get_eics-408"><a href="#ThermoBaseClass.get_eics-408"><span class="linenos">408</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="ThermoBaseClass.get_eics-409"><a href="#ThermoBaseClass.get_eics-409"><span class="linenos">409</span></a>        <span class="c1"># print(chroma_settings)</span>
</span><span id="ThermoBaseClass.get_eics-410"><a href="#ThermoBaseClass.get_eics-410"><span class="linenos">410</span></a>
</span><span id="ThermoBaseClass.get_eics-411"><a href="#ThermoBaseClass.get_eics-411"><span class="linenos">411</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_eics-412"><a href="#ThermoBaseClass.get_eics-412"><span class="linenos">412</span></a>            <span class="n">all_chroma_settings</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">options</span>
</span><span id="ThermoBaseClass.get_eics-413"><a href="#ThermoBaseClass.get_eics-413"><span class="linenos">413</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-414"><a href="#ThermoBaseClass.get_eics-414"><span class="linenos">414</span></a>
</span><span id="ThermoBaseClass.get_eics-415"><a href="#ThermoBaseClass.get_eics-415"><span class="linenos">415</span></a>        <span class="n">traces</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-416"><a href="#ThermoBaseClass.get_eics-416"><span class="linenos">416</span></a>
</span><span id="ThermoBaseClass.get_eics-417"><a href="#ThermoBaseClass.get_eics-417"><span class="linenos">417</span></a>        <span class="n">chroma</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_eics-418"><a href="#ThermoBaseClass.get_eics-418"><span class="linenos">418</span></a>
</span><span id="ThermoBaseClass.get_eics-419"><a href="#ThermoBaseClass.get_eics-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-420"><a href="#ThermoBaseClass.get_eics-420"><span class="linenos">420</span></a>            <span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Bbox</span>
</span><span id="ThermoBaseClass.get_eics-421"><a href="#ThermoBaseClass.get_eics-421"><span class="linenos">421</span></a>            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="ThermoBaseClass.get_eics-422"><a href="#ThermoBaseClass.get_eics-422"><span class="linenos">422</span></a>
</span><span id="ThermoBaseClass.get_eics-423"><a href="#ThermoBaseClass.get_eics-423"><span class="linenos">423</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-424"><a href="#ThermoBaseClass.get_eics-424"><span class="linenos">424</span></a>                <span class="c1"># ax = plt.gca()</span>
</span><span id="ThermoBaseClass.get_eics-425"><a href="#ThermoBaseClass.get_eics-425"><span class="linenos">425</span></a>                <span class="c1"># ax.clear()</span>
</span><span id="ThermoBaseClass.get_eics-426"><a href="#ThermoBaseClass.get_eics-426"><span class="linenos">426</span></a>                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-427"><a href="#ThermoBaseClass.get_eics-427"><span class="linenos">427</span></a>
</span><span id="ThermoBaseClass.get_eics-428"><a href="#ThermoBaseClass.get_eics-428"><span class="linenos">428</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-429"><a href="#ThermoBaseClass.get_eics-429"><span class="linenos">429</span></a>                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-430"><a href="#ThermoBaseClass.get_eics-430"><span class="linenos">430</span></a>
</span><span id="ThermoBaseClass.get_eics-431"><a href="#ThermoBaseClass.get_eics-431"><span class="linenos">431</span></a>            <span class="c1"># plt.show()</span>
</span><span id="ThermoBaseClass.get_eics-432"><a href="#ThermoBaseClass.get_eics-432"><span class="linenos">432</span></a>
</span><span id="ThermoBaseClass.get_eics-433"><a href="#ThermoBaseClass.get_eics-433"><span class="linenos">433</span></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">trace</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">traces</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_eics-434"><a href="#ThermoBaseClass.get_eics-434"><span class="linenos">434</span></a>            <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-435"><a href="#ThermoBaseClass.get_eics-435"><span class="linenos">435</span></a>                <span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">scans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rt_time_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-436"><a href="#ThermoBaseClass.get_eics-436"><span class="linenos">436</span></a>                <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-437"><a href="#ThermoBaseClass.get_eics-437"><span class="linenos">437</span></a>                    <span class="n">eic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-438"><a href="#ThermoBaseClass.get_eics-438"><span class="linenos">438</span></a>
</span><span id="ThermoBaseClass.get_eics-439"><a href="#ThermoBaseClass.get_eics-439"><span class="linenos">439</span></a>                <span class="n">chroma</span><span class="p">[</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span><span class="n">scans</span><span class="o">=</span><span class="n">scans</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="o">=</span><span class="n">eic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-440"><a href="#ThermoBaseClass.get_eics-440"><span class="linenos">440</span></a>                <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-441"><a href="#ThermoBaseClass.get_eics-441"><span class="linenos">441</span></a>                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rt</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{:.5f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">target_mzs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</span><span id="ThermoBaseClass.get_eics-442"><a href="#ThermoBaseClass.get_eics-442"><span class="linenos">442</span></a>
</span><span id="ThermoBaseClass.get_eics-443"><a href="#ThermoBaseClass.get_eics-443"><span class="linenos">443</span></a>        <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-444"><a href="#ThermoBaseClass.get_eics-444"><span class="linenos">444</span></a>            <span class="c1"># max_eic = self.get_max_eic(chroma)</span>
</span><span id="ThermoBaseClass.get_eics-445"><a href="#ThermoBaseClass.get_eics-445"><span class="linenos">445</span></a>            <span class="n">max_signal</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-446"><a href="#ThermoBaseClass.get_eics-446"><span class="linenos">446</span></a>
</span><span id="ThermoBaseClass.get_eics-447"><a href="#ThermoBaseClass.get_eics-447"><span class="linenos">447</span></a>            <span class="k">for</span> <span class="n">eic_data</span> <span class="ow">in</span> <span class="n">chroma</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
</span><span id="ThermoBaseClass.get_eics-448"><a href="#ThermoBaseClass.get_eics-448"><span class="linenos">448</span></a>                <span class="n">eic</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">eic</span>
</span><span id="ThermoBaseClass.get_eics-449"><a href="#ThermoBaseClass.get_eics-449"><span class="linenos">449</span></a>                <span class="n">time</span> <span class="o">=</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">time</span>
</span><span id="ThermoBaseClass.get_eics-450"><a href="#ThermoBaseClass.get_eics-450"><span class="linenos">450</span></a>
</span><span id="ThermoBaseClass.get_eics-451"><a href="#ThermoBaseClass.get_eics-451"><span class="linenos">451</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">eic</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_eics-452"><a href="#ThermoBaseClass.get_eics-452"><span class="linenos">452</span></a>                    <span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_eics-453"><a href="#ThermoBaseClass.get_eics-453"><span class="linenos">453</span></a>                        <span class="s2">&quot;The software assumes same lenth of TIC and EIC, this does not seems to be the case and the results mass spectrum selected by the scan number might not be correct&quot;</span>
</span><span id="ThermoBaseClass.get_eics-454"><a href="#ThermoBaseClass.get_eics-454"><span class="linenos">454</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-455"><a href="#ThermoBaseClass.get_eics-455"><span class="linenos">455</span></a>
</span><span id="ThermoBaseClass.get_eics-456"><a href="#ThermoBaseClass.get_eics-456"><span class="linenos">456</span></a>                <span class="k">if</span> <span class="n">eic</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-457"><a href="#ThermoBaseClass.get_eics-457"><span class="linenos">457</span></a>                    <span class="n">centroid_eics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eic_centroid_detector</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">eic</span><span class="p">,</span> <span class="n">max_signal</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-458"><a href="#ThermoBaseClass.get_eics-458"><span class="linenos">458</span></a>                    <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">centroid_eics</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_eics-459"><a href="#ThermoBaseClass.get_eics-459"><span class="linenos">459</span></a>
</span><span id="ThermoBaseClass.get_eics-460"><a href="#ThermoBaseClass.get_eics-460"><span class="linenos">460</span></a>                    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-461"><a href="#ThermoBaseClass.get_eics-461"><span class="linenos">461</span></a>                        <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">eic_data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-462"><a href="#ThermoBaseClass.get_eics-462"><span class="linenos">462</span></a>                            <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_eics-463"><a href="#ThermoBaseClass.get_eics-463"><span class="linenos">463</span></a>                            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_eics-464"><a href="#ThermoBaseClass.get_eics-464"><span class="linenos">464</span></a>                                <span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_eics-465"><a href="#ThermoBaseClass.get_eics-465"><span class="linenos">465</span></a>                                <span class="n">eic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_eics-466"><a href="#ThermoBaseClass.get_eics-466"><span class="linenos">466</span></a>                                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-467"><a href="#ThermoBaseClass.get_eics-467"><span class="linenos">467</span></a>                                <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_eics-468"><a href="#ThermoBaseClass.get_eics-468"><span class="linenos">468</span></a>                            <span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-469"><a href="#ThermoBaseClass.get_eics-469"><span class="linenos">469</span></a>
</span><span id="ThermoBaseClass.get_eics-470"><a href="#ThermoBaseClass.get_eics-470"><span class="linenos">470</span></a>        <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-471"><a href="#ThermoBaseClass.get_eics-471"><span class="linenos">471</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-472"><a href="#ThermoBaseClass.get_eics-472"><span class="linenos">472</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-473"><a href="#ThermoBaseClass.get_eics-473"><span class="linenos">473</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ms_type</span> <span class="o">+</span> <span class="s2">&quot; EIC&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-474"><a href="#ThermoBaseClass.get_eics-474"><span class="linenos">474</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;major&quot;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-475"><a href="#ThermoBaseClass.get_eics-475"><span class="linenos">475</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-476"><a href="#ThermoBaseClass.get_eics-476"><span class="linenos">476</span></a>            <span class="n">ax</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-477"><a href="#ThermoBaseClass.get_eics-477"><span class="linenos">477</span></a>
</span><span id="ThermoBaseClass.get_eics-478"><a href="#ThermoBaseClass.get_eics-478"><span class="linenos">478</span></a>            <span class="k">if</span> <span class="n">legend</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-479"><a href="#ThermoBaseClass.get_eics-479"><span class="linenos">479</span></a>                <span class="n">legend</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="ThermoBaseClass.get_eics-480"><a href="#ThermoBaseClass.get_eics-480"><span class="linenos">480</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.76</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-481"><a href="#ThermoBaseClass.get_eics-481"><span class="linenos">481</span></a>                <span class="c1"># ax.set_prop_cycle(color=plt.cm.gist_rainbow(np.linspace(0, 1, len(traces))))</span>
</span><span id="ThermoBaseClass.get_eics-482"><a href="#ThermoBaseClass.get_eics-482"><span class="linenos">482</span></a>
</span><span id="ThermoBaseClass.get_eics-483"><a href="#ThermoBaseClass.get_eics-483"><span class="linenos">483</span></a>                <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;down&quot;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">}</span>
</span><span id="ThermoBaseClass.get_eics-484"><a href="#ThermoBaseClass.get_eics-484"><span class="linenos">484</span></a>
</span><span id="ThermoBaseClass.get_eics-485"><a href="#ThermoBaseClass.get_eics-485"><span class="linenos">485</span></a>                <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_eics-486"><a href="#ThermoBaseClass.get_eics-486"><span class="linenos">486</span></a>                    <span class="k">if</span> <span class="n">legend</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">evt</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_eics-487"><a href="#ThermoBaseClass.get_eics-487"><span class="linenos">487</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_bbox_to_anchor</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-488"><a href="#ThermoBaseClass.get_eics-488"><span class="linenos">488</span></a>                        <span class="n">bbox</span> <span class="o">=</span> <span class="n">Bbox</span><span class="o">.</span><span class="n">from_bounds</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_eics-489"><a href="#ThermoBaseClass.get_eics-489"><span class="linenos">489</span></a>                            <span class="n">bbox</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">evt</span><span class="o">.</span><span class="n">button</span><span class="p">],</span> <span class="n">bbox</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">bbox</span><span class="o">.</span><span class="n">height</span>
</span><span id="ThermoBaseClass.get_eics-490"><a href="#ThermoBaseClass.get_eics-490"><span class="linenos">490</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-491"><a href="#ThermoBaseClass.get_eics-491"><span class="linenos">491</span></a>                        <span class="n">tr</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">transAxes</span><span class="o">.</span><span class="n">inverted</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-492"><a href="#ThermoBaseClass.get_eics-492"><span class="linenos">492</span></a>                        <span class="n">legend</span><span class="o">.</span><span class="n">set_bbox_to_anchor</span><span class="p">(</span><span class="n">bbox</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">tr</span><span class="p">))</span>
</span><span id="ThermoBaseClass.get_eics-493"><a href="#ThermoBaseClass.get_eics-493"><span class="linenos">493</span></a>                        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_eics-494"><a href="#ThermoBaseClass.get_eics-494"><span class="linenos">494</span></a>
</span><span id="ThermoBaseClass.get_eics-495"><a href="#ThermoBaseClass.get_eics-495"><span class="linenos">495</span></a>                <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s2">&quot;scroll_event&quot;</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_eics-496"><a href="#ThermoBaseClass.get_eics-496"><span class="linenos">496</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="ThermoBaseClass.get_eics-497"><a href="#ThermoBaseClass.get_eics-497"><span class="linenos">497</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_eics-498"><a href="#ThermoBaseClass.get_eics-498"><span class="linenos">498</span></a>            <span class="k">return</span> <span class="n">chroma</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_eics-499"><a href="#ThermoBaseClass.get_eics-499"><span class="linenos">499</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_eics-500"><a href="#ThermoBaseClass.get_eics-500"><span class="linenos">500</span></a>            <span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_eics-501"><a href="#ThermoBaseClass.get_eics-501"><span class="linenos">501</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_eics-502"><a href="#ThermoBaseClass.get_eics-502"><span class="linenos">502</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_eics-503"><a href="#ThermoBaseClass.get_eics-503"><span class="linenos">503</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="ThermoBaseClass.get_eics-504"><a href="#ThermoBaseClass.get_eics-504"><span class="linenos">504</span></a>
</span><span id="ThermoBaseClass.get_eics-505"><a href="#ThermoBaseClass.get_eics-505"><span class="linenos">505</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="ThermoBaseClass.get_eics-506"><a href="#ThermoBaseClass.get_eics-506"><span class="linenos">506</span></a>                <span class="n">rt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_eics-507"><a href="#ThermoBaseClass.get_eics-507"><span class="linenos">507</span></a>                <span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_eics-508"><a href="#ThermoBaseClass.get_eics-508"><span class="linenos">508</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">traces</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_eics-509"><a href="#ThermoBaseClass.get_eics-509"><span class="linenos">509</span></a>
</span><span id="ThermoBaseClass.get_eics-510"><a href="#ThermoBaseClass.get_eics-510"><span class="linenos">510</span></a>            <span class="k">return</span> <span class="n">traces</span>
</span><span id="ThermoBaseClass.get_eics-511"><a href="#ThermoBaseClass.get_eics-511"><span class="linenos">511</span></a>            <span class="c1"># plot_chroma(rt, tic)</span>
</span><span id="ThermoBaseClass.get_eics-512"><a href="#ThermoBaseClass.get_eics-512"><span class="linenos">512</span></a>            <span class="c1"># plt.show()</span>
</span></pre></div>


            <div class="docstring"><p>ms_type: str ('MS', MS2')
start_scan: int default -1 will select the lowest available
end_scan: int default -1 will select the highest available</p>

<p>returns:</p>

<pre><code>chroma: dict{target_mz: EIC_Data(
                            Scans: [int]
                                original thermo scan numbers
                            Time: [floats]
                                list of retention times
                            TIC: [floats]
                                total ion chromatogram
                            Apexes: [int]
                                original thermo apex scan number after peak picking
                            )
</code></pre>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_tic" class="classattr">
                                        <input id="ThermoBaseClass.get_tic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tic</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">ms_type</span><span class="o">=</span><span class="s1">&#39;MS !d&#39;</span>,</span><span class="param">	<span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">smooth</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">plot</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">ax</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">trace_type</span><span class="o">=</span><span class="s1">&#39;TIC&#39;</span></span><span class="return-annotation">) -> <span class="n">Tuple</span><span class="p">[</span><span class="n"><a href="../factory/chromat_data.html#TIC_Data">corems.mass_spectra.factory.chromat_data.TIC_Data</a></span><span class="p">,</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_tic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_tic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_tic-514"><a href="#ThermoBaseClass.get_tic-514"><span class="linenos">514</span></a>    <span class="k">def</span> <span class="nf">get_tic</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_tic-515"><a href="#ThermoBaseClass.get_tic-515"><span class="linenos">515</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-516"><a href="#ThermoBaseClass.get_tic-516"><span class="linenos">516</span></a>        <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS !d&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-517"><a href="#ThermoBaseClass.get_tic-517"><span class="linenos">517</span></a>        <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="ThermoBaseClass.get_tic-518"><a href="#ThermoBaseClass.get_tic-518"><span class="linenos">518</span></a>        <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># This wont work right now</span>
</span><span id="ThermoBaseClass.get_tic-519"><a href="#ThermoBaseClass.get_tic-519"><span class="linenos">519</span></a>        <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-520"><a href="#ThermoBaseClass.get_tic-520"><span class="linenos">520</span></a>        <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-521"><a href="#ThermoBaseClass.get_tic-521"><span class="linenos">521</span></a>        <span class="n">trace_type</span><span class="o">=</span><span class="s2">&quot;TIC&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-522"><a href="#ThermoBaseClass.get_tic-522"><span class="linenos">522</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">TIC_Data</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>
</span><span id="ThermoBaseClass.get_tic-523"><a href="#ThermoBaseClass.get_tic-523"><span class="linenos">523</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;ms_type: str (&#39;MS !d&#39;, &#39;MS2&#39;, None)</span>
</span><span id="ThermoBaseClass.get_tic-524"><a href="#ThermoBaseClass.get_tic-524"><span class="linenos">524</span></a><span class="sd">            if you use None you get all scans.</span>
</span><span id="ThermoBaseClass.get_tic-525"><a href="#ThermoBaseClass.get_tic-525"><span class="linenos">525</span></a><span class="sd">        peak_detection: bool</span>
</span><span id="ThermoBaseClass.get_tic-526"><a href="#ThermoBaseClass.get_tic-526"><span class="linenos">526</span></a><span class="sd">        smooth: bool</span>
</span><span id="ThermoBaseClass.get_tic-527"><a href="#ThermoBaseClass.get_tic-527"><span class="linenos">527</span></a><span class="sd">        plot: bool</span>
</span><span id="ThermoBaseClass.get_tic-528"><a href="#ThermoBaseClass.get_tic-528"><span class="linenos">528</span></a><span class="sd">        ax: matplotlib axis object</span>
</span><span id="ThermoBaseClass.get_tic-529"><a href="#ThermoBaseClass.get_tic-529"><span class="linenos">529</span></a><span class="sd">        trace_type: str (&#39;TIC&#39;,&#39;BPC&#39;)</span>
</span><span id="ThermoBaseClass.get_tic-530"><a href="#ThermoBaseClass.get_tic-530"><span class="linenos">530</span></a>
</span><span id="ThermoBaseClass.get_tic-531"><a href="#ThermoBaseClass.get_tic-531"><span class="linenos">531</span></a><span class="sd">        returns:</span>
</span><span id="ThermoBaseClass.get_tic-532"><a href="#ThermoBaseClass.get_tic-532"><span class="linenos">532</span></a><span class="sd">            chroma: dict</span>
</span><span id="ThermoBaseClass.get_tic-533"><a href="#ThermoBaseClass.get_tic-533"><span class="linenos">533</span></a><span class="sd">            {</span>
</span><span id="ThermoBaseClass.get_tic-534"><a href="#ThermoBaseClass.get_tic-534"><span class="linenos">534</span></a><span class="sd">            Scan: [int]</span>
</span><span id="ThermoBaseClass.get_tic-535"><a href="#ThermoBaseClass.get_tic-535"><span class="linenos">535</span></a><span class="sd">                original thermo scan numberMS</span>
</span><span id="ThermoBaseClass.get_tic-536"><a href="#ThermoBaseClass.get_tic-536"><span class="linenos">536</span></a><span class="sd">            Time: [floats]</span>
</span><span id="ThermoBaseClass.get_tic-537"><a href="#ThermoBaseClass.get_tic-537"><span class="linenos">537</span></a><span class="sd">                list of retention times</span>
</span><span id="ThermoBaseClass.get_tic-538"><a href="#ThermoBaseClass.get_tic-538"><span class="linenos">538</span></a><span class="sd">            TIC: [floats]</span>
</span><span id="ThermoBaseClass.get_tic-539"><a href="#ThermoBaseClass.get_tic-539"><span class="linenos">539</span></a><span class="sd">                total ion chromatogram</span>
</span><span id="ThermoBaseClass.get_tic-540"><a href="#ThermoBaseClass.get_tic-540"><span class="linenos">540</span></a><span class="sd">            Apexes: [int]</span>
</span><span id="ThermoBaseClass.get_tic-541"><a href="#ThermoBaseClass.get_tic-541"><span class="linenos">541</span></a><span class="sd">                original thermo apex scan number after peak picking</span>
</span><span id="ThermoBaseClass.get_tic-542"><a href="#ThermoBaseClass.get_tic-542"><span class="linenos">542</span></a><span class="sd">            }</span>
</span><span id="ThermoBaseClass.get_tic-543"><a href="#ThermoBaseClass.get_tic-543"><span class="linenos">543</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_tic-544"><a href="#ThermoBaseClass.get_tic-544"><span class="linenos">544</span></a>        <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;TIC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-545"><a href="#ThermoBaseClass.get_tic-545"><span class="linenos">545</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">TIC</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-546"><a href="#ThermoBaseClass.get_tic-546"><span class="linenos">546</span></a>        <span class="k">elif</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-547"><a href="#ThermoBaseClass.get_tic-547"><span class="linenos">547</span></a>            <span class="n">settings</span> <span class="o">=</span> <span class="n">ChromatogramTraceSettings</span><span class="p">(</span><span class="n">TraceType</span><span class="o">.</span><span class="n">BasePeak</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-548"><a href="#ThermoBaseClass.get_tic-548"><span class="linenos">548</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-549"><a href="#ThermoBaseClass.get_tic-549"><span class="linenos">549</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">trace_type</span><span class="si">}</span><span class="s2"> undefined&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-550"><a href="#ThermoBaseClass.get_tic-550"><span class="linenos">550</span></a>        <span class="k">if</span> <span class="n">ms_type</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-551"><a href="#ThermoBaseClass.get_tic-551"><span class="linenos">551</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_tic-552"><a href="#ThermoBaseClass.get_tic-552"><span class="linenos">552</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-553"><a href="#ThermoBaseClass.get_tic-553"><span class="linenos">553</span></a>            <span class="n">settings</span><span class="o">.</span><span class="n">Filter</span> <span class="o">=</span> <span class="n">ms_type</span>
</span><span id="ThermoBaseClass.get_tic-554"><a href="#ThermoBaseClass.get_tic-554"><span class="linenos">554</span></a>
</span><span id="ThermoBaseClass.get_tic-555"><a href="#ThermoBaseClass.get_tic-555"><span class="linenos">555</span></a>        <span class="n">chroma_settings</span> <span class="o">=</span> <span class="n">IChromatogramSettings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-556"><a href="#ThermoBaseClass.get_tic-556"><span class="linenos">556</span></a>
</span><span id="ThermoBaseClass.get_tic-557"><a href="#ThermoBaseClass.get_tic-557"><span class="linenos">557</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetChromatogramData</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_tic-558"><a href="#ThermoBaseClass.get_tic-558"><span class="linenos">558</span></a>            <span class="p">[</span><span class="n">chroma_settings</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ThermoBaseClass.get_tic-559"><a href="#ThermoBaseClass.get_tic-559"><span class="linenos">559</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-560"><a href="#ThermoBaseClass.get_tic-560"><span class="linenos">560</span></a>
</span><span id="ThermoBaseClass.get_tic-561"><a href="#ThermoBaseClass.get_tic-561"><span class="linenos">561</span></a>        <span class="n">trace</span> <span class="o">=</span> <span class="n">ChromatogramSignal</span><span class="o">.</span><span class="n">FromChromatogramData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-562"><a href="#ThermoBaseClass.get_tic-562"><span class="linenos">562</span></a>
</span><span id="ThermoBaseClass.get_tic-563"><a href="#ThermoBaseClass.get_tic-563"><span class="linenos">563</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">TIC_Data</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="p">[],</span> <span class="n">scans</span><span class="o">=</span><span class="p">[],</span> <span class="n">tic</span><span class="o">=</span><span class="p">[],</span> <span class="n">bpc</span><span class="o">=</span><span class="p">[],</span> <span class="n">apexes</span><span class="o">=</span><span class="p">[])</span>
</span><span id="ThermoBaseClass.get_tic-564"><a href="#ThermoBaseClass.get_tic-564"><span class="linenos">564</span></a>
</span><span id="ThermoBaseClass.get_tic-565"><a href="#ThermoBaseClass.get_tic-565"><span class="linenos">565</span></a>        <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-566"><a href="#ThermoBaseClass.get_tic-566"><span class="linenos">566</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_tic-567"><a href="#ThermoBaseClass.get_tic-567"><span class="linenos">567</span></a>                <span class="c1"># print(trace[0].HasBasePeakData,trace[0].EndTime )</span>
</span><span id="ThermoBaseClass.get_tic-568"><a href="#ThermoBaseClass.get_tic-568"><span class="linenos">568</span></a>
</span><span id="ThermoBaseClass.get_tic-569"><a href="#ThermoBaseClass.get_tic-569"><span class="linenos">569</span></a>                <span class="c1"># print(&quot;  {} - {}, {}&quot;.format( i, trace[0].Times[i], trace[0].Intensities[i] ))</span>
</span><span id="ThermoBaseClass.get_tic-570"><a href="#ThermoBaseClass.get_tic-570"><span class="linenos">570</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_tic-571"><a href="#ThermoBaseClass.get_tic-571"><span class="linenos">571</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Intensities</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_tic-572"><a href="#ThermoBaseClass.get_tic-572"><span class="linenos">572</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">scans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">Scans</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="ThermoBaseClass.get_tic-573"><a href="#ThermoBaseClass.get_tic-573"><span class="linenos">573</span></a>
</span><span id="ThermoBaseClass.get_tic-574"><a href="#ThermoBaseClass.get_tic-574"><span class="linenos">574</span></a>                <span class="c1"># print(trace[0].Scans[i])</span>
</span><span id="ThermoBaseClass.get_tic-575"><a href="#ThermoBaseClass.get_tic-575"><span class="linenos">575</span></a>            <span class="k">if</span> <span class="n">smooth</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-576"><a href="#ThermoBaseClass.get_tic-576"><span class="linenos">576</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">smooth_tic</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-577"><a href="#ThermoBaseClass.get_tic-577"><span class="linenos">577</span></a>
</span><span id="ThermoBaseClass.get_tic-578"><a href="#ThermoBaseClass.get_tic-578"><span class="linenos">578</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-579"><a href="#ThermoBaseClass.get_tic-579"><span class="linenos">579</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-580"><a href="#ThermoBaseClass.get_tic-580"><span class="linenos">580</span></a>
</span><span id="ThermoBaseClass.get_tic-581"><a href="#ThermoBaseClass.get_tic-581"><span class="linenos">581</span></a>            <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-582"><a href="#ThermoBaseClass.get_tic-582"><span class="linenos">582</span></a>                <span class="n">centroid_peak_indexes</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ThermoBaseClass.get_tic-583"><a href="#ThermoBaseClass.get_tic-583"><span class="linenos">583</span></a>                    <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid_detector</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-584"><a href="#ThermoBaseClass.get_tic-584"><span class="linenos">584</span></a>                <span class="p">]</span>
</span><span id="ThermoBaseClass.get_tic-585"><a href="#ThermoBaseClass.get_tic-585"><span class="linenos">585</span></a>
</span><span id="ThermoBaseClass.get_tic-586"><a href="#ThermoBaseClass.get_tic-586"><span class="linenos">586</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="n">centroid_peak_indexes</span>
</span><span id="ThermoBaseClass.get_tic-587"><a href="#ThermoBaseClass.get_tic-587"><span class="linenos">587</span></a>
</span><span id="ThermoBaseClass.get_tic-588"><a href="#ThermoBaseClass.get_tic-588"><span class="linenos">588</span></a>            <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-589"><a href="#ThermoBaseClass.get_tic-589"><span class="linenos">589</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">ax</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-590"><a href="#ThermoBaseClass.get_tic-590"><span class="linenos">590</span></a>                    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="ThermoBaseClass.get_tic-591"><a href="#ThermoBaseClass.get_tic-591"><span class="linenos">591</span></a>
</span><span id="ThermoBaseClass.get_tic-592"><a href="#ThermoBaseClass.get_tic-592"><span class="linenos">592</span></a>                    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_tic-593"><a href="#ThermoBaseClass.get_tic-593"><span class="linenos">593</span></a>                    <span class="c1"># fig, ax = plt.subplots(figsize=(6, 3))</span>
</span><span id="ThermoBaseClass.get_tic-594"><a href="#ThermoBaseClass.get_tic-594"><span class="linenos">594</span></a>
</span><span id="ThermoBaseClass.get_tic-595"><a href="#ThermoBaseClass.get_tic-595"><span class="linenos">595</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">trace_type</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-596"><a href="#ThermoBaseClass.get_tic-596"><span class="linenos">596</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (min)&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-597"><a href="#ThermoBaseClass.get_tic-597"><span class="linenos">597</span></a>                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;a.u.&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-598"><a href="#ThermoBaseClass.get_tic-598"><span class="linenos">598</span></a>                <span class="k">if</span> <span class="n">peak_detection</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-599"><a href="#ThermoBaseClass.get_tic-599"><span class="linenos">599</span></a>                    <span class="k">for</span> <span class="n">peak_indexes</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">apexes</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-600"><a href="#ThermoBaseClass.get_tic-600"><span class="linenos">600</span></a>                        <span class="n">apex_index</span> <span class="o">=</span> <span class="n">peak_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_tic-601"><a href="#ThermoBaseClass.get_tic-601"><span class="linenos">601</span></a>                        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_tic-602"><a href="#ThermoBaseClass.get_tic-602"><span class="linenos">602</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_tic-603"><a href="#ThermoBaseClass.get_tic-603"><span class="linenos">603</span></a>                            <span class="n">data</span><span class="o">.</span><span class="n">tic</span><span class="p">[</span><span class="n">apex_index</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_tic-604"><a href="#ThermoBaseClass.get_tic-604"><span class="linenos">604</span></a>                            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-605"><a href="#ThermoBaseClass.get_tic-605"><span class="linenos">605</span></a>                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_tic-606"><a href="#ThermoBaseClass.get_tic-606"><span class="linenos">606</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_tic-607"><a href="#ThermoBaseClass.get_tic-607"><span class="linenos">607</span></a>
</span><span id="ThermoBaseClass.get_tic-608"><a href="#ThermoBaseClass.get_tic-608"><span class="linenos">608</span></a>                <span class="c1"># plt.show()</span>
</span><span id="ThermoBaseClass.get_tic-609"><a href="#ThermoBaseClass.get_tic-609"><span class="linenos">609</span></a>                <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-610"><a href="#ThermoBaseClass.get_tic-610"><span class="linenos">610</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="ThermoBaseClass.get_tic-611"><a href="#ThermoBaseClass.get_tic-611"><span class="linenos">611</span></a>                    <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_tic-612"><a href="#ThermoBaseClass.get_tic-612"><span class="linenos">612</span></a>                <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="n">ax</span>
</span><span id="ThermoBaseClass.get_tic-613"><a href="#ThermoBaseClass.get_tic-613"><span class="linenos">613</span></a>            <span class="k">if</span> <span class="n">trace_type</span> <span class="o">==</span> <span class="s2">&quot;BPC&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-614"><a href="#ThermoBaseClass.get_tic-614"><span class="linenos">614</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">bpc</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tic</span>
</span><span id="ThermoBaseClass.get_tic-615"><a href="#ThermoBaseClass.get_tic-615"><span class="linenos">615</span></a>                <span class="n">data</span><span class="o">.</span><span class="n">tic</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_tic-616"><a href="#ThermoBaseClass.get_tic-616"><span class="linenos">616</span></a>            <span class="k">return</span> <span class="n">data</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_tic-617"><a href="#ThermoBaseClass.get_tic-617"><span class="linenos">617</span></a>
</span><span id="ThermoBaseClass.get_tic-618"><a href="#ThermoBaseClass.get_tic-618"><span class="linenos">618</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tic-619"><a href="#ThermoBaseClass.get_tic-619"><span class="linenos">619</span></a>            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>ms_type: str ('MS !d', 'MS2', None)
    if you use None you get all scans.
peak_detection: bool
smooth: bool
plot: bool
ax: matplotlib axis object
trace_type: str ('TIC','BPC')</p>

<p>returns:
    chroma: dict
    {
    Scan: [int]
        original thermo scan numberMS
    Time: [floats]
        list of retention times
    TIC: [floats]
        total ion chromatogram
    Apexes: [int]
        original thermo apex scan number after peak picking
    }</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_average_mass_spectrum" class="classattr">
                                        <input id="ThermoBaseClass.get_average_mass_spectrum-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_average_mass_spectrum</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">spectrum_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;profile&#39;</span>,</span><span class="param">	<span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>,</span><span class="param">	<span class="n">ms_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;MS1&#39;</span></span><span class="return-annotation">) -> <span class="n"><a href="../../mass_spectrum/factory/MassSpectrumClasses.html#MassSpecProfile">corems.mass_spectrum.factory.MassSpectrumClasses.MassSpecProfile</a></span> <span class="o">|</span> <span class="n"><a href="../../mass_spectrum/factory/MassSpectrumClasses.html#MassSpecCentroid">corems.mass_spectrum.factory.MassSpectrumClasses.MassSpecCentroid</a></span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_average_mass_spectrum-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_average_mass_spectrum"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_average_mass_spectrum-621"><a href="#ThermoBaseClass.get_average_mass_spectrum-621"><span class="linenos">621</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-622"><a href="#ThermoBaseClass.get_average_mass_spectrum-622"><span class="linenos">622</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-623"><a href="#ThermoBaseClass.get_average_mass_spectrum-623"><span class="linenos">623</span></a>        <span class="n">spectrum_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-624"><a href="#ThermoBaseClass.get_average_mass_spectrum-624"><span class="linenos">624</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-625"><a href="#ThermoBaseClass.get_average_mass_spectrum-625"><span class="linenos">625</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-626"><a href="#ThermoBaseClass.get_average_mass_spectrum-626"><span class="linenos">626</span></a>        <span class="n">ms_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;MS1&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-627"><a href="#ThermoBaseClass.get_average_mass_spectrum-627"><span class="linenos">627</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span> <span class="o">|</span> <span class="n">MassSpecCentroid</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-628"><a href="#ThermoBaseClass.get_average_mass_spectrum-628"><span class="linenos">628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-629"><a href="#ThermoBaseClass.get_average_mass_spectrum-629"><span class="linenos">629</span></a><span class="sd">        Averages mass spectra over a scan range using Thermo&#39;s AverageScansInScanRange method</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-630"><a href="#ThermoBaseClass.get_average_mass_spectrum-630"><span class="linenos">630</span></a><span class="sd">        or a scan list using Thermo&#39;s AverageScans method</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-631"><a href="#ThermoBaseClass.get_average_mass_spectrum-631"><span class="linenos">631</span></a><span class="sd">        spectrum_mode: str</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-632"><a href="#ThermoBaseClass.get_average_mass_spectrum-632"><span class="linenos">632</span></a><span class="sd">            centroid or profile mass spectrum</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-633"><a href="#ThermoBaseClass.get_average_mass_spectrum-633"><span class="linenos">633</span></a><span class="sd">        auto_process: bool</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-634"><a href="#ThermoBaseClass.get_average_mass_spectrum-634"><span class="linenos">634</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-635"><a href="#ThermoBaseClass.get_average_mass_spectrum-635"><span class="linenos">635</span></a><span class="sd">        ms_type: str</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-636"><a href="#ThermoBaseClass.get_average_mass_spectrum-636"><span class="linenos">636</span></a><span class="sd">            String of form &#39;ms1&#39; or &#39;ms2&#39; or &#39;MS3&#39; etc. Valid up to MS10.</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-637"><a href="#ThermoBaseClass.get_average_mass_spectrum-637"><span class="linenos">637</span></a><span class="sd">            Internal function converts to Thermo MSOrderType class.</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-638"><a href="#ThermoBaseClass.get_average_mass_spectrum-638"><span class="linenos">638</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-639"><a href="#ThermoBaseClass.get_average_mass_spectrum-639"><span class="linenos">639</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-640"><a href="#ThermoBaseClass.get_average_mass_spectrum-640"><span class="linenos">640</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-641"><a href="#ThermoBaseClass.get_average_mass_spectrum-641"><span class="linenos">641</span></a>        <span class="k">def</span> <span class="nf">get_profile_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-642"><a href="#ThermoBaseClass.get_average_mass_spectrum-642"><span class="linenos">642</span></a>            <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-643"><a href="#ThermoBaseClass.get_average_mass_spectrum-643"><span class="linenos">643</span></a>            <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-644"><a href="#ThermoBaseClass.get_average_mass_spectrum-644"><span class="linenos">644</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-645"><a href="#ThermoBaseClass.get_average_mass_spectrum-645"><span class="linenos">645</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-646"><a href="#ThermoBaseClass.get_average_mass_spectrum-646"><span class="linenos">646</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-647"><a href="#ThermoBaseClass.get_average_mass_spectrum-647"><span class="linenos">647</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-648"><a href="#ThermoBaseClass.get_average_mass_spectrum-648"><span class="linenos">648</span></a>            <span class="p">}</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-649"><a href="#ThermoBaseClass.get_average_mass_spectrum-649"><span class="linenos">649</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-650"><a href="#ThermoBaseClass.get_average_mass_spectrum-650"><span class="linenos">650</span></a>            <span class="k">return</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-651"><a href="#ThermoBaseClass.get_average_mass_spectrum-651"><span class="linenos">651</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-652"><a href="#ThermoBaseClass.get_average_mass_spectrum-652"><span class="linenos">652</span></a>        <span class="k">def</span> <span class="nf">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-653"><a href="#ThermoBaseClass.get_average_mass_spectrum-653"><span class="linenos">653</span></a>            <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-654"><a href="#ThermoBaseClass.get_average_mass_spectrum-654"><span class="linenos">654</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-655"><a href="#ThermoBaseClass.get_average_mass_spectrum-655"><span class="linenos">655</span></a>            <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-656"><a href="#ThermoBaseClass.get_average_mass_spectrum-656"><span class="linenos">656</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-657"><a href="#ThermoBaseClass.get_average_mass_spectrum-657"><span class="linenos">657</span></a>            <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-658"><a href="#ThermoBaseClass.get_average_mass_spectrum-658"><span class="linenos">658</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-659"><a href="#ThermoBaseClass.get_average_mass_spectrum-659"><span class="linenos">659</span></a>            <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-660"><a href="#ThermoBaseClass.get_average_mass_spectrum-660"><span class="linenos">660</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-661"><a href="#ThermoBaseClass.get_average_mass_spectrum-661"><span class="linenos">661</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">centroidScan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-662"><a href="#ThermoBaseClass.get_average_mass_spectrum-662"><span class="linenos">662</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-663"><a href="#ThermoBaseClass.get_average_mass_spectrum-663"><span class="linenos">663</span></a>            <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-664"><a href="#ThermoBaseClass.get_average_mass_spectrum-664"><span class="linenos">664</span></a>            <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-665"><a href="#ThermoBaseClass.get_average_mass_spectrum-665"><span class="linenos">665</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-666"><a href="#ThermoBaseClass.get_average_mass_spectrum-666"><span class="linenos">666</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-667"><a href="#ThermoBaseClass.get_average_mass_spectrum-667"><span class="linenos">667</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-668"><a href="#ThermoBaseClass.get_average_mass_spectrum-668"><span class="linenos">668</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-669"><a href="#ThermoBaseClass.get_average_mass_spectrum-669"><span class="linenos">669</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-670"><a href="#ThermoBaseClass.get_average_mass_spectrum-670"><span class="linenos">670</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-671"><a href="#ThermoBaseClass.get_average_mass_spectrum-671"><span class="linenos">671</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-672"><a href="#ThermoBaseClass.get_average_mass_spectrum-672"><span class="linenos">672</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-673"><a href="#ThermoBaseClass.get_average_mass_spectrum-673"><span class="linenos">673</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-674"><a href="#ThermoBaseClass.get_average_mass_spectrum-674"><span class="linenos">674</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-675"><a href="#ThermoBaseClass.get_average_mass_spectrum-675"><span class="linenos">675</span></a>            <span class="p">}</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-676"><a href="#ThermoBaseClass.get_average_mass_spectrum-676"><span class="linenos">676</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-677"><a href="#ThermoBaseClass.get_average_mass_spectrum-677"><span class="linenos">677</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-678"><a href="#ThermoBaseClass.get_average_mass_spectrum-678"><span class="linenos">678</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-679"><a href="#ThermoBaseClass.get_average_mass_spectrum-679"><span class="linenos">679</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-680"><a href="#ThermoBaseClass.get_average_mass_spectrum-680"><span class="linenos">680</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-681"><a href="#ThermoBaseClass.get_average_mass_spectrum-681"><span class="linenos">681</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-682"><a href="#ThermoBaseClass.get_average_mass_spectrum-682"><span class="linenos">682</span></a>            <span class="n">firstScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-683"><a href="#ThermoBaseClass.get_average_mass_spectrum-683"><span class="linenos">683</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-684"><a href="#ThermoBaseClass.get_average_mass_spectrum-684"><span class="linenos">684</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-685"><a href="#ThermoBaseClass.get_average_mass_spectrum-685"><span class="linenos">685</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-686"><a href="#ThermoBaseClass.get_average_mass_spectrum-686"><span class="linenos">686</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-687"><a href="#ThermoBaseClass.get_average_mass_spectrum-687"><span class="linenos">687</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-688"><a href="#ThermoBaseClass.get_average_mass_spectrum-688"><span class="linenos">688</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-689"><a href="#ThermoBaseClass.get_average_mass_spectrum-689"><span class="linenos">689</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-690"><a href="#ThermoBaseClass.get_average_mass_spectrum-690"><span class="linenos">690</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-691"><a href="#ThermoBaseClass.get_average_mass_spectrum-691"><span class="linenos">691</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-692"><a href="#ThermoBaseClass.get_average_mass_spectrum-692"><span class="linenos">692</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetFilterForScanNumber</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-693"><a href="#ThermoBaseClass.get_average_mass_spectrum-693"><span class="linenos">693</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-694"><a href="#ThermoBaseClass.get_average_mass_spectrum-694"><span class="linenos">694</span></a>        <span class="c1"># force it to only look for the MSType</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-695"><a href="#ThermoBaseClass.get_average_mass_spectrum-695"><span class="linenos">695</span></a>        <span class="n">scanFilter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_msordertype</span><span class="p">(</span><span class="n">scanFilter</span><span class="p">,</span> <span class="n">ms_type</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-696"><a href="#ThermoBaseClass.get_average_mass_spectrum-696"><span class="linenos">696</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-697"><a href="#ThermoBaseClass.get_average_mass_spectrum-697"><span class="linenos">697</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-698"><a href="#ThermoBaseClass.get_average_mass_spectrum-698"><span class="linenos">698</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScansInScanRange</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-699"><a href="#ThermoBaseClass.get_average_mass_spectrum-699"><span class="linenos">699</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span><span class="p">,</span> <span class="n">scanFilter</span><span class="p">,</span> <span class="n">options</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-700"><a href="#ThermoBaseClass.get_average_mass_spectrum-700"><span class="linenos">700</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-701"><a href="#ThermoBaseClass.get_average_mass_spectrum-701"><span class="linenos">701</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-702"><a href="#ThermoBaseClass.get_average_mass_spectrum-702"><span class="linenos">702</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-703"><a href="#ThermoBaseClass.get_average_mass_spectrum-703"><span class="linenos">703</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-704"><a href="#ThermoBaseClass.get_average_mass_spectrum-704"><span class="linenos">704</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-705"><a href="#ThermoBaseClass.get_average_mass_spectrum-705"><span class="linenos">705</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-706"><a href="#ThermoBaseClass.get_average_mass_spectrum-706"><span class="linenos">706</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-707"><a href="#ThermoBaseClass.get_average_mass_spectrum-707"><span class="linenos">707</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-708"><a href="#ThermoBaseClass.get_average_mass_spectrum-708"><span class="linenos">708</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-709"><a href="#ThermoBaseClass.get_average_mass_spectrum-709"><span class="linenos">709</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-710"><a href="#ThermoBaseClass.get_average_mass_spectrum-710"><span class="linenos">710</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-711"><a href="#ThermoBaseClass.get_average_mass_spectrum-711"><span class="linenos">711</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-712"><a href="#ThermoBaseClass.get_average_mass_spectrum-712"><span class="linenos">712</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-713"><a href="#ThermoBaseClass.get_average_mass_spectrum-713"><span class="linenos">713</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-714"><a href="#ThermoBaseClass.get_average_mass_spectrum-714"><span class="linenos">714</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-715"><a href="#ThermoBaseClass.get_average_mass_spectrum-715"><span class="linenos">715</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-716"><a href="#ThermoBaseClass.get_average_mass_spectrum-716"><span class="linenos">716</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-717"><a href="#ThermoBaseClass.get_average_mass_spectrum-717"><span class="linenos">717</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-718"><a href="#ThermoBaseClass.get_average_mass_spectrum-718"><span class="linenos">718</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-719"><a href="#ThermoBaseClass.get_average_mass_spectrum-719"><span class="linenos">719</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-720"><a href="#ThermoBaseClass.get_average_mass_spectrum-720"><span class="linenos">720</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-721"><a href="#ThermoBaseClass.get_average_mass_spectrum-721"><span class="linenos">721</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-722"><a href="#ThermoBaseClass.get_average_mass_spectrum-722"><span class="linenos">722</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-723"><a href="#ThermoBaseClass.get_average_mass_spectrum-723"><span class="linenos">723</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-724"><a href="#ThermoBaseClass.get_average_mass_spectrum-724"><span class="linenos">724</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-725"><a href="#ThermoBaseClass.get_average_mass_spectrum-725"><span class="linenos">725</span></a>        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-726"><a href="#ThermoBaseClass.get_average_mass_spectrum-726"><span class="linenos">726</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-727"><a href="#ThermoBaseClass.get_average_mass_spectrum-727"><span class="linenos">727</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-728"><a href="#ThermoBaseClass.get_average_mass_spectrum-728"><span class="linenos">728</span></a>            <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-729"><a href="#ThermoBaseClass.get_average_mass_spectrum-729"><span class="linenos">729</span></a>            <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scans</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-730"><a href="#ThermoBaseClass.get_average_mass_spectrum-730"><span class="linenos">730</span></a>                <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-731"><a href="#ThermoBaseClass.get_average_mass_spectrum-731"><span class="linenos">731</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-732"><a href="#ThermoBaseClass.get_average_mass_spectrum-732"><span class="linenos">732</span></a>            <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-733"><a href="#ThermoBaseClass.get_average_mass_spectrum-733"><span class="linenos">733</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-734"><a href="#ThermoBaseClass.get_average_mass_spectrum-734"><span class="linenos">734</span></a>            <span class="k">if</span> <span class="n">averageScan</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-735"><a href="#ThermoBaseClass.get_average_mass_spectrum-735"><span class="linenos">735</span></a>                <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-736"><a href="#ThermoBaseClass.get_average_mass_spectrum-736"><span class="linenos">736</span></a>                    <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_profile_mass_spec</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-737"><a href="#ThermoBaseClass.get_average_mass_spectrum-737"><span class="linenos">737</span></a>                        <span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-738"><a href="#ThermoBaseClass.get_average_mass_spectrum-738"><span class="linenos">738</span></a>                    <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-739"><a href="#ThermoBaseClass.get_average_mass_spectrum-739"><span class="linenos">739</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-740"><a href="#ThermoBaseClass.get_average_mass_spectrum-740"><span class="linenos">740</span></a>                    <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-741"><a href="#ThermoBaseClass.get_average_mass_spectrum-741"><span class="linenos">741</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-742"><a href="#ThermoBaseClass.get_average_mass_spectrum-742"><span class="linenos">742</span></a>                <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-743"><a href="#ThermoBaseClass.get_average_mass_spectrum-743"><span class="linenos">743</span></a>                    <span class="k">if</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">HasCentroidStream</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-744"><a href="#ThermoBaseClass.get_average_mass_spectrum-744"><span class="linenos">744</span></a>                        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">get_centroid_mass_spec</span><span class="p">(</span><span class="n">averageScan</span><span class="p">,</span> <span class="n">d_params</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-745"><a href="#ThermoBaseClass.get_average_mass_spectrum-745"><span class="linenos">745</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-746"><a href="#ThermoBaseClass.get_average_mass_spectrum-746"><span class="linenos">746</span></a>                        <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-747"><a href="#ThermoBaseClass.get_average_mass_spectrum-747"><span class="linenos">747</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-748"><a href="#ThermoBaseClass.get_average_mass_spectrum-748"><span class="linenos">748</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-749"><a href="#ThermoBaseClass.get_average_mass_spectrum-749"><span class="linenos">749</span></a>                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-750"><a href="#ThermoBaseClass.get_average_mass_spectrum-750"><span class="linenos">750</span></a>                            <span class="s2">&quot;No Centroind data available for the selected scans&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-751"><a href="#ThermoBaseClass.get_average_mass_spectrum-751"><span class="linenos">751</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-752"><a href="#ThermoBaseClass.get_average_mass_spectrum-752"><span class="linenos">752</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-753"><a href="#ThermoBaseClass.get_average_mass_spectrum-753"><span class="linenos">753</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-754"><a href="#ThermoBaseClass.get_average_mass_spectrum-754"><span class="linenos">754</span></a>                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectrum_mode must be &#39;profile&#39; or centroid&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-755"><a href="#ThermoBaseClass.get_average_mass_spectrum-755"><span class="linenos">755</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-756"><a href="#ThermoBaseClass.get_average_mass_spectrum-756"><span class="linenos">756</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-757"><a href="#ThermoBaseClass.get_average_mass_spectrum-757"><span class="linenos">757</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No data found for the selected scans&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-758"><a href="#ThermoBaseClass.get_average_mass_spectrum-758"><span class="linenos">758</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-759"><a href="#ThermoBaseClass.get_average_mass_spectrum-759"><span class="linenos">759</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum-760"><a href="#ThermoBaseClass.get_average_mass_spectrum-760"><span class="linenos">760</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;scans must be a list intergers or a tuple if integers&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Averages mass spectra over a scan range using Thermo's AverageScansInScanRange method
or a scan list using Thermo's AverageScans method
spectrum_mode: str
    centroid or profile mass spectrum
auto_process: bool
    If true performs peak picking, and noise threshold calculation after creation of mass spectrum object
ms_type: str
    String of form 'ms1' or 'ms2' or 'MS3' etc. Valid up to MS10.
    Internal function converts to Thermo MSOrderType class.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.set_metadata" class="classattr">
                                        <input id="ThermoBaseClass.set_metadata-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_metadata</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">firstScanNumber</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">lastScanNumber</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="s1">&#39;Thermo_Profile&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.set_metadata-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.set_metadata"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.set_metadata-762"><a href="#ThermoBaseClass.set_metadata-762"><span class="linenos">762</span></a>    <span class="k">def</span> <span class="nf">set_metadata</span><span class="p">(</span>
</span><span id="ThermoBaseClass.set_metadata-763"><a href="#ThermoBaseClass.set_metadata-763"><span class="linenos">763</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_metadata-764"><a href="#ThermoBaseClass.set_metadata-764"><span class="linenos">764</span></a>        <span class="n">firstScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_metadata-765"><a href="#ThermoBaseClass.set_metadata-765"><span class="linenos">765</span></a>        <span class="n">lastScanNumber</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_metadata-766"><a href="#ThermoBaseClass.set_metadata-766"><span class="linenos">766</span></a>        <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_metadata-767"><a href="#ThermoBaseClass.set_metadata-767"><span class="linenos">767</span></a>        <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="ThermoBaseClass.set_metadata-768"><a href="#ThermoBaseClass.set_metadata-768"><span class="linenos">768</span></a>    <span class="p">):</span>
</span><span id="ThermoBaseClass.set_metadata-769"><a href="#ThermoBaseClass.set_metadata-769"><span class="linenos">769</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.set_metadata-770"><a href="#ThermoBaseClass.set_metadata-770"><span class="linenos">770</span></a><span class="sd">        Collect metadata to be ingested in the mass spectrum object</span>
</span><span id="ThermoBaseClass.set_metadata-771"><a href="#ThermoBaseClass.set_metadata-771"><span class="linenos">771</span></a>
</span><span id="ThermoBaseClass.set_metadata-772"><a href="#ThermoBaseClass.set_metadata-772"><span class="linenos">772</span></a><span class="sd">        scans_list: list[int] or false</span>
</span><span id="ThermoBaseClass.set_metadata-773"><a href="#ThermoBaseClass.set_metadata-773"><span class="linenos">773</span></a><span class="sd">        lastScanNumber: int</span>
</span><span id="ThermoBaseClass.set_metadata-774"><a href="#ThermoBaseClass.set_metadata-774"><span class="linenos">774</span></a><span class="sd">        firstScanNumber: int</span>
</span><span id="ThermoBaseClass.set_metadata-775"><a href="#ThermoBaseClass.set_metadata-775"><span class="linenos">775</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.set_metadata-776"><a href="#ThermoBaseClass.set_metadata-776"><span class="linenos">776</span></a>
</span><span id="ThermoBaseClass.set_metadata-777"><a href="#ThermoBaseClass.set_metadata-777"><span class="linenos">777</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="n">default_parameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="ThermoBaseClass.set_metadata-778"><a href="#ThermoBaseClass.set_metadata-778"><span class="linenos">778</span></a>
</span><span id="ThermoBaseClass.set_metadata-779"><a href="#ThermoBaseClass.set_metadata-779"><span class="linenos">779</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="ThermoBaseClass.set_metadata-780"><a href="#ThermoBaseClass.set_metadata-780"><span class="linenos">780</span></a>
</span><span id="ThermoBaseClass.set_metadata-781"><a href="#ThermoBaseClass.set_metadata-781"><span class="linenos">781</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span>
</span><span id="ThermoBaseClass.set_metadata-782"><a href="#ThermoBaseClass.set_metadata-782"><span class="linenos">782</span></a>
</span><span id="ThermoBaseClass.set_metadata-783"><a href="#ThermoBaseClass.set_metadata-783"><span class="linenos">783</span></a>        <span class="k">if</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="ThermoBaseClass.set_metadata-784"><a href="#ThermoBaseClass.set_metadata-784"><span class="linenos">784</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scans_list</span>
</span><span id="ThermoBaseClass.set_metadata-785"><a href="#ThermoBaseClass.set_metadata-785"><span class="linenos">785</span></a>
</span><span id="ThermoBaseClass.set_metadata-786"><a href="#ThermoBaseClass.set_metadata-786"><span class="linenos">786</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">scans_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="ThermoBaseClass.set_metadata-787"><a href="#ThermoBaseClass.set_metadata-787"><span class="linenos">787</span></a>
</span><span id="ThermoBaseClass.set_metadata-788"><a href="#ThermoBaseClass.set_metadata-788"><span class="linenos">788</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.set_metadata-789"><a href="#ThermoBaseClass.set_metadata-789"><span class="linenos">789</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;scan_number&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">)</span>
</span><span id="ThermoBaseClass.set_metadata-790"><a href="#ThermoBaseClass.set_metadata-790"><span class="linenos">790</span></a>
</span><span id="ThermoBaseClass.set_metadata-791"><a href="#ThermoBaseClass.set_metadata-791"><span class="linenos">791</span></a>            <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_polarity_mode</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">)</span>
</span><span id="ThermoBaseClass.set_metadata-792"><a href="#ThermoBaseClass.set_metadata-792"><span class="linenos">792</span></a>
</span><span id="ThermoBaseClass.set_metadata-793"><a href="#ThermoBaseClass.set_metadata-793"><span class="linenos">793</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;analyzer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Model</span>
</span><span id="ThermoBaseClass.set_metadata-794"><a href="#ThermoBaseClass.set_metadata-794"><span class="linenos">794</span></a>
</span><span id="ThermoBaseClass.set_metadata-795"><a href="#ThermoBaseClass.set_metadata-795"><span class="linenos">795</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;acquisition_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_creation_time</span><span class="p">()</span>
</span><span id="ThermoBaseClass.set_metadata-796"><a href="#ThermoBaseClass.set_metadata-796"><span class="linenos">796</span></a>
</span><span id="ThermoBaseClass.set_metadata-797"><a href="#ThermoBaseClass.set_metadata-797"><span class="linenos">797</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;instrument_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span><span class="o">.</span><span class="n">Name</span>
</span><span id="ThermoBaseClass.set_metadata-798"><a href="#ThermoBaseClass.set_metadata-798"><span class="linenos">798</span></a>
</span><span id="ThermoBaseClass.set_metadata-799"><a href="#ThermoBaseClass.set_metadata-799"><span class="linenos">799</span></a>        <span class="k">return</span> <span class="n">d_params</span>
</span></pre></div>


            <div class="docstring"><p>Collect metadata to be ingested in the mass spectrum object</p>

<p>scans_list: list[int] or false
lastScanNumber: int
firstScanNumber: int</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_instrument_methods" class="classattr">
                                        <input id="ThermoBaseClass.get_instrument_methods-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_instrument_methods</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">parse_strings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_instrument_methods-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_instrument_methods"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_instrument_methods-801"><a href="#ThermoBaseClass.get_instrument_methods-801"><span class="linenos">801</span></a>    <span class="k">def</span> <span class="nf">get_instrument_methods</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parse_strings</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_methods-802"><a href="#ThermoBaseClass.get_instrument_methods-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_instrument_methods-803"><a href="#ThermoBaseClass.get_instrument_methods-803"><span class="linenos">803</span></a><span class="sd">        This function will extract the instrument methods embedded in the raw file</span>
</span><span id="ThermoBaseClass.get_instrument_methods-804"><a href="#ThermoBaseClass.get_instrument_methods-804"><span class="linenos">804</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-805"><a href="#ThermoBaseClass.get_instrument_methods-805"><span class="linenos">805</span></a><span class="sd">        First it will check if there are any instrument methods, if not returning None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-806"><a href="#ThermoBaseClass.get_instrument_methods-806"><span class="linenos">806</span></a><span class="sd">        Then it will get the total number of instrument methods.</span>
</span><span id="ThermoBaseClass.get_instrument_methods-807"><a href="#ThermoBaseClass.get_instrument_methods-807"><span class="linenos">807</span></a><span class="sd">        For each method, it will extract the plaintext string of the method and attempt to parse it into a dictionary</span>
</span><span id="ThermoBaseClass.get_instrument_methods-808"><a href="#ThermoBaseClass.get_instrument_methods-808"><span class="linenos">808</span></a><span class="sd">        If this fails, it will return just the string object.</span>
</span><span id="ThermoBaseClass.get_instrument_methods-809"><a href="#ThermoBaseClass.get_instrument_methods-809"><span class="linenos">809</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-810"><a href="#ThermoBaseClass.get_instrument_methods-810"><span class="linenos">810</span></a><span class="sd">        This has been tested on data from an Orbitrap ID-X with embedded MS and LC methods, but other instrument types may fail.</span>
</span><span id="ThermoBaseClass.get_instrument_methods-811"><a href="#ThermoBaseClass.get_instrument_methods-811"><span class="linenos">811</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-812"><a href="#ThermoBaseClass.get_instrument_methods-812"><span class="linenos">812</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-813"><a href="#ThermoBaseClass.get_instrument_methods-813"><span class="linenos">813</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.get_instrument_methods-814"><a href="#ThermoBaseClass.get_instrument_methods-814"><span class="linenos">814</span></a><span class="sd">        parse_strings: bool</span>
</span><span id="ThermoBaseClass.get_instrument_methods-815"><a href="#ThermoBaseClass.get_instrument_methods-815"><span class="linenos">815</span></a><span class="sd">            If True, will attempt to parse the instrument methods into a dictionary. If False, will return the raw string.</span>
</span><span id="ThermoBaseClass.get_instrument_methods-816"><a href="#ThermoBaseClass.get_instrument_methods-816"><span class="linenos">816</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-817"><a href="#ThermoBaseClass.get_instrument_methods-817"><span class="linenos">817</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-818"><a href="#ThermoBaseClass.get_instrument_methods-818"><span class="linenos">818</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_instrument_methods-819"><a href="#ThermoBaseClass.get_instrument_methods-819"><span class="linenos">819</span></a><span class="sd">        List[Dict[str, Any]] or List</span>
</span><span id="ThermoBaseClass.get_instrument_methods-820"><a href="#ThermoBaseClass.get_instrument_methods-820"><span class="linenos">820</span></a><span class="sd">            A list of dictionaries containing the instrument methods, or a list of strings if parsing fails.</span>
</span><span id="ThermoBaseClass.get_instrument_methods-821"><a href="#ThermoBaseClass.get_instrument_methods-821"><span class="linenos">821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_instrument_methods-822"><a href="#ThermoBaseClass.get_instrument_methods-822"><span class="linenos">822</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-823"><a href="#ThermoBaseClass.get_instrument_methods-823"><span class="linenos">823</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">HasInstrumentMethod</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-824"><a href="#ThermoBaseClass.get_instrument_methods-824"><span class="linenos">824</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-825"><a href="#ThermoBaseClass.get_instrument_methods-825"><span class="linenos">825</span></a>                <span class="s2">&quot;Raw Data file does not have any instrument methods attached&quot;</span>
</span><span id="ThermoBaseClass.get_instrument_methods-826"><a href="#ThermoBaseClass.get_instrument_methods-826"><span class="linenos">826</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-827"><a href="#ThermoBaseClass.get_instrument_methods-827"><span class="linenos">827</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-828"><a href="#ThermoBaseClass.get_instrument_methods-828"><span class="linenos">828</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-829"><a href="#ThermoBaseClass.get_instrument_methods-829"><span class="linenos">829</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-830"><a href="#ThermoBaseClass.get_instrument_methods-830"><span class="linenos">830</span></a>            <span class="k">def</span> <span class="nf">parse_instrument_method</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_methods-831"><a href="#ThermoBaseClass.get_instrument_methods-831"><span class="linenos">831</span></a>                <span class="n">lines</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-832"><a href="#ThermoBaseClass.get_instrument_methods-832"><span class="linenos">832</span></a>                <span class="n">method</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_instrument_methods-833"><a href="#ThermoBaseClass.get_instrument_methods-833"><span class="linenos">833</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-834"><a href="#ThermoBaseClass.get_instrument_methods-834"><span class="linenos">834</span></a>                <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-835"><a href="#ThermoBaseClass.get_instrument_methods-835"><span class="linenos">835</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-836"><a href="#ThermoBaseClass.get_instrument_methods-836"><span class="linenos">836</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-837"><a href="#ThermoBaseClass.get_instrument_methods-837"><span class="linenos">837</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>  <span class="c1"># Skip empty lines</span>
</span><span id="ThermoBaseClass.get_instrument_methods-838"><a href="#ThermoBaseClass.get_instrument_methods-838"><span class="linenos">838</span></a>                        <span class="k">continue</span>
</span><span id="ThermoBaseClass.get_instrument_methods-839"><a href="#ThermoBaseClass.get_instrument_methods-839"><span class="linenos">839</span></a>                    <span class="k">if</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-840"><a href="#ThermoBaseClass.get_instrument_methods-840"><span class="linenos">840</span></a>                        <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;----&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-841"><a href="#ThermoBaseClass.get_instrument_methods-841"><span class="linenos">841</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Settings&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-842"><a href="#ThermoBaseClass.get_instrument_methods-842"><span class="linenos">842</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;Summary&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-843"><a href="#ThermoBaseClass.get_instrument_methods-843"><span class="linenos">843</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Experiment&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-844"><a href="#ThermoBaseClass.get_instrument_methods-844"><span class="linenos">844</span></a>                        <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;Scan Event&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-845"><a href="#ThermoBaseClass.get_instrument_methods-845"><span class="linenos">845</span></a>                    <span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_methods-846"><a href="#ThermoBaseClass.get_instrument_methods-846"><span class="linenos">846</span></a>                        <span class="n">current_section</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-847"><a href="#ThermoBaseClass.get_instrument_methods-847"><span class="linenos">847</span></a>                        <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_instrument_methods-848"><a href="#ThermoBaseClass.get_instrument_methods-848"><span class="linenos">848</span></a>                        <span class="n">sub_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-849"><a href="#ThermoBaseClass.get_instrument_methods-849"><span class="linenos">849</span></a>                    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_methods-850"><a href="#ThermoBaseClass.get_instrument_methods-850"><span class="linenos">850</span></a>                        <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\t\t</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-851"><a href="#ThermoBaseClass.get_instrument_methods-851"><span class="linenos">851</span></a>                            <span class="n">indent_level</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-852"><a href="#ThermoBaseClass.get_instrument_methods-852"><span class="linenos">852</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-853"><a href="#ThermoBaseClass.get_instrument_methods-853"><span class="linenos">853</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-854"><a href="#ThermoBaseClass.get_instrument_methods-854"><span class="linenos">854</span></a>                            <span class="k">if</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-855"><a href="#ThermoBaseClass.get_instrument_methods-855"><span class="linenos">855</span></a>                                <span class="k">if</span> <span class="n">sub_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-856"><a href="#ThermoBaseClass.get_instrument_methods-856"><span class="linenos">856</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-857"><a href="#ThermoBaseClass.get_instrument_methods-857"><span class="linenos">857</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-858"><a href="#ThermoBaseClass.get_instrument_methods-858"><span class="linenos">858</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass.get_instrument_methods-859"><a href="#ThermoBaseClass.get_instrument_methods-859"><span class="linenos">859</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-860"><a href="#ThermoBaseClass.get_instrument_methods-860"><span class="linenos">860</span></a>                                    <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-861"><a href="#ThermoBaseClass.get_instrument_methods-861"><span class="linenos">861</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span>
</span><span id="ThermoBaseClass.get_instrument_methods-862"><a href="#ThermoBaseClass.get_instrument_methods-862"><span class="linenos">862</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-863"><a href="#ThermoBaseClass.get_instrument_methods-863"><span class="linenos">863</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-864"><a href="#ThermoBaseClass.get_instrument_methods-864"><span class="linenos">864</span></a>                            <span class="k">elif</span> <span class="n">indent_level</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-865"><a href="#ThermoBaseClass.get_instrument_methods-865"><span class="linenos">865</span></a>                                <span class="n">scan_type</span><span class="p">,</span> <span class="n">key_value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-866"><a href="#ThermoBaseClass.get_instrument_methods-866"><span class="linenos">866</span></a>                                    <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-867"><a href="#ThermoBaseClass.get_instrument_methods-867"><span class="linenos">867</span></a>                                    <span class="k">if</span> <span class="s2">&quot; &quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass.get_instrument_methods-868"><a href="#ThermoBaseClass.get_instrument_methods-868"><span class="linenos">868</span></a>                                    <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-869"><a href="#ThermoBaseClass.get_instrument_methods-869"><span class="linenos">869</span></a>                                <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-870"><a href="#ThermoBaseClass.get_instrument_methods-870"><span class="linenos">870</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-871"><a href="#ThermoBaseClass.get_instrument_methods-871"><span class="linenos">871</span></a>                                    <span class="n">sub_section</span><span class="p">,</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_instrument_methods-872"><a href="#ThermoBaseClass.get_instrument_methods-872"><span class="linenos">872</span></a>                                <span class="p">)</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">scan_type</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="ThermoBaseClass.get_instrument_methods-873"><a href="#ThermoBaseClass.get_instrument_methods-873"><span class="linenos">873</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-874"><a href="#ThermoBaseClass.get_instrument_methods-874"><span class="linenos">874</span></a>                                <span class="k">if</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-875"><a href="#ThermoBaseClass.get_instrument_methods-875"><span class="linenos">875</span></a>                                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-876"><a href="#ThermoBaseClass.get_instrument_methods-876"><span class="linenos">876</span></a>                                        <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-877"><a href="#ThermoBaseClass.get_instrument_methods-877"><span class="linenos">877</span></a>                                        <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass.get_instrument_methods-878"><a href="#ThermoBaseClass.get_instrument_methods-878"><span class="linenos">878</span></a>                                        <span class="k">else</span> <span class="p">(</span><span class="n">key_value</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-879"><a href="#ThermoBaseClass.get_instrument_methods-879"><span class="linenos">879</span></a>                                    <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-880"><a href="#ThermoBaseClass.get_instrument_methods-880"><span class="linenos">880</span></a>                                    <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">sub_section</span><span class="p">][</span><span class="n">scan_type</span><span class="p">][</span>
</span><span id="ThermoBaseClass.get_instrument_methods-881"><a href="#ThermoBaseClass.get_instrument_methods-881"><span class="linenos">881</span></a>                                        <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-882"><a href="#ThermoBaseClass.get_instrument_methods-882"><span class="linenos">882</span></a>                                    <span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_instrument_methods-883"><a href="#ThermoBaseClass.get_instrument_methods-883"><span class="linenos">883</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-884"><a href="#ThermoBaseClass.get_instrument_methods-884"><span class="linenos">884</span></a>                            <span class="n">key_value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-885"><a href="#ThermoBaseClass.get_instrument_methods-885"><span class="linenos">885</span></a>                            <span class="k">if</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">key_value</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-886"><a href="#ThermoBaseClass.get_instrument_methods-886"><span class="linenos">886</span></a>                                <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">key_value</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-887"><a href="#ThermoBaseClass.get_instrument_methods-887"><span class="linenos">887</span></a>                                <span class="n">method</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">current_section</span><span class="p">,</span> <span class="p">{})[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-888"><a href="#ThermoBaseClass.get_instrument_methods-888"><span class="linenos">888</span></a>                                    <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-889"><a href="#ThermoBaseClass.get_instrument_methods-889"><span class="linenos">889</span></a>                                <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-890"><a href="#ThermoBaseClass.get_instrument_methods-890"><span class="linenos">890</span></a>                            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-891"><a href="#ThermoBaseClass.get_instrument_methods-891"><span class="linenos">891</span></a>                                <span class="n">sub_section</span> <span class="o">=</span> <span class="n">key_value</span>
</span><span id="ThermoBaseClass.get_instrument_methods-892"><a href="#ThermoBaseClass.get_instrument_methods-892"><span class="linenos">892</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-893"><a href="#ThermoBaseClass.get_instrument_methods-893"><span class="linenos">893</span></a>                        <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-894"><a href="#ThermoBaseClass.get_instrument_methods-894"><span class="linenos">894</span></a>                            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-895"><a href="#ThermoBaseClass.get_instrument_methods-895"><span class="linenos">895</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_methods-896"><a href="#ThermoBaseClass.get_instrument_methods-896"><span class="linenos">896</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-897"><a href="#ThermoBaseClass.get_instrument_methods-897"><span class="linenos">897</span></a>                            <span class="n">method</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">line</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_instrument_methods-898"><a href="#ThermoBaseClass.get_instrument_methods-898"><span class="linenos">898</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-899"><a href="#ThermoBaseClass.get_instrument_methods-899"><span class="linenos">899</span></a>                <span class="k">return</span> <span class="n">method</span>
</span><span id="ThermoBaseClass.get_instrument_methods-900"><a href="#ThermoBaseClass.get_instrument_methods-900"><span class="linenos">900</span></a>
</span><span id="ThermoBaseClass.get_instrument_methods-901"><a href="#ThermoBaseClass.get_instrument_methods-901"><span class="linenos">901</span></a>            <span class="n">count_instrument_methods</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">InstrumentMethodsCount</span>
</span><span id="ThermoBaseClass.get_instrument_methods-902"><a href="#ThermoBaseClass.get_instrument_methods-902"><span class="linenos">902</span></a>            <span class="c1"># TODO make this code better...</span>
</span><span id="ThermoBaseClass.get_instrument_methods-903"><a href="#ThermoBaseClass.get_instrument_methods-903"><span class="linenos">903</span></a>            <span class="n">instrument_methods</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ThermoBaseClass.get_instrument_methods-904"><a href="#ThermoBaseClass.get_instrument_methods-904"><span class="linenos">904</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count_instrument_methods</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_methods-905"><a href="#ThermoBaseClass.get_instrument_methods-905"><span class="linenos">905</span></a>                <span class="n">instrument_method_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentMethod</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-906"><a href="#ThermoBaseClass.get_instrument_methods-906"><span class="linenos">906</span></a>                <span class="k">if</span> <span class="n">parse_strings</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-907"><a href="#ThermoBaseClass.get_instrument_methods-907"><span class="linenos">907</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-908"><a href="#ThermoBaseClass.get_instrument_methods-908"><span class="linenos">908</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">parse_instrument_method</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_instrument_methods-909"><a href="#ThermoBaseClass.get_instrument_methods-909"><span class="linenos">909</span></a>                            <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass.get_instrument_methods-910"><a href="#ThermoBaseClass.get_instrument_methods-910"><span class="linenos">910</span></a>                        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-911"><a href="#ThermoBaseClass.get_instrument_methods-911"><span class="linenos">911</span></a>                    <span class="k">except</span><span class="p">:</span>  <span class="c1"># if it fails for any reason</span>
</span><span id="ThermoBaseClass.get_instrument_methods-912"><a href="#ThermoBaseClass.get_instrument_methods-912"><span class="linenos">912</span></a>                        <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass.get_instrument_methods-913"><a href="#ThermoBaseClass.get_instrument_methods-913"><span class="linenos">913</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_instrument_methods-914"><a href="#ThermoBaseClass.get_instrument_methods-914"><span class="linenos">914</span></a>                    <span class="n">instrument_method_dict</span> <span class="o">=</span> <span class="n">instrument_method_string</span>
</span><span id="ThermoBaseClass.get_instrument_methods-915"><a href="#ThermoBaseClass.get_instrument_methods-915"><span class="linenos">915</span></a>                <span class="n">instrument_methods</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">instrument_method_dict</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_instrument_methods-916"><a href="#ThermoBaseClass.get_instrument_methods-916"><span class="linenos">916</span></a>            <span class="k">return</span> <span class="n">instrument_methods</span>
</span></pre></div>


            <div class="docstring"><p>This function will extract the instrument methods embedded in the raw file</p>

<p>First it will check if there are any instrument methods, if not returning None
Then it will get the total number of instrument methods.
For each method, it will extract the plaintext string of the method and attempt to parse it into a dictionary
If this fails, it will return just the string object.</p>

<p>This has been tested on data from an Orbitrap ID-X with embedded MS and LC methods, but other instrument types may fail.</p>

<h2 id="parameters">Parameters:</h2>

<p>parse_strings: bool
    If True, will attempt to parse the instrument methods into a dictionary. If False, will return the raw string.</p>

<h2 id="returns">Returns:</h2>

<p>List[Dict[str, Any]] or List
    A list of dictionaries containing the instrument methods, or a list of strings if parsing fails.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_tune_method" class="classattr">
                                        <input id="ThermoBaseClass.get_tune_method-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_tune_method</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_tune_method-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_tune_method"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_tune_method-918"><a href="#ThermoBaseClass.get_tune_method-918"><span class="linenos">918</span></a>    <span class="k">def</span> <span class="nf">get_tune_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_tune_method-919"><a href="#ThermoBaseClass.get_tune_method-919"><span class="linenos">919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_tune_method-920"><a href="#ThermoBaseClass.get_tune_method-920"><span class="linenos">920</span></a><span class="sd">        This code will extract the tune method from the raw file</span>
</span><span id="ThermoBaseClass.get_tune_method-921"><a href="#ThermoBaseClass.get_tune_method-921"><span class="linenos">921</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="ThermoBaseClass.get_tune_method-922"><a href="#ThermoBaseClass.get_tune_method-922"><span class="linenos">922</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="ThermoBaseClass.get_tune_method-923"><a href="#ThermoBaseClass.get_tune_method-923"><span class="linenos">923</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="ThermoBaseClass.get_tune_method-924"><a href="#ThermoBaseClass.get_tune_method-924"><span class="linenos">924</span></a>
</span><span id="ThermoBaseClass.get_tune_method-925"><a href="#ThermoBaseClass.get_tune_method-925"><span class="linenos">925</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_tune_method-926"><a href="#ThermoBaseClass.get_tune_method-926"><span class="linenos">926</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_tune_method-927"><a href="#ThermoBaseClass.get_tune_method-927"><span class="linenos">927</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass.get_tune_method-928"><a href="#ThermoBaseClass.get_tune_method-928"><span class="linenos">928</span></a><span class="sd">            A dictionary containing the tune method information</span>
</span><span id="ThermoBaseClass.get_tune_method-929"><a href="#ThermoBaseClass.get_tune_method-929"><span class="linenos">929</span></a>
</span><span id="ThermoBaseClass.get_tune_method-930"><a href="#ThermoBaseClass.get_tune_method-930"><span class="linenos">930</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass.get_tune_method-931"><a href="#ThermoBaseClass.get_tune_method-931"><span class="linenos">931</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass.get_tune_method-932"><a href="#ThermoBaseClass.get_tune_method-932"><span class="linenos">932</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass.get_tune_method-933"><a href="#ThermoBaseClass.get_tune_method-933"><span class="linenos">933</span></a><span class="sd">            If no tune methods are found in the raw file</span>
</span><span id="ThermoBaseClass.get_tune_method-934"><a href="#ThermoBaseClass.get_tune_method-934"><span class="linenos">934</span></a>
</span><span id="ThermoBaseClass.get_tune_method-935"><a href="#ThermoBaseClass.get_tune_method-935"><span class="linenos">935</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_tune_method-936"><a href="#ThermoBaseClass.get_tune_method-936"><span class="linenos">936</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneDataCount</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_tune_method-937"><a href="#ThermoBaseClass.get_tune_method-937"><span class="linenos">937</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tune_method-938"><a href="#ThermoBaseClass.get_tune_method-938"><span class="linenos">938</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No tune methods found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tune_method-939"><a href="#ThermoBaseClass.get_tune_method-939"><span class="linenos">939</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_tune_method-940"><a href="#ThermoBaseClass.get_tune_method-940"><span class="linenos">940</span></a>        <span class="k">elif</span> <span class="n">tunemethodcount</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tune_method-941"><a href="#ThermoBaseClass.get_tune_method-941"><span class="linenos">941</span></a>            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_tune_method-942"><a href="#ThermoBaseClass.get_tune_method-942"><span class="linenos">942</span></a>                <span class="s2">&quot;Multiple tune methods found in the raw data file, returning the 1st&quot;</span>
</span><span id="ThermoBaseClass.get_tune_method-943"><a href="#ThermoBaseClass.get_tune_method-943"><span class="linenos">943</span></a>            <span class="p">)</span>
</span><span id="ThermoBaseClass.get_tune_method-944"><a href="#ThermoBaseClass.get_tune_method-944"><span class="linenos">944</span></a>
</span><span id="ThermoBaseClass.get_tune_method-945"><a href="#ThermoBaseClass.get_tune_method-945"><span class="linenos">945</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetTuneData</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tune_method-946"><a href="#ThermoBaseClass.get_tune_method-946"><span class="linenos">946</span></a>
</span><span id="ThermoBaseClass.get_tune_method-947"><a href="#ThermoBaseClass.get_tune_method-947"><span class="linenos">947</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_tune_method-948"><a href="#ThermoBaseClass.get_tune_method-948"><span class="linenos">948</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_tune_method-949"><a href="#ThermoBaseClass.get_tune_method-949"><span class="linenos">949</span></a>
</span><span id="ThermoBaseClass.get_tune_method-950"><a href="#ThermoBaseClass.get_tune_method-950"><span class="linenos">950</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_tune_method-951"><a href="#ThermoBaseClass.get_tune_method-951"><span class="linenos">951</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_tune_method-952"><a href="#ThermoBaseClass.get_tune_method-952"><span class="linenos">952</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_tune_method-953"><a href="#ThermoBaseClass.get_tune_method-953"><span class="linenos">953</span></a>
</span><span id="ThermoBaseClass.get_tune_method-954"><a href="#ThermoBaseClass.get_tune_method-954"><span class="linenos">954</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="ThermoBaseClass.get_tune_method-955"><a href="#ThermoBaseClass.get_tune_method-955"><span class="linenos">955</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_tune_method-956"><a href="#ThermoBaseClass.get_tune_method-956"><span class="linenos">956</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_tune_method-957"><a href="#ThermoBaseClass.get_tune_method-957"><span class="linenos">957</span></a>            <span class="p">):</span>
</span><span id="ThermoBaseClass.get_tune_method-958"><a href="#ThermoBaseClass.get_tune_method-958"><span class="linenos">958</span></a>                <span class="c1"># This is a section header</span>
</span><span id="ThermoBaseClass.get_tune_method-959"><a href="#ThermoBaseClass.get_tune_method-959"><span class="linenos">959</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_tune_method-960"><a href="#ThermoBaseClass.get_tune_method-960"><span class="linenos">960</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_tune_method-961"><a href="#ThermoBaseClass.get_tune_method-961"><span class="linenos">961</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="ThermoBaseClass.get_tune_method-962"><a href="#ThermoBaseClass.get_tune_method-962"><span class="linenos">962</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_tune_method-963"><a href="#ThermoBaseClass.get_tune_method-963"><span class="linenos">963</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="ThermoBaseClass.get_tune_method-964"><a href="#ThermoBaseClass.get_tune_method-964"><span class="linenos">964</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tune_method-965"><a href="#ThermoBaseClass.get_tune_method-965"><span class="linenos">965</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tune_method-966"><a href="#ThermoBaseClass.get_tune_method-966"><span class="linenos">966</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass.get_tune_method-967"><a href="#ThermoBaseClass.get_tune_method-967"><span class="linenos">967</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_tune_method-968"><a href="#ThermoBaseClass.get_tune_method-968"><span class="linenos">968</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass.get_tune_method-969"><a href="#ThermoBaseClass.get_tune_method-969"><span class="linenos">969</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span></pre></div>


            <div class="docstring"><p>This code will extract the tune method from the raw file
It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.
It attempts to parse out section headers and sub-sections, but may not work for all instrument types.
It will also not return Labels (keys) where the value is blank</p>

<h2 id="returns">Returns:</h2>

<p>Dict[str, Any]
    A dictionary containing the tune method information</p>

<h2 id="raises">Raises:</h2>

<p>ValueError
    If no tune methods are found in the raw file</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_status_log" class="classattr">
                                        <input id="ThermoBaseClass.get_status_log-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_status_log</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">retention_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_status_log-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_status_log"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_status_log-971"><a href="#ThermoBaseClass.get_status_log-971"><span class="linenos"> 971</span></a>    <span class="k">def</span> <span class="nf">get_status_log</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">retention_time</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_status_log-972"><a href="#ThermoBaseClass.get_status_log-972"><span class="linenos"> 972</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_status_log-973"><a href="#ThermoBaseClass.get_status_log-973"><span class="linenos"> 973</span></a><span class="sd">        This code will extract the status logs from the raw file</span>
</span><span id="ThermoBaseClass.get_status_log-974"><a href="#ThermoBaseClass.get_status_log-974"><span class="linenos"> 974</span></a><span class="sd">        It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.</span>
</span><span id="ThermoBaseClass.get_status_log-975"><a href="#ThermoBaseClass.get_status_log-975"><span class="linenos"> 975</span></a><span class="sd">        It attempts to parse out section headers and sub-sections, but may not work for all instrument types.</span>
</span><span id="ThermoBaseClass.get_status_log-976"><a href="#ThermoBaseClass.get_status_log-976"><span class="linenos"> 976</span></a><span class="sd">        It will also not return Labels (keys) where the value is blank</span>
</span><span id="ThermoBaseClass.get_status_log-977"><a href="#ThermoBaseClass.get_status_log-977"><span class="linenos"> 977</span></a>
</span><span id="ThermoBaseClass.get_status_log-978"><a href="#ThermoBaseClass.get_status_log-978"><span class="linenos"> 978</span></a><span class="sd">        Parameters:</span>
</span><span id="ThermoBaseClass.get_status_log-979"><a href="#ThermoBaseClass.get_status_log-979"><span class="linenos"> 979</span></a><span class="sd">        -----------</span>
</span><span id="ThermoBaseClass.get_status_log-980"><a href="#ThermoBaseClass.get_status_log-980"><span class="linenos"> 980</span></a><span class="sd">        retention_time: float</span>
</span><span id="ThermoBaseClass.get_status_log-981"><a href="#ThermoBaseClass.get_status_log-981"><span class="linenos"> 981</span></a><span class="sd">            The retention time in minutes to extract the status log data from.</span>
</span><span id="ThermoBaseClass.get_status_log-982"><a href="#ThermoBaseClass.get_status_log-982"><span class="linenos"> 982</span></a><span class="sd">            Will use the closest retention time found. Default 0.</span>
</span><span id="ThermoBaseClass.get_status_log-983"><a href="#ThermoBaseClass.get_status_log-983"><span class="linenos"> 983</span></a>
</span><span id="ThermoBaseClass.get_status_log-984"><a href="#ThermoBaseClass.get_status_log-984"><span class="linenos"> 984</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_status_log-985"><a href="#ThermoBaseClass.get_status_log-985"><span class="linenos"> 985</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_status_log-986"><a href="#ThermoBaseClass.get_status_log-986"><span class="linenos"> 986</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass.get_status_log-987"><a href="#ThermoBaseClass.get_status_log-987"><span class="linenos"> 987</span></a><span class="sd">            A dictionary containing the status log information</span>
</span><span id="ThermoBaseClass.get_status_log-988"><a href="#ThermoBaseClass.get_status_log-988"><span class="linenos"> 988</span></a>
</span><span id="ThermoBaseClass.get_status_log-989"><a href="#ThermoBaseClass.get_status_log-989"><span class="linenos"> 989</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass.get_status_log-990"><a href="#ThermoBaseClass.get_status_log-990"><span class="linenos"> 990</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass.get_status_log-991"><a href="#ThermoBaseClass.get_status_log-991"><span class="linenos"> 991</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass.get_status_log-992"><a href="#ThermoBaseClass.get_status_log-992"><span class="linenos"> 992</span></a><span class="sd">            If no status logs are found in the raw file</span>
</span><span id="ThermoBaseClass.get_status_log-993"><a href="#ThermoBaseClass.get_status_log-993"><span class="linenos"> 993</span></a>
</span><span id="ThermoBaseClass.get_status_log-994"><a href="#ThermoBaseClass.get_status_log-994"><span class="linenos"> 994</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_status_log-995"><a href="#ThermoBaseClass.get_status_log-995"><span class="linenos"> 995</span></a>        <span class="n">tunemethodcount</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogEntriesCount</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_status_log-996"><a href="#ThermoBaseClass.get_status_log-996"><span class="linenos"> 996</span></a>        <span class="k">if</span> <span class="n">tunemethodcount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_status_log-997"><a href="#ThermoBaseClass.get_status_log-997"><span class="linenos"> 997</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No status logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_status_log-998"><a href="#ThermoBaseClass.get_status_log-998"><span class="linenos"> 998</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_status_log-999"><a href="#ThermoBaseClass.get_status_log-999"><span class="linenos"> 999</span></a>
</span><span id="ThermoBaseClass.get_status_log-1000"><a href="#ThermoBaseClass.get_status_log-1000"><span class="linenos">1000</span></a>        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetStatusLogForRetentionTime</span><span class="p">(</span><span class="n">retention_time</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_status_log-1001"><a href="#ThermoBaseClass.get_status_log-1001"><span class="linenos">1001</span></a>
</span><span id="ThermoBaseClass.get_status_log-1002"><a href="#ThermoBaseClass.get_status_log-1002"><span class="linenos">1002</span></a>        <span class="n">header_dic</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_status_log-1003"><a href="#ThermoBaseClass.get_status_log-1003"><span class="linenos">1003</span></a>        <span class="n">current_section</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_status_log-1004"><a href="#ThermoBaseClass.get_status_log-1004"><span class="linenos">1004</span></a>
</span><span id="ThermoBaseClass.get_status_log-1005"><a href="#ThermoBaseClass.get_status_log-1005"><span class="linenos">1005</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">Length</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_status_log-1006"><a href="#ThermoBaseClass.get_status_log-1006"><span class="linenos">1006</span></a>            <span class="n">label</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_status_log-1007"><a href="#ThermoBaseClass.get_status_log-1007"><span class="linenos">1007</span></a>            <span class="n">value</span> <span class="o">=</span> <span class="n">header</span><span class="o">.</span><span class="n">Values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_status_log-1008"><a href="#ThermoBaseClass.get_status_log-1008"><span class="linenos">1008</span></a>
</span><span id="ThermoBaseClass.get_status_log-1009"><a href="#ThermoBaseClass.get_status_log-1009"><span class="linenos">1009</span></a>            <span class="c1"># Check for section headers</span>
</span><span id="ThermoBaseClass.get_status_log-1010"><a href="#ThermoBaseClass.get_status_log-1010"><span class="linenos">1010</span></a>            <span class="k">if</span> <span class="s2">&quot;===&quot;</span> <span class="ow">in</span> <span class="n">label</span> <span class="ow">or</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_status_log-1011"><a href="#ThermoBaseClass.get_status_log-1011"><span class="linenos">1011</span></a>                <span class="p">(</span><span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">label</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_status_log-1012"><a href="#ThermoBaseClass.get_status_log-1012"><span class="linenos">1012</span></a>            <span class="p">):</span>
</span><span id="ThermoBaseClass.get_status_log-1013"><a href="#ThermoBaseClass.get_status_log-1013"><span class="linenos">1013</span></a>                <span class="c1"># This is a section header</span>
</span><span id="ThermoBaseClass.get_status_log-1014"><a href="#ThermoBaseClass.get_status_log-1014"><span class="linenos">1014</span></a>                <span class="n">section_name</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ThermoBaseClass.get_status_log-1015"><a href="#ThermoBaseClass.get_status_log-1015"><span class="linenos">1015</span></a>                    <span class="n">label</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_status_log-1016"><a href="#ThermoBaseClass.get_status_log-1016"><span class="linenos">1016</span></a>                <span class="p">)</span>  <span class="c1"># Clean the label if it contains &#39;=&#39;</span>
</span><span id="ThermoBaseClass.get_status_log-1017"><a href="#ThermoBaseClass.get_status_log-1017"><span class="linenos">1017</span></a>                <span class="n">header_dic</span><span class="p">[</span><span class="n">section_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_status_log-1018"><a href="#ThermoBaseClass.get_status_log-1018"><span class="linenos">1018</span></a>                <span class="n">current_section</span> <span class="o">=</span> <span class="n">section_name</span>
</span><span id="ThermoBaseClass.get_status_log-1019"><a href="#ThermoBaseClass.get_status_log-1019"><span class="linenos">1019</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_status_log-1020"><a href="#ThermoBaseClass.get_status_log-1020"><span class="linenos">1020</span></a>                <span class="k">if</span> <span class="n">current_section</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_status_log-1021"><a href="#ThermoBaseClass.get_status_log-1021"><span class="linenos">1021</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">current_section</span><span class="p">][</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass.get_status_log-1022"><a href="#ThermoBaseClass.get_status_log-1022"><span class="linenos">1022</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_status_log-1023"><a href="#ThermoBaseClass.get_status_log-1023"><span class="linenos">1023</span></a>                    <span class="n">header_dic</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="ThermoBaseClass.get_status_log-1024"><a href="#ThermoBaseClass.get_status_log-1024"><span class="linenos">1024</span></a>        <span class="k">return</span> <span class="n">header_dic</span>
</span></pre></div>


            <div class="docstring"><p>This code will extract the status logs from the raw file
It has been tested on data from a Thermo Orbitrap ID-X, Astral and Q-Exactive, but may fail on other instrument types.
It attempts to parse out section headers and sub-sections, but may not work for all instrument types.
It will also not return Labels (keys) where the value is blank</p>

<h2 id="parameters">Parameters:</h2>

<p>retention_time: float
    The retention time in minutes to extract the status log data from.
    Will use the closest retention time found. Default 0.</p>

<h2 id="returns">Returns:</h2>

<p>Dict[str, Any]
    A dictionary containing the status log information</p>

<h2 id="raises">Raises:</h2>

<p>ValueError
    If no status logs are found in the raw file</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_error_logs" class="classattr">
                                        <input id="ThermoBaseClass.get_error_logs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_error_logs</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_error_logs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_error_logs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_error_logs-1026"><a href="#ThermoBaseClass.get_error_logs-1026"><span class="linenos">1026</span></a>    <span class="k">def</span> <span class="nf">get_error_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_error_logs-1027"><a href="#ThermoBaseClass.get_error_logs-1027"><span class="linenos">1027</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_error_logs-1028"><a href="#ThermoBaseClass.get_error_logs-1028"><span class="linenos">1028</span></a><span class="sd">        This code will extract the error logs from the raw file</span>
</span><span id="ThermoBaseClass.get_error_logs-1029"><a href="#ThermoBaseClass.get_error_logs-1029"><span class="linenos">1029</span></a>
</span><span id="ThermoBaseClass.get_error_logs-1030"><a href="#ThermoBaseClass.get_error_logs-1030"><span class="linenos">1030</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_error_logs-1031"><a href="#ThermoBaseClass.get_error_logs-1031"><span class="linenos">1031</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_error_logs-1032"><a href="#ThermoBaseClass.get_error_logs-1032"><span class="linenos">1032</span></a><span class="sd">        Dict[float, str]</span>
</span><span id="ThermoBaseClass.get_error_logs-1033"><a href="#ThermoBaseClass.get_error_logs-1033"><span class="linenos">1033</span></a><span class="sd">            A dictionary containing the error log information with the retention time as the key</span>
</span><span id="ThermoBaseClass.get_error_logs-1034"><a href="#ThermoBaseClass.get_error_logs-1034"><span class="linenos">1034</span></a>
</span><span id="ThermoBaseClass.get_error_logs-1035"><a href="#ThermoBaseClass.get_error_logs-1035"><span class="linenos">1035</span></a><span class="sd">        Raises:</span>
</span><span id="ThermoBaseClass.get_error_logs-1036"><a href="#ThermoBaseClass.get_error_logs-1036"><span class="linenos">1036</span></a><span class="sd">        -------</span>
</span><span id="ThermoBaseClass.get_error_logs-1037"><a href="#ThermoBaseClass.get_error_logs-1037"><span class="linenos">1037</span></a><span class="sd">        ValueError</span>
</span><span id="ThermoBaseClass.get_error_logs-1038"><a href="#ThermoBaseClass.get_error_logs-1038"><span class="linenos">1038</span></a><span class="sd">            If no error logs are found in the raw file</span>
</span><span id="ThermoBaseClass.get_error_logs-1039"><a href="#ThermoBaseClass.get_error_logs-1039"><span class="linenos">1039</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_error_logs-1040"><a href="#ThermoBaseClass.get_error_logs-1040"><span class="linenos">1040</span></a>
</span><span id="ThermoBaseClass.get_error_logs-1041"><a href="#ThermoBaseClass.get_error_logs-1041"><span class="linenos">1041</span></a>        <span class="n">error_log_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">RunHeaderEx</span><span class="o">.</span><span class="n">ErrorLogCount</span>
</span><span id="ThermoBaseClass.get_error_logs-1042"><a href="#ThermoBaseClass.get_error_logs-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="n">error_log_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_error_logs-1043"><a href="#ThermoBaseClass.get_error_logs-1043"><span class="linenos">1043</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No error logs found in the raw data file&quot;</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_error_logs-1044"><a href="#ThermoBaseClass.get_error_logs-1044"><span class="linenos">1044</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="ThermoBaseClass.get_error_logs-1045"><a href="#ThermoBaseClass.get_error_logs-1045"><span class="linenos">1045</span></a>
</span><span id="ThermoBaseClass.get_error_logs-1046"><a href="#ThermoBaseClass.get_error_logs-1046"><span class="linenos">1046</span></a>        <span class="n">error_logs</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_error_logs-1047"><a href="#ThermoBaseClass.get_error_logs-1047"><span class="linenos">1047</span></a>
</span><span id="ThermoBaseClass.get_error_logs-1048"><a href="#ThermoBaseClass.get_error_logs-1048"><span class="linenos">1048</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">error_log_count</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_error_logs-1049"><a href="#ThermoBaseClass.get_error_logs-1049"><span class="linenos">1049</span></a>            <span class="n">error_log_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetErrorLogItem</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_error_logs-1050"><a href="#ThermoBaseClass.get_error_logs-1050"><span class="linenos">1050</span></a>            <span class="n">rt</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">RetentionTime</span>
</span><span id="ThermoBaseClass.get_error_logs-1051"><a href="#ThermoBaseClass.get_error_logs-1051"><span class="linenos">1051</span></a>            <span class="n">message</span> <span class="o">=</span> <span class="n">error_log_item</span><span class="o">.</span><span class="n">Message</span>
</span><span id="ThermoBaseClass.get_error_logs-1052"><a href="#ThermoBaseClass.get_error_logs-1052"><span class="linenos">1052</span></a>            <span class="c1"># Use the index `i` as the unique ID key</span>
</span><span id="ThermoBaseClass.get_error_logs-1053"><a href="#ThermoBaseClass.get_error_logs-1053"><span class="linenos">1053</span></a>            <span class="n">error_logs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;rt&quot;</span><span class="p">:</span> <span class="n">rt</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">}</span>
</span><span id="ThermoBaseClass.get_error_logs-1054"><a href="#ThermoBaseClass.get_error_logs-1054"><span class="linenos">1054</span></a>        <span class="k">return</span> <span class="n">error_logs</span>
</span></pre></div>


            <div class="docstring"><p>This code will extract the error logs from the raw file</p>

<h2 id="returns">Returns:</h2>

<p>Dict[float, str]
    A dictionary containing the error log information with the retention time as the key</p>

<h2 id="raises">Raises:</h2>

<p>ValueError
    If no error logs are found in the raw file</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_sample_information" class="classattr">
                                        <input id="ThermoBaseClass.get_sample_information-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_sample_information</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_sample_information-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_sample_information"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_sample_information-1056"><a href="#ThermoBaseClass.get_sample_information-1056"><span class="linenos">1056</span></a>    <span class="k">def</span> <span class="nf">get_sample_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_sample_information-1057"><a href="#ThermoBaseClass.get_sample_information-1057"><span class="linenos">1057</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_sample_information-1058"><a href="#ThermoBaseClass.get_sample_information-1058"><span class="linenos">1058</span></a><span class="sd">        This code will extract the sample information from the raw file</span>
</span><span id="ThermoBaseClass.get_sample_information-1059"><a href="#ThermoBaseClass.get_sample_information-1059"><span class="linenos">1059</span></a>
</span><span id="ThermoBaseClass.get_sample_information-1060"><a href="#ThermoBaseClass.get_sample_information-1060"><span class="linenos">1060</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_sample_information-1061"><a href="#ThermoBaseClass.get_sample_information-1061"><span class="linenos">1061</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_sample_information-1062"><a href="#ThermoBaseClass.get_sample_information-1062"><span class="linenos">1062</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass.get_sample_information-1063"><a href="#ThermoBaseClass.get_sample_information-1063"><span class="linenos">1063</span></a><span class="sd">            A dictionary containing the sample information</span>
</span><span id="ThermoBaseClass.get_sample_information-1064"><a href="#ThermoBaseClass.get_sample_information-1064"><span class="linenos">1064</span></a><span class="sd">            Note that UserText field may not be handled properly and may need further processing</span>
</span><span id="ThermoBaseClass.get_sample_information-1065"><a href="#ThermoBaseClass.get_sample_information-1065"><span class="linenos">1065</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_sample_information-1066"><a href="#ThermoBaseClass.get_sample_information-1066"><span class="linenos">1066</span></a>        <span class="n">sminfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">SampleInformation</span>
</span><span id="ThermoBaseClass.get_sample_information-1067"><a href="#ThermoBaseClass.get_sample_information-1067"><span class="linenos">1067</span></a>        <span class="n">smdict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_sample_information-1068"><a href="#ThermoBaseClass.get_sample_information-1068"><span class="linenos">1068</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Comment&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Comment</span>
</span><span id="ThermoBaseClass.get_sample_information-1069"><a href="#ThermoBaseClass.get_sample_information-1069"><span class="linenos">1069</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleId&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleId</span>
</span><span id="ThermoBaseClass.get_sample_information-1070"><a href="#ThermoBaseClass.get_sample_information-1070"><span class="linenos">1070</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleName</span>
</span><span id="ThermoBaseClass.get_sample_information-1071"><a href="#ThermoBaseClass.get_sample_information-1071"><span class="linenos">1071</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Vial&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Vial</span>
</span><span id="ThermoBaseClass.get_sample_information-1072"><a href="#ThermoBaseClass.get_sample_information-1072"><span class="linenos">1072</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InjectionVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InjectionVolume</span>
</span><span id="ThermoBaseClass.get_sample_information-1073"><a href="#ThermoBaseClass.get_sample_information-1073"><span class="linenos">1073</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Barcode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Barcode</span>
</span><span id="ThermoBaseClass.get_sample_information-1074"><a href="#ThermoBaseClass.get_sample_information-1074"><span class="linenos">1074</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;BarcodeStatus&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">BarcodeStatus</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_sample_information-1075"><a href="#ThermoBaseClass.get_sample_information-1075"><span class="linenos">1075</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationLevel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationLevel</span>
</span><span id="ThermoBaseClass.get_sample_information-1076"><a href="#ThermoBaseClass.get_sample_information-1076"><span class="linenos">1076</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;DilutionFactor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">DilutionFactor</span>
</span><span id="ThermoBaseClass.get_sample_information-1077"><a href="#ThermoBaseClass.get_sample_information-1077"><span class="linenos">1077</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;InstrumentMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">InstrumentMethodFile</span>
</span><span id="ThermoBaseClass.get_sample_information-1078"><a href="#ThermoBaseClass.get_sample_information-1078"><span class="linenos">1078</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RawFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RawFileName</span>
</span><span id="ThermoBaseClass.get_sample_information-1079"><a href="#ThermoBaseClass.get_sample_information-1079"><span class="linenos">1079</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;CalibrationFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">CalibrationFile</span>
</span><span id="ThermoBaseClass.get_sample_information-1080"><a href="#ThermoBaseClass.get_sample_information-1080"><span class="linenos">1080</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;IstdAmount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">IstdAmount</span>
</span><span id="ThermoBaseClass.get_sample_information-1081"><a href="#ThermoBaseClass.get_sample_information-1081"><span class="linenos">1081</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;RowNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">RowNumber</span>
</span><span id="ThermoBaseClass.get_sample_information-1082"><a href="#ThermoBaseClass.get_sample_information-1082"><span class="linenos">1082</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;Path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">Path</span>
</span><span id="ThermoBaseClass.get_sample_information-1083"><a href="#ThermoBaseClass.get_sample_information-1083"><span class="linenos">1083</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;ProcessingMethodFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">ProcessingMethodFile</span>
</span><span id="ThermoBaseClass.get_sample_information-1084"><a href="#ThermoBaseClass.get_sample_information-1084"><span class="linenos">1084</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sminfo</span><span class="o">.</span><span class="n">SampleType</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_sample_information-1085"><a href="#ThermoBaseClass.get_sample_information-1085"><span class="linenos">1085</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;SampleWeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">SampleWeight</span>
</span><span id="ThermoBaseClass.get_sample_information-1086"><a href="#ThermoBaseClass.get_sample_information-1086"><span class="linenos">1086</span></a>        <span class="n">smdict</span><span class="p">[</span><span class="s2">&quot;UserText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_sample_information-1087"><a href="#ThermoBaseClass.get_sample_information-1087"><span class="linenos">1087</span></a>            <span class="s2">&quot;UserText&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sminfo</span><span class="o">.</span><span class="n">UserText</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_sample_information-1088"><a href="#ThermoBaseClass.get_sample_information-1088"><span class="linenos">1088</span></a>        <span class="p">}</span>  <span class="c1"># [0] #This may not work - needs debugging with</span>
</span><span id="ThermoBaseClass.get_sample_information-1089"><a href="#ThermoBaseClass.get_sample_information-1089"><span class="linenos">1089</span></a>        <span class="k">return</span> <span class="n">smdict</span>
</span></pre></div>


            <div class="docstring"><p>This code will extract the sample information from the raw file</p>

<h2 id="returns">Returns:</h2>

<p>Dict[str, Any]
    A dictionary containing the sample information
    Note that UserText field may not be handled properly and may need further processing</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_instrument_data" class="classattr">
                                        <input id="ThermoBaseClass.get_instrument_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_instrument_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_instrument_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_instrument_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_instrument_data-1091"><a href="#ThermoBaseClass.get_instrument_data-1091"><span class="linenos">1091</span></a>    <span class="k">def</span> <span class="nf">get_instrument_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_instrument_data-1092"><a href="#ThermoBaseClass.get_instrument_data-1092"><span class="linenos">1092</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_instrument_data-1093"><a href="#ThermoBaseClass.get_instrument_data-1093"><span class="linenos">1093</span></a><span class="sd">        This code will extract the instrument data from the raw file</span>
</span><span id="ThermoBaseClass.get_instrument_data-1094"><a href="#ThermoBaseClass.get_instrument_data-1094"><span class="linenos">1094</span></a>
</span><span id="ThermoBaseClass.get_instrument_data-1095"><a href="#ThermoBaseClass.get_instrument_data-1095"><span class="linenos">1095</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_instrument_data-1096"><a href="#ThermoBaseClass.get_instrument_data-1096"><span class="linenos">1096</span></a><span class="sd">        --------</span>
</span><span id="ThermoBaseClass.get_instrument_data-1097"><a href="#ThermoBaseClass.get_instrument_data-1097"><span class="linenos">1097</span></a><span class="sd">        Dict[str, Any]</span>
</span><span id="ThermoBaseClass.get_instrument_data-1098"><a href="#ThermoBaseClass.get_instrument_data-1098"><span class="linenos">1098</span></a><span class="sd">            A dictionary containing the instrument data</span>
</span><span id="ThermoBaseClass.get_instrument_data-1099"><a href="#ThermoBaseClass.get_instrument_data-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_instrument_data-1100"><a href="#ThermoBaseClass.get_instrument_data-1100"><span class="linenos">1100</span></a>        <span class="n">instrument_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetInstrumentData</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_instrument_data-1101"><a href="#ThermoBaseClass.get_instrument_data-1101"><span class="linenos">1101</span></a>        <span class="n">id_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ThermoBaseClass.get_instrument_data-1102"><a href="#ThermoBaseClass.get_instrument_data-1102"><span class="linenos">1102</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Name</span>
</span><span id="ThermoBaseClass.get_instrument_data-1103"><a href="#ThermoBaseClass.get_instrument_data-1103"><span class="linenos">1103</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Model</span>
</span><span id="ThermoBaseClass.get_instrument_data-1104"><a href="#ThermoBaseClass.get_instrument_data-1104"><span class="linenos">1104</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SerialNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SerialNumber</span>
</span><span id="ThermoBaseClass.get_instrument_data-1105"><a href="#ThermoBaseClass.get_instrument_data-1105"><span class="linenos">1105</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;SoftwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">SoftwareVersion</span>
</span><span id="ThermoBaseClass.get_instrument_data-1106"><a href="#ThermoBaseClass.get_instrument_data-1106"><span class="linenos">1106</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;HardwareVersion&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">HardwareVersion</span>
</span><span id="ThermoBaseClass.get_instrument_data-1107"><a href="#ThermoBaseClass.get_instrument_data-1107"><span class="linenos">1107</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;ChannelLabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_instrument_data-1108"><a href="#ThermoBaseClass.get_instrument_data-1108"><span class="linenos">1108</span></a>            <span class="s2">&quot;ChannelLabels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">ChannelLabels</span><span class="p">]</span>
</span><span id="ThermoBaseClass.get_instrument_data-1109"><a href="#ThermoBaseClass.get_instrument_data-1109"><span class="linenos">1109</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass.get_instrument_data-1110"><a href="#ThermoBaseClass.get_instrument_data-1110"><span class="linenos">1110</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;Flags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">Flags</span>
</span><span id="ThermoBaseClass.get_instrument_data-1111"><a href="#ThermoBaseClass.get_instrument_data-1111"><span class="linenos">1111</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelY</span>
</span><span id="ThermoBaseClass.get_instrument_data-1112"><a href="#ThermoBaseClass.get_instrument_data-1112"><span class="linenos">1112</span></a>        <span class="n">id_dict</span><span class="p">[</span><span class="s2">&quot;AxisLabelX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instrument_data</span><span class="o">.</span><span class="n">AxisLabelX</span>
</span><span id="ThermoBaseClass.get_instrument_data-1113"><a href="#ThermoBaseClass.get_instrument_data-1113"><span class="linenos">1113</span></a>        <span class="k">return</span> <span class="n">id_dict</span>
</span></pre></div>


            <div class="docstring"><p>This code will extract the instrument data from the raw file</p>

<h2 id="returns">Returns:</h2>

<p>Dict[str, Any]
    A dictionary containing the instrument data</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_centroid_msms_data" class="classattr">
                                        <input id="ThermoBaseClass.get_centroid_msms_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_centroid_msms_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_centroid_msms_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_centroid_msms_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_centroid_msms_data-1115"><a href="#ThermoBaseClass.get_centroid_msms_data-1115"><span class="linenos">1115</span></a>    <span class="k">def</span> <span class="nf">get_centroid_msms_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan</span><span class="p">):</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1116"><a href="#ThermoBaseClass.get_centroid_msms_data-1116"><span class="linenos">1116</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1117"><a href="#ThermoBaseClass.get_centroid_msms_data-1117"><span class="linenos">1117</span></a><span class="sd">        .. deprecated:: 2.0</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1118"><a href="#ThermoBaseClass.get_centroid_msms_data-1118"><span class="linenos">1118</span></a><span class="sd">            This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1119"><a href="#ThermoBaseClass.get_centroid_msms_data-1119"><span class="linenos">1119</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1120"><a href="#ThermoBaseClass.get_centroid_msms_data-1120"><span class="linenos">1120</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1121"><a href="#ThermoBaseClass.get_centroid_msms_data-1121"><span class="linenos">1121</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1122"><a href="#ThermoBaseClass.get_centroid_msms_data-1122"><span class="linenos">1122</span></a>            <span class="s2">&quot;The `get_centroid_msms_data()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1123"><a href="#ThermoBaseClass.get_centroid_msms_data-1123"><span class="linenos">1123</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1124"><a href="#ThermoBaseClass.get_centroid_msms_data-1124"><span class="linenos">1124</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1125"><a href="#ThermoBaseClass.get_centroid_msms_data-1125"><span class="linenos">1125</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1126"><a href="#ThermoBaseClass.get_centroid_msms_data-1126"><span class="linenos">1126</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1127"><a href="#ThermoBaseClass.get_centroid_msms_data-1127"><span class="linenos">1127</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="p">[</span><span class="n">scan</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1128"><a href="#ThermoBaseClass.get_centroid_msms_data-1128"><span class="linenos">1128</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1129"><a href="#ThermoBaseClass.get_centroid_msms_data-1129"><span class="linenos">1129</span></a>        <span class="n">centroidStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1130"><a href="#ThermoBaseClass.get_centroid_msms_data-1130"><span class="linenos">1130</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1131"><a href="#ThermoBaseClass.get_centroid_msms_data-1131"><span class="linenos">1131</span></a>        <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1132"><a href="#ThermoBaseClass.get_centroid_msms_data-1132"><span class="linenos">1132</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1133"><a href="#ThermoBaseClass.get_centroid_msms_data-1133"><span class="linenos">1133</span></a>        <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1134"><a href="#ThermoBaseClass.get_centroid_msms_data-1134"><span class="linenos">1134</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1135"><a href="#ThermoBaseClass.get_centroid_msms_data-1135"><span class="linenos">1135</span></a>        <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1136"><a href="#ThermoBaseClass.get_centroid_msms_data-1136"><span class="linenos">1136</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1137"><a href="#ThermoBaseClass.get_centroid_msms_data-1137"><span class="linenos">1137</span></a>        <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1138"><a href="#ThermoBaseClass.get_centroid_msms_data-1138"><span class="linenos">1138</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1139"><a href="#ThermoBaseClass.get_centroid_msms_data-1139"><span class="linenos">1139</span></a>        <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroidStream</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1140"><a href="#ThermoBaseClass.get_centroid_msms_data-1140"><span class="linenos">1140</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1141"><a href="#ThermoBaseClass.get_centroid_msms_data-1141"><span class="linenos">1141</span></a>        <span class="c1"># charge = scans_labels[5]</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1142"><a href="#ThermoBaseClass.get_centroid_msms_data-1142"><span class="linenos">1142</span></a>        <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1143"><a href="#ThermoBaseClass.get_centroid_msms_data-1143"><span class="linenos">1143</span></a>        <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1144"><a href="#ThermoBaseClass.get_centroid_msms_data-1144"><span class="linenos">1144</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1145"><a href="#ThermoBaseClass.get_centroid_msms_data-1145"><span class="linenos">1145</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1146"><a href="#ThermoBaseClass.get_centroid_msms_data-1146"><span class="linenos">1146</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1147"><a href="#ThermoBaseClass.get_centroid_msms_data-1147"><span class="linenos">1147</span></a>        <span class="n">d_params</span><span class="p">[</span><span class="s2">&quot;baseline_noise_std&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">array_noise_std</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1148"><a href="#ThermoBaseClass.get_centroid_msms_data-1148"><span class="linenos">1148</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1149"><a href="#ThermoBaseClass.get_centroid_msms_data-1149"><span class="linenos">1149</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1150"><a href="#ThermoBaseClass.get_centroid_msms_data-1150"><span class="linenos">1150</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1151"><a href="#ThermoBaseClass.get_centroid_msms_data-1151"><span class="linenos">1151</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">magnitude</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1152"><a href="#ThermoBaseClass.get_centroid_msms_data-1152"><span class="linenos">1152</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1153"><a href="#ThermoBaseClass.get_centroid_msms_data-1153"><span class="linenos">1153</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1154"><a href="#ThermoBaseClass.get_centroid_msms_data-1154"><span class="linenos">1154</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1155"><a href="#ThermoBaseClass.get_centroid_msms_data-1155"><span class="linenos">1155</span></a>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1156"><a href="#ThermoBaseClass.get_centroid_msms_data-1156"><span class="linenos">1156</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1157"><a href="#ThermoBaseClass.get_centroid_msms_data-1157"><span class="linenos">1157</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_method</span> <span class="o">=</span> <span class="s2">&quot;relative_abundance&quot;</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1158"><a href="#ThermoBaseClass.get_centroid_msms_data-1158"><span class="linenos">1158</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">noise_threshold_min_relative_abundance</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1159"><a href="#ThermoBaseClass.get_centroid_msms_data-1159"><span class="linenos">1159</span></a>        <span class="n">mass_spec</span><span class="o">.</span><span class="n">process_mass_spec</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_centroid_msms_data-1160"><a href="#ThermoBaseClass.get_centroid_msms_data-1160"><span class="linenos">1160</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span></pre></div>


            <div class="docstring"><p><em>Deprecated since version 2.0:</em>
This function will be removed in CoreMS 2.0. Please use <code><a href="#ThermoBaseClass.get_average_mass_spectrum">get_average_mass_spectrum()</a></code> instead for similar functionality.</p>
</div>


                            </div>
                            <div id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist" class="classattr">
                                        <input id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_average_mass_spectrum_by_scanlist</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">scans_list</span><span class="p">:</span> <span class="n">System</span><span class="o">.</span><span class="n">Collections</span><span class="o">.</span><span class="n">Generic</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="n">Int32</span><span class="p">]</span>,</span><span class="param">	<span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span></span><span class="return-annotation">) -> <span class="n"><a href="../../mass_spectrum/factory/MassSpectrumClasses.html#MassSpecProfile">corems.mass_spectrum.factory.MassSpectrumClasses.MassSpecProfile</a></span>:</span></span>

                <label class="view-source-button" for="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1162"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1162"><span class="linenos">1162</span></a>    <span class="k">def</span> <span class="nf">get_average_mass_spectrum_by_scanlist</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1163"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1163"><span class="linenos">1163</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1164"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1164"><span class="linenos">1164</span></a>        <span class="n">scans_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1165"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1165"><span class="linenos">1165</span></a>        <span class="n">auto_process</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1166"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1166"><span class="linenos">1166</span></a>        <span class="n">ppm_tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1167"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1167"><span class="linenos">1167</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpecProfile</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1168"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1168"><span class="linenos">1168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1169"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1169"><span class="linenos">1169</span></a><span class="sd">        Averages selected scans mass spectra using Thermo&#39;s AverageScans method</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1170"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1170"><span class="linenos">1170</span></a><span class="sd">        scans_list: list[int]</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1171"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1171"><span class="linenos">1171</span></a><span class="sd">        auto_process: bool</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1172"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1172"><span class="linenos">1172</span></a><span class="sd">            If true performs peak picking, and noise threshold calculation after creation of mass spectrum object</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1173"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1173"><span class="linenos">1173</span></a><span class="sd">        Returns:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1174"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1174"><span class="linenos">1174</span></a><span class="sd">            MassSpecProfile</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1175"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1175"><span class="linenos">1175</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1176"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1176"><span class="linenos">1176</span></a><span class="sd">         .. deprecated:: 2.0</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1177"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1177"><span class="linenos">1177</span></a><span class="sd">        This function will be removed in CoreMS 2.0. Please use `get_average_mass_spectrum()` instead for similar functionality.</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1178"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1178"><span class="linenos">1178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1179"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1179"><span class="linenos">1179</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1180"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1180"><span class="linenos">1180</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1181"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1181"><span class="linenos">1181</span></a>            <span class="s2">&quot;The `get_average_mass_spectrum_by_scanlist()` is deprecated as of CoreMS 2.0 and will be removed in a future version. &quot;</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1182"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1182"><span class="linenos">1182</span></a>            <span class="s2">&quot;Please use `get_average_mass_spectrum()` instead.&quot;</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1183"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1183"><span class="linenos">1183</span></a>            <span class="ne">DeprecationWarning</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1184"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1184"><span class="linenos">1184</span></a>        <span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1185"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1185"><span class="linenos">1185</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1186"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1186"><span class="linenos">1186</span></a>        <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="n">scans_list</span><span class="o">=</span><span class="n">scans_list</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1187"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1187"><span class="linenos">1187</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1188"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1188"><span class="linenos">1188</span></a>        <span class="c1"># assumes scans is full scan or reduced profile scan</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1189"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1189"><span class="linenos">1189</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1190"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1190"><span class="linenos">1190</span></a>        <span class="n">scans</span> <span class="o">=</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]()</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1191"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1191"><span class="linenos">1191</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">scans_list</span><span class="p">:</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1192"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1192"><span class="linenos">1192</span></a>            <span class="n">scans</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1193"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1193"><span class="linenos">1193</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1194"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1194"><span class="linenos">1194</span></a>        <span class="c1"># Create the mass options object that will be used when averaging the scans</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1195"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1195"><span class="linenos">1195</span></a>        <span class="n">options</span> <span class="o">=</span> <span class="n">MassOptions</span><span class="p">()</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1196"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1196"><span class="linenos">1196</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">ToleranceUnits</span> <span class="o">=</span> <span class="n">ToleranceUnits</span><span class="o">.</span><span class="n">ppm</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1197"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1197"><span class="linenos">1197</span></a>        <span class="n">options</span><span class="o">.</span><span class="n">Tolerance</span> <span class="o">=</span> <span class="n">ppm_tolerance</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1198"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1198"><span class="linenos">1198</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1199"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1199"><span class="linenos">1199</span></a>        <span class="c1"># Get the scan filter for the first scan.  This scan filter will be used to located</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1200"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1200"><span class="linenos">1200</span></a>        <span class="c1"># scans within the given scan range of the same type</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1201"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1201"><span class="linenos">1201</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1202"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1202"><span class="linenos">1202</span></a>        <span class="n">averageScan</span> <span class="o">=</span> <span class="n">Extensions</span><span class="o">.</span><span class="n">AverageScans</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="p">,</span> <span class="n">scans</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1203"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1203"><span class="linenos">1203</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1204"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1204"><span class="linenos">1204</span></a>        <span class="n">len_data</span> <span class="o">=</span> <span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="o">.</span><span class="n">Length</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1205"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1205"><span class="linenos">1205</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1206"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1206"><span class="linenos">1206</span></a>        <span class="n">mz_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1207"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1207"><span class="linenos">1207</span></a>        <span class="n">abund_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">averageScan</span><span class="o">.</span><span class="n">SegmentedScan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1208"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1208"><span class="linenos">1208</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1209"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1209"><span class="linenos">1209</span></a>        <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1210"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1210"><span class="linenos">1210</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1211"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1211"><span class="linenos">1211</span></a>            <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abund_list</span><span class="p">,</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1212"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1212"><span class="linenos">1212</span></a>        <span class="p">}</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1213"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1213"><span class="linenos">1213</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1214"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1214"><span class="linenos">1214</span></a>        <span class="n">mass_spec</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span><span class="p">)</span>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1215"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1215"><span class="linenos">1215</span></a>
</span><span id="ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1216"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist-1216"><span class="linenos">1216</span></a>        <span class="k">return</span> <span class="n">mass_spec</span>
</span></pre></div>


            <div class="docstring"><p>Averages selected scans mass spectra using Thermo's AverageScans method
scans_list: list[int]
auto_process: bool
    If true performs peak picking, and noise threshold calculation after creation of mass spectrum object
Returns:
    MassSpecProfile</p>

<p><em>Deprecated since version 2.0.</em></p>

<p>This function will be removed in CoreMS 2.0. Please use <code><a href="#ThermoBaseClass.get_average_mass_spectrum">get_average_mass_spectrum()</a></code> instead for similar functionality.</p>
</div>


                            </div>
                </section>
                <section id="ImportMassSpectraThermoMSFileReader">
                            <input id="ImportMassSpectraThermoMSFileReader-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ImportMassSpectraThermoMSFileReader</span><wbr>(<span class="base"><a href="#ThermoBaseClass">ThermoBaseClass</a></span>, <span class="base"><a href="parserbase.html#SpectraParserInterface">corems.mass_spectra.input.parserbase.SpectraParserInterface</a></span>):

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader-1219"><a href="#ImportMassSpectraThermoMSFileReader-1219"><span class="linenos">1219</span></a><span class="k">class</span> <span class="nc">ImportMassSpectraThermoMSFileReader</span><span class="p">(</span><span class="n">ThermoBaseClass</span><span class="p">,</span> <span class="n">SpectraParserInterface</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1220"><a href="#ImportMassSpectraThermoMSFileReader-1220"><span class="linenos">1220</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for parsing Thermo RAW mass spectrometry data files and instatiating MassSpectraBase or LCMSBase objects</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1221"><a href="#ImportMassSpectraThermoMSFileReader-1221"><span class="linenos">1221</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1222"><a href="#ImportMassSpectraThermoMSFileReader-1222"><span class="linenos">1222</span></a><span class="sd">    Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1223"><a href="#ImportMassSpectraThermoMSFileReader-1223"><span class="linenos">1223</span></a><span class="sd">    ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1224"><a href="#ImportMassSpectraThermoMSFileReader-1224"><span class="linenos">1224</span></a><span class="sd">    file_location : str or Path</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1225"><a href="#ImportMassSpectraThermoMSFileReader-1225"><span class="linenos">1225</span></a><span class="sd">        The path to the RAW file to be parsed.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1226"><a href="#ImportMassSpectraThermoMSFileReader-1226"><span class="linenos">1226</span></a><span class="sd">    analyzer : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1227"><a href="#ImportMassSpectraThermoMSFileReader-1227"><span class="linenos">1227</span></a><span class="sd">        The type of mass analyzer used in the instrument. Default is &quot;Unknown&quot;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1228"><a href="#ImportMassSpectraThermoMSFileReader-1228"><span class="linenos">1228</span></a><span class="sd">    instrument_label : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1229"><a href="#ImportMassSpectraThermoMSFileReader-1229"><span class="linenos">1229</span></a><span class="sd">        The name of the instrument used to acquire the data. Default is &quot;Unknown&quot;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1230"><a href="#ImportMassSpectraThermoMSFileReader-1230"><span class="linenos">1230</span></a><span class="sd">    sample_name : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1231"><a href="#ImportMassSpectraThermoMSFileReader-1231"><span class="linenos">1231</span></a><span class="sd">        The name of the sample being analyzed. If not provided, the stem of the file_location path will be used.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1232"><a href="#ImportMassSpectraThermoMSFileReader-1232"><span class="linenos">1232</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1233"><a href="#ImportMassSpectraThermoMSFileReader-1233"><span class="linenos">1233</span></a><span class="sd">    Attributes</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1234"><a href="#ImportMassSpectraThermoMSFileReader-1234"><span class="linenos">1234</span></a><span class="sd">    ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1235"><a href="#ImportMassSpectraThermoMSFileReader-1235"><span class="linenos">1235</span></a><span class="sd">    file_location : Path</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1236"><a href="#ImportMassSpectraThermoMSFileReader-1236"><span class="linenos">1236</span></a><span class="sd">        The path to the RAW file being parsed.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1237"><a href="#ImportMassSpectraThermoMSFileReader-1237"><span class="linenos">1237</span></a><span class="sd">    analyzer : str</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1238"><a href="#ImportMassSpectraThermoMSFileReader-1238"><span class="linenos">1238</span></a><span class="sd">        The type of mass analyzer used in the instrument.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1239"><a href="#ImportMassSpectraThermoMSFileReader-1239"><span class="linenos">1239</span></a><span class="sd">    instrument_label : str</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1240"><a href="#ImportMassSpectraThermoMSFileReader-1240"><span class="linenos">1240</span></a><span class="sd">        The name of the instrument used to acquire the data.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1241"><a href="#ImportMassSpectraThermoMSFileReader-1241"><span class="linenos">1241</span></a><span class="sd">    sample_name : str</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1242"><a href="#ImportMassSpectraThermoMSFileReader-1242"><span class="linenos">1242</span></a><span class="sd">        The name of the sample being analyzed.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1243"><a href="#ImportMassSpectraThermoMSFileReader-1243"><span class="linenos">1243</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1244"><a href="#ImportMassSpectraThermoMSFileReader-1244"><span class="linenos">1244</span></a><span class="sd">    Methods</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1245"><a href="#ImportMassSpectraThermoMSFileReader-1245"><span class="linenos">1245</span></a><span class="sd">    -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1246"><a href="#ImportMassSpectraThermoMSFileReader-1246"><span class="linenos">1246</span></a><span class="sd">    * run(spectra=True).</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1247"><a href="#ImportMassSpectraThermoMSFileReader-1247"><span class="linenos">1247</span></a><span class="sd">        Parses the RAW file and returns a dictionary of mass spectra dataframes and a scan metadata dataframe.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1248"><a href="#ImportMassSpectraThermoMSFileReader-1248"><span class="linenos">1248</span></a><span class="sd">    * get_mass_spectrum_from_scan(scan_number, polarity, auto_process=True)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1249"><a href="#ImportMassSpectraThermoMSFileReader-1249"><span class="linenos">1249</span></a><span class="sd">        Parses the RAW file and returns a MassSpecBase object from a single scan.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1250"><a href="#ImportMassSpectraThermoMSFileReader-1250"><span class="linenos">1250</span></a><span class="sd">    * get_mass_spectra_obj().</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1251"><a href="#ImportMassSpectraThermoMSFileReader-1251"><span class="linenos">1251</span></a><span class="sd">        Parses the RAW file and instantiates a MassSpectraBase object.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1252"><a href="#ImportMassSpectraThermoMSFileReader-1252"><span class="linenos">1252</span></a><span class="sd">    * get_lcms_obj().</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1253"><a href="#ImportMassSpectraThermoMSFileReader-1253"><span class="linenos">1253</span></a><span class="sd">        Parses the RAW file and instantiates an LCMSBase object.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1254"><a href="#ImportMassSpectraThermoMSFileReader-1254"><span class="linenos">1254</span></a><span class="sd">    * get_icr_transient_times().</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1255"><a href="#ImportMassSpectraThermoMSFileReader-1255"><span class="linenos">1255</span></a><span class="sd">        Return a list for transient time targets for all scans, or selected scans range</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1256"><a href="#ImportMassSpectraThermoMSFileReader-1256"><span class="linenos">1256</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1257"><a href="#ImportMassSpectraThermoMSFileReader-1257"><span class="linenos">1257</span></a><span class="sd">    Inherits from ThermoBaseClass and SpectraParserInterface</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1258"><a href="#ImportMassSpectraThermoMSFileReader-1258"><span class="linenos">1258</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1259"><a href="#ImportMassSpectraThermoMSFileReader-1259"><span class="linenos">1259</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1260"><a href="#ImportMassSpectraThermoMSFileReader-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1261"><a href="#ImportMassSpectraThermoMSFileReader-1261"><span class="linenos">1261</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1262"><a href="#ImportMassSpectraThermoMSFileReader-1262"><span class="linenos">1262</span></a>        <span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1263"><a href="#ImportMassSpectraThermoMSFileReader-1263"><span class="linenos">1263</span></a>        <span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1264"><a href="#ImportMassSpectraThermoMSFileReader-1264"><span class="linenos">1264</span></a>        <span class="n">instrument_label</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1265"><a href="#ImportMassSpectraThermoMSFileReader-1265"><span class="linenos">1265</span></a>        <span class="n">sample_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1266"><a href="#ImportMassSpectraThermoMSFileReader-1266"><span class="linenos">1266</span></a>    <span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1267"><a href="#ImportMassSpectraThermoMSFileReader-1267"><span class="linenos">1267</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1268"><a href="#ImportMassSpectraThermoMSFileReader-1268"><span class="linenos">1268</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1269"><a href="#ImportMassSpectraThermoMSFileReader-1269"><span class="linenos">1269</span></a>            <span class="c1"># if obj is a string it defaults to create a Path obj, pass the S3Path if needed</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1270"><a href="#ImportMassSpectraThermoMSFileReader-1270"><span class="linenos">1270</span></a>            <span class="n">file_location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1271"><a href="#ImportMassSpectraThermoMSFileReader-1271"><span class="linenos">1271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_location</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1272"><a href="#ImportMassSpectraThermoMSFileReader-1272"><span class="linenos">1272</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_location</span><span class="p">))</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1273"><a href="#ImportMassSpectraThermoMSFileReader-1273"><span class="linenos">1273</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1274"><a href="#ImportMassSpectraThermoMSFileReader-1274"><span class="linenos">1274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1275"><a href="#ImportMassSpectraThermoMSFileReader-1275"><span class="linenos">1275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">analyzer</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1276"><a href="#ImportMassSpectraThermoMSFileReader-1276"><span class="linenos">1276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span> <span class="o">=</span> <span class="n">instrument_label</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1277"><a href="#ImportMassSpectraThermoMSFileReader-1277"><span class="linenos">1277</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1278"><a href="#ImportMassSpectraThermoMSFileReader-1278"><span class="linenos">1278</span></a>        <span class="k">if</span> <span class="n">sample_name</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1279"><a href="#ImportMassSpectraThermoMSFileReader-1279"><span class="linenos">1279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">sample_name</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1280"><a href="#ImportMassSpectraThermoMSFileReader-1280"><span class="linenos">1280</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1281"><a href="#ImportMassSpectraThermoMSFileReader-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">file_location</span><span class="o">.</span><span class="n">stem</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1282"><a href="#ImportMassSpectraThermoMSFileReader-1282"><span class="linenos">1282</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1283"><a href="#ImportMassSpectraThermoMSFileReader-1283"><span class="linenos">1283</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1284"><a href="#ImportMassSpectraThermoMSFileReader-1284"><span class="linenos">1284</span></a>        <span class="k">pass</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1285"><a href="#ImportMassSpectraThermoMSFileReader-1285"><span class="linenos">1285</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1286"><a href="#ImportMassSpectraThermoMSFileReader-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1287"><a href="#ImportMassSpectraThermoMSFileReader-1287"><span class="linenos">1287</span></a>        <span class="c1"># This automatically brings in all the data</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1288"><a href="#ImportMassSpectraThermoMSFileReader-1288"><span class="linenos">1288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1289"><a href="#ImportMassSpectraThermoMSFileReader-1289"><span class="linenos">1289</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1290"><a href="#ImportMassSpectraThermoMSFileReader-1290"><span class="linenos">1290</span></a>        <span class="c1"># Get scan df info; starting with bulk ms1 and ms2 scans</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1291"><a href="#ImportMassSpectraThermoMSFileReader-1291"><span class="linenos">1291</span></a>        <span class="n">ms1_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span><span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1292"><a href="#ImportMassSpectraThermoMSFileReader-1292"><span class="linenos">1292</span></a>        <span class="n">ms1_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1293"><a href="#ImportMassSpectraThermoMSFileReader-1293"><span class="linenos">1293</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1294"><a href="#ImportMassSpectraThermoMSFileReader-1294"><span class="linenos">1294</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1295"><a href="#ImportMassSpectraThermoMSFileReader-1295"><span class="linenos">1295</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1296"><a href="#ImportMassSpectraThermoMSFileReader-1296"><span class="linenos">1296</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1297"><a href="#ImportMassSpectraThermoMSFileReader-1297"><span class="linenos">1297</span></a>        <span class="n">ms1_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms1_scan_dict</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1298"><a href="#ImportMassSpectraThermoMSFileReader-1298"><span class="linenos">1298</span></a>        <span class="n">ms1_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1299"><a href="#ImportMassSpectraThermoMSFileReader-1299"><span class="linenos">1299</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1300"><a href="#ImportMassSpectraThermoMSFileReader-1300"><span class="linenos">1300</span></a>        <span class="n">ms2_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1301"><a href="#ImportMassSpectraThermoMSFileReader-1301"><span class="linenos">1301</span></a>            <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS2&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1302"><a href="#ImportMassSpectraThermoMSFileReader-1302"><span class="linenos">1302</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1303"><a href="#ImportMassSpectraThermoMSFileReader-1303"><span class="linenos">1303</span></a>        <span class="n">ms2_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1304"><a href="#ImportMassSpectraThermoMSFileReader-1304"><span class="linenos">1304</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1305"><a href="#ImportMassSpectraThermoMSFileReader-1305"><span class="linenos">1305</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1306"><a href="#ImportMassSpectraThermoMSFileReader-1306"><span class="linenos">1306</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1307"><a href="#ImportMassSpectraThermoMSFileReader-1307"><span class="linenos">1307</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1308"><a href="#ImportMassSpectraThermoMSFileReader-1308"><span class="linenos">1308</span></a>        <span class="n">ms2_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms2_scan_dict</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1309"><a href="#ImportMassSpectraThermoMSFileReader-1309"><span class="linenos">1309</span></a>        <span class="n">ms2_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms2&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1310"><a href="#ImportMassSpectraThermoMSFileReader-1310"><span class="linenos">1310</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1311"><a href="#ImportMassSpectraThermoMSFileReader-1311"><span class="linenos">1311</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1312"><a href="#ImportMassSpectraThermoMSFileReader-1312"><span class="linenos">1312</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ms1_tic_df</span><span class="p">,</span> <span class="n">ms2_tic_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1313"><a href="#ImportMassSpectraThermoMSFileReader-1313"><span class="linenos">1313</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1314"><a href="#ImportMassSpectraThermoMSFileReader-1314"><span class="linenos">1314</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1315"><a href="#ImportMassSpectraThermoMSFileReader-1315"><span class="linenos">1315</span></a>        <span class="c1"># get scan text</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1316"><a href="#ImportMassSpectraThermoMSFileReader-1316"><span class="linenos">1316</span></a>        <span class="n">scan_filter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1317"><a href="#ImportMassSpectraThermoMSFileReader-1317"><span class="linenos">1317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_filters</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1318"><a href="#ImportMassSpectraThermoMSFileReader-1318"><span class="linenos">1318</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1319"><a href="#ImportMassSpectraThermoMSFileReader-1319"><span class="linenos">1319</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1320"><a href="#ImportMassSpectraThermoMSFileReader-1320"><span class="linenos">1320</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;scan_text&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1321"><a href="#ImportMassSpectraThermoMSFileReader-1321"><span class="linenos">1321</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1322"><a href="#ImportMassSpectraThermoMSFileReader-1322"><span class="linenos">1322</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">scan_filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1323"><a href="#ImportMassSpectraThermoMSFileReader-1323"><span class="linenos">1323</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1324"><a href="#ImportMassSpectraThermoMSFileReader-1324"><span class="linenos">1324</span></a>            <span class="sa">r</span><span class="s2">&quot;\[(\d+\.\d+)-\d+\.\d+\]&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1325"><a href="#ImportMassSpectraThermoMSFileReader-1325"><span class="linenos">1325</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1326"><a href="#ImportMassSpectraThermoMSFileReader-1326"><span class="linenos">1326</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_upper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1327"><a href="#ImportMassSpectraThermoMSFileReader-1327"><span class="linenos">1327</span></a>            <span class="sa">r</span><span class="s2">&quot;\[\d+\.\d+-(\d+\.\d+)\]&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1328"><a href="#ImportMassSpectraThermoMSFileReader-1328"><span class="linenos">1328</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1329"><a href="#ImportMassSpectraThermoMSFileReader-1329"><span class="linenos">1329</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1330"><a href="#ImportMassSpectraThermoMSFileReader-1330"><span class="linenos">1330</span></a>            <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">),</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1331"><a href="#ImportMassSpectraThermoMSFileReader-1331"><span class="linenos">1331</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1332"><a href="#ImportMassSpectraThermoMSFileReader-1332"><span class="linenos">1332</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+\.\d+)@&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1333"><a href="#ImportMassSpectraThermoMSFileReader-1333"><span class="linenos">1333</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1334"><a href="#ImportMassSpectraThermoMSFileReader-1334"><span class="linenos">1334</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1335"><a href="#ImportMassSpectraThermoMSFileReader-1335"><span class="linenos">1335</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1336"><a href="#ImportMassSpectraThermoMSFileReader-1336"><span class="linenos">1336</span></a>        <span class="c1"># Assign each scan as centroid or profile</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1337"><a href="#ImportMassSpectraThermoMSFileReader-1337"><span class="linenos">1337</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1338"><a href="#ImportMassSpectraThermoMSFileReader-1338"><span class="linenos">1338</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1339"><a href="#ImportMassSpectraThermoMSFileReader-1339"><span class="linenos">1339</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsCentroidScanFromScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1340"><a href="#ImportMassSpectraThermoMSFileReader-1340"><span class="linenos">1340</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centroid&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1341"><a href="#ImportMassSpectraThermoMSFileReader-1341"><span class="linenos">1341</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1342"><a href="#ImportMassSpectraThermoMSFileReader-1342"><span class="linenos">1342</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1343"><a href="#ImportMassSpectraThermoMSFileReader-1343"><span class="linenos">1343</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1344"><a href="#ImportMassSpectraThermoMSFileReader-1344"><span class="linenos">1344</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1345"><a href="#ImportMassSpectraThermoMSFileReader-1345"><span class="linenos">1345</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1346"><a href="#ImportMassSpectraThermoMSFileReader-1346"><span class="linenos">1346</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1347"><a href="#ImportMassSpectraThermoMSFileReader-1347"><span class="linenos">1347</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1348"><a href="#ImportMassSpectraThermoMSFileReader-1348"><span class="linenos">1348</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1349"><a href="#ImportMassSpectraThermoMSFileReader-1349"><span class="linenos">1349</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms1&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1350"><a href="#ImportMassSpectraThermoMSFileReader-1350"><span class="linenos">1350</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1351"><a href="#ImportMassSpectraThermoMSFileReader-1351"><span class="linenos">1351</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms2&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1352"><a href="#ImportMassSpectraThermoMSFileReader-1352"><span class="linenos">1352</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1353"><a href="#ImportMassSpectraThermoMSFileReader-1353"><span class="linenos">1353</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1354"><a href="#ImportMassSpectraThermoMSFileReader-1354"><span class="linenos">1354</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectra must be &#39;none&#39;, &#39;all&#39;, &#39;ms1&#39;, or &#39;ms2&#39;&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1355"><a href="#ImportMassSpectraThermoMSFileReader-1355"><span class="linenos">1355</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1356"><a href="#ImportMassSpectraThermoMSFileReader-1356"><span class="linenos">1356</span></a>        <span class="c1"># Result container</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1357"><a href="#ImportMassSpectraThermoMSFileReader-1357"><span class="linenos">1357</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1358"><a href="#ImportMassSpectraThermoMSFileReader-1358"><span class="linenos">1358</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1359"><a href="#ImportMassSpectraThermoMSFileReader-1359"><span class="linenos">1359</span></a>        <span class="c1"># Row count container</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1360"><a href="#ImportMassSpectraThermoMSFileReader-1360"><span class="linenos">1360</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1361"><a href="#ImportMassSpectraThermoMSFileReader-1361"><span class="linenos">1361</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1362"><a href="#ImportMassSpectraThermoMSFileReader-1362"><span class="linenos">1362</span></a>        <span class="c1"># Column name container</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1363"><a href="#ImportMassSpectraThermoMSFileReader-1363"><span class="linenos">1363</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1364"><a href="#ImportMassSpectraThermoMSFileReader-1364"><span class="linenos">1364</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1365"><a href="#ImportMassSpectraThermoMSFileReader-1365"><span class="linenos">1365</span></a>        <span class="c1"># set at float32</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1366"><a href="#ImportMassSpectraThermoMSFileReader-1366"><span class="linenos">1366</span></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1367"><a href="#ImportMassSpectraThermoMSFileReader-1367"><span class="linenos">1367</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1368"><a href="#ImportMassSpectraThermoMSFileReader-1368"><span class="linenos">1368</span></a>        <span class="c1"># First pass: get nrows</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1369"><a href="#ImportMassSpectraThermoMSFileReader-1369"><span class="linenos">1369</span></a>        <span class="n">N</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1370"><a href="#ImportMassSpectraThermoMSFileReader-1370"><span class="linenos">1370</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1371"><a href="#ImportMassSpectraThermoMSFileReader-1371"><span class="linenos">1371</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1372"><a href="#ImportMassSpectraThermoMSFileReader-1372"><span class="linenos">1372</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1373"><a href="#ImportMassSpectraThermoMSFileReader-1373"><span class="linenos">1373</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1374"><a href="#ImportMassSpectraThermoMSFileReader-1374"><span class="linenos">1374</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1375"><a href="#ImportMassSpectraThermoMSFileReader-1375"><span class="linenos">1375</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1376"><a href="#ImportMassSpectraThermoMSFileReader-1376"><span class="linenos">1376</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1377"><a href="#ImportMassSpectraThermoMSFileReader-1377"><span class="linenos">1377</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1378"><a href="#ImportMassSpectraThermoMSFileReader-1378"><span class="linenos">1378</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1379"><a href="#ImportMassSpectraThermoMSFileReader-1379"><span class="linenos">1379</span></a>            <span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1380"><a href="#ImportMassSpectraThermoMSFileReader-1380"><span class="linenos">1380</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1381"><a href="#ImportMassSpectraThermoMSFileReader-1381"><span class="linenos">1381</span></a>        <span class="c1"># Second pass: parse</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1382"><a href="#ImportMassSpectraThermoMSFileReader-1382"><span class="linenos">1382</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1383"><a href="#ImportMassSpectraThermoMSFileReader-1383"><span class="linenos">1383</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1384"><a href="#ImportMassSpectraThermoMSFileReader-1384"><span class="linenos">1384</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1385"><a href="#ImportMassSpectraThermoMSFileReader-1385"><span class="linenos">1385</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1386"><a href="#ImportMassSpectraThermoMSFileReader-1386"><span class="linenos">1386</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1387"><a href="#ImportMassSpectraThermoMSFileReader-1387"><span class="linenos">1387</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1388"><a href="#ImportMassSpectraThermoMSFileReader-1388"><span class="linenos">1388</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1389"><a href="#ImportMassSpectraThermoMSFileReader-1389"><span class="linenos">1389</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1390"><a href="#ImportMassSpectraThermoMSFileReader-1390"><span class="linenos">1390</span></a>            <span class="c1"># Get index of abun that are &gt; 0</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1391"><a href="#ImportMassSpectraThermoMSFileReader-1391"><span class="linenos">1391</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1392"><a href="#ImportMassSpectraThermoMSFileReader-1392"><span class="linenos">1392</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mz</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1393"><a href="#ImportMassSpectraThermoMSFileReader-1393"><span class="linenos">1393</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1394"><a href="#ImportMassSpectraThermoMSFileReader-1394"><span class="linenos">1394</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1395"><a href="#ImportMassSpectraThermoMSFileReader-1395"><span class="linenos">1395</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1396"><a href="#ImportMassSpectraThermoMSFileReader-1396"><span class="linenos">1396</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1397"><a href="#ImportMassSpectraThermoMSFileReader-1397"><span class="linenos">1397</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1398"><a href="#ImportMassSpectraThermoMSFileReader-1398"><span class="linenos">1398</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1399"><a href="#ImportMassSpectraThermoMSFileReader-1399"><span class="linenos">1399</span></a>            <span class="c1"># Number of rows</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1400"><a href="#ImportMassSpectraThermoMSFileReader-1400"><span class="linenos">1400</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1401"><a href="#ImportMassSpectraThermoMSFileReader-1401"><span class="linenos">1401</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1402"><a href="#ImportMassSpectraThermoMSFileReader-1402"><span class="linenos">1402</span></a>            <span class="c1"># No measurements</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1403"><a href="#ImportMassSpectraThermoMSFileReader-1403"><span class="linenos">1403</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1404"><a href="#ImportMassSpectraThermoMSFileReader-1404"><span class="linenos">1404</span></a>                <span class="k">continue</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1405"><a href="#ImportMassSpectraThermoMSFileReader-1405"><span class="linenos">1405</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1406"><a href="#ImportMassSpectraThermoMSFileReader-1406"><span class="linenos">1406</span></a>            <span class="c1"># Dimension check</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1407"><a href="#ImportMassSpectraThermoMSFileReader-1407"><span class="linenos">1407</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1408"><a href="#ImportMassSpectraThermoMSFileReader-1408"><span class="linenos">1408</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;m/z and intensity array dimension mismatch&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1409"><a href="#ImportMassSpectraThermoMSFileReader-1409"><span class="linenos">1409</span></a>                <span class="k">continue</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1410"><a href="#ImportMassSpectraThermoMSFileReader-1410"><span class="linenos">1410</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1411"><a href="#ImportMassSpectraThermoMSFileReader-1411"><span class="linenos">1411</span></a>            <span class="c1"># Scan/frame info</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1412"><a href="#ImportMassSpectraThermoMSFileReader-1412"><span class="linenos">1412</span></a>            <span class="n">id_dict</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1413"><a href="#ImportMassSpectraThermoMSFileReader-1413"><span class="linenos">1413</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1414"><a href="#ImportMassSpectraThermoMSFileReader-1414"><span class="linenos">1414</span></a>            <span class="c1"># Columns</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1415"><a href="#ImportMassSpectraThermoMSFileReader-1415"><span class="linenos">1415</span></a>            <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1416"><a href="#ImportMassSpectraThermoMSFileReader-1416"><span class="linenos">1416</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1417"><a href="#ImportMassSpectraThermoMSFileReader-1417"><span class="linenos">1417</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1418"><a href="#ImportMassSpectraThermoMSFileReader-1418"><span class="linenos">1418</span></a>            <span class="c1"># Subarray init</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1419"><a href="#ImportMassSpectraThermoMSFileReader-1419"><span class="linenos">1419</span></a>            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1420"><a href="#ImportMassSpectraThermoMSFileReader-1420"><span class="linenos">1420</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1421"><a href="#ImportMassSpectraThermoMSFileReader-1421"><span class="linenos">1421</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1422"><a href="#ImportMassSpectraThermoMSFileReader-1422"><span class="linenos">1422</span></a>            <span class="c1"># Populate scan/frame info</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1423"><a href="#ImportMassSpectraThermoMSFileReader-1423"><span class="linenos">1423</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1424"><a href="#ImportMassSpectraThermoMSFileReader-1424"><span class="linenos">1424</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1425"><a href="#ImportMassSpectraThermoMSFileReader-1425"><span class="linenos">1425</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1426"><a href="#ImportMassSpectraThermoMSFileReader-1426"><span class="linenos">1426</span></a>            <span class="c1"># Populate m/z</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1427"><a href="#ImportMassSpectraThermoMSFileReader-1427"><span class="linenos">1427</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">mz</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1428"><a href="#ImportMassSpectraThermoMSFileReader-1428"><span class="linenos">1428</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1429"><a href="#ImportMassSpectraThermoMSFileReader-1429"><span class="linenos">1429</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1430"><a href="#ImportMassSpectraThermoMSFileReader-1430"><span class="linenos">1430</span></a>            <span class="c1"># Populate intensity</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1431"><a href="#ImportMassSpectraThermoMSFileReader-1431"><span class="linenos">1431</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">abun</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1432"><a href="#ImportMassSpectraThermoMSFileReader-1432"><span class="linenos">1432</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1433"><a href="#ImportMassSpectraThermoMSFileReader-1433"><span class="linenos">1433</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1434"><a href="#ImportMassSpectraThermoMSFileReader-1434"><span class="linenos">1434</span></a>            <span class="c1"># Initialize output container</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1435"><a href="#ImportMassSpectraThermoMSFileReader-1435"><span class="linenos">1435</span></a>            <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1436"><a href="#ImportMassSpectraThermoMSFileReader-1436"><span class="linenos">1436</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">],</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1437"><a href="#ImportMassSpectraThermoMSFileReader-1437"><span class="linenos">1437</span></a>                <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1438"><a href="#ImportMassSpectraThermoMSFileReader-1438"><span class="linenos">1438</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1439"><a href="#ImportMassSpectraThermoMSFileReader-1439"><span class="linenos">1439</span></a>            <span class="c1"># Insert subarray</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1440"><a href="#ImportMassSpectraThermoMSFileReader-1440"><span class="linenos">1440</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="p">:</span> <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">arr</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1441"><a href="#ImportMassSpectraThermoMSFileReader-1441"><span class="linenos">1441</span></a>            <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="n">n</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1442"><a href="#ImportMassSpectraThermoMSFileReader-1442"><span class="linenos">1442</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1443"><a href="#ImportMassSpectraThermoMSFileReader-1443"><span class="linenos">1443</span></a>        <span class="c1"># Construct ms1 and ms2 mz dataframes</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1444"><a href="#ImportMassSpectraThermoMSFileReader-1444"><span class="linenos">1444</span></a>        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1445"><a href="#ImportMassSpectraThermoMSFileReader-1445"><span class="linenos">1445</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1446"><a href="#ImportMassSpectraThermoMSFileReader-1446"><span class="linenos">1446</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1447"><a href="#ImportMassSpectraThermoMSFileReader-1447"><span class="linenos">1447</span></a>        <span class="c1"># rename keys in res to add &#39;ms&#39; prefix</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1448"><a href="#ImportMassSpectraThermoMSFileReader-1448"><span class="linenos">1448</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;ms</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1449"><a href="#ImportMassSpectraThermoMSFileReader-1449"><span class="linenos">1449</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1450"><a href="#ImportMassSpectraThermoMSFileReader-1450"><span class="linenos">1450</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1451"><a href="#ImportMassSpectraThermoMSFileReader-1451"><span class="linenos">1451</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1452"><a href="#ImportMassSpectraThermoMSFileReader-1452"><span class="linenos">1452</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1453"><a href="#ImportMassSpectraThermoMSFileReader-1453"><span class="linenos">1453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1454"><a href="#ImportMassSpectraThermoMSFileReader-1454"><span class="linenos">1454</span></a><span class="sd">        Extracts mass spectra data from a raw file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1455"><a href="#ImportMassSpectraThermoMSFileReader-1455"><span class="linenos">1455</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1456"><a href="#ImportMassSpectraThermoMSFileReader-1456"><span class="linenos">1456</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1457"><a href="#ImportMassSpectraThermoMSFileReader-1457"><span class="linenos">1457</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1458"><a href="#ImportMassSpectraThermoMSFileReader-1458"><span class="linenos">1458</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1459"><a href="#ImportMassSpectraThermoMSFileReader-1459"><span class="linenos">1459</span></a><span class="sd">            Which mass spectra data to include in the output. Default is all.  Other options: none, ms1, ms2.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1460"><a href="#ImportMassSpectraThermoMSFileReader-1460"><span class="linenos">1460</span></a><span class="sd">        scan_df : pandas.DataFrame, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1461"><a href="#ImportMassSpectraThermoMSFileReader-1461"><span class="linenos">1461</span></a><span class="sd">            Scan dataframe.  If not provided, the scan dataframe is created from the mzML file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1462"><a href="#ImportMassSpectraThermoMSFileReader-1462"><span class="linenos">1462</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1463"><a href="#ImportMassSpectraThermoMSFileReader-1463"><span class="linenos">1463</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1464"><a href="#ImportMassSpectraThermoMSFileReader-1464"><span class="linenos">1464</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1465"><a href="#ImportMassSpectraThermoMSFileReader-1465"><span class="linenos">1465</span></a><span class="sd">        tuple</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1466"><a href="#ImportMassSpectraThermoMSFileReader-1466"><span class="linenos">1466</span></a><span class="sd">            A tuple containing two elements:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1467"><a href="#ImportMassSpectraThermoMSFileReader-1467"><span class="linenos">1467</span></a><span class="sd">            - A dictionary containing mass spectra data, separated by MS level.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1468"><a href="#ImportMassSpectraThermoMSFileReader-1468"><span class="linenos">1468</span></a><span class="sd">            - A pandas DataFrame containing scan information, including scan number, scan time, TIC, MS level,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1469"><a href="#ImportMassSpectraThermoMSFileReader-1469"><span class="linenos">1469</span></a><span class="sd">                scan text, scan window lower and upper bounds, polarity, and precursor m/z (if applicable).</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1470"><a href="#ImportMassSpectraThermoMSFileReader-1470"><span class="linenos">1470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1471"><a href="#ImportMassSpectraThermoMSFileReader-1471"><span class="linenos">1471</span></a>        <span class="c1"># Prepare scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1472"><a href="#ImportMassSpectraThermoMSFileReader-1472"><span class="linenos">1472</span></a>        <span class="k">if</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1473"><a href="#ImportMassSpectraThermoMSFileReader-1473"><span class="linenos">1473</span></a>            <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1474"><a href="#ImportMassSpectraThermoMSFileReader-1474"><span class="linenos">1474</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1475"><a href="#ImportMassSpectraThermoMSFileReader-1475"><span class="linenos">1475</span></a>        <span class="c1"># Prepare mass spectra data</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1476"><a href="#ImportMassSpectraThermoMSFileReader-1476"><span class="linenos">1476</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1477"><a href="#ImportMassSpectraThermoMSFileReader-1477"><span class="linenos">1477</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1478"><a href="#ImportMassSpectraThermoMSFileReader-1478"><span class="linenos">1478</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1479"><a href="#ImportMassSpectraThermoMSFileReader-1479"><span class="linenos">1479</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1480"><a href="#ImportMassSpectraThermoMSFileReader-1480"><span class="linenos">1480</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1481"><a href="#ImportMassSpectraThermoMSFileReader-1481"><span class="linenos">1481</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1482"><a href="#ImportMassSpectraThermoMSFileReader-1482"><span class="linenos">1482</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1483"><a href="#ImportMassSpectraThermoMSFileReader-1483"><span class="linenos">1483</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1484"><a href="#ImportMassSpectraThermoMSFileReader-1484"><span class="linenos">1484</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">,</span> <span class="n">spectrum_mode</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1485"><a href="#ImportMassSpectraThermoMSFileReader-1485"><span class="linenos">1485</span></a>    <span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1486"><a href="#ImportMassSpectraThermoMSFileReader-1486"><span class="linenos">1486</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpecBase object from a single scan number from the binary file, currently only supports profile mode.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1487"><a href="#ImportMassSpectraThermoMSFileReader-1487"><span class="linenos">1487</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1488"><a href="#ImportMassSpectraThermoMSFileReader-1488"><span class="linenos">1488</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1489"><a href="#ImportMassSpectraThermoMSFileReader-1489"><span class="linenos">1489</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1490"><a href="#ImportMassSpectraThermoMSFileReader-1490"><span class="linenos">1490</span></a><span class="sd">        scan_number : int</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1491"><a href="#ImportMassSpectraThermoMSFileReader-1491"><span class="linenos">1491</span></a><span class="sd">            The scan number to extract the mass spectrum from.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1492"><a href="#ImportMassSpectraThermoMSFileReader-1492"><span class="linenos">1492</span></a><span class="sd">        polarity : int</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1493"><a href="#ImportMassSpectraThermoMSFileReader-1493"><span class="linenos">1493</span></a><span class="sd">            The polarity of the scan.  1 for positive mode, -1 for negative mode.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1494"><a href="#ImportMassSpectraThermoMSFileReader-1494"><span class="linenos">1494</span></a><span class="sd">        spectrum_mode : str</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1495"><a href="#ImportMassSpectraThermoMSFileReader-1495"><span class="linenos">1495</span></a><span class="sd">            The type of mass spectrum to extract.  Must be &#39;profile&#39; or &#39;centroid&#39;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1496"><a href="#ImportMassSpectraThermoMSFileReader-1496"><span class="linenos">1496</span></a><span class="sd">        auto_process : bool, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1497"><a href="#ImportMassSpectraThermoMSFileReader-1497"><span class="linenos">1497</span></a><span class="sd">            If True, perform peak picking and noise threshold calculation after creating the mass spectrum object. Default is True.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1498"><a href="#ImportMassSpectraThermoMSFileReader-1498"><span class="linenos">1498</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1499"><a href="#ImportMassSpectraThermoMSFileReader-1499"><span class="linenos">1499</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1500"><a href="#ImportMassSpectraThermoMSFileReader-1500"><span class="linenos">1500</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1501"><a href="#ImportMassSpectraThermoMSFileReader-1501"><span class="linenos">1501</span></a><span class="sd">        MassSpecProfile | MassSpecCentroid</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1502"><a href="#ImportMassSpectraThermoMSFileReader-1502"><span class="linenos">1502</span></a><span class="sd">            The MassSpecProfile or MassSpecCentroid object containing the parsed mass spectrum.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1503"><a href="#ImportMassSpectraThermoMSFileReader-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1504"><a href="#ImportMassSpectraThermoMSFileReader-1504"><span class="linenos">1504</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1505"><a href="#ImportMassSpectraThermoMSFileReader-1505"><span class="linenos">1505</span></a>        <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1506"><a href="#ImportMassSpectraThermoMSFileReader-1506"><span class="linenos">1506</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1507"><a href="#ImportMassSpectraThermoMSFileReader-1507"><span class="linenos">1507</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1508"><a href="#ImportMassSpectraThermoMSFileReader-1508"><span class="linenos">1508</span></a>                <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1509"><a href="#ImportMassSpectraThermoMSFileReader-1509"><span class="linenos">1509</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1510"><a href="#ImportMassSpectraThermoMSFileReader-1510"><span class="linenos">1510</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1511"><a href="#ImportMassSpectraThermoMSFileReader-1511"><span class="linenos">1511</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1512"><a href="#ImportMassSpectraThermoMSFileReader-1512"><span class="linenos">1512</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1513"><a href="#ImportMassSpectraThermoMSFileReader-1513"><span class="linenos">1513</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1514"><a href="#ImportMassSpectraThermoMSFileReader-1514"><span class="linenos">1514</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1515"><a href="#ImportMassSpectraThermoMSFileReader-1515"><span class="linenos">1515</span></a>            <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1516"><a href="#ImportMassSpectraThermoMSFileReader-1516"><span class="linenos">1516</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1517"><a href="#ImportMassSpectraThermoMSFileReader-1517"><span class="linenos">1517</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1518"><a href="#ImportMassSpectraThermoMSFileReader-1518"><span class="linenos">1518</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1519"><a href="#ImportMassSpectraThermoMSFileReader-1519"><span class="linenos">1519</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1520"><a href="#ImportMassSpectraThermoMSFileReader-1520"><span class="linenos">1520</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1521"><a href="#ImportMassSpectraThermoMSFileReader-1521"><span class="linenos">1521</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1522"><a href="#ImportMassSpectraThermoMSFileReader-1522"><span class="linenos">1522</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1523"><a href="#ImportMassSpectraThermoMSFileReader-1523"><span class="linenos">1523</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1524"><a href="#ImportMassSpectraThermoMSFileReader-1524"><span class="linenos">1524</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1525"><a href="#ImportMassSpectraThermoMSFileReader-1525"><span class="linenos">1525</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1526"><a href="#ImportMassSpectraThermoMSFileReader-1526"><span class="linenos">1526</span></a>        <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1527"><a href="#ImportMassSpectraThermoMSFileReader-1527"><span class="linenos">1527</span></a>            <span class="n">centroid_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1528"><a href="#ImportMassSpectraThermoMSFileReader-1528"><span class="linenos">1528</span></a>            <span class="k">if</span> <span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1529"><a href="#ImportMassSpectraThermoMSFileReader-1529"><span class="linenos">1529</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1530"><a href="#ImportMassSpectraThermoMSFileReader-1530"><span class="linenos">1530</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1531"><a href="#ImportMassSpectraThermoMSFileReader-1531"><span class="linenos">1531</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1532"><a href="#ImportMassSpectraThermoMSFileReader-1532"><span class="linenos">1532</span></a>                <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1533"><a href="#ImportMassSpectraThermoMSFileReader-1533"><span class="linenos">1533</span></a>                <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1534"><a href="#ImportMassSpectraThermoMSFileReader-1534"><span class="linenos">1534</span></a>                <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1535"><a href="#ImportMassSpectraThermoMSFileReader-1535"><span class="linenos">1535</span></a>                <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1536"><a href="#ImportMassSpectraThermoMSFileReader-1536"><span class="linenos">1536</span></a>                <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1537"><a href="#ImportMassSpectraThermoMSFileReader-1537"><span class="linenos">1537</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1538"><a href="#ImportMassSpectraThermoMSFileReader-1538"><span class="linenos">1538</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1539"><a href="#ImportMassSpectraThermoMSFileReader-1539"><span class="linenos">1539</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1540"><a href="#ImportMassSpectraThermoMSFileReader-1540"><span class="linenos">1540</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1541"><a href="#ImportMassSpectraThermoMSFileReader-1541"><span class="linenos">1541</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1542"><a href="#ImportMassSpectraThermoMSFileReader-1542"><span class="linenos">1542</span></a>                <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1543"><a href="#ImportMassSpectraThermoMSFileReader-1543"><span class="linenos">1543</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># For CID MS2, the centroid data are stored in the profile data location, they do not have any associated rp or baseline data, but they should be treated as centroid data</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1544"><a href="#ImportMassSpectraThermoMSFileReader-1544"><span class="linenos">1544</span></a>                <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1545"><a href="#ImportMassSpectraThermoMSFileReader-1545"><span class="linenos">1545</span></a>                    <span class="n">scan_number</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1546"><a href="#ImportMassSpectraThermoMSFileReader-1546"><span class="linenos">1546</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1547"><a href="#ImportMassSpectraThermoMSFileReader-1547"><span class="linenos">1547</span></a>                <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1548"><a href="#ImportMassSpectraThermoMSFileReader-1548"><span class="linenos">1548</span></a>                    <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1549"><a href="#ImportMassSpectraThermoMSFileReader-1549"><span class="linenos">1549</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1550"><a href="#ImportMassSpectraThermoMSFileReader-1550"><span class="linenos">1550</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1551"><a href="#ImportMassSpectraThermoMSFileReader-1551"><span class="linenos">1551</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1552"><a href="#ImportMassSpectraThermoMSFileReader-1552"><span class="linenos">1552</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1553"><a href="#ImportMassSpectraThermoMSFileReader-1553"><span class="linenos">1553</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1554"><a href="#ImportMassSpectraThermoMSFileReader-1554"><span class="linenos">1554</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1555"><a href="#ImportMassSpectraThermoMSFileReader-1555"><span class="linenos">1555</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1556"><a href="#ImportMassSpectraThermoMSFileReader-1556"><span class="linenos">1556</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1557"><a href="#ImportMassSpectraThermoMSFileReader-1557"><span class="linenos">1557</span></a>                <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1558"><a href="#ImportMassSpectraThermoMSFileReader-1558"><span class="linenos">1558</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1559"><a href="#ImportMassSpectraThermoMSFileReader-1559"><span class="linenos">1559</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1560"><a href="#ImportMassSpectraThermoMSFileReader-1560"><span class="linenos">1560</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1561"><a href="#ImportMassSpectraThermoMSFileReader-1561"><span class="linenos">1561</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1562"><a href="#ImportMassSpectraThermoMSFileReader-1562"><span class="linenos">1562</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1563"><a href="#ImportMassSpectraThermoMSFileReader-1563"><span class="linenos">1563</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1564"><a href="#ImportMassSpectraThermoMSFileReader-1564"><span class="linenos">1564</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1565"><a href="#ImportMassSpectraThermoMSFileReader-1565"><span class="linenos">1565</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1566"><a href="#ImportMassSpectraThermoMSFileReader-1566"><span class="linenos">1566</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1567"><a href="#ImportMassSpectraThermoMSFileReader-1567"><span class="linenos">1567</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1568"><a href="#ImportMassSpectraThermoMSFileReader-1568"><span class="linenos">1568</span></a>        <span class="k">return</span> <span class="n">mass_spectrum_obj</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1569"><a href="#ImportMassSpectraThermoMSFileReader-1569"><span class="linenos">1569</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1570"><a href="#ImportMassSpectraThermoMSFileReader-1570"><span class="linenos">1570</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1571"><a href="#ImportMassSpectraThermoMSFileReader-1571"><span class="linenos">1571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpectraBase object from the binary data file file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1572"><a href="#ImportMassSpectraThermoMSFileReader-1572"><span class="linenos">1572</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1573"><a href="#ImportMassSpectraThermoMSFileReader-1573"><span class="linenos">1573</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1574"><a href="#ImportMassSpectraThermoMSFileReader-1574"><span class="linenos">1574</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1575"><a href="#ImportMassSpectraThermoMSFileReader-1575"><span class="linenos">1575</span></a><span class="sd">        MassSpectraBase</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1576"><a href="#ImportMassSpectraThermoMSFileReader-1576"><span class="linenos">1576</span></a><span class="sd">            The MassSpectra object containing the parsed mass spectra.  The object is instatiated with the mzML file, analyzer, instrument, sample name, and scan dataframe.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1577"><a href="#ImportMassSpectraThermoMSFileReader-1577"><span class="linenos">1577</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1578"><a href="#ImportMassSpectraThermoMSFileReader-1578"><span class="linenos">1578</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1579"><a href="#ImportMassSpectraThermoMSFileReader-1579"><span class="linenos">1579</span></a>        <span class="n">mass_spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1580"><a href="#ImportMassSpectraThermoMSFileReader-1580"><span class="linenos">1580</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1581"><a href="#ImportMassSpectraThermoMSFileReader-1581"><span class="linenos">1581</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1582"><a href="#ImportMassSpectraThermoMSFileReader-1582"><span class="linenos">1582</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1583"><a href="#ImportMassSpectraThermoMSFileReader-1583"><span class="linenos">1583</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1584"><a href="#ImportMassSpectraThermoMSFileReader-1584"><span class="linenos">1584</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1585"><a href="#ImportMassSpectraThermoMSFileReader-1585"><span class="linenos">1585</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1586"><a href="#ImportMassSpectraThermoMSFileReader-1586"><span class="linenos">1586</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1587"><a href="#ImportMassSpectraThermoMSFileReader-1587"><span class="linenos">1587</span></a>        <span class="n">mass_spectra_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1588"><a href="#ImportMassSpectraThermoMSFileReader-1588"><span class="linenos">1588</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1589"><a href="#ImportMassSpectraThermoMSFileReader-1589"><span class="linenos">1589</span></a>        <span class="k">return</span> <span class="n">mass_spectra_obj</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1590"><a href="#ImportMassSpectraThermoMSFileReader-1590"><span class="linenos">1590</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1591"><a href="#ImportMassSpectraThermoMSFileReader-1591"><span class="linenos">1591</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1592"><a href="#ImportMassSpectraThermoMSFileReader-1592"><span class="linenos">1592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiates a LCMSBase object from the mzML file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1593"><a href="#ImportMassSpectraThermoMSFileReader-1593"><span class="linenos">1593</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1594"><a href="#ImportMassSpectraThermoMSFileReader-1594"><span class="linenos">1594</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1595"><a href="#ImportMassSpectraThermoMSFileReader-1595"><span class="linenos">1595</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1596"><a href="#ImportMassSpectraThermoMSFileReader-1596"><span class="linenos">1596</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1597"><a href="#ImportMassSpectraThermoMSFileReader-1597"><span class="linenos">1597</span></a><span class="sd">            Which mass spectra data to include in the output. Default is &quot;all&quot;.  Other options: &quot;none&quot;, &quot;ms1&quot;, &quot;ms2&quot;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1598"><a href="#ImportMassSpectraThermoMSFileReader-1598"><span class="linenos">1598</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1599"><a href="#ImportMassSpectraThermoMSFileReader-1599"><span class="linenos">1599</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1600"><a href="#ImportMassSpectraThermoMSFileReader-1600"><span class="linenos">1600</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1601"><a href="#ImportMassSpectraThermoMSFileReader-1601"><span class="linenos">1601</span></a><span class="sd">        LCMSBase</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1602"><a href="#ImportMassSpectraThermoMSFileReader-1602"><span class="linenos">1602</span></a><span class="sd">            LCMS object containing mass spectra data. The object is instatiated with the file location, analyzer, instrument, sample name, scan info, mz dataframe (as specifified), polarity, as well as the attributes holding the scans, retention times, and tics.</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1603"><a href="#ImportMassSpectraThermoMSFileReader-1603"><span class="linenos">1603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1604"><a href="#ImportMassSpectraThermoMSFileReader-1604"><span class="linenos">1604</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>  <span class="c1"># first run it to just get scan info</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1605"><a href="#ImportMassSpectraThermoMSFileReader-1605"><span class="linenos">1605</span></a>        <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1606"><a href="#ImportMassSpectraThermoMSFileReader-1606"><span class="linenos">1606</span></a>            <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1607"><a href="#ImportMassSpectraThermoMSFileReader-1607"><span class="linenos">1607</span></a>        <span class="p">)</span>  <span class="c1"># second run to parse data</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1608"><a href="#ImportMassSpectraThermoMSFileReader-1608"><span class="linenos">1608</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1609"><a href="#ImportMassSpectraThermoMSFileReader-1609"><span class="linenos">1609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1610"><a href="#ImportMassSpectraThermoMSFileReader-1610"><span class="linenos">1610</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1611"><a href="#ImportMassSpectraThermoMSFileReader-1611"><span class="linenos">1611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1612"><a href="#ImportMassSpectraThermoMSFileReader-1612"><span class="linenos">1612</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1613"><a href="#ImportMassSpectraThermoMSFileReader-1613"><span class="linenos">1613</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1614"><a href="#ImportMassSpectraThermoMSFileReader-1614"><span class="linenos">1614</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1615"><a href="#ImportMassSpectraThermoMSFileReader-1615"><span class="linenos">1615</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1616"><a href="#ImportMassSpectraThermoMSFileReader-1616"><span class="linenos">1616</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1617"><a href="#ImportMassSpectraThermoMSFileReader-1617"><span class="linenos">1617</span></a>                <span class="n">key_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1618"><a href="#ImportMassSpectraThermoMSFileReader-1618"><span class="linenos">1618</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">intensity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1619"><a href="#ImportMassSpectraThermoMSFileReader-1619"><span class="linenos">1619</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1620"><a href="#ImportMassSpectraThermoMSFileReader-1620"><span class="linenos">1620</span></a>                    <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1621"><a href="#ImportMassSpectraThermoMSFileReader-1621"><span class="linenos">1621</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1622"><a href="#ImportMassSpectraThermoMSFileReader-1622"><span class="linenos">1622</span></a>                <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_ms_unprocessed</span><span class="p">[</span><span class="n">key_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1623"><a href="#ImportMassSpectraThermoMSFileReader-1623"><span class="linenos">1623</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1624"><a href="#ImportMassSpectraThermoMSFileReader-1624"><span class="linenos">1624</span></a>        <span class="c1"># Check if polarity is mixed</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1625"><a href="#ImportMassSpectraThermoMSFileReader-1625"><span class="linenos">1625</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1626"><a href="#ImportMassSpectraThermoMSFileReader-1626"><span class="linenos">1626</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mixed polarities detected in scan data&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1627"><a href="#ImportMassSpectraThermoMSFileReader-1627"><span class="linenos">1627</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1628"><a href="#ImportMassSpectraThermoMSFileReader-1628"><span class="linenos">1628</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1629"><a href="#ImportMassSpectraThermoMSFileReader-1629"><span class="linenos">1629</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1630"><a href="#ImportMassSpectraThermoMSFileReader-1630"><span class="linenos">1630</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1631"><a href="#ImportMassSpectraThermoMSFileReader-1631"><span class="linenos">1631</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1632"><a href="#ImportMassSpectraThermoMSFileReader-1632"><span class="linenos">1632</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1633"><a href="#ImportMassSpectraThermoMSFileReader-1633"><span class="linenos">1633</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1634"><a href="#ImportMassSpectraThermoMSFileReader-1634"><span class="linenos">1634</span></a>    <span class="k">def</span> <span class="nf">get_icr_transient_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1635"><a href="#ImportMassSpectraThermoMSFileReader-1635"><span class="linenos">1635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list for transient time targets for all scans, or selected scans range</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1636"><a href="#ImportMassSpectraThermoMSFileReader-1636"><span class="linenos">1636</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1637"><a href="#ImportMassSpectraThermoMSFileReader-1637"><span class="linenos">1637</span></a><span class="sd">        Notes</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1638"><a href="#ImportMassSpectraThermoMSFileReader-1638"><span class="linenos">1638</span></a><span class="sd">        --------</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1639"><a href="#ImportMassSpectraThermoMSFileReader-1639"><span class="linenos">1639</span></a><span class="sd">        Resolving Power and Transient time targets based on 7T FT-ICR MS system</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1640"><a href="#ImportMassSpectraThermoMSFileReader-1640"><span class="linenos">1640</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1641"><a href="#ImportMassSpectraThermoMSFileReader-1641"><span class="linenos">1641</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1642"><a href="#ImportMassSpectraThermoMSFileReader-1642"><span class="linenos">1642</span></a>        <span class="n">res_trans_time</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1643"><a href="#ImportMassSpectraThermoMSFileReader-1643"><span class="linenos">1643</span></a>            <span class="s2">&quot;50&quot;</span><span class="p">:</span> <span class="mf">0.384</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1644"><a href="#ImportMassSpectraThermoMSFileReader-1644"><span class="linenos">1644</span></a>            <span class="s2">&quot;100000&quot;</span><span class="p">:</span> <span class="mf">0.768</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1645"><a href="#ImportMassSpectraThermoMSFileReader-1645"><span class="linenos">1645</span></a>            <span class="s2">&quot;200000&quot;</span><span class="p">:</span> <span class="mf">1.536</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1646"><a href="#ImportMassSpectraThermoMSFileReader-1646"><span class="linenos">1646</span></a>            <span class="s2">&quot;400000&quot;</span><span class="p">:</span> <span class="mf">3.072</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1647"><a href="#ImportMassSpectraThermoMSFileReader-1647"><span class="linenos">1647</span></a>            <span class="s2">&quot;750000&quot;</span><span class="p">:</span> <span class="mf">6.144</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1648"><a href="#ImportMassSpectraThermoMSFileReader-1648"><span class="linenos">1648</span></a>            <span class="s2">&quot;1000000&quot;</span><span class="p">:</span> <span class="mf">12.288</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1649"><a href="#ImportMassSpectraThermoMSFileReader-1649"><span class="linenos">1649</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1650"><a href="#ImportMassSpectraThermoMSFileReader-1650"><span class="linenos">1650</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1651"><a href="#ImportMassSpectraThermoMSFileReader-1651"><span class="linenos">1651</span></a>        <span class="n">firstScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1652"><a href="#ImportMassSpectraThermoMSFileReader-1652"><span class="linenos">1652</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1653"><a href="#ImportMassSpectraThermoMSFileReader-1653"><span class="linenos">1653</span></a>        <span class="n">lastScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1654"><a href="#ImportMassSpectraThermoMSFileReader-1654"><span class="linenos">1654</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1655"><a href="#ImportMassSpectraThermoMSFileReader-1655"><span class="linenos">1655</span></a>        <span class="n">transient_time_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1656"><a href="#ImportMassSpectraThermoMSFileReader-1656"><span class="linenos">1656</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1657"><a href="#ImportMassSpectraThermoMSFileReader-1657"><span class="linenos">1657</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1658"><a href="#ImportMassSpectraThermoMSFileReader-1658"><span class="linenos">1658</span></a>            <span class="n">scan_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_header</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1659"><a href="#ImportMassSpectraThermoMSFileReader-1659"><span class="linenos">1659</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1660"><a href="#ImportMassSpectraThermoMSFileReader-1660"><span class="linenos">1660</span></a>            <span class="n">rp_target</span> <span class="o">=</span> <span class="n">scan_header</span><span class="p">[</span><span class="s2">&quot;FT Resolution:&quot;</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1661"><a href="#ImportMassSpectraThermoMSFileReader-1661"><span class="linenos">1661</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1662"><a href="#ImportMassSpectraThermoMSFileReader-1662"><span class="linenos">1662</span></a>            <span class="n">transient_time</span> <span class="o">=</span> <span class="n">res_trans_time</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rp_target</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1663"><a href="#ImportMassSpectraThermoMSFileReader-1663"><span class="linenos">1663</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1664"><a href="#ImportMassSpectraThermoMSFileReader-1664"><span class="linenos">1664</span></a>            <span class="n">transient_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transient_time</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1665"><a href="#ImportMassSpectraThermoMSFileReader-1665"><span class="linenos">1665</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1666"><a href="#ImportMassSpectraThermoMSFileReader-1666"><span class="linenos">1666</span></a>            <span class="c1"># print(transient_time, rp_target)</span>
</span><span id="ImportMassSpectraThermoMSFileReader-1667"><a href="#ImportMassSpectraThermoMSFileReader-1667"><span class="linenos">1667</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader-1668"><a href="#ImportMassSpectraThermoMSFileReader-1668"><span class="linenos">1668</span></a>        <span class="k">return</span> <span class="n">transient_time_list</span>
</span></pre></div>


            <div class="docstring"><p>A class for parsing Thermo RAW mass spectrometry data files and instatiating MassSpectraBase or LCMSBase objects</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>file_location</strong> (str or Path):
The path to the RAW file to be parsed.</li>
<li><strong>analyzer</strong> (str, optional):
The type of mass analyzer used in the instrument. Default is "Unknown".</li>
<li><strong>instrument_label</strong> (str, optional):
The name of the instrument used to acquire the data. Default is "Unknown".</li>
<li><strong>sample_name</strong> (str, optional):
The name of the sample being analyzed. If not provided, the stem of the file_location path will be used.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>file_location</strong> (Path):
The path to the RAW file being parsed.</li>
<li><strong>analyzer</strong> (str):
The type of mass analyzer used in the instrument.</li>
<li><strong>instrument_label</strong> (str):
The name of the instrument used to acquire the data.</li>
<li><strong>sample_name</strong> (str):
The name of the sample being analyzed.</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>run(spectra=True).
Parses the RAW file and returns a dictionary of mass spectra dataframes and a scan metadata dataframe.</li>
<li>get_mass_spectrum_from_scan(scan_number, polarity, auto_process=True)
Parses the RAW file and returns a MassSpecBase object from a single scan.</li>
<li>get_mass_spectra_obj().
Parses the RAW file and instantiates a MassSpectraBase object.</li>
<li>get_lcms_obj().
Parses the RAW file and instantiates an LCMSBase object.</li>
<li>get_icr_transient_times().
Return a list for transient time targets for all scans, or selected scans range</li>
</ul>

<p>Inherits from ThermoBaseClass and SpectraParserInterface</p>
</div>


                            <div id="ImportMassSpectraThermoMSFileReader.__init__" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ImportMassSpectraThermoMSFileReader</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">file_location</span>,</span><span class="param">	<span class="n">analyzer</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span>,</span><span class="param">	<span class="n">instrument_label</span><span class="o">=</span><span class="s1">&#39;Unknown&#39;</span>,</span><span class="param">	<span class="n">sample_name</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.__init__-1260"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1261"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1261"><span class="linenos">1261</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1262"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1262"><span class="linenos">1262</span></a>        <span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1263"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1263"><span class="linenos">1263</span></a>        <span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1264"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1264"><span class="linenos">1264</span></a>        <span class="n">instrument_label</span><span class="o">=</span><span class="s2">&quot;Unknown&quot;</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1265"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1265"><span class="linenos">1265</span></a>        <span class="n">sample_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1266"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1266"><span class="linenos">1266</span></a>    <span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1267"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1267"><span class="linenos">1267</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1268"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1268"><span class="linenos">1268</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_location</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1269"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1269"><span class="linenos">1269</span></a>            <span class="c1"># if obj is a string it defaults to create a Path obj, pass the S3Path if needed</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1270"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1270"><span class="linenos">1270</span></a>            <span class="n">file_location</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_location</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1271"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1271"><span class="linenos">1271</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">file_location</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1272"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1272"><span class="linenos">1272</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span><span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">file_location</span><span class="p">))</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1273"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1273"><span class="linenos">1273</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1274"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1274"><span class="linenos">1274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span> <span class="o">=</span> <span class="n">file_location</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1275"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1275"><span class="linenos">1275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">analyzer</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1276"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1276"><span class="linenos">1276</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span> <span class="o">=</span> <span class="n">instrument_label</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1277"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1277"><span class="linenos">1277</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1278"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1278"><span class="linenos">1278</span></a>        <span class="k">if</span> <span class="n">sample_name</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1279"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1279"><span class="linenos">1279</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">sample_name</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1280"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1280"><span class="linenos">1280</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.__init__-1281"><a href="#ImportMassSpectraThermoMSFileReader.__init__-1281"><span class="linenos">1281</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span> <span class="o">=</span> <span class="n">file_location</span><span class="o">.</span><span class="n">stem</span>
</span></pre></div>


            <div class="docstring"><p>file_location: srt pathlib.Path or s3path.S3Path
Thermo Raw file path</p>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.file_location" class="classattr">
                                <div class="attr variable">
            <span class="name">file_location</span>

        
    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.file_location"></a>
    
    

                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.analyzer" class="classattr">
                                <div class="attr variable">
            <span class="name">analyzer</span>

        
    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.analyzer"></a>
    
    

                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.instrument_label" class="classattr">
                                <div class="attr variable">
            <span class="name">instrument_label</span>

        
    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.instrument_label"></a>
    
    

                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.load" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.load-1283"><a href="#ImportMassSpectraThermoMSFileReader.load-1283"><span class="linenos">1283</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.load-1284"><a href="#ImportMassSpectraThermoMSFileReader.load-1284"><span class="linenos">1284</span></a>        <span class="k">pass</span>
</span></pre></div>


            <div class="docstring"><p>Load mass spectra data.</p>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_scan_df" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_scan_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_scan_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_scan_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_scan_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1286"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1287"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1287"><span class="linenos">1287</span></a>        <span class="c1"># This automatically brings in all the data</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1288"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1288"><span class="linenos">1288</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chromatogram_settings</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1289"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1289"><span class="linenos">1289</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1290"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1290"><span class="linenos">1290</span></a>        <span class="c1"># Get scan df info; starting with bulk ms1 and ms2 scans</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1291"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1291"><span class="linenos">1291</span></a>        <span class="n">ms1_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span><span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1292"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1292"><span class="linenos">1292</span></a>        <span class="n">ms1_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1293"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1293"><span class="linenos">1293</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1294"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1294"><span class="linenos">1294</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1295"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1295"><span class="linenos">1295</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms1_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1296"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1296"><span class="linenos">1296</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1297"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1297"><span class="linenos">1297</span></a>        <span class="n">ms1_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms1_scan_dict</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1298"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1298"><span class="linenos">1298</span></a>        <span class="n">ms1_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms1&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1299"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1299"><span class="linenos">1299</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1300"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1300"><span class="linenos">1300</span></a>        <span class="n">ms2_tic_data</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tic</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1301"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1301"><span class="linenos">1301</span></a>            <span class="n">ms_type</span><span class="o">=</span><span class="s2">&quot;MS2&quot;</span><span class="p">,</span> <span class="n">peak_detection</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="kc">False</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1302"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1302"><span class="linenos">1302</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1303"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1303"><span class="linenos">1303</span></a>        <span class="n">ms2_scan_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1304"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1304"><span class="linenos">1304</span></a>            <span class="s2">&quot;scan&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">scans</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1305"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1305"><span class="linenos">1305</span></a>            <span class="s2">&quot;scan_time&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1306"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1306"><span class="linenos">1306</span></a>            <span class="s2">&quot;tic&quot;</span><span class="p">:</span> <span class="n">ms2_tic_data</span><span class="o">.</span><span class="n">tic</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1307"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1307"><span class="linenos">1307</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1308"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1308"><span class="linenos">1308</span></a>        <span class="n">ms2_tic_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">ms2_scan_dict</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1309"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1309"><span class="linenos">1309</span></a>        <span class="n">ms2_tic_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ms2&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1310"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1310"><span class="linenos">1310</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1311"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1311"><span class="linenos">1311</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1312"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1312"><span class="linenos">1312</span></a>            <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ms1_tic_df</span><span class="p">,</span> <span class="n">ms2_tic_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1313"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1313"><span class="linenos">1313</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1314"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1314"><span class="linenos">1314</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1315"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1315"><span class="linenos">1315</span></a>        <span class="c1"># get scan text</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1316"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1316"><span class="linenos">1316</span></a>        <span class="n">scan_filter_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1317"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1317"><span class="linenos">1317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">get_all_filters</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;index&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1318"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1318"><span class="linenos">1318</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1319"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1319"><span class="linenos">1319</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1320"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1320"><span class="linenos">1320</span></a>        <span class="n">scan_filter_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;scan_text&quot;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1321"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1321"><span class="linenos">1321</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1322"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1322"><span class="linenos">1322</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">scan_filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1323"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1323"><span class="linenos">1323</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_lower&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1324"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1324"><span class="linenos">1324</span></a>            <span class="sa">r</span><span class="s2">&quot;\[(\d+\.\d+)-\d+\.\d+\]&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1325"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1325"><span class="linenos">1325</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1326"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1326"><span class="linenos">1326</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;scan_window_upper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1327"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1327"><span class="linenos">1327</span></a>            <span class="sa">r</span><span class="s2">&quot;\[\d+\.\d+-(\d+\.\d+)\]&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1328"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1328"><span class="linenos">1328</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1329"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1329"><span class="linenos">1329</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1330"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1330"><span class="linenos">1330</span></a>            <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot; - &quot;</span><span class="p">),</span> <span class="s2">&quot;negative&quot;</span><span class="p">,</span> <span class="s2">&quot;positive&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1331"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1331"><span class="linenos">1331</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1332"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1332"><span class="linenos">1332</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan_text</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\d+\.\d+)@&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1333"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1333"><span class="linenos">1333</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1334"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1334"><span class="linenos">1334</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1335"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1335"><span class="linenos">1335</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1336"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1336"><span class="linenos">1336</span></a>        <span class="c1"># Assign each scan as centroid or profile</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1337"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1337"><span class="linenos">1337</span></a>        <span class="n">scan_df</span><span class="p">[</span><span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1338"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1338"><span class="linenos">1338</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1339"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1339"><span class="linenos">1339</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">IsCentroidScanFromScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1340"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1340"><span class="linenos">1340</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;centroid&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1341"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1341"><span class="linenos">1341</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1342"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1342"><span class="linenos">1342</span></a>                <span class="n">scan_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;profile&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1343"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1343"><span class="linenos">1343</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_scan_df-1344"><a href="#ImportMassSpectraThermoMSFileReader.get_scan_df-1344"><span class="linenos">1344</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span></pre></div>


            <div class="docstring"><p>Return scan data as a pandas DataFrame.</p>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_ms_raw" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_ms_raw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_ms_raw</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">spectra</span>, </span><span class="param"><span class="n">scan_df</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_ms_raw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_ms_raw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1346"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1346"><span class="linenos">1346</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1347"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1347"><span class="linenos">1347</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1348"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1348"><span class="linenos">1348</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1349"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1349"><span class="linenos">1349</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms1&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1350"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1350"><span class="linenos">1350</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1351"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1351"><span class="linenos">1351</span></a>        <span class="k">elif</span> <span class="n">spectra</span> <span class="o">==</span> <span class="s2">&quot;ms2&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1352"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1352"><span class="linenos">1352</span></a>            <span class="n">scan_df_forspec</span> <span class="o">=</span> <span class="n">scan_df</span><span class="p">[</span><span class="n">scan_df</span><span class="o">.</span><span class="n">ms_level</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1353"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1353"><span class="linenos">1353</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1354"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1354"><span class="linenos">1354</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;spectra must be &#39;none&#39;, &#39;all&#39;, &#39;ms1&#39;, or &#39;ms2&#39;&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1355"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1355"><span class="linenos">1355</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1356"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1356"><span class="linenos">1356</span></a>        <span class="c1"># Result container</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1357"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1357"><span class="linenos">1357</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1358"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1358"><span class="linenos">1358</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1359"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1359"><span class="linenos">1359</span></a>        <span class="c1"># Row count container</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1360"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1360"><span class="linenos">1360</span></a>        <span class="n">counter</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1361"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1361"><span class="linenos">1361</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1362"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1362"><span class="linenos">1362</span></a>        <span class="c1"># Column name container</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1363"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1363"><span class="linenos">1363</span></a>        <span class="n">cols</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1364"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1364"><span class="linenos">1364</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1365"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1365"><span class="linenos">1365</span></a>        <span class="c1"># set at float32</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1366"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1366"><span class="linenos">1366</span></a>        <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1367"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1367"><span class="linenos">1367</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1368"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1368"><span class="linenos">1368</span></a>        <span class="c1"># First pass: get nrows</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1369"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1369"><span class="linenos">1369</span></a>        <span class="n">N</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1370"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1370"><span class="linenos">1370</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1371"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1371"><span class="linenos">1371</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1372"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1372"><span class="linenos">1372</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1373"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1373"><span class="linenos">1373</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1374"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1374"><span class="linenos">1374</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1375"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1375"><span class="linenos">1375</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1376"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1376"><span class="linenos">1376</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1377"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1377"><span class="linenos">1377</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1378"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1378"><span class="linenos">1378</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1379"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1379"><span class="linenos">1379</span></a>            <span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1380"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1380"><span class="linenos">1380</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1381"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1381"><span class="linenos">1381</span></a>        <span class="c1"># Second pass: parse</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1382"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1382"><span class="linenos">1382</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1383"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1383"><span class="linenos">1383</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1384"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1384"><span class="linenos">1384</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1385"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1385"><span class="linenos">1385</span></a>                <span class="n">i</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1386"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1386"><span class="linenos">1386</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1387"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1387"><span class="linenos">1387</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1388"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1388"><span class="linenos">1388</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1389"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1389"><span class="linenos">1389</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1390"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1390"><span class="linenos">1390</span></a>            <span class="c1"># Get index of abun that are &gt; 0</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1391"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1391"><span class="linenos">1391</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1392"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1392"><span class="linenos">1392</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mz</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1393"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1393"><span class="linenos">1393</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1394"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1394"><span class="linenos">1394</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">abun</span><span class="p">)[</span><span class="n">inx</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1395"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1395"><span class="linenos">1395</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="n">abun</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1396"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1396"><span class="linenos">1396</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1397"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1397"><span class="linenos">1397</span></a>            <span class="n">level</span> <span class="o">=</span> <span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">scan_df_forspec</span><span class="o">.</span><span class="n">scan</span> <span class="o">==</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;ms_level&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1398"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1398"><span class="linenos">1398</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1399"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1399"><span class="linenos">1399</span></a>            <span class="c1"># Number of rows</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1400"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1400"><span class="linenos">1400</span></a>            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1401"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1401"><span class="linenos">1401</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1402"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1402"><span class="linenos">1402</span></a>            <span class="c1"># No measurements</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1403"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1403"><span class="linenos">1403</span></a>            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1404"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1404"><span class="linenos">1404</span></a>                <span class="k">continue</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1405"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1405"><span class="linenos">1405</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1406"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1406"><span class="linenos">1406</span></a>            <span class="c1"># Dimension check</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1407"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1407"><span class="linenos">1407</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abun</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1408"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1408"><span class="linenos">1408</span></a>                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;m/z and intensity array dimension mismatch&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1409"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1409"><span class="linenos">1409</span></a>                <span class="k">continue</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1410"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1410"><span class="linenos">1410</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1411"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1411"><span class="linenos">1411</span></a>            <span class="c1"># Scan/frame info</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1412"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1412"><span class="linenos">1412</span></a>            <span class="n">id_dict</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1413"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1413"><span class="linenos">1413</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1414"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1414"><span class="linenos">1414</span></a>            <span class="c1"># Columns</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1415"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1415"><span class="linenos">1415</span></a>            <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1416"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1416"><span class="linenos">1416</span></a>            <span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1417"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1417"><span class="linenos">1417</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1418"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1418"><span class="linenos">1418</span></a>            <span class="c1"># Subarray init</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1419"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1419"><span class="linenos">1419</span></a>            <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1420"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1420"><span class="linenos">1420</span></a>            <span class="n">inx</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1421"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1421"><span class="linenos">1421</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1422"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1422"><span class="linenos">1422</span></a>            <span class="c1"># Populate scan/frame info</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1423"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1423"><span class="linenos">1423</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1424"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1424"><span class="linenos">1424</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1425"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1425"><span class="linenos">1425</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1426"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1426"><span class="linenos">1426</span></a>            <span class="c1"># Populate m/z</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1427"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1427"><span class="linenos">1427</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">mz</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1428"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1428"><span class="linenos">1428</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1429"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1429"><span class="linenos">1429</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1430"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1430"><span class="linenos">1430</span></a>            <span class="c1"># Populate intensity</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1431"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1431"><span class="linenos">1431</span></a>            <span class="n">arr</span><span class="p">[:,</span> <span class="n">inx</span><span class="p">]</span> <span class="o">=</span> <span class="n">abun</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1432"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1432"><span class="linenos">1432</span></a>            <span class="n">inx</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1433"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1433"><span class="linenos">1433</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1434"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1434"><span class="linenos">1434</span></a>            <span class="c1"># Initialize output container</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1435"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1435"><span class="linenos">1435</span></a>            <span class="k">if</span> <span class="n">level</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1436"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1436"><span class="linenos">1436</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">[</span><span class="n">level</span><span class="p">],</span> <span class="n">m</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1437"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1437"><span class="linenos">1437</span></a>                <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1438"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1438"><span class="linenos">1438</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1439"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1439"><span class="linenos">1439</span></a>            <span class="c1"># Insert subarray</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1440"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1440"><span class="linenos">1440</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">][</span><span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="p">:</span> <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+</span> <span class="n">n</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">arr</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1441"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1441"><span class="linenos">1441</span></a>            <span class="n">counter</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">+=</span> <span class="n">n</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1442"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1442"><span class="linenos">1442</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1443"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1443"><span class="linenos">1443</span></a>        <span class="c1"># Construct ms1 and ms2 mz dataframes</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1444"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1444"><span class="linenos">1444</span></a>        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1445"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1445"><span class="linenos">1445</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">])</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1446"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1446"><span class="linenos">1446</span></a>            <span class="n">res</span><span class="p">[</span><span class="n">level</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">level</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1447"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1447"><span class="linenos">1447</span></a>        <span class="c1"># rename keys in res to add &#39;ms&#39; prefix</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1448"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1448"><span class="linenos">1448</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;ms</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1449"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1449"><span class="linenos">1449</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_ms_raw-1450"><a href="#ImportMassSpectraThermoMSFileReader.get_ms_raw-1450"><span class="linenos">1450</span></a>        <span class="k">return</span> <span class="n">res</span>
</span></pre></div>


            <div class="docstring"><p>Return a dictionary of mass spectra data as a pandas DataFrame.</p>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.run" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>, </span><span class="param"><span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.run-1452"><a href="#ImportMassSpectraThermoMSFileReader.run-1452"><span class="linenos">1452</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1453"><a href="#ImportMassSpectraThermoMSFileReader.run-1453"><span class="linenos">1453</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1454"><a href="#ImportMassSpectraThermoMSFileReader.run-1454"><span class="linenos">1454</span></a><span class="sd">        Extracts mass spectra data from a raw file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1455"><a href="#ImportMassSpectraThermoMSFileReader.run-1455"><span class="linenos">1455</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1456"><a href="#ImportMassSpectraThermoMSFileReader.run-1456"><span class="linenos">1456</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1457"><a href="#ImportMassSpectraThermoMSFileReader.run-1457"><span class="linenos">1457</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1458"><a href="#ImportMassSpectraThermoMSFileReader.run-1458"><span class="linenos">1458</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1459"><a href="#ImportMassSpectraThermoMSFileReader.run-1459"><span class="linenos">1459</span></a><span class="sd">            Which mass spectra data to include in the output. Default is all.  Other options: none, ms1, ms2.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1460"><a href="#ImportMassSpectraThermoMSFileReader.run-1460"><span class="linenos">1460</span></a><span class="sd">        scan_df : pandas.DataFrame, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1461"><a href="#ImportMassSpectraThermoMSFileReader.run-1461"><span class="linenos">1461</span></a><span class="sd">            Scan dataframe.  If not provided, the scan dataframe is created from the mzML file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1462"><a href="#ImportMassSpectraThermoMSFileReader.run-1462"><span class="linenos">1462</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1463"><a href="#ImportMassSpectraThermoMSFileReader.run-1463"><span class="linenos">1463</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1464"><a href="#ImportMassSpectraThermoMSFileReader.run-1464"><span class="linenos">1464</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1465"><a href="#ImportMassSpectraThermoMSFileReader.run-1465"><span class="linenos">1465</span></a><span class="sd">        tuple</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1466"><a href="#ImportMassSpectraThermoMSFileReader.run-1466"><span class="linenos">1466</span></a><span class="sd">            A tuple containing two elements:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1467"><a href="#ImportMassSpectraThermoMSFileReader.run-1467"><span class="linenos">1467</span></a><span class="sd">            - A dictionary containing mass spectra data, separated by MS level.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1468"><a href="#ImportMassSpectraThermoMSFileReader.run-1468"><span class="linenos">1468</span></a><span class="sd">            - A pandas DataFrame containing scan information, including scan number, scan time, TIC, MS level,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1469"><a href="#ImportMassSpectraThermoMSFileReader.run-1469"><span class="linenos">1469</span></a><span class="sd">                scan text, scan window lower and upper bounds, polarity, and precursor m/z (if applicable).</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1470"><a href="#ImportMassSpectraThermoMSFileReader.run-1470"><span class="linenos">1470</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1471"><a href="#ImportMassSpectraThermoMSFileReader.run-1471"><span class="linenos">1471</span></a>        <span class="c1"># Prepare scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1472"><a href="#ImportMassSpectraThermoMSFileReader.run-1472"><span class="linenos">1472</span></a>        <span class="k">if</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1473"><a href="#ImportMassSpectraThermoMSFileReader.run-1473"><span class="linenos">1473</span></a>            <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1474"><a href="#ImportMassSpectraThermoMSFileReader.run-1474"><span class="linenos">1474</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1475"><a href="#ImportMassSpectraThermoMSFileReader.run-1475"><span class="linenos">1475</span></a>        <span class="c1"># Prepare mass spectra data</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1476"><a href="#ImportMassSpectraThermoMSFileReader.run-1476"><span class="linenos">1476</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1477"><a href="#ImportMassSpectraThermoMSFileReader.run-1477"><span class="linenos">1477</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1478"><a href="#ImportMassSpectraThermoMSFileReader.run-1478"><span class="linenos">1478</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1479"><a href="#ImportMassSpectraThermoMSFileReader.run-1479"><span class="linenos">1479</span></a>            <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1480"><a href="#ImportMassSpectraThermoMSFileReader.run-1480"><span class="linenos">1480</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.run-1481"><a href="#ImportMassSpectraThermoMSFileReader.run-1481"><span class="linenos">1481</span></a>        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span>
</span></pre></div>


            <div class="docstring"><p>Extracts mass spectra data from a raw file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>spectra</strong> (str, optional):
Which mass spectra data to include in the output. Default is all.  Other options: none, ms1, ms2.</li>
<li><strong>scan_df</strong> (pandas.DataFrame, optional):
Scan dataframe.  If not provided, the scan dataframe is created from the mzML file.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: A tuple containing two elements:
<ul>
<li>A dictionary containing mass spectra data, separated by MS level.</li>
<li>A pandas DataFrame containing scan information, including scan number, scan time, TIC, MS level,
scan text, scan window lower and upper bounds, polarity, and precursor m/z (if applicable).</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_mass_spectrum_from_scan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan_number</span>, </span><span class="param"><span class="n">spectrum_mode</span>, </span><span class="param"><span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1483"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1483"><span class="linenos">1483</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1484"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1484"><span class="linenos">1484</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">,</span> <span class="n">spectrum_mode</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="kc">True</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1485"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1485"><span class="linenos">1485</span></a>    <span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1486"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1486"><span class="linenos">1486</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpecBase object from a single scan number from the binary file, currently only supports profile mode.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1487"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1487"><span class="linenos">1487</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1488"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1488"><span class="linenos">1488</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1489"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1489"><span class="linenos">1489</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1490"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1490"><span class="linenos">1490</span></a><span class="sd">        scan_number : int</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1491"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1491"><span class="linenos">1491</span></a><span class="sd">            The scan number to extract the mass spectrum from.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1492"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1492"><span class="linenos">1492</span></a><span class="sd">        polarity : int</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1493"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1493"><span class="linenos">1493</span></a><span class="sd">            The polarity of the scan.  1 for positive mode, -1 for negative mode.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1494"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1494"><span class="linenos">1494</span></a><span class="sd">        spectrum_mode : str</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1495"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1495"><span class="linenos">1495</span></a><span class="sd">            The type of mass spectrum to extract.  Must be &#39;profile&#39; or &#39;centroid&#39;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1496"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1496"><span class="linenos">1496</span></a><span class="sd">        auto_process : bool, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1497"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1497"><span class="linenos">1497</span></a><span class="sd">            If True, perform peak picking and noise threshold calculation after creating the mass spectrum object. Default is True.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1498"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1498"><span class="linenos">1498</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1499"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1499"><span class="linenos">1499</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1500"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1500"><span class="linenos">1500</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1501"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1501"><span class="linenos">1501</span></a><span class="sd">        MassSpecProfile | MassSpecCentroid</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1502"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1502"><span class="linenos">1502</span></a><span class="sd">            The MassSpecProfile or MassSpecCentroid object containing the parsed mass spectrum.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1503"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1503"><span class="linenos">1503</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1504"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1504"><span class="linenos">1504</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1505"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1505"><span class="linenos">1505</span></a>        <span class="k">if</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;profile&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1506"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1506"><span class="linenos">1506</span></a>            <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1507"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1507"><span class="linenos">1507</span></a>            <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1508"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1508"><span class="linenos">1508</span></a>                <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1509"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1509"><span class="linenos">1509</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1510"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1510"><span class="linenos">1510</span></a>            <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1511"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1511"><span class="linenos">1511</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1512"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1512"><span class="linenos">1512</span></a>            <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1513"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1513"><span class="linenos">1513</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1514"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1514"><span class="linenos">1514</span></a>                <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1515"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1515"><span class="linenos">1515</span></a>            <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1516"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1516"><span class="linenos">1516</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1517"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1517"><span class="linenos">1517</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1518"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1518"><span class="linenos">1518</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1519"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1519"><span class="linenos">1519</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1520"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1520"><span class="linenos">1520</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_profile</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1521"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1521"><span class="linenos">1521</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1522"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1522"><span class="linenos">1522</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecProfile</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1523"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1523"><span class="linenos">1523</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1524"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1524"><span class="linenos">1524</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1525"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1525"><span class="linenos">1525</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1526"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1526"><span class="linenos">1526</span></a>        <span class="k">elif</span> <span class="n">spectrum_mode</span> <span class="o">==</span> <span class="s2">&quot;centroid&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1527"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1527"><span class="linenos">1527</span></a>            <span class="n">centroid_scan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetCentroidStream</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1528"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1528"><span class="linenos">1528</span></a>            <span class="k">if</span> <span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1529"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1529"><span class="linenos">1529</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Masses</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1530"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1530"><span class="linenos">1530</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1531"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1531"><span class="linenos">1531</span></a>                <span class="n">rp</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Resolutions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1532"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1532"><span class="linenos">1532</span></a>                <span class="n">magnitude</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1533"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1533"><span class="linenos">1533</span></a>                <span class="n">noise</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Noises</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1534"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1534"><span class="linenos">1534</span></a>                <span class="n">baselines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">centroid_scan</span><span class="o">.</span><span class="n">Baselines</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1535"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1535"><span class="linenos">1535</span></a>                <span class="n">array_noise_std</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">noise</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">baselines</span><span class="p">))</span> <span class="o">/</span> <span class="mi">3</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1536"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1536"><span class="linenos">1536</span></a>                <span class="n">l_signal_to_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">magnitude</span><span class="p">)</span> <span class="o">/</span> <span class="n">array_noise_std</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1537"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1537"><span class="linenos">1537</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1538"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1538"><span class="linenos">1538</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1539"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1539"><span class="linenos">1539</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1540"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1540"><span class="linenos">1540</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="n">rp</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1541"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1541"><span class="linenos">1541</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">l_signal_to_noise</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1542"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1542"><span class="linenos">1542</span></a>                <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1543"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1543"><span class="linenos">1543</span></a>            <span class="k">else</span><span class="p">:</span>  <span class="c1"># For CID MS2, the centroid data are stored in the profile data location, they do not have any associated rp or baseline data, but they should be treated as centroid data</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1544"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1544"><span class="linenos">1544</span></a>                <span class="n">scanStatistics</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetScanStatsForScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1545"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1545"><span class="linenos">1545</span></a>                    <span class="n">scan_number</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1546"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1546"><span class="linenos">1546</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1547"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1547"><span class="linenos">1547</span></a>                <span class="n">profileStream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">iRawDataPlus</span><span class="o">.</span><span class="n">GetSegmentedScanFromScanNumber</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1548"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1548"><span class="linenos">1548</span></a>                    <span class="n">scan_number</span><span class="p">,</span> <span class="n">scanStatistics</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1549"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1549"><span class="linenos">1549</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1550"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1550"><span class="linenos">1550</span></a>                <span class="n">abun</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Intensities</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1551"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1551"><span class="linenos">1551</span></a>                <span class="n">mz</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">profileStream</span><span class="o">.</span><span class="n">Positions</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1552"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1552"><span class="linenos">1552</span></a>                <span class="n">data_dict</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1553"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1553"><span class="linenos">1553</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">mz</span><span class="p">:</span> <span class="n">mz</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1554"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1554"><span class="linenos">1554</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">abundance</span><span class="p">:</span> <span class="n">abun</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1555"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1555"><span class="linenos">1555</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">rp</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1556"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1556"><span class="linenos">1556</span></a>                    <span class="n">Labels</span><span class="o">.</span><span class="n">s2n</span><span class="p">:</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">mz</span><span class="p">),</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1557"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1557"><span class="linenos">1557</span></a>                <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1558"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1558"><span class="linenos">1558</span></a>            <span class="n">d_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1559"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1559"><span class="linenos">1559</span></a>                <span class="n">firstScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1560"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1560"><span class="linenos">1560</span></a>                <span class="n">lastScanNumber</span><span class="o">=</span><span class="n">scan_number</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1561"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1561"><span class="linenos">1561</span></a>                <span class="n">scans_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1562"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1562"><span class="linenos">1562</span></a>                <span class="n">label</span><span class="o">=</span><span class="n">Labels</span><span class="o">.</span><span class="n">thermo_centroid</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1563"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1563"><span class="linenos">1563</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1564"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1564"><span class="linenos">1564</span></a>            <span class="n">mass_spectrum_obj</span> <span class="o">=</span> <span class="n">MassSpecCentroid</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1565"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1565"><span class="linenos">1565</span></a>                <span class="n">data_dict</span><span class="p">,</span> <span class="n">d_params</span><span class="p">,</span> <span class="n">auto_process</span><span class="o">=</span><span class="n">auto_process</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1566"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1566"><span class="linenos">1566</span></a>            <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1567"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1567"><span class="linenos">1567</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1568"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectrum_from_scan-1568"><span class="linenos">1568</span></a>        <span class="k">return</span> <span class="n">mass_spectrum_obj</span>
</span></pre></div>


            <div class="docstring"><p>Instatiate a MassSpecBase object from a single scan number from the binary file, currently only supports profile mode.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>scan_number</strong> (int):
The scan number to extract the mass spectrum from.</li>
<li><strong>polarity</strong> (int):
The polarity of the scan.  1 for positive mode, -1 for negative mode.</li>
<li><strong>spectrum_mode</strong> (str):
The type of mass spectrum to extract.  Must be 'profile' or 'centroid'.</li>
<li><strong>auto_process</strong> (bool, optional):
If True, perform peak picking and noise threshold calculation after creating the mass spectrum object. Default is True.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>MassSpecProfile | MassSpecCentroid</strong>: The MassSpecProfile or MassSpecCentroid object containing the parsed mass spectrum.</li>
</ul>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_mass_spectra_obj</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1570"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1570"><span class="linenos">1570</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1571"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1571"><span class="linenos">1571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiate a MassSpectraBase object from the binary data file file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1572"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1572"><span class="linenos">1572</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1573"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1573"><span class="linenos">1573</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1574"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1574"><span class="linenos">1574</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1575"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1575"><span class="linenos">1575</span></a><span class="sd">        MassSpectraBase</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1576"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1576"><span class="linenos">1576</span></a><span class="sd">            The MassSpectra object containing the parsed mass spectra.  The object is instatiated with the mzML file, analyzer, instrument, sample name, and scan dataframe.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1577"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1577"><span class="linenos">1577</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1578"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1578"><span class="linenos">1578</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1579"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1579"><span class="linenos">1579</span></a>        <span class="n">mass_spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1580"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1580"><span class="linenos">1580</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1581"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1581"><span class="linenos">1581</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1582"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1582"><span class="linenos">1582</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1583"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1583"><span class="linenos">1583</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1584"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1584"><span class="linenos">1584</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1585"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1585"><span class="linenos">1585</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1586"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1586"><span class="linenos">1586</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1587"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1587"><span class="linenos">1587</span></a>        <span class="n">mass_spectra_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1588"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1588"><span class="linenos">1588</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1589"><a href="#ImportMassSpectraThermoMSFileReader.get_mass_spectra_obj-1589"><span class="linenos">1589</span></a>        <span class="k">return</span> <span class="n">mass_spectra_obj</span>
</span></pre></div>


            <div class="docstring"><p>Instatiate a MassSpectraBase object from the binary data file file.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>MassSpectraBase</strong>: The MassSpectra object containing the parsed mass spectra.  The object is instatiated with the mzML file, analyzer, instrument, sample name, and scan dataframe.</li>
</ul>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_lcms_obj" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_lcms_obj</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">spectra</span><span class="o">=</span><span class="s1">&#39;all&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_lcms_obj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1591"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1591"><span class="linenos">1591</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1592"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1592"><span class="linenos">1592</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Instatiates a LCMSBase object from the mzML file.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1593"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1593"><span class="linenos">1593</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1594"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1594"><span class="linenos">1594</span></a><span class="sd">        Parameters</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1595"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1595"><span class="linenos">1595</span></a><span class="sd">        ----------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1596"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1596"><span class="linenos">1596</span></a><span class="sd">        spectra : str, optional</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1597"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1597"><span class="linenos">1597</span></a><span class="sd">            Which mass spectra data to include in the output. Default is &quot;all&quot;.  Other options: &quot;none&quot;, &quot;ms1&quot;, &quot;ms2&quot;.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1598"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1598"><span class="linenos">1598</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1599"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1599"><span class="linenos">1599</span></a><span class="sd">        Returns</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1600"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1600"><span class="linenos">1600</span></a><span class="sd">        -------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1601"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1601"><span class="linenos">1601</span></a><span class="sd">        LCMSBase</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1602"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1602"><span class="linenos">1602</span></a><span class="sd">            LCMS object containing mass spectra data. The object is instatiated with the file location, analyzer, instrument, sample name, scan info, mz dataframe (as specifified), polarity, as well as the attributes holding the scans, retention times, and tics.</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1603"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1603"><span class="linenos">1603</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1604"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1604"><span class="linenos">1604</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>  <span class="c1"># first run it to just get scan info</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1605"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1605"><span class="linenos">1605</span></a>        <span class="n">res</span><span class="p">,</span> <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1606"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1606"><span class="linenos">1606</span></a>            <span class="n">scan_df</span><span class="o">=</span><span class="n">scan_df</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="n">spectra</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1607"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1607"><span class="linenos">1607</span></a>        <span class="p">)</span>  <span class="c1"># second run to parse data</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1608"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1608"><span class="linenos">1608</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1609"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1609"><span class="linenos">1609</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1610"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1610"><span class="linenos">1610</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1611"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1611"><span class="linenos">1611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1612"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1612"><span class="linenos">1612</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1613"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1613"><span class="linenos">1613</span></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1614"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1614"><span class="linenos">1614</span></a>        <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1615"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1615"><span class="linenos">1615</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="o">!=</span> <span class="s2">&quot;none&quot;</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1616"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1616"><span class="linenos">1616</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1617"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1617"><span class="linenos">1617</span></a>                <span class="n">key_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;ms&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1618"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1618"><span class="linenos">1618</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">intensity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1619"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1619"><span class="linenos">1619</span></a>                <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1620"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1620"><span class="linenos">1620</span></a>                    <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1621"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1621"><span class="linenos">1621</span></a>                <span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1622"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1622"><span class="linenos">1622</span></a>                <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_ms_unprocessed</span><span class="p">[</span><span class="n">key_int</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1623"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1623"><span class="linenos">1623</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1624"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1624"><span class="linenos">1624</span></a>        <span class="c1"># Check if polarity is mixed</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1625"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1625"><span class="linenos">1625</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1626"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1626"><span class="linenos">1626</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mixed polarities detected in scan data&quot;</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1627"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1627"><span class="linenos">1627</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">polarity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1628"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1628"><span class="linenos">1628</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1629"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1629"><span class="linenos">1629</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1630"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1630"><span class="linenos">1630</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1631"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1631"><span class="linenos">1631</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_lcms_obj-1632"><a href="#ImportMassSpectraThermoMSFileReader.get_lcms_obj-1632"><span class="linenos">1632</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span></pre></div>


            <div class="docstring"><p>Instatiates a LCMSBase object from the mzML file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>spectra</strong> (str, optional):
Which mass spectra data to include in the output. Default is "all".  Other options: "none", "ms1", "ms2".</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>LCMSBase</strong>: LCMS object containing mass spectra data. The object is instatiated with the file location, analyzer, instrument, sample name, scan info, mz dataframe (as specifified), polarity, as well as the attributes holding the scans, retention times, and tics.</li>
</ul>
</div>


                            </div>
                            <div id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times" class="classattr">
                                        <input id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_icr_transient_times</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1634"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1634"><span class="linenos">1634</span></a>    <span class="k">def</span> <span class="nf">get_icr_transient_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1635"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1635"><span class="linenos">1635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list for transient time targets for all scans, or selected scans range</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1636"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1636"><span class="linenos">1636</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1637"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1637"><span class="linenos">1637</span></a><span class="sd">        Notes</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1638"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1638"><span class="linenos">1638</span></a><span class="sd">        --------</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1639"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1639"><span class="linenos">1639</span></a><span class="sd">        Resolving Power and Transient time targets based on 7T FT-ICR MS system</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1640"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1640"><span class="linenos">1640</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1641"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1641"><span class="linenos">1641</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1642"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1642"><span class="linenos">1642</span></a>        <span class="n">res_trans_time</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1643"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1643"><span class="linenos">1643</span></a>            <span class="s2">&quot;50&quot;</span><span class="p">:</span> <span class="mf">0.384</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1644"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1644"><span class="linenos">1644</span></a>            <span class="s2">&quot;100000&quot;</span><span class="p">:</span> <span class="mf">0.768</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1645"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1645"><span class="linenos">1645</span></a>            <span class="s2">&quot;200000&quot;</span><span class="p">:</span> <span class="mf">1.536</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1646"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1646"><span class="linenos">1646</span></a>            <span class="s2">&quot;400000&quot;</span><span class="p">:</span> <span class="mf">3.072</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1647"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1647"><span class="linenos">1647</span></a>            <span class="s2">&quot;750000&quot;</span><span class="p">:</span> <span class="mf">6.144</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1648"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1648"><span class="linenos">1648</span></a>            <span class="s2">&quot;1000000&quot;</span><span class="p">:</span> <span class="mf">12.288</span><span class="p">,</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1649"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1649"><span class="linenos">1649</span></a>        <span class="p">}</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1650"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1650"><span class="linenos">1650</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1651"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1651"><span class="linenos">1651</span></a>        <span class="n">firstScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_scan</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1652"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1652"><span class="linenos">1652</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1653"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1653"><span class="linenos">1653</span></a>        <span class="n">lastScanNumber</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_scan</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1654"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1654"><span class="linenos">1654</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1655"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1655"><span class="linenos">1655</span></a>        <span class="n">transient_time_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1656"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1656"><span class="linenos">1656</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1657"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1657"><span class="linenos">1657</span></a>        <span class="k">for</span> <span class="n">scan</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">firstScanNumber</span><span class="p">,</span> <span class="n">lastScanNumber</span><span class="p">):</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1658"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1658"><span class="linenos">1658</span></a>            <span class="n">scan_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_header</span><span class="p">(</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1659"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1659"><span class="linenos">1659</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1660"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1660"><span class="linenos">1660</span></a>            <span class="n">rp_target</span> <span class="o">=</span> <span class="n">scan_header</span><span class="p">[</span><span class="s2">&quot;FT Resolution:&quot;</span><span class="p">]</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1661"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1661"><span class="linenos">1661</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1662"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1662"><span class="linenos">1662</span></a>            <span class="n">transient_time</span> <span class="o">=</span> <span class="n">res_trans_time</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">rp_target</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1663"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1663"><span class="linenos">1663</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1664"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1664"><span class="linenos">1664</span></a>            <span class="n">transient_time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">transient_time</span><span class="p">)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1665"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1665"><span class="linenos">1665</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1666"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1666"><span class="linenos">1666</span></a>            <span class="c1"># print(transient_time, rp_target)</span>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1667"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1667"><span class="linenos">1667</span></a>
</span><span id="ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1668"><a href="#ImportMassSpectraThermoMSFileReader.get_icr_transient_times-1668"><span class="linenos">1668</span></a>        <span class="k">return</span> <span class="n">transient_time_list</span>
</span></pre></div>


            <div class="docstring"><p>Return a list for transient time targets for all scans, or selected scans range</p>

<h6 id="notes">Notes</h6>

<p>Resolving Power and Transient time targets based on 7T FT-ICR MS system</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ThermoBaseClass">ThermoBaseClass</a></dt>
                                <dd id="ImportMassSpectraThermoMSFileReader.iRawDataPlus" class="variable"><a href="#ThermoBaseClass.iRawDataPlus">iRawDataPlus</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.res" class="variable"><a href="#ThermoBaseClass.res">res</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.file_path" class="variable"><a href="#ThermoBaseClass.file_path">file_path</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.iFileHeader" class="variable"><a href="#ThermoBaseClass.iFileHeader">iFileHeader</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.parameters" class="variable"><a href="#ThermoBaseClass.parameters">parameters</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.chromatogram_settings" class="variable"><a href="#ThermoBaseClass.chromatogram_settings">chromatogram_settings</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.scans" class="variable"><a href="#ThermoBaseClass.scans">scans</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.start_scan" class="variable"><a href="#ThermoBaseClass.start_scan">start_scan</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.end_scan" class="variable"><a href="#ThermoBaseClass.end_scan">end_scan</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.set_msordertype" class="function"><a href="#ThermoBaseClass.set_msordertype">set_msordertype</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_creation_time" class="function"><a href="#ThermoBaseClass.get_creation_time">get_creation_time</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.remove_temp_file" class="function"><a href="#ThermoBaseClass.remove_temp_file">remove_temp_file</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.close_file" class="function"><a href="#ThermoBaseClass.close_file">close_file</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_polarity_mode" class="function"><a href="#ThermoBaseClass.get_polarity_mode">get_polarity_mode</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_filter_for_scan_num" class="function"><a href="#ThermoBaseClass.get_filter_for_scan_num">get_filter_for_scan_num</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.check_full_scan" class="function"><a href="#ThermoBaseClass.check_full_scan">check_full_scan</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_all_filters" class="function"><a href="#ThermoBaseClass.get_all_filters">get_all_filters</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_scan_header" class="function"><a href="#ThermoBaseClass.get_scan_header">get_scan_header</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_rt_time_from_trace" class="function"><a href="#ThermoBaseClass.get_rt_time_from_trace">get_rt_time_from_trace</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_eics" class="function"><a href="#ThermoBaseClass.get_eics">get_eics</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_tic" class="function"><a href="#ThermoBaseClass.get_tic">get_tic</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_average_mass_spectrum" class="function"><a href="#ThermoBaseClass.get_average_mass_spectrum">get_average_mass_spectrum</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.set_metadata" class="function"><a href="#ThermoBaseClass.set_metadata">set_metadata</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_instrument_methods" class="function"><a href="#ThermoBaseClass.get_instrument_methods">get_instrument_methods</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_tune_method" class="function"><a href="#ThermoBaseClass.get_tune_method">get_tune_method</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_status_log" class="function"><a href="#ThermoBaseClass.get_status_log">get_status_log</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_error_logs" class="function"><a href="#ThermoBaseClass.get_error_logs">get_error_logs</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_sample_information" class="function"><a href="#ThermoBaseClass.get_sample_information">get_sample_information</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_instrument_data" class="function"><a href="#ThermoBaseClass.get_instrument_data">get_instrument_data</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_centroid_msms_data" class="function"><a href="#ThermoBaseClass.get_centroid_msms_data">get_centroid_msms_data</a></dd>
                <dd id="ImportMassSpectraThermoMSFileReader.get_average_mass_spectrum_by_scanlist" class="function"><a href="#ThermoBaseClass.get_average_mass_spectrum_by_scanlist">get_average_mass_spectrum_by_scanlist</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>