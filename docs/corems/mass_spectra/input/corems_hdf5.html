<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.1.0"/>
    <title>corems.mass_spectra.input.corems_hdf5 API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../input.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;corems.mass_spectra.input</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#ReadCoreMSHDFMassSpectra">ReadCoreMSHDFMassSpectra</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.__init__">ReadCoreMSHDFMassSpectra</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReadCoreMSHDFMassSpectra.scans">scans</a>
                        </li>
                        <li>
                                <a class="variable" href="#ReadCoreMSHDFMassSpectra.scan_number_list">scan_number_list</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan">get_mass_spectrum_from_scan</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.load">load</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.get_ms_raw">get_ms_raw</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.get_scan_df">get_scan_df</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.run">run</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_mass_spectra">import_mass_spectra</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_scan_info">import_scan_info</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed">import_ms_unprocessed</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_parameters">import_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_mass_features">import_mass_features</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_eics">import_eics</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results">import_spectral_search_results</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj">get_mass_spectra_obj</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.get_lcms_obj">get_lcms_obj</a>
                        </li>
                        <li>
                                <a class="function" href="#ReadCoreMSHDFMassSpectra.add_original_parser">add_original_parser</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../../corems.html">corems</a><wbr>.<a href="./../../mass_spectra.html">mass_spectra</a><wbr>.<a href="./../input.html">input</a><wbr>.corems_hdf5    </h1>

                
                        <input id="mod-corems_hdf5-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-corems_hdf5-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Yuri E. Corilo&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;Oct 29, 2019&quot;</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">corems.chroma_peak.factory.chroma_peak_classes</span> <span class="kn">import</span> <span class="n">LCMSMassFeature</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">corems.encapsulation.input.parameter_from_json</span> <span class="kn">import</span> <span class="p">(</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">load_and_set_json_parameters_lcms</span><span class="p">,</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="n">load_and_set_toml_parameters_lcms</span><span class="p">,</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="p">)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.factory.lc_class</span> <span class="kn">import</span> <span class="n">LCMSBase</span><span class="p">,</span> <span class="n">MassSpectraBase</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.factory.chromat_data</span> <span class="kn">import</span> <span class="n">EIC_Data</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.input.parserbase</span> <span class="kn">import</span> <span class="n">SpectraParserInterface</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectrum.input.coremsHDF5</span> <span class="kn">import</span> <span class="n">ReadCoreMSHDF_MassSpectrum</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">from</span> <span class="nn">corems.molecular_id.factory.spectrum_search_results</span> <span class="kn">import</span> <span class="n">SpectrumSearchResults</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.input.rawFileReader</span> <span class="kn">import</span> <span class="n">ImportMassSpectraThermoMSFileReader</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span> <span class="nn">corems.mass_spectra.input.mzml</span> <span class="kn">import</span> <span class="n">MZMLSpectraParser</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="k">class</span> <span class="nc">ReadCoreMSHDFMassSpectra</span><span class="p">(</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>    <span class="n">SpectraParserInterface</span><span class="p">,</span> <span class="n">ReadCoreMSHDF_MassSpectrum</span><span class="p">,</span> <span class="n">Thread</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="p">):</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to read CoreMS HDF5 files and populate a LCMS or MassSpectraBase object.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Parameters</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    ----------</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    file_location : str</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        The location of the HDF5 file to read, including the suffix.</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">    Attributes</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">    ----------</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">    file_location : str</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        The location of the HDF5 file to read.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">    h5pydata : h5py.File</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        The HDF5 file object.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">    scans : list</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        A list of the location of individual mass spectra within the HDF5 file.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    scan_number_list : list</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        A list of the scan numbers of the mass spectra within the HDF5 file.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">    parameters_location : str</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        The location of the parameters file (json or toml).</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    Methods</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    -------</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    * import_mass_spectra(mass_spectra).</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        Imports all mass spectra from the HDF5 file onto the LCMS or MassSpectraBase object.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    * get_mass_spectrum_from_scan(scan_number).</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        Return mass spectrum data object from scan number.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    * load().</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">        Placeholder method to meet the requirements of the SpectraParserInterface.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">    * run(mass_spectra).</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        Runs the importer functions to populate a LCMS or MassSpectraBase object.</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">    * import_scan_info(mass_spectra).</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">        Imports the scan info from the HDF5 file to populate the _scan_info attribute</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        on the LCMS or MassSpectraBase object</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">    * import_ms_unprocessed(mass_spectra).</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        Imports the unprocessed mass spectra from the HDF5 file to populate the</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        _ms_unprocessed attribute on the LCMS or MassSpectraBase object</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">    * import_parameters(mass_spectra).</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        Imports the parameters from the HDF5 file to populate the parameters</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        attribute on the LCMS or MassSpectraBase object</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">    * import_mass_features(mass_spectra).</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        Imports the mass features from the HDF5 file to populate the mass_features</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        attribute on the LCMS or MassSpectraBase object</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">    * import_eics(mass_spectra).</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        Imports the extracted ion chromatograms from the HDF5 file to populate the</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        eics attribute on the LCMS or MassSpectraBase object</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">    * import_spectral_search_results(mass_spectra).</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        Imports the spectral search results from the HDF5 file to populate the</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        spectral_search_results attribute on the LCMS or MassSpectraBase object</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">    * get_mass_spectra_obj().</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        Return mass spectra data object, populating the _ms list on the LCMS or</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        MassSpectraBase object from the HDF5 file</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">    * get_lcms_obj().</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        Return LCMSBase object, populating the majority of the attributes on the</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        LCMS object from the HDF5 file</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>        <span class="n">ReadCoreMSHDF_MassSpectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="c1"># override the scans attribute on ReadCoreMSHDF_MassSpectrum class to expect a nested location within the HDF5 file</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="s2">&quot;mass_spectra/&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="p">]</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>        <span class="c1"># set the location of the parameters file (json or toml)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="n">add_files</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="n">x</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>            <span class="p">)</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">&quot;.hdf5&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>        <span class="p">]</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">):</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return mass spectrum data object from scan number.&quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="k">if</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Scan number not found in HDF5 file.&quot;</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="k">pass</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="c1"># Warn if spectra or scan_df are not None that they are not used for CoreMS HDF5 files and should be rerun after instantiation</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>            <span class="ne">SyntaxWarning</span><span class="p">(</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="s2">&quot;get_ms_raw method for CoreMS HDF5 files can only access saved data, consider rerunning after instantiation.&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>            <span class="p">)</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;ms_unprocessed&quot;</span><span class="p">]</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>            <span class="n">ms_up_int</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="n">ms_unprocessed</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                <span class="n">ms_up_int</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="p">)</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="k">return</span> <span class="n">ms_unprocessed</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="n">scan_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;scan_info&quot;</span><span class="p">]</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="n">scan_info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scan_info</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="nb">object</span><span class="p">])</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">str_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">str_df</span><span class="p">:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="n">scan_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">str_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the importer functions to populate a LCMS or MassSpectraBase object.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        Notes</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        -----</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        The following functions are run in order, if the HDF5 file contains the necessary data:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        1. import_parameters(), which populates the parameters attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        2. import_mass_spectra(), which populates the _ms list on the LCMS or MassSpectraBase object.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        3. import_scan_info(), which populates the _scan_info on the LCMS or MassSpectraBase object.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        4. import_ms_unprocessed(), which populates the _ms_unprocessed attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">        5. import_mass_features(), which populates the mass_features attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        6. import_eics(), which populates the eics attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        7. import_spectral_search_results(), which populates the spectral_search_results attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">        Parameters</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        ----------</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        mass_spectra : LCMSBase or MassSpectraBase</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">            The LCMS or MassSpectraBase object to populate with mass spectra, generally instantiated with only the file_location, analyzer, and instrument_label attributes.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        load_raw : bool</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        Returns</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        -------</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">        None, but populates several attributes on the LCMS or MassSpectraBase object.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="c1"># Populate the parameters attribute on the LCMS object</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_parameters</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_spectra&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>            <span class="c1"># Populate the _ms list on the LCMS object</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_spectra</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="s2">&quot;scan_info&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="c1"># Populate the _scan_info attribute on the LCMS object</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_scan_info</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>        <span class="k">if</span> <span class="s2">&quot;ms_unprocessed&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span> <span class="ow">and</span> <span class="n">load_raw</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="c1"># Populate the _ms_unprocessed attribute on the LCMS object</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_ms_unprocessed</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_features&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="c1"># Populate the mass_features attribute on the LCMS object</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_features</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="s2">&quot;eics&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="c1"># Populate the eics attribute on the LCMS object</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_eics</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="s2">&quot;spectral_search_results&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="c1"># Populate the spectral_search_results attribute on the LCMS object</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_spectral_search_results</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>    <span class="k">def</span> <span class="nf">import_mass_spectra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports all mass spectra from the HDF5 file.</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="sd">        Parameters</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">        ----------</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass spectra.</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">        load_raw : bool</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">        Returns</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">        -------</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">        None, but populates the &#39;_ms&#39; list on the LCMSBase or MassSpectraBase</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">        object with mass spectra from the HDF5 file.</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="n">mass_spec</span><span class="o">.</span><span class="n">scan_number</span> <span class="o">=</span> <span class="n">scan_number</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">add_mass_spectrum</span><span class="p">(</span><span class="n">mass_spec</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>    <span class="k">def</span> <span class="nf">import_scan_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the scan info from the HDF5 file.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        Parameters</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        ----------</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        Returns</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        -------</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">        None, but populates the &#39;scan_df&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        object with a pandas DataFrame of the &#39;scan_info&#39; from the HDF5 file.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>    <span class="k">def</span> <span class="nf">import_ms_unprocessed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the unprocessed mass spectra from the HDF5 file.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        Parameters</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        ----------</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a><span class="sd">        Returns</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a><span class="sd">        -------</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a><span class="sd">        None, but populates the &#39;_ms_unprocessed&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="sd">        object with a dictionary of the &#39;ms_unprocessed&#39; from the HDF5 file.</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">()</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms_unprocessed</span> <span class="o">=</span> <span class="n">ms_unprocessed</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    <span class="k">def</span> <span class="nf">import_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the parameters from the HDF5 file.</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        Parameters</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        ----------</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with parameters.</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        Returns</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">        -------</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        None, but populates the &#39;parameters&#39; attribute on the LCMS or MassSpectraBase</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">        object with a dictionary of the &#39;parameters&#39; from the HDF5 file.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>        <span class="k">if</span> <span class="s2">&quot;.json&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>            <span class="n">load_and_set_json_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>        <span class="k">if</span> <span class="s2">&quot;.toml&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">load_and_set_toml_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                <span class="s2">&quot;Parameters file must be in JSON format, TOML format is not yet supported.&quot;</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="k">def</span> <span class="nf">import_mass_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the mass features from the HDF5 file.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        Parameters</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        ----------</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass features.</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        Returns</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        -------</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        None, but populates the &#39;mass_features&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        object with a dictionary of the &#39;mass_features&#39; from the HDF5 file.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_features&quot;</span><span class="p">]</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>            <span class="c1"># Instantiate the MassFeature object</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>            <span class="n">mass_feature</span> <span class="o">=</span> <span class="n">LCMSMassFeature</span><span class="p">(</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                <span class="n">mass_spectra</span><span class="p">,</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>                <span class="n">mz</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_mz_exp&quot;</span><span class="p">],</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>                <span class="n">retention_time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_retention_time&quot;</span><span class="p">],</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>                <span class="n">intensity</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_intensity&quot;</span><span class="p">],</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="n">apex_scan</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_apex_scan&quot;</span><span class="p">],</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                <span class="n">persistence</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_persistence&quot;</span><span class="p">],</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                <span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">),</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="c1"># Populate additional attributes on the MassFeature object</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                <span class="s2">&quot;_mz_exp&quot;</span><span class="p">,</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="s2">&quot;_mz_cal&quot;</span><span class="p">,</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>                <span class="s2">&quot;_retention_time&quot;</span><span class="p">,</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>                <span class="s2">&quot;_intensity&quot;</span><span class="p">,</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>                <span class="s2">&quot;_apex_scan&quot;</span><span class="p">,</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="s2">&quot;_persistence&quot;</span><span class="p">,</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>            <span class="p">}:</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>            <span class="c1"># Populate attributes on MassFeature object that are lists</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mass_feature</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="c1"># Associate mass features with ms1 and ms2 spectra, if available</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">mf_id</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">mass_spectrum</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                    <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                <span class="p">]</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                <span class="k">for</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span><span class="p">:</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                    <span class="k">if</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_mass_spectra</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                        <span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>    <span class="k">def</span> <span class="nf">import_eics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the extracted ion chromatograms from the HDF5 file.</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        Parameters</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        ----------</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with extracted ion chromatograms.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        Returns</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        -------</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        None, but populates the &#39;eics&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">        object with a dictionary of the &#39;eics&#39; from the HDF5 file.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;eics&quot;</span><span class="p">]</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">my_eic</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="n">scans</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;scans&quot;</span><span class="p">][:],</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                <span class="n">time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;time&quot;</span><span class="p">][:],</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="n">eic</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;eic&quot;</span><span class="p">][:],</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>            <span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;scans&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;eic&quot;</span><span class="p">]:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">my_eic</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                    <span class="c1"># if key is apexes, convert to a tuple of a list</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;apexes&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>                        <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">]</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>            <span class="c1"># Add to mass_spectra object</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;mz&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">my_eic</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>        <span class="c1"># Add to mass features</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">mz</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="n">mz</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_eic_data</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">mz</span><span class="p">]</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>    <span class="k">def</span> <span class="nf">import_spectral_search_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the spectral search results from the HDF5 file.</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        Parameters</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        ----------</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with spectral search results.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        Returns</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">        -------</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        None, but populates the &#39;spectral_search_results&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">        object with a dictionary of the &#39;spectral_search_results&#39; from the HDF5 file.</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>        <span class="n">overall_results_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>        <span class="n">ms2_results_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;spectral_search_results&quot;</span><span class="p">]</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>            <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>                <span class="n">ms2_search_res</span> <span class="o">=</span> <span class="n">SpectrumSearchResults</span><span class="p">(</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>                    <span class="n">query_spectrum</span><span class="o">=</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)],</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>                    <span class="n">precursor_mz</span><span class="o">=</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">],</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>                    <span class="n">spectral_similarity_search_results</span><span class="o">=</span><span class="p">{},</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>                <span class="p">)</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">}:</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">ms2_search_res</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">][</span><span class="n">key</span><span class="p">][:]))</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>                <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)][</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>                    <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>                <span class="p">]</span> <span class="o">=</span> <span class="n">ms2_search_res</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="c1"># add to mass_spectra</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">overall_results_dict</span><span class="p">)</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="c1"># If there are mass features, associate the results with each mass feature</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="k">for</span> <span class="n">mass_feature_id</span><span class="p">,</span> <span class="n">mass_feature</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="n">scan_ids</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">ms2_scan_numbers</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>                <span class="k">for</span> <span class="n">ms2_scan_id</span> <span class="ow">in</span> <span class="n">scan_ids</span><span class="p">:</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>                    <span class="n">precursor_mz</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">mz</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span><span class="n">precursor_mz</span><span class="p">]</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>                        <span class="k">pass</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>                            <span class="n">mass_feature_id</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">ms2_similarity_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>                                <span class="n">precursor_mz</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>                            <span class="p">]</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>                        <span class="p">)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpectraBase</span><span class="p">:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        Return mass spectra data object, populating the _ms list on MassSpectraBase object from the HDF5 file.</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">        Parameters</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">        ----------</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        load_raw : bool</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall spectra object and individual mass spectra. Default is True.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>        <span class="n">spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>        <span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>        <span class="c1"># This will populate the _ms list on the LCMS or MassSpectraBase object</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="k">return</span> <span class="n">spectra_obj</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_original_parser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LCMSBase</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        Return LCMSBase object, populating attributes on the LCMSBase object from the HDF5 file.</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">        Parameters</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">        ----------</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">        load_raw : bool</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        use_original_parser : bool</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">            If True, use the original parser to populate the LCMS object. Default is True.</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a><span class="sd">            The location of the raw file to parse if attempting to use original parser.</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a><span class="sd">            Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="sd">            If the original file path has moved, this parameter can be used to specify the new location.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>        <span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>        <span class="c1"># This will populate the majority of the attributes on the LCMS object</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>        <span class="c1"># Set final attributes of the LCMS object</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="c1"># If use_original_parser is True, instantiate the original parser and populate the LCMS object</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="k">if</span> <span class="n">use_original_parser</span><span class="p">:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>            <span class="n">lcms_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_original_parser</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>    <span class="k">def</span> <span class="nf">add_original_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">        Add the original parser to the mass spectra object.</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        Parameters</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">        ----------</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">        mass_spectra : MassSpectraBase | LCMSBase</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to add the original parser to.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">            The location of the raw file to parse. Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>        <span class="c1"># Try to get the raw file path from the HDF5 file</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>        <span class="k">if</span> <span class="n">raw_file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>            <span class="c1"># Check if og_file_location exists, if not raise an error</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>        <span class="n">raw_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">raw_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>                <span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">),</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="s2">&quot;. Cannot use original parser for instatiating the lcms_obj.&quot;</span><span class="p">,</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>            <span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="c1"># Get the original parser type</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="n">og_parser_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;parser_type&quot;</span><span class="p">]</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="k">if</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;ImportMassSpectraThermoMSFileReader&quot;</span><span class="p">:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">ImportMassSpectraThermoMSFileReader</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="k">elif</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;MZMLSpectraParser&quot;</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">MZMLSpectraParser</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser_class</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="vm">__class__</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser</span> <span class="o">=</span> <span class="n">parser</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">return</span> <span class="n">mass_spectra</span>
</span></pre></div>


            </section>
                <section id="ReadCoreMSHDFMassSpectra">
                            <input id="ReadCoreMSHDFMassSpectra-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ReadCoreMSHDFMassSpectra</span><wbr>(<span class="base"><a href="parserbase.html#SpectraParserInterface">corems.mass_spectra.input.parserbase.SpectraParserInterface</a></span>, <span class="base"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum">corems.mass_spectrum.input.coremsHDF5.ReadCoreMSHDF_MassSpectrum</a></span>, <span class="base">threading.Thread</span>):

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra-25"><a href="#ReadCoreMSHDFMassSpectra-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">ReadCoreMSHDFMassSpectra</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-26"><a href="#ReadCoreMSHDFMassSpectra-26"><span class="linenos"> 26</span></a>    <span class="n">SpectraParserInterface</span><span class="p">,</span> <span class="n">ReadCoreMSHDF_MassSpectrum</span><span class="p">,</span> <span class="n">Thread</span>
</span><span id="ReadCoreMSHDFMassSpectra-27"><a href="#ReadCoreMSHDFMassSpectra-27"><span class="linenos"> 27</span></a><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-28"><a href="#ReadCoreMSHDFMassSpectra-28"><span class="linenos"> 28</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to read CoreMS HDF5 files and populate a LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-29"><a href="#ReadCoreMSHDFMassSpectra-29"><span class="linenos"> 29</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-30"><a href="#ReadCoreMSHDFMassSpectra-30"><span class="linenos"> 30</span></a><span class="sd">    Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-31"><a href="#ReadCoreMSHDFMassSpectra-31"><span class="linenos"> 31</span></a><span class="sd">    ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-32"><a href="#ReadCoreMSHDFMassSpectra-32"><span class="linenos"> 32</span></a><span class="sd">    file_location : str</span>
</span><span id="ReadCoreMSHDFMassSpectra-33"><a href="#ReadCoreMSHDFMassSpectra-33"><span class="linenos"> 33</span></a><span class="sd">        The location of the HDF5 file to read, including the suffix.</span>
</span><span id="ReadCoreMSHDFMassSpectra-34"><a href="#ReadCoreMSHDFMassSpectra-34"><span class="linenos"> 34</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-35"><a href="#ReadCoreMSHDFMassSpectra-35"><span class="linenos"> 35</span></a><span class="sd">    Attributes</span>
</span><span id="ReadCoreMSHDFMassSpectra-36"><a href="#ReadCoreMSHDFMassSpectra-36"><span class="linenos"> 36</span></a><span class="sd">    ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-37"><a href="#ReadCoreMSHDFMassSpectra-37"><span class="linenos"> 37</span></a><span class="sd">    file_location : str</span>
</span><span id="ReadCoreMSHDFMassSpectra-38"><a href="#ReadCoreMSHDFMassSpectra-38"><span class="linenos"> 38</span></a><span class="sd">        The location of the HDF5 file to read.</span>
</span><span id="ReadCoreMSHDFMassSpectra-39"><a href="#ReadCoreMSHDFMassSpectra-39"><span class="linenos"> 39</span></a><span class="sd">    h5pydata : h5py.File</span>
</span><span id="ReadCoreMSHDFMassSpectra-40"><a href="#ReadCoreMSHDFMassSpectra-40"><span class="linenos"> 40</span></a><span class="sd">        The HDF5 file object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-41"><a href="#ReadCoreMSHDFMassSpectra-41"><span class="linenos"> 41</span></a><span class="sd">    scans : list</span>
</span><span id="ReadCoreMSHDFMassSpectra-42"><a href="#ReadCoreMSHDFMassSpectra-42"><span class="linenos"> 42</span></a><span class="sd">        A list of the location of individual mass spectra within the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-43"><a href="#ReadCoreMSHDFMassSpectra-43"><span class="linenos"> 43</span></a><span class="sd">    scan_number_list : list</span>
</span><span id="ReadCoreMSHDFMassSpectra-44"><a href="#ReadCoreMSHDFMassSpectra-44"><span class="linenos"> 44</span></a><span class="sd">        A list of the scan numbers of the mass spectra within the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-45"><a href="#ReadCoreMSHDFMassSpectra-45"><span class="linenos"> 45</span></a><span class="sd">    parameters_location : str</span>
</span><span id="ReadCoreMSHDFMassSpectra-46"><a href="#ReadCoreMSHDFMassSpectra-46"><span class="linenos"> 46</span></a><span class="sd">        The location of the parameters file (json or toml).</span>
</span><span id="ReadCoreMSHDFMassSpectra-47"><a href="#ReadCoreMSHDFMassSpectra-47"><span class="linenos"> 47</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-48"><a href="#ReadCoreMSHDFMassSpectra-48"><span class="linenos"> 48</span></a><span class="sd">    Methods</span>
</span><span id="ReadCoreMSHDFMassSpectra-49"><a href="#ReadCoreMSHDFMassSpectra-49"><span class="linenos"> 49</span></a><span class="sd">    -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-50"><a href="#ReadCoreMSHDFMassSpectra-50"><span class="linenos"> 50</span></a><span class="sd">    * import_mass_spectra(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-51"><a href="#ReadCoreMSHDFMassSpectra-51"><span class="linenos"> 51</span></a><span class="sd">        Imports all mass spectra from the HDF5 file onto the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-52"><a href="#ReadCoreMSHDFMassSpectra-52"><span class="linenos"> 52</span></a><span class="sd">    * get_mass_spectrum_from_scan(scan_number).</span>
</span><span id="ReadCoreMSHDFMassSpectra-53"><a href="#ReadCoreMSHDFMassSpectra-53"><span class="linenos"> 53</span></a><span class="sd">        Return mass spectrum data object from scan number.</span>
</span><span id="ReadCoreMSHDFMassSpectra-54"><a href="#ReadCoreMSHDFMassSpectra-54"><span class="linenos"> 54</span></a><span class="sd">    * load().</span>
</span><span id="ReadCoreMSHDFMassSpectra-55"><a href="#ReadCoreMSHDFMassSpectra-55"><span class="linenos"> 55</span></a><span class="sd">        Placeholder method to meet the requirements of the SpectraParserInterface.</span>
</span><span id="ReadCoreMSHDFMassSpectra-56"><a href="#ReadCoreMSHDFMassSpectra-56"><span class="linenos"> 56</span></a><span class="sd">    * run(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-57"><a href="#ReadCoreMSHDFMassSpectra-57"><span class="linenos"> 57</span></a><span class="sd">        Runs the importer functions to populate a LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-58"><a href="#ReadCoreMSHDFMassSpectra-58"><span class="linenos"> 58</span></a><span class="sd">    * import_scan_info(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-59"><a href="#ReadCoreMSHDFMassSpectra-59"><span class="linenos"> 59</span></a><span class="sd">        Imports the scan info from the HDF5 file to populate the _scan_info attribute</span>
</span><span id="ReadCoreMSHDFMassSpectra-60"><a href="#ReadCoreMSHDFMassSpectra-60"><span class="linenos"> 60</span></a><span class="sd">        on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-61"><a href="#ReadCoreMSHDFMassSpectra-61"><span class="linenos"> 61</span></a><span class="sd">    * import_ms_unprocessed(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-62"><a href="#ReadCoreMSHDFMassSpectra-62"><span class="linenos"> 62</span></a><span class="sd">        Imports the unprocessed mass spectra from the HDF5 file to populate the</span>
</span><span id="ReadCoreMSHDFMassSpectra-63"><a href="#ReadCoreMSHDFMassSpectra-63"><span class="linenos"> 63</span></a><span class="sd">        _ms_unprocessed attribute on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-64"><a href="#ReadCoreMSHDFMassSpectra-64"><span class="linenos"> 64</span></a><span class="sd">    * import_parameters(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-65"><a href="#ReadCoreMSHDFMassSpectra-65"><span class="linenos"> 65</span></a><span class="sd">        Imports the parameters from the HDF5 file to populate the parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-66"><a href="#ReadCoreMSHDFMassSpectra-66"><span class="linenos"> 66</span></a><span class="sd">        attribute on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-67"><a href="#ReadCoreMSHDFMassSpectra-67"><span class="linenos"> 67</span></a><span class="sd">    * import_mass_features(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-68"><a href="#ReadCoreMSHDFMassSpectra-68"><span class="linenos"> 68</span></a><span class="sd">        Imports the mass features from the HDF5 file to populate the mass_features</span>
</span><span id="ReadCoreMSHDFMassSpectra-69"><a href="#ReadCoreMSHDFMassSpectra-69"><span class="linenos"> 69</span></a><span class="sd">        attribute on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-70"><a href="#ReadCoreMSHDFMassSpectra-70"><span class="linenos"> 70</span></a><span class="sd">    * import_eics(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-71"><a href="#ReadCoreMSHDFMassSpectra-71"><span class="linenos"> 71</span></a><span class="sd">        Imports the extracted ion chromatograms from the HDF5 file to populate the</span>
</span><span id="ReadCoreMSHDFMassSpectra-72"><a href="#ReadCoreMSHDFMassSpectra-72"><span class="linenos"> 72</span></a><span class="sd">        eics attribute on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-73"><a href="#ReadCoreMSHDFMassSpectra-73"><span class="linenos"> 73</span></a><span class="sd">    * import_spectral_search_results(mass_spectra).</span>
</span><span id="ReadCoreMSHDFMassSpectra-74"><a href="#ReadCoreMSHDFMassSpectra-74"><span class="linenos"> 74</span></a><span class="sd">        Imports the spectral search results from the HDF5 file to populate the</span>
</span><span id="ReadCoreMSHDFMassSpectra-75"><a href="#ReadCoreMSHDFMassSpectra-75"><span class="linenos"> 75</span></a><span class="sd">        spectral_search_results attribute on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-76"><a href="#ReadCoreMSHDFMassSpectra-76"><span class="linenos"> 76</span></a><span class="sd">    * get_mass_spectra_obj().</span>
</span><span id="ReadCoreMSHDFMassSpectra-77"><a href="#ReadCoreMSHDFMassSpectra-77"><span class="linenos"> 77</span></a><span class="sd">        Return mass spectra data object, populating the _ms list on the LCMS or</span>
</span><span id="ReadCoreMSHDFMassSpectra-78"><a href="#ReadCoreMSHDFMassSpectra-78"><span class="linenos"> 78</span></a><span class="sd">        MassSpectraBase object from the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra-79"><a href="#ReadCoreMSHDFMassSpectra-79"><span class="linenos"> 79</span></a><span class="sd">    * get_lcms_obj().</span>
</span><span id="ReadCoreMSHDFMassSpectra-80"><a href="#ReadCoreMSHDFMassSpectra-80"><span class="linenos"> 80</span></a><span class="sd">        Return LCMSBase object, populating the majority of the attributes on the</span>
</span><span id="ReadCoreMSHDFMassSpectra-81"><a href="#ReadCoreMSHDFMassSpectra-81"><span class="linenos"> 81</span></a><span class="sd">        LCMS object from the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra-82"><a href="#ReadCoreMSHDFMassSpectra-82"><span class="linenos"> 82</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-83"><a href="#ReadCoreMSHDFMassSpectra-83"><span class="linenos"> 83</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-84"><a href="#ReadCoreMSHDFMassSpectra-84"><span class="linenos"> 84</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-85"><a href="#ReadCoreMSHDFMassSpectra-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-86"><a href="#ReadCoreMSHDFMassSpectra-86"><span class="linenos"> 86</span></a>        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-87"><a href="#ReadCoreMSHDFMassSpectra-87"><span class="linenos"> 87</span></a>        <span class="n">ReadCoreMSHDF_MassSpectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-88"><a href="#ReadCoreMSHDFMassSpectra-88"><span class="linenos"> 88</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-89"><a href="#ReadCoreMSHDFMassSpectra-89"><span class="linenos"> 89</span></a>        <span class="c1"># override the scans attribute on ReadCoreMSHDF_MassSpectrum class to expect a nested location within the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra-90"><a href="#ReadCoreMSHDFMassSpectra-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra-91"><a href="#ReadCoreMSHDFMassSpectra-91"><span class="linenos"> 91</span></a>            <span class="s2">&quot;mass_spectra/&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="ReadCoreMSHDFMassSpectra-92"><a href="#ReadCoreMSHDFMassSpectra-92"><span class="linenos"> 92</span></a>        <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-93"><a href="#ReadCoreMSHDFMassSpectra-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-94"><a href="#ReadCoreMSHDFMassSpectra-94"><span class="linenos"> 94</span></a>            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</span><span id="ReadCoreMSHDFMassSpectra-95"><a href="#ReadCoreMSHDFMassSpectra-95"><span class="linenos"> 95</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-96"><a href="#ReadCoreMSHDFMassSpectra-96"><span class="linenos"> 96</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-97"><a href="#ReadCoreMSHDFMassSpectra-97"><span class="linenos"> 97</span></a>        <span class="c1"># set the location of the parameters file (json or toml)</span>
</span><span id="ReadCoreMSHDFMassSpectra-98"><a href="#ReadCoreMSHDFMassSpectra-98"><span class="linenos"> 98</span></a>        <span class="n">add_files</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra-99"><a href="#ReadCoreMSHDFMassSpectra-99"><span class="linenos"> 99</span></a>            <span class="n">x</span>
</span><span id="ReadCoreMSHDFMassSpectra-100"><a href="#ReadCoreMSHDFMassSpectra-100"><span class="linenos">100</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-101"><a href="#ReadCoreMSHDFMassSpectra-101"><span class="linenos">101</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-102"><a href="#ReadCoreMSHDFMassSpectra-102"><span class="linenos">102</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-103"><a href="#ReadCoreMSHDFMassSpectra-103"><span class="linenos">103</span></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">&quot;.hdf5&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-104"><a href="#ReadCoreMSHDFMassSpectra-104"><span class="linenos">104</span></a>        <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-105"><a href="#ReadCoreMSHDFMassSpectra-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-106"><a href="#ReadCoreMSHDFMassSpectra-106"><span class="linenos">106</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-107"><a href="#ReadCoreMSHDFMassSpectra-107"><span class="linenos">107</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-108"><a href="#ReadCoreMSHDFMassSpectra-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-109"><a href="#ReadCoreMSHDFMassSpectra-109"><span class="linenos">109</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-110"><a href="#ReadCoreMSHDFMassSpectra-110"><span class="linenos">110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ReadCoreMSHDFMassSpectra-111"><a href="#ReadCoreMSHDFMassSpectra-111"><span class="linenos">111</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-112"><a href="#ReadCoreMSHDFMassSpectra-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-113"><a href="#ReadCoreMSHDFMassSpectra-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return mass spectrum data object from scan number.&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-114"><a href="#ReadCoreMSHDFMassSpectra-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-115"><a href="#ReadCoreMSHDFMassSpectra-115"><span class="linenos">115</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-116"><a href="#ReadCoreMSHDFMassSpectra-116"><span class="linenos">116</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ReadCoreMSHDFMassSpectra-117"><a href="#ReadCoreMSHDFMassSpectra-117"><span class="linenos">117</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-118"><a href="#ReadCoreMSHDFMassSpectra-118"><span class="linenos">118</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Scan number not found in HDF5 file.&quot;</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-119"><a href="#ReadCoreMSHDFMassSpectra-119"><span class="linenos">119</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-120"><a href="#ReadCoreMSHDFMassSpectra-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-121"><a href="#ReadCoreMSHDFMassSpectra-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-122"><a href="#ReadCoreMSHDFMassSpectra-122"><span class="linenos">122</span></a>        <span class="k">pass</span>
</span><span id="ReadCoreMSHDFMassSpectra-123"><a href="#ReadCoreMSHDFMassSpectra-123"><span class="linenos">123</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-124"><a href="#ReadCoreMSHDFMassSpectra-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-125"><a href="#ReadCoreMSHDFMassSpectra-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-126"><a href="#ReadCoreMSHDFMassSpectra-126"><span class="linenos">126</span></a>        <span class="c1"># Warn if spectra or scan_df are not None that they are not used for CoreMS HDF5 files and should be rerun after instantiation</span>
</span><span id="ReadCoreMSHDFMassSpectra-127"><a href="#ReadCoreMSHDFMassSpectra-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-128"><a href="#ReadCoreMSHDFMassSpectra-128"><span class="linenos">128</span></a>            <span class="ne">SyntaxWarning</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-129"><a href="#ReadCoreMSHDFMassSpectra-129"><span class="linenos">129</span></a>                <span class="s2">&quot;get_ms_raw method for CoreMS HDF5 files can only access saved data, consider rerunning after instantiation.&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-130"><a href="#ReadCoreMSHDFMassSpectra-130"><span class="linenos">130</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-131"><a href="#ReadCoreMSHDFMassSpectra-131"><span class="linenos">131</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra-132"><a href="#ReadCoreMSHDFMassSpectra-132"><span class="linenos">132</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;ms_unprocessed&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-133"><a href="#ReadCoreMSHDFMassSpectra-133"><span class="linenos">133</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-134"><a href="#ReadCoreMSHDFMassSpectra-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-135"><a href="#ReadCoreMSHDFMassSpectra-135"><span class="linenos">135</span></a>            <span class="n">ms_up_int</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="ReadCoreMSHDFMassSpectra-136"><a href="#ReadCoreMSHDFMassSpectra-136"><span class="linenos">136</span></a>            <span class="n">ms_unprocessed</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-137"><a href="#ReadCoreMSHDFMassSpectra-137"><span class="linenos">137</span></a>                <span class="n">ms_up_int</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-138"><a href="#ReadCoreMSHDFMassSpectra-138"><span class="linenos">138</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-139"><a href="#ReadCoreMSHDFMassSpectra-139"><span class="linenos">139</span></a>        <span class="k">return</span> <span class="n">ms_unprocessed</span>
</span><span id="ReadCoreMSHDFMassSpectra-140"><a href="#ReadCoreMSHDFMassSpectra-140"><span class="linenos">140</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-141"><a href="#ReadCoreMSHDFMassSpectra-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-142"><a href="#ReadCoreMSHDFMassSpectra-142"><span class="linenos">142</span></a>        <span class="n">scan_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra-143"><a href="#ReadCoreMSHDFMassSpectra-143"><span class="linenos">143</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;scan_info&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-144"><a href="#ReadCoreMSHDFMassSpectra-144"><span class="linenos">144</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-145"><a href="#ReadCoreMSHDFMassSpectra-145"><span class="linenos">145</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-146"><a href="#ReadCoreMSHDFMassSpectra-146"><span class="linenos">146</span></a>            <span class="n">scan_info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="ReadCoreMSHDFMassSpectra-147"><a href="#ReadCoreMSHDFMassSpectra-147"><span class="linenos">147</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scan_info</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-148"><a href="#ReadCoreMSHDFMassSpectra-148"><span class="linenos">148</span></a>        <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-149"><a href="#ReadCoreMSHDFMassSpectra-149"><span class="linenos">149</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="nb">object</span><span class="p">])</span>
</span><span id="ReadCoreMSHDFMassSpectra-150"><a href="#ReadCoreMSHDFMassSpectra-150"><span class="linenos">150</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">str_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-151"><a href="#ReadCoreMSHDFMassSpectra-151"><span class="linenos">151</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">str_df</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-152"><a href="#ReadCoreMSHDFMassSpectra-152"><span class="linenos">152</span></a>            <span class="n">scan_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">str_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-153"><a href="#ReadCoreMSHDFMassSpectra-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span><span id="ReadCoreMSHDFMassSpectra-154"><a href="#ReadCoreMSHDFMassSpectra-154"><span class="linenos">154</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-155"><a href="#ReadCoreMSHDFMassSpectra-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-156"><a href="#ReadCoreMSHDFMassSpectra-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the importer functions to populate a LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-157"><a href="#ReadCoreMSHDFMassSpectra-157"><span class="linenos">157</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-158"><a href="#ReadCoreMSHDFMassSpectra-158"><span class="linenos">158</span></a><span class="sd">        Notes</span>
</span><span id="ReadCoreMSHDFMassSpectra-159"><a href="#ReadCoreMSHDFMassSpectra-159"><span class="linenos">159</span></a><span class="sd">        -----</span>
</span><span id="ReadCoreMSHDFMassSpectra-160"><a href="#ReadCoreMSHDFMassSpectra-160"><span class="linenos">160</span></a><span class="sd">        The following functions are run in order, if the HDF5 file contains the necessary data:</span>
</span><span id="ReadCoreMSHDFMassSpectra-161"><a href="#ReadCoreMSHDFMassSpectra-161"><span class="linenos">161</span></a><span class="sd">        1. import_parameters(), which populates the parameters attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-162"><a href="#ReadCoreMSHDFMassSpectra-162"><span class="linenos">162</span></a><span class="sd">        2. import_mass_spectra(), which populates the _ms list on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-163"><a href="#ReadCoreMSHDFMassSpectra-163"><span class="linenos">163</span></a><span class="sd">        3. import_scan_info(), which populates the _scan_info on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-164"><a href="#ReadCoreMSHDFMassSpectra-164"><span class="linenos">164</span></a><span class="sd">        4. import_ms_unprocessed(), which populates the _ms_unprocessed attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-165"><a href="#ReadCoreMSHDFMassSpectra-165"><span class="linenos">165</span></a><span class="sd">        5. import_mass_features(), which populates the mass_features attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-166"><a href="#ReadCoreMSHDFMassSpectra-166"><span class="linenos">166</span></a><span class="sd">        6. import_eics(), which populates the eics attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-167"><a href="#ReadCoreMSHDFMassSpectra-167"><span class="linenos">167</span></a><span class="sd">        7. import_spectral_search_results(), which populates the spectral_search_results attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-168"><a href="#ReadCoreMSHDFMassSpectra-168"><span class="linenos">168</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-169"><a href="#ReadCoreMSHDFMassSpectra-169"><span class="linenos">169</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-170"><a href="#ReadCoreMSHDFMassSpectra-170"><span class="linenos">170</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-171"><a href="#ReadCoreMSHDFMassSpectra-171"><span class="linenos">171</span></a><span class="sd">        mass_spectra : LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-172"><a href="#ReadCoreMSHDFMassSpectra-172"><span class="linenos">172</span></a><span class="sd">            The LCMS or MassSpectraBase object to populate with mass spectra, generally instantiated with only the file_location, analyzer, and instrument_label attributes.</span>
</span><span id="ReadCoreMSHDFMassSpectra-173"><a href="#ReadCoreMSHDFMassSpectra-173"><span class="linenos">173</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra-174"><a href="#ReadCoreMSHDFMassSpectra-174"><span class="linenos">174</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra-175"><a href="#ReadCoreMSHDFMassSpectra-175"><span class="linenos">175</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-176"><a href="#ReadCoreMSHDFMassSpectra-176"><span class="linenos">176</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-177"><a href="#ReadCoreMSHDFMassSpectra-177"><span class="linenos">177</span></a><span class="sd">        None, but populates several attributes on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-178"><a href="#ReadCoreMSHDFMassSpectra-178"><span class="linenos">178</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-179"><a href="#ReadCoreMSHDFMassSpectra-179"><span class="linenos">179</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-180"><a href="#ReadCoreMSHDFMassSpectra-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-181"><a href="#ReadCoreMSHDFMassSpectra-181"><span class="linenos">181</span></a>            <span class="c1"># Populate the parameters attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-182"><a href="#ReadCoreMSHDFMassSpectra-182"><span class="linenos">182</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_parameters</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-183"><a href="#ReadCoreMSHDFMassSpectra-183"><span class="linenos">183</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-184"><a href="#ReadCoreMSHDFMassSpectra-184"><span class="linenos">184</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_spectra&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-185"><a href="#ReadCoreMSHDFMassSpectra-185"><span class="linenos">185</span></a>            <span class="c1"># Populate the _ms list on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-186"><a href="#ReadCoreMSHDFMassSpectra-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_spectra</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-187"><a href="#ReadCoreMSHDFMassSpectra-187"><span class="linenos">187</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-188"><a href="#ReadCoreMSHDFMassSpectra-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="s2">&quot;scan_info&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-189"><a href="#ReadCoreMSHDFMassSpectra-189"><span class="linenos">189</span></a>            <span class="c1"># Populate the _scan_info attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-190"><a href="#ReadCoreMSHDFMassSpectra-190"><span class="linenos">190</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_scan_info</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-191"><a href="#ReadCoreMSHDFMassSpectra-191"><span class="linenos">191</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-192"><a href="#ReadCoreMSHDFMassSpectra-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="s2">&quot;ms_unprocessed&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span> <span class="ow">and</span> <span class="n">load_raw</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-193"><a href="#ReadCoreMSHDFMassSpectra-193"><span class="linenos">193</span></a>            <span class="c1"># Populate the _ms_unprocessed attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-194"><a href="#ReadCoreMSHDFMassSpectra-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_ms_unprocessed</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-195"><a href="#ReadCoreMSHDFMassSpectra-195"><span class="linenos">195</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-196"><a href="#ReadCoreMSHDFMassSpectra-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_features&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-197"><a href="#ReadCoreMSHDFMassSpectra-197"><span class="linenos">197</span></a>            <span class="c1"># Populate the mass_features attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-198"><a href="#ReadCoreMSHDFMassSpectra-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_features</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-199"><a href="#ReadCoreMSHDFMassSpectra-199"><span class="linenos">199</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-200"><a href="#ReadCoreMSHDFMassSpectra-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="s2">&quot;eics&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-201"><a href="#ReadCoreMSHDFMassSpectra-201"><span class="linenos">201</span></a>            <span class="c1"># Populate the eics attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-202"><a href="#ReadCoreMSHDFMassSpectra-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_eics</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-203"><a href="#ReadCoreMSHDFMassSpectra-203"><span class="linenos">203</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-204"><a href="#ReadCoreMSHDFMassSpectra-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="s2">&quot;spectral_search_results&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-205"><a href="#ReadCoreMSHDFMassSpectra-205"><span class="linenos">205</span></a>            <span class="c1"># Populate the spectral_search_results attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-206"><a href="#ReadCoreMSHDFMassSpectra-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_spectral_search_results</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-207"><a href="#ReadCoreMSHDFMassSpectra-207"><span class="linenos">207</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-208"><a href="#ReadCoreMSHDFMassSpectra-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">import_mass_spectra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-209"><a href="#ReadCoreMSHDFMassSpectra-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports all mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-210"><a href="#ReadCoreMSHDFMassSpectra-210"><span class="linenos">210</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-211"><a href="#ReadCoreMSHDFMassSpectra-211"><span class="linenos">211</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-212"><a href="#ReadCoreMSHDFMassSpectra-212"><span class="linenos">212</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-213"><a href="#ReadCoreMSHDFMassSpectra-213"><span class="linenos">213</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-214"><a href="#ReadCoreMSHDFMassSpectra-214"><span class="linenos">214</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass spectra.</span>
</span><span id="ReadCoreMSHDFMassSpectra-215"><a href="#ReadCoreMSHDFMassSpectra-215"><span class="linenos">215</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra-216"><a href="#ReadCoreMSHDFMassSpectra-216"><span class="linenos">216</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default</span>
</span><span id="ReadCoreMSHDFMassSpectra-217"><a href="#ReadCoreMSHDFMassSpectra-217"><span class="linenos">217</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-218"><a href="#ReadCoreMSHDFMassSpectra-218"><span class="linenos">218</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-219"><a href="#ReadCoreMSHDFMassSpectra-219"><span class="linenos">219</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-220"><a href="#ReadCoreMSHDFMassSpectra-220"><span class="linenos">220</span></a><span class="sd">        None, but populates the &#39;_ms&#39; list on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-221"><a href="#ReadCoreMSHDFMassSpectra-221"><span class="linenos">221</span></a><span class="sd">        object with mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-222"><a href="#ReadCoreMSHDFMassSpectra-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-223"><a href="#ReadCoreMSHDFMassSpectra-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-224"><a href="#ReadCoreMSHDFMassSpectra-224"><span class="linenos">224</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-225"><a href="#ReadCoreMSHDFMassSpectra-225"><span class="linenos">225</span></a>            <span class="n">mass_spec</span><span class="o">.</span><span class="n">scan_number</span> <span class="o">=</span> <span class="n">scan_number</span>
</span><span id="ReadCoreMSHDFMassSpectra-226"><a href="#ReadCoreMSHDFMassSpectra-226"><span class="linenos">226</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">add_mass_spectrum</span><span class="p">(</span><span class="n">mass_spec</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-227"><a href="#ReadCoreMSHDFMassSpectra-227"><span class="linenos">227</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-228"><a href="#ReadCoreMSHDFMassSpectra-228"><span class="linenos">228</span></a>    <span class="k">def</span> <span class="nf">import_scan_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-229"><a href="#ReadCoreMSHDFMassSpectra-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the scan info from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-230"><a href="#ReadCoreMSHDFMassSpectra-230"><span class="linenos">230</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-231"><a href="#ReadCoreMSHDFMassSpectra-231"><span class="linenos">231</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-232"><a href="#ReadCoreMSHDFMassSpectra-232"><span class="linenos">232</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-233"><a href="#ReadCoreMSHDFMassSpectra-233"><span class="linenos">233</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-234"><a href="#ReadCoreMSHDFMassSpectra-234"><span class="linenos">234</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="ReadCoreMSHDFMassSpectra-235"><a href="#ReadCoreMSHDFMassSpectra-235"><span class="linenos">235</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-236"><a href="#ReadCoreMSHDFMassSpectra-236"><span class="linenos">236</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-237"><a href="#ReadCoreMSHDFMassSpectra-237"><span class="linenos">237</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-238"><a href="#ReadCoreMSHDFMassSpectra-238"><span class="linenos">238</span></a><span class="sd">        None, but populates the &#39;scan_df&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-239"><a href="#ReadCoreMSHDFMassSpectra-239"><span class="linenos">239</span></a><span class="sd">        object with a pandas DataFrame of the &#39;scan_info&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-240"><a href="#ReadCoreMSHDFMassSpectra-240"><span class="linenos">240</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-241"><a href="#ReadCoreMSHDFMassSpectra-241"><span class="linenos">241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-242"><a href="#ReadCoreMSHDFMassSpectra-242"><span class="linenos">242</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-243"><a href="#ReadCoreMSHDFMassSpectra-243"><span class="linenos">243</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span><span id="ReadCoreMSHDFMassSpectra-244"><a href="#ReadCoreMSHDFMassSpectra-244"><span class="linenos">244</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-245"><a href="#ReadCoreMSHDFMassSpectra-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">import_ms_unprocessed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-246"><a href="#ReadCoreMSHDFMassSpectra-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the unprocessed mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-247"><a href="#ReadCoreMSHDFMassSpectra-247"><span class="linenos">247</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-248"><a href="#ReadCoreMSHDFMassSpectra-248"><span class="linenos">248</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-249"><a href="#ReadCoreMSHDFMassSpectra-249"><span class="linenos">249</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-250"><a href="#ReadCoreMSHDFMassSpectra-250"><span class="linenos">250</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-251"><a href="#ReadCoreMSHDFMassSpectra-251"><span class="linenos">251</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="ReadCoreMSHDFMassSpectra-252"><a href="#ReadCoreMSHDFMassSpectra-252"><span class="linenos">252</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-253"><a href="#ReadCoreMSHDFMassSpectra-253"><span class="linenos">253</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-254"><a href="#ReadCoreMSHDFMassSpectra-254"><span class="linenos">254</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-255"><a href="#ReadCoreMSHDFMassSpectra-255"><span class="linenos">255</span></a><span class="sd">        None, but populates the &#39;_ms_unprocessed&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-256"><a href="#ReadCoreMSHDFMassSpectra-256"><span class="linenos">256</span></a><span class="sd">        object with a dictionary of the &#39;ms_unprocessed&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-257"><a href="#ReadCoreMSHDFMassSpectra-257"><span class="linenos">257</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-258"><a href="#ReadCoreMSHDFMassSpectra-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-259"><a href="#ReadCoreMSHDFMassSpectra-259"><span class="linenos">259</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-260"><a href="#ReadCoreMSHDFMassSpectra-260"><span class="linenos">260</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms_unprocessed</span> <span class="o">=</span> <span class="n">ms_unprocessed</span>
</span><span id="ReadCoreMSHDFMassSpectra-261"><a href="#ReadCoreMSHDFMassSpectra-261"><span class="linenos">261</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-262"><a href="#ReadCoreMSHDFMassSpectra-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">import_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-263"><a href="#ReadCoreMSHDFMassSpectra-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the parameters from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-264"><a href="#ReadCoreMSHDFMassSpectra-264"><span class="linenos">264</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-265"><a href="#ReadCoreMSHDFMassSpectra-265"><span class="linenos">265</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-266"><a href="#ReadCoreMSHDFMassSpectra-266"><span class="linenos">266</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-267"><a href="#ReadCoreMSHDFMassSpectra-267"><span class="linenos">267</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-268"><a href="#ReadCoreMSHDFMassSpectra-268"><span class="linenos">268</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with parameters.</span>
</span><span id="ReadCoreMSHDFMassSpectra-269"><a href="#ReadCoreMSHDFMassSpectra-269"><span class="linenos">269</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-270"><a href="#ReadCoreMSHDFMassSpectra-270"><span class="linenos">270</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-271"><a href="#ReadCoreMSHDFMassSpectra-271"><span class="linenos">271</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-272"><a href="#ReadCoreMSHDFMassSpectra-272"><span class="linenos">272</span></a><span class="sd">        None, but populates the &#39;parameters&#39; attribute on the LCMS or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-273"><a href="#ReadCoreMSHDFMassSpectra-273"><span class="linenos">273</span></a><span class="sd">        object with a dictionary of the &#39;parameters&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-274"><a href="#ReadCoreMSHDFMassSpectra-274"><span class="linenos">274</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-275"><a href="#ReadCoreMSHDFMassSpectra-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-276"><a href="#ReadCoreMSHDFMassSpectra-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="s2">&quot;.json&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-277"><a href="#ReadCoreMSHDFMassSpectra-277"><span class="linenos">277</span></a>            <span class="n">load_and_set_json_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-278"><a href="#ReadCoreMSHDFMassSpectra-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="s2">&quot;.toml&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-279"><a href="#ReadCoreMSHDFMassSpectra-279"><span class="linenos">279</span></a>            <span class="n">load_and_set_toml_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-280"><a href="#ReadCoreMSHDFMassSpectra-280"><span class="linenos">280</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-281"><a href="#ReadCoreMSHDFMassSpectra-281"><span class="linenos">281</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-282"><a href="#ReadCoreMSHDFMassSpectra-282"><span class="linenos">282</span></a>                <span class="s2">&quot;Parameters file must be in JSON format, TOML format is not yet supported.&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-283"><a href="#ReadCoreMSHDFMassSpectra-283"><span class="linenos">283</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-284"><a href="#ReadCoreMSHDFMassSpectra-284"><span class="linenos">284</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-285"><a href="#ReadCoreMSHDFMassSpectra-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">import_mass_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-286"><a href="#ReadCoreMSHDFMassSpectra-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the mass features from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-287"><a href="#ReadCoreMSHDFMassSpectra-287"><span class="linenos">287</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-288"><a href="#ReadCoreMSHDFMassSpectra-288"><span class="linenos">288</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-289"><a href="#ReadCoreMSHDFMassSpectra-289"><span class="linenos">289</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-290"><a href="#ReadCoreMSHDFMassSpectra-290"><span class="linenos">290</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-291"><a href="#ReadCoreMSHDFMassSpectra-291"><span class="linenos">291</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass features.</span>
</span><span id="ReadCoreMSHDFMassSpectra-292"><a href="#ReadCoreMSHDFMassSpectra-292"><span class="linenos">292</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-293"><a href="#ReadCoreMSHDFMassSpectra-293"><span class="linenos">293</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-294"><a href="#ReadCoreMSHDFMassSpectra-294"><span class="linenos">294</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-295"><a href="#ReadCoreMSHDFMassSpectra-295"><span class="linenos">295</span></a><span class="sd">        None, but populates the &#39;mass_features&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-296"><a href="#ReadCoreMSHDFMassSpectra-296"><span class="linenos">296</span></a><span class="sd">        object with a dictionary of the &#39;mass_features&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-297"><a href="#ReadCoreMSHDFMassSpectra-297"><span class="linenos">297</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-298"><a href="#ReadCoreMSHDFMassSpectra-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-299"><a href="#ReadCoreMSHDFMassSpectra-299"><span class="linenos">299</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_features&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-300"><a href="#ReadCoreMSHDFMassSpectra-300"><span class="linenos">300</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-301"><a href="#ReadCoreMSHDFMassSpectra-301"><span class="linenos">301</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-302"><a href="#ReadCoreMSHDFMassSpectra-302"><span class="linenos">302</span></a>            <span class="c1"># Instantiate the MassFeature object</span>
</span><span id="ReadCoreMSHDFMassSpectra-303"><a href="#ReadCoreMSHDFMassSpectra-303"><span class="linenos">303</span></a>            <span class="n">mass_feature</span> <span class="o">=</span> <span class="n">LCMSMassFeature</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-304"><a href="#ReadCoreMSHDFMassSpectra-304"><span class="linenos">304</span></a>                <span class="n">mass_spectra</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-305"><a href="#ReadCoreMSHDFMassSpectra-305"><span class="linenos">305</span></a>                <span class="n">mz</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_mz_exp&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-306"><a href="#ReadCoreMSHDFMassSpectra-306"><span class="linenos">306</span></a>                <span class="n">retention_time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_retention_time&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-307"><a href="#ReadCoreMSHDFMassSpectra-307"><span class="linenos">307</span></a>                <span class="n">intensity</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_intensity&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-308"><a href="#ReadCoreMSHDFMassSpectra-308"><span class="linenos">308</span></a>                <span class="n">apex_scan</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_apex_scan&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-309"><a href="#ReadCoreMSHDFMassSpectra-309"><span class="linenos">309</span></a>                <span class="n">persistence</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_persistence&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-310"><a href="#ReadCoreMSHDFMassSpectra-310"><span class="linenos">310</span></a>                <span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">),</span>
</span><span id="ReadCoreMSHDFMassSpectra-311"><a href="#ReadCoreMSHDFMassSpectra-311"><span class="linenos">311</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-312"><a href="#ReadCoreMSHDFMassSpectra-312"><span class="linenos">312</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-313"><a href="#ReadCoreMSHDFMassSpectra-313"><span class="linenos">313</span></a>            <span class="c1"># Populate additional attributes on the MassFeature object</span>
</span><span id="ReadCoreMSHDFMassSpectra-314"><a href="#ReadCoreMSHDFMassSpectra-314"><span class="linenos">314</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span>
</span><span id="ReadCoreMSHDFMassSpectra-315"><a href="#ReadCoreMSHDFMassSpectra-315"><span class="linenos">315</span></a>                <span class="s2">&quot;_mz_exp&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-316"><a href="#ReadCoreMSHDFMassSpectra-316"><span class="linenos">316</span></a>                <span class="s2">&quot;_mz_cal&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-317"><a href="#ReadCoreMSHDFMassSpectra-317"><span class="linenos">317</span></a>                <span class="s2">&quot;_retention_time&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-318"><a href="#ReadCoreMSHDFMassSpectra-318"><span class="linenos">318</span></a>                <span class="s2">&quot;_intensity&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-319"><a href="#ReadCoreMSHDFMassSpectra-319"><span class="linenos">319</span></a>                <span class="s2">&quot;_apex_scan&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-320"><a href="#ReadCoreMSHDFMassSpectra-320"><span class="linenos">320</span></a>                <span class="s2">&quot;_persistence&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-321"><a href="#ReadCoreMSHDFMassSpectra-321"><span class="linenos">321</span></a>            <span class="p">}:</span>
</span><span id="ReadCoreMSHDFMassSpectra-322"><a href="#ReadCoreMSHDFMassSpectra-322"><span class="linenos">322</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="ReadCoreMSHDFMassSpectra-323"><a href="#ReadCoreMSHDFMassSpectra-323"><span class="linenos">323</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-324"><a href="#ReadCoreMSHDFMassSpectra-324"><span class="linenos">324</span></a>            <span class="c1"># Populate attributes on MassFeature object that are lists</span>
</span><span id="ReadCoreMSHDFMassSpectra-325"><a href="#ReadCoreMSHDFMassSpectra-325"><span class="linenos">325</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-326"><a href="#ReadCoreMSHDFMassSpectra-326"><span class="linenos">326</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="ReadCoreMSHDFMassSpectra-327"><a href="#ReadCoreMSHDFMassSpectra-327"><span class="linenos">327</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-328"><a href="#ReadCoreMSHDFMassSpectra-328"><span class="linenos">328</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mass_feature</span>
</span><span id="ReadCoreMSHDFMassSpectra-329"><a href="#ReadCoreMSHDFMassSpectra-329"><span class="linenos">329</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-330"><a href="#ReadCoreMSHDFMassSpectra-330"><span class="linenos">330</span></a>        <span class="c1"># Associate mass features with ms1 and ms2 spectra, if available</span>
</span><span id="ReadCoreMSHDFMassSpectra-331"><a href="#ReadCoreMSHDFMassSpectra-331"><span class="linenos">331</span></a>        <span class="k">for</span> <span class="n">mf_id</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-332"><a href="#ReadCoreMSHDFMassSpectra-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-333"><a href="#ReadCoreMSHDFMassSpectra-333"><span class="linenos">333</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">mass_spectrum</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra-334"><a href="#ReadCoreMSHDFMassSpectra-334"><span class="linenos">334</span></a>                    <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span>
</span><span id="ReadCoreMSHDFMassSpectra-335"><a href="#ReadCoreMSHDFMassSpectra-335"><span class="linenos">335</span></a>                <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-336"><a href="#ReadCoreMSHDFMassSpectra-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-337"><a href="#ReadCoreMSHDFMassSpectra-337"><span class="linenos">337</span></a>                <span class="k">for</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-338"><a href="#ReadCoreMSHDFMassSpectra-338"><span class="linenos">338</span></a>                    <span class="k">if</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-339"><a href="#ReadCoreMSHDFMassSpectra-339"><span class="linenos">339</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_mass_spectra</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-340"><a href="#ReadCoreMSHDFMassSpectra-340"><span class="linenos">340</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-341"><a href="#ReadCoreMSHDFMassSpectra-341"><span class="linenos">341</span></a>                        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-342"><a href="#ReadCoreMSHDFMassSpectra-342"><span class="linenos">342</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-343"><a href="#ReadCoreMSHDFMassSpectra-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">import_eics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-344"><a href="#ReadCoreMSHDFMassSpectra-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the extracted ion chromatograms from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-345"><a href="#ReadCoreMSHDFMassSpectra-345"><span class="linenos">345</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-346"><a href="#ReadCoreMSHDFMassSpectra-346"><span class="linenos">346</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-347"><a href="#ReadCoreMSHDFMassSpectra-347"><span class="linenos">347</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-348"><a href="#ReadCoreMSHDFMassSpectra-348"><span class="linenos">348</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-349"><a href="#ReadCoreMSHDFMassSpectra-349"><span class="linenos">349</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with extracted ion chromatograms.</span>
</span><span id="ReadCoreMSHDFMassSpectra-350"><a href="#ReadCoreMSHDFMassSpectra-350"><span class="linenos">350</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-351"><a href="#ReadCoreMSHDFMassSpectra-351"><span class="linenos">351</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-352"><a href="#ReadCoreMSHDFMassSpectra-352"><span class="linenos">352</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-353"><a href="#ReadCoreMSHDFMassSpectra-353"><span class="linenos">353</span></a><span class="sd">        None, but populates the &#39;eics&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-354"><a href="#ReadCoreMSHDFMassSpectra-354"><span class="linenos">354</span></a><span class="sd">        object with a dictionary of the &#39;eics&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-355"><a href="#ReadCoreMSHDFMassSpectra-355"><span class="linenos">355</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-356"><a href="#ReadCoreMSHDFMassSpectra-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-357"><a href="#ReadCoreMSHDFMassSpectra-357"><span class="linenos">357</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;eics&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-358"><a href="#ReadCoreMSHDFMassSpectra-358"><span class="linenos">358</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra-359"><a href="#ReadCoreMSHDFMassSpectra-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-360"><a href="#ReadCoreMSHDFMassSpectra-360"><span class="linenos">360</span></a>            <span class="n">my_eic</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-361"><a href="#ReadCoreMSHDFMassSpectra-361"><span class="linenos">361</span></a>                <span class="n">scans</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;scans&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra-362"><a href="#ReadCoreMSHDFMassSpectra-362"><span class="linenos">362</span></a>                <span class="n">time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;time&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra-363"><a href="#ReadCoreMSHDFMassSpectra-363"><span class="linenos">363</span></a>                <span class="n">eic</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;eic&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra-364"><a href="#ReadCoreMSHDFMassSpectra-364"><span class="linenos">364</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-365"><a href="#ReadCoreMSHDFMassSpectra-365"><span class="linenos">365</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-366"><a href="#ReadCoreMSHDFMassSpectra-366"><span class="linenos">366</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;scans&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;eic&quot;</span><span class="p">]:</span>
</span><span id="ReadCoreMSHDFMassSpectra-367"><a href="#ReadCoreMSHDFMassSpectra-367"><span class="linenos">367</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">my_eic</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="ReadCoreMSHDFMassSpectra-368"><a href="#ReadCoreMSHDFMassSpectra-368"><span class="linenos">368</span></a>                    <span class="c1"># if key is apexes, convert to a tuple of a list</span>
</span><span id="ReadCoreMSHDFMassSpectra-369"><a href="#ReadCoreMSHDFMassSpectra-369"><span class="linenos">369</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;apexes&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-370"><a href="#ReadCoreMSHDFMassSpectra-370"><span class="linenos">370</span></a>                        <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-371"><a href="#ReadCoreMSHDFMassSpectra-371"><span class="linenos">371</span></a>            <span class="c1"># Add to mass_spectra object</span>
</span><span id="ReadCoreMSHDFMassSpectra-372"><a href="#ReadCoreMSHDFMassSpectra-372"><span class="linenos">372</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;mz&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">my_eic</span>
</span><span id="ReadCoreMSHDFMassSpectra-373"><a href="#ReadCoreMSHDFMassSpectra-373"><span class="linenos">373</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-374"><a href="#ReadCoreMSHDFMassSpectra-374"><span class="linenos">374</span></a>        <span class="c1"># Add to mass features</span>
</span><span id="ReadCoreMSHDFMassSpectra-375"><a href="#ReadCoreMSHDFMassSpectra-375"><span class="linenos">375</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-376"><a href="#ReadCoreMSHDFMassSpectra-376"><span class="linenos">376</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">mz</span>
</span><span id="ReadCoreMSHDFMassSpectra-377"><a href="#ReadCoreMSHDFMassSpectra-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="n">mz</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-378"><a href="#ReadCoreMSHDFMassSpectra-378"><span class="linenos">378</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_eic_data</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">mz</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-379"><a href="#ReadCoreMSHDFMassSpectra-379"><span class="linenos">379</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-380"><a href="#ReadCoreMSHDFMassSpectra-380"><span class="linenos">380</span></a>    <span class="k">def</span> <span class="nf">import_spectral_search_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-381"><a href="#ReadCoreMSHDFMassSpectra-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the spectral search results from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-382"><a href="#ReadCoreMSHDFMassSpectra-382"><span class="linenos">382</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-383"><a href="#ReadCoreMSHDFMassSpectra-383"><span class="linenos">383</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-384"><a href="#ReadCoreMSHDFMassSpectra-384"><span class="linenos">384</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-385"><a href="#ReadCoreMSHDFMassSpectra-385"><span class="linenos">385</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-386"><a href="#ReadCoreMSHDFMassSpectra-386"><span class="linenos">386</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with spectral search results.</span>
</span><span id="ReadCoreMSHDFMassSpectra-387"><a href="#ReadCoreMSHDFMassSpectra-387"><span class="linenos">387</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-388"><a href="#ReadCoreMSHDFMassSpectra-388"><span class="linenos">388</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra-389"><a href="#ReadCoreMSHDFMassSpectra-389"><span class="linenos">389</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra-390"><a href="#ReadCoreMSHDFMassSpectra-390"><span class="linenos">390</span></a><span class="sd">        None, but populates the &#39;spectral_search_results&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-391"><a href="#ReadCoreMSHDFMassSpectra-391"><span class="linenos">391</span></a><span class="sd">        object with a dictionary of the &#39;spectral_search_results&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-392"><a href="#ReadCoreMSHDFMassSpectra-392"><span class="linenos">392</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-393"><a href="#ReadCoreMSHDFMassSpectra-393"><span class="linenos">393</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-394"><a href="#ReadCoreMSHDFMassSpectra-394"><span class="linenos">394</span></a>        <span class="n">overall_results_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra-395"><a href="#ReadCoreMSHDFMassSpectra-395"><span class="linenos">395</span></a>        <span class="n">ms2_results_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;spectral_search_results&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-396"><a href="#ReadCoreMSHDFMassSpectra-396"><span class="linenos">396</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-397"><a href="#ReadCoreMSHDFMassSpectra-397"><span class="linenos">397</span></a>            <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra-398"><a href="#ReadCoreMSHDFMassSpectra-398"><span class="linenos">398</span></a>            <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-399"><a href="#ReadCoreMSHDFMassSpectra-399"><span class="linenos">399</span></a>                <span class="n">ms2_search_res</span> <span class="o">=</span> <span class="n">SpectrumSearchResults</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-400"><a href="#ReadCoreMSHDFMassSpectra-400"><span class="linenos">400</span></a>                    <span class="n">query_spectrum</span><span class="o">=</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)],</span>
</span><span id="ReadCoreMSHDFMassSpectra-401"><a href="#ReadCoreMSHDFMassSpectra-401"><span class="linenos">401</span></a>                    <span class="n">precursor_mz</span><span class="o">=</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra-402"><a href="#ReadCoreMSHDFMassSpectra-402"><span class="linenos">402</span></a>                    <span class="n">spectral_similarity_search_results</span><span class="o">=</span><span class="p">{},</span>
</span><span id="ReadCoreMSHDFMassSpectra-403"><a href="#ReadCoreMSHDFMassSpectra-403"><span class="linenos">403</span></a>                <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-404"><a href="#ReadCoreMSHDFMassSpectra-404"><span class="linenos">404</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-405"><a href="#ReadCoreMSHDFMassSpectra-405"><span class="linenos">405</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">}:</span>
</span><span id="ReadCoreMSHDFMassSpectra-406"><a href="#ReadCoreMSHDFMassSpectra-406"><span class="linenos">406</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">ms2_search_res</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">][</span><span class="n">key</span><span class="p">][:]))</span>
</span><span id="ReadCoreMSHDFMassSpectra-407"><a href="#ReadCoreMSHDFMassSpectra-407"><span class="linenos">407</span></a>                <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)][</span>
</span><span id="ReadCoreMSHDFMassSpectra-408"><a href="#ReadCoreMSHDFMassSpectra-408"><span class="linenos">408</span></a>                    <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-409"><a href="#ReadCoreMSHDFMassSpectra-409"><span class="linenos">409</span></a>                <span class="p">]</span> <span class="o">=</span> <span class="n">ms2_search_res</span>
</span><span id="ReadCoreMSHDFMassSpectra-410"><a href="#ReadCoreMSHDFMassSpectra-410"><span class="linenos">410</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-411"><a href="#ReadCoreMSHDFMassSpectra-411"><span class="linenos">411</span></a>        <span class="c1"># add to mass_spectra</span>
</span><span id="ReadCoreMSHDFMassSpectra-412"><a href="#ReadCoreMSHDFMassSpectra-412"><span class="linenos">412</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">overall_results_dict</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-413"><a href="#ReadCoreMSHDFMassSpectra-413"><span class="linenos">413</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-414"><a href="#ReadCoreMSHDFMassSpectra-414"><span class="linenos">414</span></a>        <span class="c1"># If there are mass features, associate the results with each mass feature</span>
</span><span id="ReadCoreMSHDFMassSpectra-415"><a href="#ReadCoreMSHDFMassSpectra-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-416"><a href="#ReadCoreMSHDFMassSpectra-416"><span class="linenos">416</span></a>            <span class="k">for</span> <span class="n">mass_feature_id</span><span class="p">,</span> <span class="n">mass_feature</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-417"><a href="#ReadCoreMSHDFMassSpectra-417"><span class="linenos">417</span></a>                <span class="n">scan_ids</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">ms2_scan_numbers</span>
</span><span id="ReadCoreMSHDFMassSpectra-418"><a href="#ReadCoreMSHDFMassSpectra-418"><span class="linenos">418</span></a>                <span class="k">for</span> <span class="n">ms2_scan_id</span> <span class="ow">in</span> <span class="n">scan_ids</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-419"><a href="#ReadCoreMSHDFMassSpectra-419"><span class="linenos">419</span></a>                    <span class="n">precursor_mz</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">mz</span>
</span><span id="ReadCoreMSHDFMassSpectra-420"><a href="#ReadCoreMSHDFMassSpectra-420"><span class="linenos">420</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-421"><a href="#ReadCoreMSHDFMassSpectra-421"><span class="linenos">421</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span><span class="n">precursor_mz</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-422"><a href="#ReadCoreMSHDFMassSpectra-422"><span class="linenos">422</span></a>                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-423"><a href="#ReadCoreMSHDFMassSpectra-423"><span class="linenos">423</span></a>                        <span class="k">pass</span>
</span><span id="ReadCoreMSHDFMassSpectra-424"><a href="#ReadCoreMSHDFMassSpectra-424"><span class="linenos">424</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-425"><a href="#ReadCoreMSHDFMassSpectra-425"><span class="linenos">425</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra-426"><a href="#ReadCoreMSHDFMassSpectra-426"><span class="linenos">426</span></a>                            <span class="n">mass_feature_id</span>
</span><span id="ReadCoreMSHDFMassSpectra-427"><a href="#ReadCoreMSHDFMassSpectra-427"><span class="linenos">427</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">ms2_similarity_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-428"><a href="#ReadCoreMSHDFMassSpectra-428"><span class="linenos">428</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span>
</span><span id="ReadCoreMSHDFMassSpectra-429"><a href="#ReadCoreMSHDFMassSpectra-429"><span class="linenos">429</span></a>                                <span class="n">precursor_mz</span>
</span><span id="ReadCoreMSHDFMassSpectra-430"><a href="#ReadCoreMSHDFMassSpectra-430"><span class="linenos">430</span></a>                            <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-431"><a href="#ReadCoreMSHDFMassSpectra-431"><span class="linenos">431</span></a>                        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-432"><a href="#ReadCoreMSHDFMassSpectra-432"><span class="linenos">432</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-433"><a href="#ReadCoreMSHDFMassSpectra-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpectraBase</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-434"><a href="#ReadCoreMSHDFMassSpectra-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-435"><a href="#ReadCoreMSHDFMassSpectra-435"><span class="linenos">435</span></a><span class="sd">        Return mass spectra data object, populating the _ms list on MassSpectraBase object from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-436"><a href="#ReadCoreMSHDFMassSpectra-436"><span class="linenos">436</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-437"><a href="#ReadCoreMSHDFMassSpectra-437"><span class="linenos">437</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-438"><a href="#ReadCoreMSHDFMassSpectra-438"><span class="linenos">438</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-439"><a href="#ReadCoreMSHDFMassSpectra-439"><span class="linenos">439</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra-440"><a href="#ReadCoreMSHDFMassSpectra-440"><span class="linenos">440</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall spectra object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra-441"><a href="#ReadCoreMSHDFMassSpectra-441"><span class="linenos">441</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-442"><a href="#ReadCoreMSHDFMassSpectra-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-443"><a href="#ReadCoreMSHDFMassSpectra-443"><span class="linenos">443</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-444"><a href="#ReadCoreMSHDFMassSpectra-444"><span class="linenos">444</span></a>        <span class="n">spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-445"><a href="#ReadCoreMSHDFMassSpectra-445"><span class="linenos">445</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-446"><a href="#ReadCoreMSHDFMassSpectra-446"><span class="linenos">446</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-447"><a href="#ReadCoreMSHDFMassSpectra-447"><span class="linenos">447</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-448"><a href="#ReadCoreMSHDFMassSpectra-448"><span class="linenos">448</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-449"><a href="#ReadCoreMSHDFMassSpectra-449"><span class="linenos">449</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-450"><a href="#ReadCoreMSHDFMassSpectra-450"><span class="linenos">450</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-451"><a href="#ReadCoreMSHDFMassSpectra-451"><span class="linenos">451</span></a>        <span class="c1"># This will populate the _ms list on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra-452"><a href="#ReadCoreMSHDFMassSpectra-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-453"><a href="#ReadCoreMSHDFMassSpectra-453"><span class="linenos">453</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-454"><a href="#ReadCoreMSHDFMassSpectra-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="n">spectra_obj</span>
</span><span id="ReadCoreMSHDFMassSpectra-455"><a href="#ReadCoreMSHDFMassSpectra-455"><span class="linenos">455</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-456"><a href="#ReadCoreMSHDFMassSpectra-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-457"><a href="#ReadCoreMSHDFMassSpectra-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_original_parser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span>
</span><span id="ReadCoreMSHDFMassSpectra-458"><a href="#ReadCoreMSHDFMassSpectra-458"><span class="linenos">458</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LCMSBase</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-459"><a href="#ReadCoreMSHDFMassSpectra-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-460"><a href="#ReadCoreMSHDFMassSpectra-460"><span class="linenos">460</span></a><span class="sd">        Return LCMSBase object, populating attributes on the LCMSBase object from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-461"><a href="#ReadCoreMSHDFMassSpectra-461"><span class="linenos">461</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-462"><a href="#ReadCoreMSHDFMassSpectra-462"><span class="linenos">462</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-463"><a href="#ReadCoreMSHDFMassSpectra-463"><span class="linenos">463</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-464"><a href="#ReadCoreMSHDFMassSpectra-464"><span class="linenos">464</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra-465"><a href="#ReadCoreMSHDFMassSpectra-465"><span class="linenos">465</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra-466"><a href="#ReadCoreMSHDFMassSpectra-466"><span class="linenos">466</span></a><span class="sd">        use_original_parser : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra-467"><a href="#ReadCoreMSHDFMassSpectra-467"><span class="linenos">467</span></a><span class="sd">            If True, use the original parser to populate the LCMS object. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra-468"><a href="#ReadCoreMSHDFMassSpectra-468"><span class="linenos">468</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="ReadCoreMSHDFMassSpectra-469"><a href="#ReadCoreMSHDFMassSpectra-469"><span class="linenos">469</span></a><span class="sd">            The location of the raw file to parse if attempting to use original parser.</span>
</span><span id="ReadCoreMSHDFMassSpectra-470"><a href="#ReadCoreMSHDFMassSpectra-470"><span class="linenos">470</span></a><span class="sd">            Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-471"><a href="#ReadCoreMSHDFMassSpectra-471"><span class="linenos">471</span></a><span class="sd">            If the original file path has moved, this parameter can be used to specify the new location.</span>
</span><span id="ReadCoreMSHDFMassSpectra-472"><a href="#ReadCoreMSHDFMassSpectra-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-473"><a href="#ReadCoreMSHDFMassSpectra-473"><span class="linenos">473</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-474"><a href="#ReadCoreMSHDFMassSpectra-474"><span class="linenos">474</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-475"><a href="#ReadCoreMSHDFMassSpectra-475"><span class="linenos">475</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-476"><a href="#ReadCoreMSHDFMassSpectra-476"><span class="linenos">476</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-477"><a href="#ReadCoreMSHDFMassSpectra-477"><span class="linenos">477</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-478"><a href="#ReadCoreMSHDFMassSpectra-478"><span class="linenos">478</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-479"><a href="#ReadCoreMSHDFMassSpectra-479"><span class="linenos">479</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-480"><a href="#ReadCoreMSHDFMassSpectra-480"><span class="linenos">480</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-481"><a href="#ReadCoreMSHDFMassSpectra-481"><span class="linenos">481</span></a>        <span class="c1"># This will populate the majority of the attributes on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-482"><a href="#ReadCoreMSHDFMassSpectra-482"><span class="linenos">482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-483"><a href="#ReadCoreMSHDFMassSpectra-483"><span class="linenos">483</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-484"><a href="#ReadCoreMSHDFMassSpectra-484"><span class="linenos">484</span></a>        <span class="c1"># Set final attributes of the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-485"><a href="#ReadCoreMSHDFMassSpectra-485"><span class="linenos">485</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-486"><a href="#ReadCoreMSHDFMassSpectra-486"><span class="linenos">486</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-487"><a href="#ReadCoreMSHDFMassSpectra-487"><span class="linenos">487</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-488"><a href="#ReadCoreMSHDFMassSpectra-488"><span class="linenos">488</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-489"><a href="#ReadCoreMSHDFMassSpectra-489"><span class="linenos">489</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-490"><a href="#ReadCoreMSHDFMassSpectra-490"><span class="linenos">490</span></a>        <span class="c1"># If use_original_parser is True, instantiate the original parser and populate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra-491"><a href="#ReadCoreMSHDFMassSpectra-491"><span class="linenos">491</span></a>        <span class="k">if</span> <span class="n">use_original_parser</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-492"><a href="#ReadCoreMSHDFMassSpectra-492"><span class="linenos">492</span></a>            <span class="n">lcms_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_original_parser</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-493"><a href="#ReadCoreMSHDFMassSpectra-493"><span class="linenos">493</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-494"><a href="#ReadCoreMSHDFMassSpectra-494"><span class="linenos">494</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span><span id="ReadCoreMSHDFMassSpectra-495"><a href="#ReadCoreMSHDFMassSpectra-495"><span class="linenos">495</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-496"><a href="#ReadCoreMSHDFMassSpectra-496"><span class="linenos">496</span></a>    <span class="k">def</span> <span class="nf">add_original_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra-497"><a href="#ReadCoreMSHDFMassSpectra-497"><span class="linenos">497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-498"><a href="#ReadCoreMSHDFMassSpectra-498"><span class="linenos">498</span></a><span class="sd">        Add the original parser to the mass spectra object.</span>
</span><span id="ReadCoreMSHDFMassSpectra-499"><a href="#ReadCoreMSHDFMassSpectra-499"><span class="linenos">499</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-500"><a href="#ReadCoreMSHDFMassSpectra-500"><span class="linenos">500</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra-501"><a href="#ReadCoreMSHDFMassSpectra-501"><span class="linenos">501</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra-502"><a href="#ReadCoreMSHDFMassSpectra-502"><span class="linenos">502</span></a><span class="sd">        mass_spectra : MassSpectraBase | LCMSBase</span>
</span><span id="ReadCoreMSHDFMassSpectra-503"><a href="#ReadCoreMSHDFMassSpectra-503"><span class="linenos">503</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to add the original parser to.</span>
</span><span id="ReadCoreMSHDFMassSpectra-504"><a href="#ReadCoreMSHDFMassSpectra-504"><span class="linenos">504</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="ReadCoreMSHDFMassSpectra-505"><a href="#ReadCoreMSHDFMassSpectra-505"><span class="linenos">505</span></a><span class="sd">            The location of the raw file to parse. Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra-506"><a href="#ReadCoreMSHDFMassSpectra-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra-507"><a href="#ReadCoreMSHDFMassSpectra-507"><span class="linenos">507</span></a>        <span class="c1"># Try to get the raw file path from the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra-508"><a href="#ReadCoreMSHDFMassSpectra-508"><span class="linenos">508</span></a>        <span class="k">if</span> <span class="n">raw_file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-509"><a href="#ReadCoreMSHDFMassSpectra-509"><span class="linenos">509</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-510"><a href="#ReadCoreMSHDFMassSpectra-510"><span class="linenos">510</span></a>            <span class="c1"># Check if og_file_location exists, if not raise an error</span>
</span><span id="ReadCoreMSHDFMassSpectra-511"><a href="#ReadCoreMSHDFMassSpectra-511"><span class="linenos">511</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-512"><a href="#ReadCoreMSHDFMassSpectra-512"><span class="linenos">512</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-513"><a href="#ReadCoreMSHDFMassSpectra-513"><span class="linenos">513</span></a>        <span class="n">raw_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-514"><a href="#ReadCoreMSHDFMassSpectra-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">raw_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra-515"><a href="#ReadCoreMSHDFMassSpectra-515"><span class="linenos">515</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra-516"><a href="#ReadCoreMSHDFMassSpectra-516"><span class="linenos">516</span></a>                <span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">),</span>
</span><span id="ReadCoreMSHDFMassSpectra-517"><a href="#ReadCoreMSHDFMassSpectra-517"><span class="linenos">517</span></a>                <span class="s2">&quot;. Cannot use original parser for instatiating the lcms_obj.&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra-518"><a href="#ReadCoreMSHDFMassSpectra-518"><span class="linenos">518</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-519"><a href="#ReadCoreMSHDFMassSpectra-519"><span class="linenos">519</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-520"><a href="#ReadCoreMSHDFMassSpectra-520"><span class="linenos">520</span></a>        <span class="c1"># Get the original parser type</span>
</span><span id="ReadCoreMSHDFMassSpectra-521"><a href="#ReadCoreMSHDFMassSpectra-521"><span class="linenos">521</span></a>        <span class="n">og_parser_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;parser_type&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra-522"><a href="#ReadCoreMSHDFMassSpectra-522"><span class="linenos">522</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-523"><a href="#ReadCoreMSHDFMassSpectra-523"><span class="linenos">523</span></a>        <span class="k">if</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;ImportMassSpectraThermoMSFileReader&quot;</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-524"><a href="#ReadCoreMSHDFMassSpectra-524"><span class="linenos">524</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">ImportMassSpectraThermoMSFileReader</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-525"><a href="#ReadCoreMSHDFMassSpectra-525"><span class="linenos">525</span></a>        <span class="k">elif</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;MZMLSpectraParser&quot;</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra-526"><a href="#ReadCoreMSHDFMassSpectra-526"><span class="linenos">526</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">MZMLSpectraParser</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra-527"><a href="#ReadCoreMSHDFMassSpectra-527"><span class="linenos">527</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-528"><a href="#ReadCoreMSHDFMassSpectra-528"><span class="linenos">528</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser_class</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="vm">__class__</span>
</span><span id="ReadCoreMSHDFMassSpectra-529"><a href="#ReadCoreMSHDFMassSpectra-529"><span class="linenos">529</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser</span> <span class="o">=</span> <span class="n">parser</span>
</span><span id="ReadCoreMSHDFMassSpectra-530"><a href="#ReadCoreMSHDFMassSpectra-530"><span class="linenos">530</span></a>
</span><span id="ReadCoreMSHDFMassSpectra-531"><a href="#ReadCoreMSHDFMassSpectra-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="n">mass_spectra</span>
</span></pre></div>


            <div class="docstring"><p>Class to read CoreMS HDF5 files and populate a LCMS or MassSpectraBase object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>file_location</strong> (str):
The location of the HDF5 file to read, including the suffix.</li>
</ul>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>file_location</strong> (str):
The location of the HDF5 file to read.</li>
<li><strong>h5pydata</strong> (h5py.File):
The HDF5 file object.</li>
<li><strong>scans</strong> (list):
A list of the location of individual mass spectra within the HDF5 file.</li>
<li><strong>scan_number_list</strong> (list):
A list of the scan numbers of the mass spectra within the HDF5 file.</li>
<li><strong>parameters_location</strong> (str):
The location of the parameters file (json or toml).</li>
</ul>

<h6 id="methods">Methods</h6>

<ul>
<li>import_mass_spectra(mass_spectra).
Imports all mass spectra from the HDF5 file onto the LCMS or MassSpectraBase object.</li>
<li>get_mass_spectrum_from_scan(scan_number).
Return mass spectrum data object from scan number.</li>
<li>load().
Placeholder method to meet the requirements of the SpectraParserInterface.</li>
<li>run(mass_spectra).
Runs the importer functions to populate a LCMS or MassSpectraBase object.</li>
<li>import_scan_info(mass_spectra).
Imports the scan info from the HDF5 file to populate the _scan_info attribute
on the LCMS or MassSpectraBase object</li>
<li>import_ms_unprocessed(mass_spectra).
Imports the unprocessed mass spectra from the HDF5 file to populate the
_ms_unprocessed attribute on the LCMS or MassSpectraBase object</li>
<li>import_parameters(mass_spectra).
Imports the parameters from the HDF5 file to populate the parameters
attribute on the LCMS or MassSpectraBase object</li>
<li>import_mass_features(mass_spectra).
Imports the mass features from the HDF5 file to populate the mass_features
attribute on the LCMS or MassSpectraBase object</li>
<li>import_eics(mass_spectra).
Imports the extracted ion chromatograms from the HDF5 file to populate the
eics attribute on the LCMS or MassSpectraBase object</li>
<li>import_spectral_search_results(mass_spectra).
Imports the spectral search results from the HDF5 file to populate the
spectral_search_results attribute on the LCMS or MassSpectraBase object</li>
<li>get_mass_spectra_obj().
Return mass spectra data object, populating the _ms list on the LCMS or
MassSpectraBase object from the HDF5 file</li>
<li>get_lcms_obj().
Return LCMSBase object, populating the majority of the attributes on the
LCMS object from the HDF5 file</li>
</ul>
</div>


                            <div id="ReadCoreMSHDFMassSpectra.__init__" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ReadCoreMSHDFMassSpectra</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">file_location</span><span class="p">:</span> <span class="nb">str</span></span>)</span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.__init__-85"><a href="#ReadCoreMSHDFMassSpectra.__init__-85"><span class="linenos"> 85</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-86"><a href="#ReadCoreMSHDFMassSpectra.__init__-86"><span class="linenos"> 86</span></a>        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-87"><a href="#ReadCoreMSHDFMassSpectra.__init__-87"><span class="linenos"> 87</span></a>        <span class="n">ReadCoreMSHDF_MassSpectrum</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-88"><a href="#ReadCoreMSHDFMassSpectra.__init__-88"><span class="linenos"> 88</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-89"><a href="#ReadCoreMSHDFMassSpectra.__init__-89"><span class="linenos"> 89</span></a>        <span class="c1"># override the scans attribute on ReadCoreMSHDF_MassSpectrum class to expect a nested location within the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-90"><a href="#ReadCoreMSHDFMassSpectra.__init__-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scans</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-91"><a href="#ReadCoreMSHDFMassSpectra.__init__-91"><span class="linenos"> 91</span></a>            <span class="s2">&quot;mass_spectra/&quot;</span> <span class="o">+</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-92"><a href="#ReadCoreMSHDFMassSpectra.__init__-92"><span class="linenos"> 92</span></a>        <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-93"><a href="#ReadCoreMSHDFMassSpectra.__init__-93"><span class="linenos"> 93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-94"><a href="#ReadCoreMSHDFMassSpectra.__init__-94"><span class="linenos"> 94</span></a>            <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_spectra&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-95"><a href="#ReadCoreMSHDFMassSpectra.__init__-95"><span class="linenos"> 95</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-96"><a href="#ReadCoreMSHDFMassSpectra.__init__-96"><span class="linenos"> 96</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-97"><a href="#ReadCoreMSHDFMassSpectra.__init__-97"><span class="linenos"> 97</span></a>        <span class="c1"># set the location of the parameters file (json or toml)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-98"><a href="#ReadCoreMSHDFMassSpectra.__init__-98"><span class="linenos"> 98</span></a>        <span class="n">add_files</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-99"><a href="#ReadCoreMSHDFMassSpectra.__init__-99"><span class="linenos"> 99</span></a>            <span class="n">x</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-100"><a href="#ReadCoreMSHDFMassSpectra.__init__-100"><span class="linenos">100</span></a>            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-101"><a href="#ReadCoreMSHDFMassSpectra.__init__-101"><span class="linenos">101</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.hdf5&quot;</span><span class="p">,</span> <span class="s2">&quot;.*&quot;</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-102"><a href="#ReadCoreMSHDFMassSpectra.__init__-102"><span class="linenos">102</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-103"><a href="#ReadCoreMSHDFMassSpectra.__init__-103"><span class="linenos">103</span></a>            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">&quot;.hdf5&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-104"><a href="#ReadCoreMSHDFMassSpectra.__init__-104"><span class="linenos">104</span></a>        <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-105"><a href="#ReadCoreMSHDFMassSpectra.__init__-105"><span class="linenos">105</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-106"><a href="#ReadCoreMSHDFMassSpectra.__init__-106"><span class="linenos">106</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.json&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-107"><a href="#ReadCoreMSHDFMassSpectra.__init__-107"><span class="linenos">107</span></a>        <span class="k">elif</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-108"><a href="#ReadCoreMSHDFMassSpectra.__init__-108"><span class="linenos">108</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">add_files</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s2">&quot;.toml&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-109"><a href="#ReadCoreMSHDFMassSpectra.__init__-109"><span class="linenos">109</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.__init__-110"><a href="#ReadCoreMSHDFMassSpectra.__init__-110"><span class="linenos">110</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>This constructor should always be called with keyword arguments. Arguments are:</p>

<p><em>group</em> should be None; reserved for future extension when a ThreadGroup
class is implemented.</p>

<p><em>target</em> is the callable object to be invoked by the run()
method. Defaults to None, meaning nothing is called.</p>

<p><em>name</em> is the thread name. By default, a unique name is constructed of
the form "Thread-N" where N is a small decimal number.</p>

<p><em>args</em> is the argument tuple for the target invocation. Defaults to ().</p>

<p><em>kwargs</em> is a dictionary of keyword arguments for the target
invocation. Defaults to {}.</p>

<p>If a subclass overrides the constructor, it must make sure to invoke
the base class constructor (Thread.__init__()) before doing anything
else to the thread.</p>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.scans" class="classattr">
                                <div class="attr variable">
            <span class="name">scans</span>

        
    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.scans"></a>
    
    

                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.scan_number_list" class="classattr">
                                <div class="attr variable">
            <span class="name">scan_number_list</span>

        
    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.scan_number_list"></a>
    
    

                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_mass_spectrum_from_scan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">scan_number</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-112"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectrum_from_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">scan_number</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-113"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return mass spectrum data object from scan number.&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-114"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-114"><span class="linenos">114</span></a>        <span class="k">if</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-115"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-115"><span class="linenos">115</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-116"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-116"><span class="linenos">116</span></a>            <span class="k">return</span> <span class="n">mass_spec</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-117"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-117"><span class="linenos">117</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-118"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectrum_from_scan-118"><span class="linenos">118</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Scan number not found in HDF5 file.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return mass spectrum data object from scan number.</p>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.load" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.load-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.load-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.load"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.load-120"><a href="#ReadCoreMSHDFMassSpectra.load-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.load-121"><a href="#ReadCoreMSHDFMassSpectra.load-121"><span class="linenos">121</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.load-122"><a href="#ReadCoreMSHDFMassSpectra.load-122"><span class="linenos">122</span></a>        <span class="k">pass</span>
</span></pre></div>


    

                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.get_ms_raw" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.get_ms_raw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_ms_raw</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">spectra</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.get_ms_raw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.get_ms_raw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-124"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-124"><span class="linenos">124</span></a>    <span class="k">def</span> <span class="nf">get_ms_raw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectra</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scan_df</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-125"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-125"><span class="linenos">125</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-126"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-126"><span class="linenos">126</span></a>        <span class="c1"># Warn if spectra or scan_df are not None that they are not used for CoreMS HDF5 files and should be rerun after instantiation</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-127"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-127"><span class="linenos">127</span></a>        <span class="k">if</span> <span class="n">spectra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">scan_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-128"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-128"><span class="linenos">128</span></a>            <span class="ne">SyntaxWarning</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-129"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-129"><span class="linenos">129</span></a>                <span class="s2">&quot;get_ms_raw method for CoreMS HDF5 files can only access saved data, consider rerunning after instantiation.&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-130"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-130"><span class="linenos">130</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-131"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-131"><span class="linenos">131</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-132"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-132"><span class="linenos">132</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;ms_unprocessed&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-133"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-133"><span class="linenos">133</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-134"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-135"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-135"><span class="linenos">135</span></a>            <span class="n">ms_up_int</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-136"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-136"><span class="linenos">136</span></a>            <span class="n">ms_unprocessed</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-137"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-137"><span class="linenos">137</span></a>                <span class="n">ms_up_int</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="s2">&quot;mz&quot;</span><span class="p">,</span> <span class="s2">&quot;intensity&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-138"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-138"><span class="linenos">138</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_ms_raw-139"><a href="#ReadCoreMSHDFMassSpectra.get_ms_raw-139"><span class="linenos">139</span></a>        <span class="k">return</span> <span class="n">ms_unprocessed</span>
</span></pre></div>


    

                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.get_scan_df" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.get_scan_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_scan_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.get_scan_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.get_scan_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-141"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-141"><span class="linenos">141</span></a>    <span class="k">def</span> <span class="nf">get_scan_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-142"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-142"><span class="linenos">142</span></a>        <span class="n">scan_info</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-143"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-143"><span class="linenos">143</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;scan_info&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-144"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-144"><span class="linenos">144</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-145"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-145"><span class="linenos">145</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-146"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-146"><span class="linenos">146</span></a>            <span class="n">scan_info</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][:]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-147"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-147"><span class="linenos">147</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">scan_info</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-148"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-148"><span class="linenos">148</span></a>        <span class="n">scan_df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;scan&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-149"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-149"><span class="linenos">149</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">scan_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">([</span><span class="nb">object</span><span class="p">])</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-150"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-150"><span class="linenos">150</span></a>        <span class="n">str_df</span> <span class="o">=</span> <span class="n">str_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-151"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-151"><span class="linenos">151</span></a>        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">str_df</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-152"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-152"><span class="linenos">152</span></a>            <span class="n">scan_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">str_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_scan_df-153"><a href="#ReadCoreMSHDFMassSpectra.get_scan_df-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="n">scan_df</span>
</span></pre></div>


            <div class="docstring"><p>Return scan data as a pandas DataFrame.</p>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.run" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.run-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">run</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span>, </span><span class="param"><span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.run-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.run"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.run-155"><a href="#ReadCoreMSHDFMassSpectra.run-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-156"><a href="#ReadCoreMSHDFMassSpectra.run-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Runs the importer functions to populate a LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-157"><a href="#ReadCoreMSHDFMassSpectra.run-157"><span class="linenos">157</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-158"><a href="#ReadCoreMSHDFMassSpectra.run-158"><span class="linenos">158</span></a><span class="sd">        Notes</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-159"><a href="#ReadCoreMSHDFMassSpectra.run-159"><span class="linenos">159</span></a><span class="sd">        -----</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-160"><a href="#ReadCoreMSHDFMassSpectra.run-160"><span class="linenos">160</span></a><span class="sd">        The following functions are run in order, if the HDF5 file contains the necessary data:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-161"><a href="#ReadCoreMSHDFMassSpectra.run-161"><span class="linenos">161</span></a><span class="sd">        1. import_parameters(), which populates the parameters attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-162"><a href="#ReadCoreMSHDFMassSpectra.run-162"><span class="linenos">162</span></a><span class="sd">        2. import_mass_spectra(), which populates the _ms list on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-163"><a href="#ReadCoreMSHDFMassSpectra.run-163"><span class="linenos">163</span></a><span class="sd">        3. import_scan_info(), which populates the _scan_info on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-164"><a href="#ReadCoreMSHDFMassSpectra.run-164"><span class="linenos">164</span></a><span class="sd">        4. import_ms_unprocessed(), which populates the _ms_unprocessed attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-165"><a href="#ReadCoreMSHDFMassSpectra.run-165"><span class="linenos">165</span></a><span class="sd">        5. import_mass_features(), which populates the mass_features attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-166"><a href="#ReadCoreMSHDFMassSpectra.run-166"><span class="linenos">166</span></a><span class="sd">        6. import_eics(), which populates the eics attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-167"><a href="#ReadCoreMSHDFMassSpectra.run-167"><span class="linenos">167</span></a><span class="sd">        7. import_spectral_search_results(), which populates the spectral_search_results attribute on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-168"><a href="#ReadCoreMSHDFMassSpectra.run-168"><span class="linenos">168</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-169"><a href="#ReadCoreMSHDFMassSpectra.run-169"><span class="linenos">169</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-170"><a href="#ReadCoreMSHDFMassSpectra.run-170"><span class="linenos">170</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-171"><a href="#ReadCoreMSHDFMassSpectra.run-171"><span class="linenos">171</span></a><span class="sd">        mass_spectra : LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-172"><a href="#ReadCoreMSHDFMassSpectra.run-172"><span class="linenos">172</span></a><span class="sd">            The LCMS or MassSpectraBase object to populate with mass spectra, generally instantiated with only the file_location, analyzer, and instrument_label attributes.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-173"><a href="#ReadCoreMSHDFMassSpectra.run-173"><span class="linenos">173</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-174"><a href="#ReadCoreMSHDFMassSpectra.run-174"><span class="linenos">174</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-175"><a href="#ReadCoreMSHDFMassSpectra.run-175"><span class="linenos">175</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-176"><a href="#ReadCoreMSHDFMassSpectra.run-176"><span class="linenos">176</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-177"><a href="#ReadCoreMSHDFMassSpectra.run-177"><span class="linenos">177</span></a><span class="sd">        None, but populates several attributes on the LCMS or MassSpectraBase object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-178"><a href="#ReadCoreMSHDFMassSpectra.run-178"><span class="linenos">178</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-179"><a href="#ReadCoreMSHDFMassSpectra.run-179"><span class="linenos">179</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-180"><a href="#ReadCoreMSHDFMassSpectra.run-180"><span class="linenos">180</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-181"><a href="#ReadCoreMSHDFMassSpectra.run-181"><span class="linenos">181</span></a>            <span class="c1"># Populate the parameters attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-182"><a href="#ReadCoreMSHDFMassSpectra.run-182"><span class="linenos">182</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_parameters</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-183"><a href="#ReadCoreMSHDFMassSpectra.run-183"><span class="linenos">183</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-184"><a href="#ReadCoreMSHDFMassSpectra.run-184"><span class="linenos">184</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_spectra&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-185"><a href="#ReadCoreMSHDFMassSpectra.run-185"><span class="linenos">185</span></a>            <span class="c1"># Populate the _ms list on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-186"><a href="#ReadCoreMSHDFMassSpectra.run-186"><span class="linenos">186</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_spectra</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-187"><a href="#ReadCoreMSHDFMassSpectra.run-187"><span class="linenos">187</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-188"><a href="#ReadCoreMSHDFMassSpectra.run-188"><span class="linenos">188</span></a>        <span class="k">if</span> <span class="s2">&quot;scan_info&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-189"><a href="#ReadCoreMSHDFMassSpectra.run-189"><span class="linenos">189</span></a>            <span class="c1"># Populate the _scan_info attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-190"><a href="#ReadCoreMSHDFMassSpectra.run-190"><span class="linenos">190</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_scan_info</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-191"><a href="#ReadCoreMSHDFMassSpectra.run-191"><span class="linenos">191</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-192"><a href="#ReadCoreMSHDFMassSpectra.run-192"><span class="linenos">192</span></a>        <span class="k">if</span> <span class="s2">&quot;ms_unprocessed&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span> <span class="ow">and</span> <span class="n">load_raw</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-193"><a href="#ReadCoreMSHDFMassSpectra.run-193"><span class="linenos">193</span></a>            <span class="c1"># Populate the _ms_unprocessed attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-194"><a href="#ReadCoreMSHDFMassSpectra.run-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_ms_unprocessed</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-195"><a href="#ReadCoreMSHDFMassSpectra.run-195"><span class="linenos">195</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-196"><a href="#ReadCoreMSHDFMassSpectra.run-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="s2">&quot;mass_features&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-197"><a href="#ReadCoreMSHDFMassSpectra.run-197"><span class="linenos">197</span></a>            <span class="c1"># Populate the mass_features attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-198"><a href="#ReadCoreMSHDFMassSpectra.run-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_mass_features</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-199"><a href="#ReadCoreMSHDFMassSpectra.run-199"><span class="linenos">199</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-200"><a href="#ReadCoreMSHDFMassSpectra.run-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="s2">&quot;eics&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-201"><a href="#ReadCoreMSHDFMassSpectra.run-201"><span class="linenos">201</span></a>            <span class="c1"># Populate the eics attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-202"><a href="#ReadCoreMSHDFMassSpectra.run-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_eics</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-203"><a href="#ReadCoreMSHDFMassSpectra.run-203"><span class="linenos">203</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.run-204"><a href="#ReadCoreMSHDFMassSpectra.run-204"><span class="linenos">204</span></a>        <span class="k">if</span> <span class="s2">&quot;spectral_search_results&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-205"><a href="#ReadCoreMSHDFMassSpectra.run-205"><span class="linenos">205</span></a>            <span class="c1"># Populate the spectral_search_results attribute on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.run-206"><a href="#ReadCoreMSHDFMassSpectra.run-206"><span class="linenos">206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">import_spectral_search_results</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Runs the importer functions to populate a LCMS or MassSpectraBase object.</p>

<h6 id="notes">Notes</h6>

<p>The following functions are run in order, if the HDF5 file contains the necessary data:</p>

<ol>
<li>import_parameters(), which populates the parameters attribute on the LCMS or MassSpectraBase object.</li>
<li>import_mass_spectra(), which populates the _ms list on the LCMS or MassSpectraBase object.</li>
<li>import_scan_info(), which populates the _scan_info on the LCMS or MassSpectraBase object.</li>
<li>import_ms_unprocessed(), which populates the _ms_unprocessed attribute on the LCMS or MassSpectraBase object.</li>
<li>import_mass_features(), which populates the mass_features attribute on the LCMS or MassSpectraBase object.</li>
<li>import_eics(), which populates the eics attribute on the LCMS or MassSpectraBase object.</li>
<li>import_spectral_search_results(), which populates the spectral_search_results attribute on the LCMS or MassSpectraBase object.</li>
</ol>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase or MassSpectraBase):
The LCMS or MassSpectraBase object to populate with mass spectra, generally instantiated with only the file_location, analyzer, and instrument_label attributes.</li>
<li><strong>load_raw</strong> (bool):
If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates several attributes on the LCMS or MassSpectraBase object.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_mass_spectra" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_mass_spectra-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_mass_spectra</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span>, </span><span class="param"><span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_mass_spectra-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_mass_spectra"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-208"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-208"><span class="linenos">208</span></a>    <span class="k">def</span> <span class="nf">import_mass_spectra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-209"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-209"><span class="linenos">209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports all mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-210"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-210"><span class="linenos">210</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-211"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-211"><span class="linenos">211</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-212"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-212"><span class="linenos">212</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-213"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-213"><span class="linenos">213</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-214"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-214"><span class="linenos">214</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass spectra.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-215"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-215"><span class="linenos">215</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-216"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-216"><span class="linenos">216</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-217"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-217"><span class="linenos">217</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-218"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-218"><span class="linenos">218</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-219"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-219"><span class="linenos">219</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-220"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-220"><span class="linenos">220</span></a><span class="sd">        None, but populates the &#39;_ms&#39; list on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-221"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-221"><span class="linenos">221</span></a><span class="sd">        object with mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-222"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-222"><span class="linenos">222</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-223"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-223"><span class="linenos">223</span></a>        <span class="k">for</span> <span class="n">scan_number</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_number_list</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-224"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-224"><span class="linenos">224</span></a>            <span class="n">mass_spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mass_spectrum</span><span class="p">(</span><span class="n">scan_number</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-225"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-225"><span class="linenos">225</span></a>            <span class="n">mass_spec</span><span class="o">.</span><span class="n">scan_number</span> <span class="o">=</span> <span class="n">scan_number</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_spectra-226"><a href="#ReadCoreMSHDFMassSpectra.import_mass_spectra-226"><span class="linenos">226</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">add_mass_spectrum</span><span class="p">(</span><span class="n">mass_spec</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Imports all mass spectra from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase object to populate with mass spectra.</li>
<li><strong>load_raw</strong> (bool):
If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the '_ms' list on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with mass spectra from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_scan_info" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_scan_info-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_scan_info</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_scan_info-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_scan_info"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-228"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-228"><span class="linenos">228</span></a>    <span class="k">def</span> <span class="nf">import_scan_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-229"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-229"><span class="linenos">229</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the scan info from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-230"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-230"><span class="linenos">230</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-231"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-231"><span class="linenos">231</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-232"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-232"><span class="linenos">232</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-233"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-233"><span class="linenos">233</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-234"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-234"><span class="linenos">234</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-235"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-235"><span class="linenos">235</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-236"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-236"><span class="linenos">236</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-237"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-237"><span class="linenos">237</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-238"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-238"><span class="linenos">238</span></a><span class="sd">        None, but populates the &#39;scan_df&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-239"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-239"><span class="linenos">239</span></a><span class="sd">        object with a pandas DataFrame of the &#39;scan_info&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-240"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-240"><span class="linenos">240</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-241"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-241"><span class="linenos">241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-242"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-242"><span class="linenos">242</span></a>        <span class="n">scan_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scan_df</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_scan_info-243"><a href="#ReadCoreMSHDFMassSpectra.import_scan_info-243"><span class="linenos">243</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">scan_df</span> <span class="o">=</span> <span class="n">scan_df</span>
</span></pre></div>


            <div class="docstring"><p>Imports the scan info from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lcms</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase objects</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the 'scan_df' attribute on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with a pandas DataFrame of the 'scan_info' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_ms_unprocessed</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-245"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-245"><span class="linenos">245</span></a>    <span class="k">def</span> <span class="nf">import_ms_unprocessed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-246"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-246"><span class="linenos">246</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the unprocessed mass spectra from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-247"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-247"><span class="linenos">247</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-248"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-248"><span class="linenos">248</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-249"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-249"><span class="linenos">249</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-250"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-250"><span class="linenos">250</span></a><span class="sd">        lcms : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-251"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-251"><span class="linenos">251</span></a><span class="sd">            The MassSpectraBase or LCMSBase objects</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-252"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-252"><span class="linenos">252</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-253"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-253"><span class="linenos">253</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-254"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-254"><span class="linenos">254</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-255"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-255"><span class="linenos">255</span></a><span class="sd">        None, but populates the &#39;_ms_unprocessed&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-256"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-256"><span class="linenos">256</span></a><span class="sd">        object with a dictionary of the &#39;ms_unprocessed&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-257"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-257"><span class="linenos">257</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-258"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-258"><span class="linenos">258</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-259"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-259"><span class="linenos">259</span></a>        <span class="n">ms_unprocessed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_ms_raw</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_ms_unprocessed-260"><a href="#ReadCoreMSHDFMassSpectra.import_ms_unprocessed-260"><span class="linenos">260</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms_unprocessed</span> <span class="o">=</span> <span class="n">ms_unprocessed</span>
</span></pre></div>


            <div class="docstring"><p>Imports the unprocessed mass spectra from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>lcms</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase objects</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the '_ms_unprocessed' attribute on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with a dictionary of the 'ms_unprocessed' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_parameters" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_parameters-262"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-262"><span class="linenos">262</span></a>    <span class="k">def</span> <span class="nf">import_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-263"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the parameters from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-264"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-264"><span class="linenos">264</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-265"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-265"><span class="linenos">265</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-266"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-266"><span class="linenos">266</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-267"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-267"><span class="linenos">267</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-268"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-268"><span class="linenos">268</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with parameters.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-269"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-269"><span class="linenos">269</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-270"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-270"><span class="linenos">270</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-271"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-271"><span class="linenos">271</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-272"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-272"><span class="linenos">272</span></a><span class="sd">        None, but populates the &#39;parameters&#39; attribute on the LCMS or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-273"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-273"><span class="linenos">273</span></a><span class="sd">        object with a dictionary of the &#39;parameters&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-274"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-274"><span class="linenos">274</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-275"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-275"><span class="linenos">275</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-276"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-276"><span class="linenos">276</span></a>        <span class="k">if</span> <span class="s2">&quot;.json&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-277"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-277"><span class="linenos">277</span></a>            <span class="n">load_and_set_json_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-278"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-278"><span class="linenos">278</span></a>        <span class="k">if</span> <span class="s2">&quot;.toml&quot;</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="o">.</span><span class="n">suffix</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-279"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-279"><span class="linenos">279</span></a>            <span class="n">load_and_set_toml_parameters_lcms</span><span class="p">(</span><span class="n">mass_spectra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters_location</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-280"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-280"><span class="linenos">280</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-281"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-281"><span class="linenos">281</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-282"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-282"><span class="linenos">282</span></a>                <span class="s2">&quot;Parameters file must be in JSON format, TOML format is not yet supported.&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_parameters-283"><a href="#ReadCoreMSHDFMassSpectra.import_parameters-283"><span class="linenos">283</span></a>            <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Imports the parameters from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase object to populate with parameters.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the 'parameters' attribute on the LCMS or MassSpectraBase</strong></li>
<li><strong>object with a dictionary of the 'parameters' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_mass_features" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_mass_features-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_mass_features</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_mass_features-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_mass_features"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-285"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-285"><span class="linenos">285</span></a>    <span class="k">def</span> <span class="nf">import_mass_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-286"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the mass features from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-287"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-287"><span class="linenos">287</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-288"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-288"><span class="linenos">288</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-289"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-289"><span class="linenos">289</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-290"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-290"><span class="linenos">290</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-291"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-291"><span class="linenos">291</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with mass features.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-292"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-292"><span class="linenos">292</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-293"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-293"><span class="linenos">293</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-294"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-294"><span class="linenos">294</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-295"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-295"><span class="linenos">295</span></a><span class="sd">        None, but populates the &#39;mass_features&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-296"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-296"><span class="linenos">296</span></a><span class="sd">        object with a dictionary of the &#39;mass_features&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-297"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-297"><span class="linenos">297</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-298"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-299"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-299"><span class="linenos">299</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;mass_features&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-300"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-300"><span class="linenos">300</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-301"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-301"><span class="linenos">301</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-302"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-302"><span class="linenos">302</span></a>            <span class="c1"># Instantiate the MassFeature object</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-303"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-303"><span class="linenos">303</span></a>            <span class="n">mass_feature</span> <span class="o">=</span> <span class="n">LCMSMassFeature</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-304"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-304"><span class="linenos">304</span></a>                <span class="n">mass_spectra</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-305"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-305"><span class="linenos">305</span></a>                <span class="n">mz</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_mz_exp&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-306"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-306"><span class="linenos">306</span></a>                <span class="n">retention_time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_retention_time&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-307"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-307"><span class="linenos">307</span></a>                <span class="n">intensity</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_intensity&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-308"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-308"><span class="linenos">308</span></a>                <span class="n">apex_scan</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_apex_scan&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-309"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-309"><span class="linenos">309</span></a>                <span class="n">persistence</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;_persistence&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-310"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-310"><span class="linenos">310</span></a>                <span class="nb">id</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">),</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-311"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-311"><span class="linenos">311</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-312"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-312"><span class="linenos">312</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-313"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-313"><span class="linenos">313</span></a>            <span class="c1"># Populate additional attributes on the MassFeature object</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-314"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-314"><span class="linenos">314</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-315"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-315"><span class="linenos">315</span></a>                <span class="s2">&quot;_mz_exp&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-316"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-316"><span class="linenos">316</span></a>                <span class="s2">&quot;_mz_cal&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-317"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-317"><span class="linenos">317</span></a>                <span class="s2">&quot;_retention_time&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-318"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-318"><span class="linenos">318</span></a>                <span class="s2">&quot;_intensity&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-319"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-319"><span class="linenos">319</span></a>                <span class="s2">&quot;_apex_scan&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-320"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-320"><span class="linenos">320</span></a>                <span class="s2">&quot;_persistence&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-321"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-321"><span class="linenos">321</span></a>            <span class="p">}:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-322"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-322"><span class="linenos">322</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-323"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-323"><span class="linenos">323</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-324"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-324"><span class="linenos">324</span></a>            <span class="c1"># Populate attributes on MassFeature object that are lists</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-325"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-325"><span class="linenos">325</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-326"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-326"><span class="linenos">326</span></a>                <span class="nb">setattr</span><span class="p">(</span><span class="n">mass_feature</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-327"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-327"><span class="linenos">327</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-328"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-328"><span class="linenos">328</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">mass_feature</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-329"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-329"><span class="linenos">329</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-330"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-330"><span class="linenos">330</span></a>        <span class="c1"># Associate mass features with ms1 and ms2 spectra, if available</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-331"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-331"><span class="linenos">331</span></a>        <span class="k">for</span> <span class="n">mf_id</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-332"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-333"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-333"><span class="linenos">333</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">mass_spectrum</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-334"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-334"><span class="linenos">334</span></a>                    <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">apex_scan</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-335"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-335"><span class="linenos">335</span></a>                <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-336"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-336"><span class="linenos">336</span></a>            <span class="k">if</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-337"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-337"><span class="linenos">337</span></a>                <span class="k">for</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_scan_numbers</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-338"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-338"><span class="linenos">338</span></a>                    <span class="k">if</span> <span class="n">ms2_scan</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-339"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-339"><span class="linenos">339</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">mf_id</span><span class="p">]</span><span class="o">.</span><span class="n">ms2_mass_spectra</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-340"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-340"><span class="linenos">340</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="n">ms2_scan</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_mass_features-341"><a href="#ReadCoreMSHDFMassSpectra.import_mass_features-341"><span class="linenos">341</span></a>                        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Imports the mass features from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase object to populate with mass features.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the 'mass_features' attribute on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with a dictionary of the 'mass_features' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_eics" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_eics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_eics</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_eics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_eics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_eics-343"><a href="#ReadCoreMSHDFMassSpectra.import_eics-343"><span class="linenos">343</span></a>    <span class="k">def</span> <span class="nf">import_eics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-344"><a href="#ReadCoreMSHDFMassSpectra.import_eics-344"><span class="linenos">344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the extracted ion chromatograms from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-345"><a href="#ReadCoreMSHDFMassSpectra.import_eics-345"><span class="linenos">345</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-346"><a href="#ReadCoreMSHDFMassSpectra.import_eics-346"><span class="linenos">346</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-347"><a href="#ReadCoreMSHDFMassSpectra.import_eics-347"><span class="linenos">347</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-348"><a href="#ReadCoreMSHDFMassSpectra.import_eics-348"><span class="linenos">348</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-349"><a href="#ReadCoreMSHDFMassSpectra.import_eics-349"><span class="linenos">349</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with extracted ion chromatograms.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-350"><a href="#ReadCoreMSHDFMassSpectra.import_eics-350"><span class="linenos">350</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-351"><a href="#ReadCoreMSHDFMassSpectra.import_eics-351"><span class="linenos">351</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-352"><a href="#ReadCoreMSHDFMassSpectra.import_eics-352"><span class="linenos">352</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-353"><a href="#ReadCoreMSHDFMassSpectra.import_eics-353"><span class="linenos">353</span></a><span class="sd">        None, but populates the &#39;eics&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-354"><a href="#ReadCoreMSHDFMassSpectra.import_eics-354"><span class="linenos">354</span></a><span class="sd">        object with a dictionary of the &#39;eics&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-355"><a href="#ReadCoreMSHDFMassSpectra.import_eics-355"><span class="linenos">355</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-356"><a href="#ReadCoreMSHDFMassSpectra.import_eics-356"><span class="linenos">356</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-357"><a href="#ReadCoreMSHDFMassSpectra.import_eics-357"><span class="linenos">357</span></a>        <span class="n">dict_group_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;eics&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-358"><a href="#ReadCoreMSHDFMassSpectra.import_eics-358"><span class="linenos">358</span></a>        <span class="n">dict_group_keys</span> <span class="o">=</span> <span class="n">dict_group_load</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-359"><a href="#ReadCoreMSHDFMassSpectra.import_eics-359"><span class="linenos">359</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dict_group_keys</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-360"><a href="#ReadCoreMSHDFMassSpectra.import_eics-360"><span class="linenos">360</span></a>            <span class="n">my_eic</span> <span class="o">=</span> <span class="n">EIC_Data</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-361"><a href="#ReadCoreMSHDFMassSpectra.import_eics-361"><span class="linenos">361</span></a>                <span class="n">scans</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;scans&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-362"><a href="#ReadCoreMSHDFMassSpectra.import_eics-362"><span class="linenos">362</span></a>                <span class="n">time</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;time&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-363"><a href="#ReadCoreMSHDFMassSpectra.import_eics-363"><span class="linenos">363</span></a>                <span class="n">eic</span><span class="o">=</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s2">&quot;eic&quot;</span><span class="p">][:],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-364"><a href="#ReadCoreMSHDFMassSpectra.import_eics-364"><span class="linenos">364</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-365"><a href="#ReadCoreMSHDFMassSpectra.import_eics-365"><span class="linenos">365</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-366"><a href="#ReadCoreMSHDFMassSpectra.import_eics-366"><span class="linenos">366</span></a>                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;scans&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;eic&quot;</span><span class="p">]:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-367"><a href="#ReadCoreMSHDFMassSpectra.import_eics-367"><span class="linenos">367</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">my_eic</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">key</span><span class="p">][:])</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-368"><a href="#ReadCoreMSHDFMassSpectra.import_eics-368"><span class="linenos">368</span></a>                    <span class="c1"># if key is apexes, convert to a tuple of a list</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-369"><a href="#ReadCoreMSHDFMassSpectra.import_eics-369"><span class="linenos">369</span></a>                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;apexes&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-370"><a href="#ReadCoreMSHDFMassSpectra.import_eics-370"><span class="linenos">370</span></a>                        <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">my_eic</span><span class="o">.</span><span class="n">apexes</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-371"><a href="#ReadCoreMSHDFMassSpectra.import_eics-371"><span class="linenos">371</span></a>            <span class="c1"># Add to mass_spectra object</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-372"><a href="#ReadCoreMSHDFMassSpectra.import_eics-372"><span class="linenos">372</span></a>            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">dict_group_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;mz&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">my_eic</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-373"><a href="#ReadCoreMSHDFMassSpectra.import_eics-373"><span class="linenos">373</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-374"><a href="#ReadCoreMSHDFMassSpectra.import_eics-374"><span class="linenos">374</span></a>        <span class="c1"># Add to mass features</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-375"><a href="#ReadCoreMSHDFMassSpectra.import_eics-375"><span class="linenos">375</span></a>        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-376"><a href="#ReadCoreMSHDFMassSpectra.import_eics-376"><span class="linenos">376</span></a>            <span class="n">mz</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">mz</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-377"><a href="#ReadCoreMSHDFMassSpectra.import_eics-377"><span class="linenos">377</span></a>            <span class="k">if</span> <span class="n">mz</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_eics-378"><a href="#ReadCoreMSHDFMassSpectra.import_eics-378"><span class="linenos">378</span></a>                <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_eic_data</span> <span class="o">=</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">eics</span><span class="p">[</span><span class="n">mz</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Imports the extracted ion chromatograms from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase object to populate with extracted ion chromatograms.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the 'eics' attribute on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with a dictionary of the 'eics' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.import_spectral_search_results" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">import_spectral_search_results</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.import_spectral_search_results-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-380"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-380"><span class="linenos">380</span></a>    <span class="k">def</span> <span class="nf">import_spectral_search_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-381"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-381"><span class="linenos">381</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Imports the spectral search results from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-382"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-382"><span class="linenos">382</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-383"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-383"><span class="linenos">383</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-384"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-384"><span class="linenos">384</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-385"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-385"><span class="linenos">385</span></a><span class="sd">        mass_spectra : LCMSBase | MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-386"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-386"><span class="linenos">386</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to populate with spectral search results.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-387"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-387"><span class="linenos">387</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-388"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-388"><span class="linenos">388</span></a><span class="sd">        Returns</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-389"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-389"><span class="linenos">389</span></a><span class="sd">        -------</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-390"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-390"><span class="linenos">390</span></a><span class="sd">        None, but populates the &#39;spectral_search_results&#39; attribute on the LCMSBase or MassSpectraBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-391"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-391"><span class="linenos">391</span></a><span class="sd">        object with a dictionary of the &#39;spectral_search_results&#39; from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-392"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-392"><span class="linenos">392</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-393"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-393"><span class="linenos">393</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-394"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-394"><span class="linenos">394</span></a>        <span class="n">overall_results_dict</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-395"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-395"><span class="linenos">395</span></a>        <span class="n">ms2_results_load</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="p">[</span><span class="s2">&quot;spectral_search_results&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-396"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-396"><span class="linenos">396</span></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-397"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-397"><span class="linenos">397</span></a>            <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-398"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-398"><span class="linenos">398</span></a>            <span class="k">for</span> <span class="n">k2</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-399"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-399"><span class="linenos">399</span></a>                <span class="n">ms2_search_res</span> <span class="o">=</span> <span class="n">SpectrumSearchResults</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-400"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-400"><span class="linenos">400</span></a>                    <span class="n">query_spectrum</span><span class="o">=</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">_ms</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-401"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-401"><span class="linenos">401</span></a>                    <span class="n">precursor_mz</span><span class="o">=</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">],</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-402"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-402"><span class="linenos">402</span></a>                    <span class="n">spectral_similarity_search_results</span><span class="o">=</span><span class="p">{},</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-403"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-403"><span class="linenos">403</span></a>                <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-404"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-404"><span class="linenos">404</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-405"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-405"><span class="linenos">405</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="p">{</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">}:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-406"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-406"><span class="linenos">406</span></a>                    <span class="nb">setattr</span><span class="p">(</span><span class="n">ms2_search_res</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">][</span><span class="n">key</span><span class="p">][:]))</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-407"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-407"><span class="linenos">407</span></a>                <span class="n">overall_results_dict</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)][</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-408"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-408"><span class="linenos">408</span></a>                    <span class="n">ms2_results_load</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">k2</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;precursor_mz&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-409"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-409"><span class="linenos">409</span></a>                <span class="p">]</span> <span class="o">=</span> <span class="n">ms2_search_res</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-410"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-410"><span class="linenos">410</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-411"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-411"><span class="linenos">411</span></a>        <span class="c1"># add to mass_spectra</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-412"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-412"><span class="linenos">412</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">overall_results_dict</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-413"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-413"><span class="linenos">413</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-414"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-414"><span class="linenos">414</span></a>        <span class="c1"># If there are mass features, associate the results with each mass feature</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-415"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-416"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-416"><span class="linenos">416</span></a>            <span class="k">for</span> <span class="n">mass_feature_id</span><span class="p">,</span> <span class="n">mass_feature</span> <span class="ow">in</span> <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-417"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-417"><span class="linenos">417</span></a>                <span class="n">scan_ids</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">ms2_scan_numbers</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-418"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-418"><span class="linenos">418</span></a>                <span class="k">for</span> <span class="n">ms2_scan_id</span> <span class="ow">in</span> <span class="n">scan_ids</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-419"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-419"><span class="linenos">419</span></a>                    <span class="n">precursor_mz</span> <span class="o">=</span> <span class="n">mass_feature</span><span class="o">.</span><span class="n">mz</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-420"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-420"><span class="linenos">420</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-421"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-421"><span class="linenos">421</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span><span class="n">precursor_mz</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-422"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-422"><span class="linenos">422</span></a>                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-423"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-423"><span class="linenos">423</span></a>                        <span class="k">pass</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-424"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-424"><span class="linenos">424</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-425"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-425"><span class="linenos">425</span></a>                        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">mass_features</span><span class="p">[</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-426"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-426"><span class="linenos">426</span></a>                            <span class="n">mass_feature_id</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-427"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-427"><span class="linenos">427</span></a>                        <span class="p">]</span><span class="o">.</span><span class="n">ms2_similarity_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-428"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-428"><span class="linenos">428</span></a>                            <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectral_search_results</span><span class="p">[</span><span class="n">ms2_scan_id</span><span class="p">][</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-429"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-429"><span class="linenos">429</span></a>                                <span class="n">precursor_mz</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-430"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-430"><span class="linenos">430</span></a>                            <span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.import_spectral_search_results-431"><a href="#ReadCoreMSHDFMassSpectra.import_spectral_search_results-431"><span class="linenos">431</span></a>                        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Imports the spectral search results from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (LCMSBase | MassSpectraBase):
The MassSpectraBase or LCMSBase object to populate with spectral search results.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>None, but populates the 'spectral_search_results' attribute on the LCMSBase or MassSpectraBase</strong></li>
<li><strong>object with a dictionary of the 'spectral_search_results' from the HDF5 file.</strong></li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_mass_spectra_obj</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">) -> <span class="n"><a href="../factory/lc_class.html#MassSpectraBase">corems.mass_spectra.factory.lc_class.MassSpectraBase</a></span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-433"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-433"><span class="linenos">433</span></a>    <span class="k">def</span> <span class="nf">get_mass_spectra_obj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MassSpectraBase</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-434"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-434"><span class="linenos">434</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-435"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-435"><span class="linenos">435</span></a><span class="sd">        Return mass spectra data object, populating the _ms list on MassSpectraBase object from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-436"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-436"><span class="linenos">436</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-437"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-437"><span class="linenos">437</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-438"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-438"><span class="linenos">438</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-439"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-439"><span class="linenos">439</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-440"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-440"><span class="linenos">440</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall spectra object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-441"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-441"><span class="linenos">441</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-442"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-443"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-443"><span class="linenos">443</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-444"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-444"><span class="linenos">444</span></a>        <span class="n">spectra_obj</span> <span class="o">=</span> <span class="n">MassSpectraBase</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-445"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-445"><span class="linenos">445</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-446"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-446"><span class="linenos">446</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-447"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-447"><span class="linenos">447</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-448"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-448"><span class="linenos">448</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-449"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-449"><span class="linenos">449</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-450"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-450"><span class="linenos">450</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-451"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-451"><span class="linenos">451</span></a>        <span class="c1"># This will populate the _ms list on the LCMS or MassSpectraBase object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-452"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spectra_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-453"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-453"><span class="linenos">453</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-454"><a href="#ReadCoreMSHDFMassSpectra.get_mass_spectra_obj-454"><span class="linenos">454</span></a>        <span class="k">return</span> <span class="n">spectra_obj</span>
</span></pre></div>


            <div class="docstring"><p>Return mass spectra data object, populating the _ms list on MassSpectraBase object from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>load_raw</strong> (bool):
If True, load raw data (unprocessed) from HDF5 files for overall spectra object and individual mass spectra. Default is True.</li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.get_lcms_obj" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.get_lcms_obj-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_lcms_obj</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">use_original_parser</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">) -> <span class="n"><a href="../factory/lc_class.html#LCMSBase">corems.mass_spectra.factory.lc_class.LCMSBase</a></span>:</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.get_lcms_obj-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.get_lcms_obj"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-456"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-456"><span class="linenos">456</span></a>    <span class="k">def</span> <span class="nf">get_lcms_obj</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-457"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-457"><span class="linenos">457</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_original_parser</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-458"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-458"><span class="linenos">458</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LCMSBase</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-459"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-459"><span class="linenos">459</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-460"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-460"><span class="linenos">460</span></a><span class="sd">        Return LCMSBase object, populating attributes on the LCMSBase object from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-461"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-461"><span class="linenos">461</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-462"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-462"><span class="linenos">462</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-463"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-463"><span class="linenos">463</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-464"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-464"><span class="linenos">464</span></a><span class="sd">        load_raw : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-465"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-465"><span class="linenos">465</span></a><span class="sd">            If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-466"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-466"><span class="linenos">466</span></a><span class="sd">        use_original_parser : bool</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-467"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-467"><span class="linenos">467</span></a><span class="sd">            If True, use the original parser to populate the LCMS object. Default is True.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-468"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-468"><span class="linenos">468</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-469"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-469"><span class="linenos">469</span></a><span class="sd">            The location of the raw file to parse if attempting to use original parser.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-470"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-470"><span class="linenos">470</span></a><span class="sd">            Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-471"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-471"><span class="linenos">471</span></a><span class="sd">            If the original file path has moved, this parameter can be used to specify the new location.</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-472"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-472"><span class="linenos">472</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-473"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-473"><span class="linenos">473</span></a>        <span class="c1"># Instantiate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-474"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-474"><span class="linenos">474</span></a>        <span class="n">lcms_obj</span> <span class="o">=</span> <span class="n">LCMSBase</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-475"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-475"><span class="linenos">475</span></a>            <span class="n">file_location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_location</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-476"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-476"><span class="linenos">476</span></a>            <span class="n">analyzer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-477"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-477"><span class="linenos">477</span></a>            <span class="n">instrument_label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">instrument_label</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-478"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-478"><span class="linenos">478</span></a>            <span class="n">sample_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sample_name</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-479"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-479"><span class="linenos">479</span></a>        <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-480"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-480"><span class="linenos">480</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-481"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-481"><span class="linenos">481</span></a>        <span class="c1"># This will populate the majority of the attributes on the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-482"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-482"><span class="linenos">482</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">load_raw</span><span class="o">=</span><span class="n">load_raw</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-483"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-483"><span class="linenos">483</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-484"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-484"><span class="linenos">484</span></a>        <span class="c1"># Set final attributes of the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-485"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-485"><span class="linenos">485</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">polarity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;polarity&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-486"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-486"><span class="linenos">486</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_scans_number_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-487"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-487"><span class="linenos">487</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_retention_time_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">scan_time</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-488"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-488"><span class="linenos">488</span></a>        <span class="n">lcms_obj</span><span class="o">.</span><span class="n">_tic_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcms_obj</span><span class="o">.</span><span class="n">scan_df</span><span class="o">.</span><span class="n">tic</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-489"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-489"><span class="linenos">489</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-490"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-490"><span class="linenos">490</span></a>        <span class="c1"># If use_original_parser is True, instantiate the original parser and populate the LCMS object</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-491"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-491"><span class="linenos">491</span></a>        <span class="k">if</span> <span class="n">use_original_parser</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-492"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-492"><span class="linenos">492</span></a>            <span class="n">lcms_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_original_parser</span><span class="p">(</span><span class="n">lcms_obj</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-493"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-493"><span class="linenos">493</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.get_lcms_obj-494"><a href="#ReadCoreMSHDFMassSpectra.get_lcms_obj-494"><span class="linenos">494</span></a>        <span class="k">return</span> <span class="n">lcms_obj</span>
</span></pre></div>


            <div class="docstring"><p>Return LCMSBase object, populating attributes on the LCMSBase object from the HDF5 file.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>load_raw</strong> (bool):
If True, load raw data (unprocessed) from HDF5 files for overall lcms object and individual mass spectra. Default is True.</li>
<li><strong>use_original_parser</strong> (bool):
If True, use the original parser to populate the LCMS object. Default is True.</li>
<li><strong>raw_file_path</strong> (str):
The location of the raw file to parse if attempting to use original parser.
Default is None, which attempts to get the raw file path from the HDF5 file.
If the original file path has moved, this parameter can be used to specify the new location.</li>
</ul>
</div>


                            </div>
                            <div id="ReadCoreMSHDFMassSpectra.add_original_parser" class="classattr">
                                        <input id="ReadCoreMSHDFMassSpectra.add_original_parser-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_original_parser</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">mass_spectra</span>, </span><span class="param"><span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ReadCoreMSHDFMassSpectra.add_original_parser-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ReadCoreMSHDFMassSpectra.add_original_parser"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-496"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-496"><span class="linenos">496</span></a>    <span class="k">def</span> <span class="nf">add_original_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass_spectra</span><span class="p">,</span> <span class="n">raw_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-497"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-497"><span class="linenos">497</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-498"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-498"><span class="linenos">498</span></a><span class="sd">        Add the original parser to the mass spectra object.</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-499"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-499"><span class="linenos">499</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-500"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-500"><span class="linenos">500</span></a><span class="sd">        Parameters</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-501"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-501"><span class="linenos">501</span></a><span class="sd">        ----------</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-502"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-502"><span class="linenos">502</span></a><span class="sd">        mass_spectra : MassSpectraBase | LCMSBase</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-503"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-503"><span class="linenos">503</span></a><span class="sd">            The MassSpectraBase or LCMSBase object to add the original parser to.</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-504"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-504"><span class="linenos">504</span></a><span class="sd">        raw_file_path : str</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-505"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-505"><span class="linenos">505</span></a><span class="sd">            The location of the raw file to parse. Default is None, which attempts to get the raw file path from the HDF5 file.</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-506"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-506"><span class="linenos">506</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-507"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-507"><span class="linenos">507</span></a>        <span class="c1"># Try to get the raw file path from the HDF5 file</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-508"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-508"><span class="linenos">508</span></a>        <span class="k">if</span> <span class="n">raw_file_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-509"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-509"><span class="linenos">509</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-510"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-510"><span class="linenos">510</span></a>            <span class="c1"># Check if og_file_location exists, if not raise an error</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-511"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-511"><span class="linenos">511</span></a>            <span class="n">raw_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;original_file_location&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-512"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-512"><span class="linenos">512</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-513"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-513"><span class="linenos">513</span></a>        <span class="n">raw_file_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-514"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">raw_file_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-515"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-515"><span class="linenos">515</span></a>            <span class="k">raise</span> <span class="ne">FileExistsError</span><span class="p">(</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-516"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-516"><span class="linenos">516</span></a>                <span class="s2">&quot;File does not exist: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">),</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-517"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-517"><span class="linenos">517</span></a>                <span class="s2">&quot;. Cannot use original parser for instatiating the lcms_obj.&quot;</span><span class="p">,</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-518"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-518"><span class="linenos">518</span></a>            <span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-519"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-519"><span class="linenos">519</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-520"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-520"><span class="linenos">520</span></a>        <span class="c1"># Get the original parser type</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-521"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-521"><span class="linenos">521</span></a>        <span class="n">og_parser_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h5pydata</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;parser_type&quot;</span><span class="p">]</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-522"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-522"><span class="linenos">522</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-523"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-523"><span class="linenos">523</span></a>        <span class="k">if</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;ImportMassSpectraThermoMSFileReader&quot;</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-524"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-524"><span class="linenos">524</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">ImportMassSpectraThermoMSFileReader</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-525"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-525"><span class="linenos">525</span></a>        <span class="k">elif</span> <span class="n">og_parser_type</span> <span class="o">==</span> <span class="s2">&quot;MZMLSpectraParser&quot;</span><span class="p">:</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-526"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-526"><span class="linenos">526</span></a>            <span class="n">parser</span> <span class="o">=</span> <span class="n">MZMLSpectraParser</span><span class="p">(</span><span class="n">raw_file_path</span><span class="p">)</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-527"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-527"><span class="linenos">527</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-528"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-528"><span class="linenos">528</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser_class</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="vm">__class__</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-529"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-529"><span class="linenos">529</span></a>        <span class="n">mass_spectra</span><span class="o">.</span><span class="n">spectra_parser</span> <span class="o">=</span> <span class="n">parser</span>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-530"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-530"><span class="linenos">530</span></a>
</span><span id="ReadCoreMSHDFMassSpectra.add_original_parser-531"><a href="#ReadCoreMSHDFMassSpectra.add_original_parser-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="n">mass_spectra</span>
</span></pre></div>


            <div class="docstring"><p>Add the original parser to the mass spectra object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>mass_spectra</strong> (MassSpectraBase | LCMSBase):
The MassSpectraBase or LCMSBase object to add the original parser to.</li>
<li><strong>raw_file_path</strong> (str):
The location of the raw file to parse. Default is None, which attempts to get the raw file path from the HDF5 file.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum">corems.mass_spectrum.input.coremsHDF5.ReadCoreMSHDF_MassSpectrum</a></dt>
                                <dd id="ReadCoreMSHDFMassSpectra.h5pydata" class="variable"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.h5pydata">h5pydata</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.load_raw_data" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.load_raw_data">load_raw_data</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_mass_spectrum" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_mass_spectrum">get_mass_spectrum</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.load_settings" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.load_settings">load_settings</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_dataframe" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_dataframe">get_dataframe</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_time_index_to_pull" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_time_index_to_pull">get_time_index_to_pull</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_high_level_attr_data" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_high_level_attr_data">get_high_level_attr_data</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_scan_group_attr_data" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_scan_group_attr_data">get_scan_group_attr_data</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_raw_data_attr_data" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_raw_data_attr_data">get_raw_data_attr_data</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_output_parameters" class="function"><a href="../../mass_spectrum/input/coremsHDF5.html#ReadCoreMSHDF_MassSpectrum.get_output_parameters">get_output_parameters</a></dd>

            </div>
            <div><dt><a href="../../mass_spectrum/input/massList.html#ReadCoremsMasslist">corems.mass_spectrum.input.massList.ReadCoremsMasslist</a></dt>
                                <dd id="ReadCoreMSHDFMassSpectra.add_molecular_formula" class="function"><a href="../../mass_spectrum/input/massList.html#ReadCoremsMasslist.add_molecular_formula">add_molecular_formula</a></dd>

            </div>
            <div><dt><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass">corems.mass_spectrum.input.baseClass.MassListBaseClass</a></dt>
                                <dd id="ReadCoreMSHDFMassSpectra.file_location" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.file_location">file_location</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.header_lines" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.header_lines">header_lines</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.isCentroid" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.isCentroid">isCentroid</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.isThermoProfile" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.isThermoProfile">isThermoProfile</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.headerless" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.headerless">headerless</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.analyzer" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.analyzer">analyzer</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.instrument_label" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.instrument_label">instrument_label</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.sample_name" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.sample_name">sample_name</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.parameters" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.parameters">parameters</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.set_parameter_from_toml" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.set_parameter_from_toml">set_parameter_from_toml</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.set_parameter_from_json" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.set_parameter_from_json">set_parameter_from_json</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.data_type" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.data_type">data_type</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.delimiter" class="variable"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.delimiter">delimiter</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.encoding_detector" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.encoding_detector">encoding_detector</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.set_data_type" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.set_data_type">set_data_type</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.clean_data_frame" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.clean_data_frame">clean_data_frame</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.check_columns" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.check_columns">check_columns</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.read_xml_peaks" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.read_xml_peaks">read_xml_peaks</a></dd>
                <dd id="ReadCoreMSHDFMassSpectra.get_xml_polarity" class="function"><a href="../../mass_spectrum/input/baseClass.html#MassListBaseClass.get_xml_polarity">get_xml_polarity</a></dd>

            </div>
            <div><dt>threading.Thread</dt>
                                <dd id="ReadCoreMSHDFMassSpectra.start" class="function">start</dd>
                <dd id="ReadCoreMSHDFMassSpectra.join" class="function">join</dd>
                <dd id="ReadCoreMSHDFMassSpectra.name" class="variable">name</dd>
                <dd id="ReadCoreMSHDFMassSpectra.ident" class="variable">ident</dd>
                <dd id="ReadCoreMSHDFMassSpectra.is_alive" class="function">is_alive</dd>
                <dd id="ReadCoreMSHDFMassSpectra.daemon" class="variable">daemon</dd>
                <dd id="ReadCoreMSHDFMassSpectra.isDaemon" class="function">isDaemon</dd>
                <dd id="ReadCoreMSHDFMassSpectra.setDaemon" class="function">setDaemon</dd>
                <dd id="ReadCoreMSHDFMassSpectra.getName" class="function">getName</dd>
                <dd id="ReadCoreMSHDFMassSpectra.setName" class="function">setName</dd>
                <dd id="ReadCoreMSHDFMassSpectra.native_id" class="variable">native_id</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>